{% include '@app/header.twig' %}
<div class="col-md-12 col-sm-12 col-xs-12">
    <div class="x_panel">
        <div class="x_content">
            <form method="post" enctype="multipart/form-data" data-parsley-validate class="twilio-admin form-horizontal form-label-left" name="save_form" action="{{ data.action }}">
                <div class="twilio-admin-box">
                    <div class="form-group">
                        <label class="control-label col-md-3">{% helper lang.l('admin_feild_account_sid', 'twilio_chat') %}:</label>
                        <div class="col-md-9">
                            <input type="text" name="keys[account_sid]" value="{{ settings.keys.account_sid }}" class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3">{% helper lang.l('admin_feild_auth_token', 'twilio_chat') %}:</label>
                        <div class="col-md-9">
                            <input type="text" name="keys[auth_token]" value="{{ settings.keys.auth_token }}" class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3">{% helper lang.l('admin_feild_api_key_sid', 'twilio_chat') %}:</label>
                        <div class="col-md-9">
                            <input type="text" name="keys[api_key_sid]" value="{{ settings.keys.api_key_sid }}" class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3">{% helper lang.l('admin_feild_api_key_secret', 'twilio_chat') %}:</label>
                        <div class="col-md-9">
                            <input type="text" name="keys[api_key_secret]" value="{{ settings.keys.api_key_secret }}" class="form-control">
                        </div>
                    </div>
                </div>
                <br>
                <div class="form-group">
                    <label class="col-md-3 col-sm-3 col-xs-12 control-label">
                        {% helper lang.l('pay_or_not', 'twilio_chat') %}:
                    </label>
                    <div class="col-md-9 col-sm-9 col-xs-12">
                        <label>
                            <input name="payment[type]" type="checkbox" value="payed" class="type_pay flat" {% if settings.payment.type == 'payed' %}checked="checked"{% endif %}>
                            {% helper lang.l('is_pay_chat', 'twilio_chat') %}
                        </label>
                    </div>
                </div>
                <div class="twilio-admin-box  amount-input" style="display: {% if settings.payment.type %} block  {% else %} none {% endif %}">
                    <div class="form-group" >
                        <label class="col-md-3 col-sm-3 col-xs-12 control-label">
                            {% helper lang.l('amount_chat', 'twilio_chat') %}
                        </label>

                        <div class="col-md-9 col-sm-9 col-xs-12">
                            <input step="0.01" name="payment[amount]" type="number" value="{{ settings.payment.amount }}" class="form-control amount"/>
                        </div>
                    </div>
                </div>
                <br>
                <div class="form-group">
                    <div class="col-md-9 col-md-offset-3">
                        <input type="submit" name="btn_save" value="{% helper lang.l('btn_save', 'start', '', 'button') %}" class="btn btn-success">
                        <a class="btn btn-default" href="{{ site_url }}admin/start/menu/add_ons_items">
                            {% helper lang.l('btn_cancel', 'start') %}
                        </a>
                    </div>
                </div>
            </form>
            <div class="clearfix"></div>
            <div class="panel panel-warning">
                <div class="panel-heading">{% helper lang.l('you_have_configure_chat', 'twilio_chat') %}  <a class="alert-link" href="https://www.twilio.com/console/video/configure" target="_blank">http://twilio.com/console/video/configure</a></div>
                <div class="panel-body">
                    <p><b>STATUS CALLBACK URL </b>{{ callbackurl }}</p>
                </div>
            </div>
        </div>
    </div>
</div>


<table id="data" cellspacing="0" cellpadding="0" class="table table-striped responsive-utilities jambo_table" width="100%">
    <thead>
    <tr class="headings">
        <th class="column-title">{% helper lang.l('field_creator_chat', 'twilio_chat') %}</th>
        <th class="column-title">{% helper lang.l('field_invited_user', 'twilio_chat') %}</th>
        <th class="column-title">{% helper lang.l('field_status', 'twilio_chat') %}</th>
        <th class="column-title">{% helper lang.l('field_date_time', 'twilio_chat') %}</th>
        <th class="column-title">
            {% helper lang.l('field_amount', 'twilio_chat') %} <br>
            <span>
               {% helper lang.l('total', 'twilio_chat') %} <br> {% helper start.currency_format_output({'value': all_sum })  %}
            </span>
        </th>
        <th class="column-title">{% helper lang.l('field_time_create', 'twilio_chat') %}</th>
    </tr>
    </thead>
    <tbody>
    {% for item in chats %}
        <tr class="">
            <td>
                <b>{{ item.name_creator }}</b>
            </td>
            <td>
                <b>{{ item.name_invaded }}</b>
            </td>
            <td>{{ item.status }}</td>
            <td>{{ item.duration }}</td>
            <td>{% helper start.currency_format_output({'value': item.amount ?: 0})  %}</td>
            <td>{{ item.date_created }}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>
<!-- Datatables -->
<script src="{{ site_root }}application/views/gentelella/js/datatables/js/jquery.dataTables.js"></script>
<script>
    $(document).ready(function () {

        var oTable = $('#data').dataTable({
            "oLanguage": {
                "sSearch": "{% helper lang.l('search_all_column','twilio_chat') %}:",
                "sEmptyTable": "{% helper lang.l('no_last_chats','twilio_chat') %}"
            },
            "aoColumnDefs": [
                {
                    'bSortable': false,
                    'aTargets': []
                } //disables sorting for column one
            ],
            'iDisplayLength': 10,
            "bPaginate": true,
            "bInfo": false,
            "dom": 'T<"clear"><"actions">lfrtip',
        });

        $(".type_pay").on('change',function(){
            if (this.checked){
                $(".amount-input").slideDown();
            }else {
                $(".amount-input").slideUp();
                $('.amount').val(0.01);
            }

        });

    });
</script>

{% include '@app/footer.twig' %}

/*! For license information please see modules.34d29e66092cccd4e35b.js.LICENSE.txt */
(()=>{var __webpack_modules__={9165:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=9165,e.exports=t},7398:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.AccessPermissions=function(e){this.properties={siteUrl:"/",id:{accessPermissions:"#access_permissions",periodsProgressBar:"#periods-progress-bar",setPrice:"#set-price",paySystemsList:"#pay-systems-list",paymentForm:"#payment-form",saving:"#saving"},class:{periodBlock:".period-block",allPeriod:".all-period",progressBarSelected:".progress-bar-selected",progressBarEmpty:".progress-bar-empty",periodDescription:".period-description",progressBar:".progress-bar",saving:".saving",setData:".set-data-js",breadcrumbs:".breadcrumbs",advertisingImage:".advertising-image",itemGroup:".item-group",accessList:".access-list",selectedJs:".selected-js",singlPeriod:".singl-period"},dataAction:{selectGroup:'[data-action="select-group"]',setPrice:'[data-action="set-price"]',selectedPeriod:'[data-action="selected-period"]',paySystems:'[data-action="pay-systems"]',setPaySystem:'[data-action="set-paysystem"]',payment:'[data-action="payment"]',close:"[data-action=close]",groupToggle:"[data-action=groupToggle]",saving:"[data-action=saving]",accessPermissionsPage:'[data-action="access-permissions-page"]'},dataContent:{advertisingImage:"[data-content=advertising-image]"},url:{loadGroupPage:"access_permissions/group/",loadAccessPermissionsPage:"access_permissions/index/",groupPage:"access_permissions/groupPage/",selectedPeriod:"access_permissions/selectedPeriod/",paymentForm:"access_permissions/paymentForm/",payment:"access_permissions/payment/"},lang:{systemError:"System error!"},headerAdvertisingImage:!1,currency:"",calculation:!1,group_gid:null,errorObj:new Errors,contentObj:new loadingContent({loadBlockWidth:"400px",loadBlockLeftType:"center",loadBlockTopType:"top",loadBlockTopPoint:100,draggable:!1,closeBtnUse:!0,closeBtnClass:"btn-close",destroyOnReload:!1,onClose:function(){t.serviceRedirect()}}),currency_output:!1};var t=this,o={group_gid:t.properties.group_gid},r=["col-xs-12","col-md-4 col-md-offset-4","col-md-8 col-md-offset-2","col-md-10 col-md-offset-1"];this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),t.rendering()},this.initControls=function(){$(document).off("click",t.properties.class.periodBlock).on("click",t.properties.class.periodBlock,(function(){t.togglePeriods($(this))})).off("click",t.properties.class.allPeriod).on("click",t.properties.class.allPeriod,(function(){t.setPeriod($(this))})).off("click",t.properties.dataAction.selectGroup).on("click",t.properties.dataAction.selectGroup,(function(){t.selectGroup($(this))})).off("click",t.properties.id.periodsProgressBar+">"+t.properties.class.progressBar).on("click",t.properties.id.periodsProgressBar+">"+t.properties.class.progressBar,(function(){t.changeSelectedPeriod($(this))})).off("click",t.properties.dataAction.setPrice).on("click",t.properties.dataAction.setPrice,(function(){t.changeSelectedPeriod($(this))})).off("click",t.properties.dataAction.selectedPeriod).on("click",t.properties.dataAction.selectedPeriod,(function(){t.selectedPeriod($(this))})).off("click",t.properties.dataAction.setPaySystem).on("click",t.properties.dataAction.setPaySystem,(function(){t.loadPaymentForm($(this))})).off("click",t.properties.dataAction.payment).on("click",t.properties.dataAction.payment,(function(){t.payment($(this))})).off("click",t.properties.dataAction.close).on("click",t.properties.dataAction.close,(function(){t.close()})).off("click",t.properties.dataAction.groupToggle).on("click",t.properties.dataAction.groupToggle,(function(){t.groupToggle($(this))})).off("click",t.properties.class.setData).on("click",t.properties.class.setData,(function(){t.setGroupData($(this))})).off("click",t.properties.dataAction.accessPermissionsPage).on("click",t.properties.dataAction.accessPermissionsPage,(function(){t.accessPermissionsPage()})).off("click",t.properties.dataAction.paySystems).on("click",t.properties.dataAction.paySystems,(function(){$(t.properties.class.singlPeriod).length>0&&t.setData($(t.properties.class.singlPeriod))}))},this.rendering=function(){var e=$(t.properties.class.itemGroup).length;e<5?$(t.properties.class.accessList).parent().addClass(r[e]):$(t.properties.class.accessList).parent().addClass(r[0]),t.headerAdvertisingImage(),t.properties.calculation&&t.savingCalculation()},this.headerAdvertisingImage=function(){if(!1!==t.properties.headerAdvertisingImage){if(!1===$(t.properties.class.advertisingImage).is(":visible")){if($(t.properties.class.breadcrumbs).hide(),$("body").is("header"))var e=$("header");else e=$(".pre-main-inner-content").first();e.after((function(){return t.properties.headerAdvertisingImage=!1,$(t.properties.dataContent.advertisingImage).html()}))}}else $(t.properties.class.advertisingImage).remove(),$(t.properties.class.breadcrumbs).show()},this.accessPermissionsPage=function(){locationHref(t.properties.siteUrl+t.properties.url.loadAccessPermissionsPage,!0)},this.togglePeriods=function(e){$("#period-"+e.data("group")+"-all").toggle()},this.setPeriod=function(e){$("#period-"+e.data("group")+"-all").hide(),$("#period-"+e.data("group")).find("div").html((function(){return t.currencyOutput(e.data("price"))})),$("#period-"+e.data("group")).find("span.period").html(e.find("span").html()),$("#period-"+e.data("group")).attr({"data-group":e.data("group"),"data-id":e.data("id"),"data-period":e.data("period"),"data-price":e.data("price")}),$(t.properties.dataAction.selectGroup).attr("href",t.properties.siteUrl+t.properties.url.groupPage+e.data("group")+"/"+e.data("id"))},this.selectGroup=function(e){var o=$("#period-"+e.data("group"));t.query(t.properties.url.loadGroupPage,{period_id:o.data("id"),group_gid:o.data("group"),send:1},"json",(function(e){t.properties.headerAdvertisingImage=!1,t.headerAdvertisingImage(),t.setData(o),$(t.properties.id.accessPermissions).html(e.html),t.setPrice(),t.savingCalculation()}))},this.setData=function(e){o.period=e.data("period"),o.period_id=e.data("id"),o.price=e.data("price"),void 0!==e.data("group")&&(o.group_gid=e.data("group")),void 0!==e.data("key")&&(o.key=e.data("key"))},this.setPrice=function(e){o.price=void 0!==e?e:o.price,$(t.properties.id.setPrice).html(t.currencyOutput(o.price))},this.changeSelectedPeriod=function(e){void 0===o.period_id&&t.setData($(t.properties.class.selectedJs)),$(t.properties.class.progressBar).each((function(){$(this).data("key")<=e.data("key")?$(this).addClass("progress-bar-selected").removeClass("progress-bar-empty"):$(this).addClass("progress-bar-empty").removeClass("progress-bar-selected")})),$(t.properties.id.periodsProgressBar).find("i").remove(),$('[data-id="'+o.period_id+'"]').find(t.properties.class.periodDescription).prepend('<div class="delimiter">|</div>'),$('[data-id="'+e.data("id")+'"]').find(t.properties.class.periodDescription).find(".delimiter").remove(),$('[data-id="'+e.data("id")+'"]').find(t.properties.class.periodDescription).prepend('<i class="fa fa-circle"></i>'),t.setData(e),t.setPrice(),t.savingCalculation()},this.loadPaymentForm=function(e){var r=e.data("gid");null===o.group_gid&&(o.group_gid=t.properties.group_gid),t.query(t.properties.url.paymentForm,{period_id:o.period_id,group_gid:o.group_gid,pay_system_gid:r,send:1},"json",(function(e){t.properties.contentObj.show_load_block(e.html)}))},this.payment=function(e){sendAnalytics("membership_system_"+e.data("pay_system")+"_payment_send","membership_system_payment_send","user"),sendAnalytics("membership_group_"+e.data("group")+"_payment_send","membership_group_payment_send","user"),"account"===e.data("pay_system")?t.query(t.properties.url.payment,{period_id:e.data("period"),group_gid:e.data("group"),pay_system_gid:e.data("pay_system"),send:1},"json",(function(o){t.properties.contentObj.show_load_block(o.html),o.success&&o.success.length>0?(sendAnalytics("membership_system_"+e.data("pay_system")+"_success","membership_payments_system_success","user"),sendAnalytics("membership_group_"+e.data("group")+"_success","membership_payments_group_success","user")):(sendAnalytics("membership_system_"+e.data("pay_system")+"_payment_fail","membership_group_payment_system_fail","user"),sendAnalytics("membership_group_"+e.data("group")+"_payment_fail","membership_group_payment_fail","user"))})):$(t.properties.id.paymentForm).submit()},this.close=function(){t.properties.contentObj.hide_load_block()},this.groupToggle=function(e){if($("#"+e.data("group")+"-block .module").length>0){var t=$("#"+e.data("group")+"-block");!1===t.hasClass("active")?(t.addClass("active"),e.closest(".modules").removeClass("collapsed-list")):(e.closest(".modules").addClass("collapsed-list"),t.removeClass("active"))}},this.savingCalculation=function(){void 0===o.period_id&&t.setData($(t.properties.class.selectedJs));var e=$(t.properties.id.periodsProgressBar+">div").first(),r=e.data("price")/e.data("period"),i=o.period*r-o.price;i>0?($(t.properties.id.saving).show(),$(t.properties.dataAction.saving).html(t.currencyOutput(i))):$(t.properties.id.saving).hide()},this.setGroupData=function(e){var o=e.data("group"),r=$("#period-"+o);if(t.setData(r),0===$("#"+o+"-block .module").length){var i=$("#"+o+"-block");!1===i.hasClass("active")&&!1===$("#pay-systems-list-"+o).is(":visible")?i.addClass("active"):i.removeClass("active")}},this.serviceRedirect=function(){var e=$(t.properties.dataAction.close).data("redirect");e&&locationHref(e,!0)},this.currencyOutput=function(e){if("function"==typeof t.properties.currency_output)try{return t.properties.currency_output(e)}catch(e){console.log(e)}return e+"<span class='currency'>"+t.properties.currency+"</span>"},this.query=function(e,o,r,i){return/^(f|ht)tps?:\/\//i.test(e)||(e=t.properties.siteUrl+e),$.ajax({url:e,type:"POST",cache:!1,data:o,dataType:r,success:function(e){void 0!==e.error&&e.error.length>0&&t.properties.errorObj.show_error_block(e.error,"error"),void 0!==e.info&&e.info.length>0&&t.properties.errorObj.show_error_block(e.info,"info"),void 0!==e.success&&e.success.length>0&&t.properties.errorObj.show_error_block(e.success,"success"),void 0!==i&&i(e)}}),!1},t.Init(e)})},8582:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}"object"===o(t)&&(t.__esModule=!0,t.AdminAccessPermissions=function(e){this.properties={siteUrl:"/",groups:!1,dataAction:{add:'[data-action="add"]',addPeriod:'[data-action="add-period"]',edit:'[data-action="edit"]',delete:'[data-action="delete"]',save:'[data-action="save"]',status:'[data-action="status"]',changePermissions:'[data-action="change_permissions"]',membershipChange:'[data-action="membership-change"]',addMembership:'[data-action="add-membership"]',changeMembership:'[data-action="change-membership"]'},url:{saveSubscriptionType:"admin/access_permissions/saveSubscriptionType/",loadSubscriptionForm:"admin/access_permissions/loadSubscriptionForm/",editSubscription:"admin/access_permissions/editSubscription/",deleteSubscription:"admin/access_permissions/deleteSubscription/",statusSubscription:"admin/access_permissions/statusSubscription/",loadPermissionsList:"admin/access_permissions/loadPermissionsList/",loadPeriodForm:"admin/access_permissions/loadPeriodForm/",membershipChange:"admin/access_permissions/membershipChange/",addMembership:"admin/access_permissions/addMembership/",reloadSubscriptionType:{all_users:"admin/access_permissions/registered/",user_types:"admin/access_permissions/userTypes/"}},id:{accessContent:"#access-content",addSubscriptionType:"#add-subscription-type",myTab:"#myTab",saveForm:"#save_form",permissionsList:"#permissions-list",periodsList:"#periods-list",sidebarMenu:"#sidebar-menu",userMembershipStr:"#user_membership_str-",userMembershipChoise:"#user_membership_choise"},class:{membershipChangeList:".membership_change_list",grouping:".grouping"},saveSubscriptionClass:".subscription_type-js",scrollToBlock:"scrollToBlock",errorObj:new Errors,lang:{expires:"Expires"},contentObj:new loadingContent({loadBlockWidth:"680px",closeBtnClass:"load_content_controller_close",closeBtnPadding:15,loadBlockSize:"lg",footerButtons:'<input type="button" data-action="save" value="Save" class="btn btn-primary">'})};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),t.scrollToBlock(),t.renderPage()},this.renderPage=function(){var e=$(window).width()-$(t.properties.id.sidebarMenu).width();if(e<$(t.properties.id.permissionsList).width()){var o=(e-500)/$(t.properties.id.permissionsList).find("th").length;$(t.properties.id.permissionsList).find("th>div:not(:first)").width(o+"px").addClass("text-ellipsis"),$(t.properties.id.periodsList).find("th>div:not(:first)").width(o+"px").addClass("text-ellipsis")}},this.initControls=function(){$(document).off("change",t.properties.saveSubscriptionClass).on("change",t.properties.saveSubscriptionClass,(function(){t.setSubscriptionType($(this))})).off("click",t.properties.dataAction.add).on("click",t.properties.dataAction.add,(function(){t.loadSubscriptionForm($(this))})).off("click",t.properties.dataAction.edit).on("click",t.properties.dataAction.edit,(function(){t.loadSubscriptionForm($(this))})).off("click",t.properties.dataAction.delete).on("click",t.properties.dataAction.delete,(function(){t.deleteSubscription($(this))})).off("click",t.properties.dataAction.save).on("click",t.properties.dataAction.save,(function(){t.saveSubscription()})).off("ifChanged",t.properties.dataAction.status).on("ifChanged",t.properties.dataAction.status,(function(){$(this).trigger("change"),t.statusSubscription($(this))})).off("click",t.properties.dataAction.changePermissions).on("click",t.properties.dataAction.changePermissions,(function(){t.changePermissionsForm($(this))})).off("click",t.properties.dataAction.addPeriod).on("click",t.properties.dataAction.addPeriod,(function(){t.loadPeriodForm($(this))})).off("click",t.properties.dataAction.membershipChange).on("click",t.properties.dataAction.membershipChange,(function(){t.membershipChange($(this))})).off("click",t.properties.dataAction.addMembership).on("click",t.properties.dataAction.addMembership,(function(){t.addMembership($(this))})).off("click",t.properties.dataAction.changeMembership).on("click",t.properties.dataAction.changeMembership,(function(){t.changeMembership($(this))})).off("click",t.properties.id.userMembershipChoise).on("click",t.properties.id.userMembershipChoise,(function(){t.choiseMembership($(this))}))},this.setSubscriptionType=function(e){$(t.properties.saveSubscriptionClass).prop("checked",!1).parent().removeClass("checked");var o=void 0!==e.data("user_type")?e.data("user_type"):0;t.query(t.properties.url.saveSubscriptionType,{type:e.data("type"),data:1,user_type:o,send:1},"json",(function(o){o?(e.prop("checked",!0).addClass("checked"),$(t.properties.id.accessContent).html(o.html).find("input").iCheck({checkboxClass:"icheckbox_flat-green"}),$(t.properties.id.myTab).find("li:eq(0)").addClass("active"),locationHref(t.properties.siteUrl+t.properties.url.reloadSubscriptionType[e.data("type")])):locationHref(t.properties.siteUrl+t.properties.url.reloadSubscriptionType.all_users)}))},this.loadSubscriptionForm=function(e){t.query(t.properties.url.loadSubscriptionForm,{id:e.data("id"),send:1},"json",(function(e){t.properties.contentObj.show_load_block(e.html)}))},this.deleteSubscription=function(e){void 0!==e.data("id")&&e.data("id")>0&&t.query(t.properties.url.deleteSubscription,{id:e.data("id"),gid:e.data("gid"),send:1},"json",(function(t){0!==t.is_delete&&(e.closest("tr").remove(),$('[data-group_actions="'+e.data("gid")+'"]').remove())}))},this.saveSubscription=function(){var e,o=$(t.properties.id.saveForm),i=function(e,t){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=function(e,t){if(e){if("string"==typeof e)return r(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,c=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return a=e.done,e},e:function(e){c=!0,s=e},f:function(){try{a||null==o.return||o.return()}finally{if(c)throw s}}}}(o[0]);try{for(i.s();!(e=i.n()).done;){var n=e.value;"number"==typeof n.value&&n.value<1&&(n.value=1)}}catch(e){i.e(e)}finally{i.f()}t.query(o.attr("action"),o.serialize(),"json",(function(e){if(e.error.length)return!1;void 0!==e.url_reload&&(lightSetCookie(t.properties.scrollToBlock,t.getBodyScrollTop()),t.properties.contentObj.hide_load_block(),setTimeout((function(){locationHref(e.url_reload)}),2e3))}))},this.statusSubscription=function(e){void 0!==e.data("id")&&e.data("id")>0&&t.query(t.properties.url.statusSubscription,{id:e.data("id"),gid:e.data("gid"),status:!0===e.find("input").prop("checked")?1:0,send:1},"json")},this.changePermissionsForm=function(e){void 0!==e.data("module_gid")&&void 0!==e.data("access")&&t.query(t.properties.url.loadPermissionsList,{module_gid:e.data("module_gid"),method:e.data("method"),access:e.data("access"),user_type:e.data("user_type"),send:1},"json",(function(e){t.properties.contentObj.show_load_block(e.html)}))},this.loadPeriodForm=function(e){t.query(t.properties.url.loadPeriodForm,{id:e.data("id"),user_type:e.data("user_type"),send:1},"json",(function(e){t.properties.contentObj.show_load_block(e.html)}))},this.scrollToBlock=function(){var e=0;"undefined"!=typeof lightGetCookie&&(e=lightGetCookie(t.properties.scrollToBlock)),e>0&&(t.clearBodyScrollTop(),$("html,body").animate({scrollTop:e},100))},this.getBodyScrollTop=function(){return t.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop},this.clearBodyScrollTop=function(){lightSetCookie(t.properties.scrollToBlock,0)},this.getMemberships=function(){if(0!=t.properties.groups)return t.properties.groups;t.query(t.properties.url.membershipChange,{},"json",(function(e){return t.properties.groups=e.groups,e.groups}))},this.membershipChange=function(e){var o=parseInt(e.data("days")),r=t.getMemberships(),i=e.data("groups").split(",");if(r){var n='<div class="list-group membership_change_list">';if(void 0!==r.short_by_type)for(var s in r.short_by_type[e.data("user_type")])-1!==$.inArray(r.full[s].group_gid,i)||r.full[s].group_gid===i?n+='<a data-action="add-membership" data-id_user="'+e.data("id_user")+'" data-gid="'+s+'" data-membership="'+r.full[s].group_gid+'" data-period="'+r.full[s].period.id+'" data-user_type="'+e.data("user_type")+'" class="list-group-item active">'+r.short_by_type[e.data("user_type")][s].title+"</a>":n+='<a data-action="add-membership" data-id_user="'+e.data("id_user")+'" data-gid="'+s+'" data-membership="'+r.full[s].group_gid+'" data-period="'+r.full[s].period.id+'" data-user_type="'+e.data("user_type")+'" class="list-group-item">'+r.short_by_type[e.data("user_type")][s].title+"</a>";else{var a=0,c="";for(var s in r.short)-1!==$.inArray(r.full[s].group_gid,i)||r.full[s].group_gid===i?((r.full[s].period.count<=o||!a)&&(a=r.full[s].period.count,c="#membership-"+s+"-"+r.full[s].group_gid),n+='<a id="membership-'+s+"-"+r.full[s].group_gid+'" data-action="add-membership" data-id_user="'+e.data("id_user")+'" data-gid="'+s+'" data-membership="'+r.full[s].group_gid+'" data-period="'+r.full[s].period.id+'" class="list-group-item">'+r.short[s].title+"</a>"):n+='<a data-action="add-membership" data-id_user="'+e.data("id_user")+'" data-gid="'+s+'" data-membership="'+r.full[s].group_gid+'" data-period="'+r.full[s].period.id+'" class="list-group-item">'+r.short[s].title+"</a>"}n+="</div>",t.properties.contentObj.update_css_styles({width:"400px",margin:"0 auto"}),t.properties.contentObj.show_load_block(n);var p=o/a*100;p=p>100?100:p,$(c).append('<div class="selected" style="width: '+p+'%"><span class="badge">'+e.data("days")+"</span></div>")}},this.addMembership=function(e){$(t.properties.dataAction.addMembership).removeClass("active"),e.addClass("active")},this.changeMembership=function(){var e=$(t.properties.class.membershipChangeList).find("a.active"),o=""!==e.data("id_user")?[e.data("id_user")]:t.getSelectedUsers();t.query(t.properties.url.addMembership,{user_ids:o,gid:e.data("gid"),user_type:e.data("user_type"),membership:e.data("membership"),period:e.data("period"),send:1},"json",(function(e){for(var o in t.properties.contentObj.hide_load_block(),e.group)$("div"+t.properties.dataAction.membershipChange+'[data-id_user="'+o+'"]').html(e.group[o].data.current_name+'<div class="date-expires">'+t.properties.lang.expires+" <div>"+e.group[o].date_expired+"</div></div>"),$(t.properties.dataAction.membershipChange+'[data-id_user="'+o+'"]').each((function(t){$(this).data("groups",e.group[o].group_gid),$(this).data("days",e.group[o].left_str)}))}))},this.choiseMembership=function(e){t.membershipChange(e)},this.getSelectedUsers=function(){var e=[];return $(t.properties.class.grouping+":checked").each((function(t){e[t]=$(this).val()})),e},this.query=function(e,o,r,i){return/^(f|ht)tps?:\/\//i.test(e)||(e=t.properties.siteUrl+e),$.ajax({url:e,type:"POST",cache:!1,data:o,dataType:r,success:function(e){void 0!==e.error&&e.error.length>0&&t.properties.errorObj.show_error_block(e.error,"error"),void 0!==e.info&&e.info.length>0&&t.properties.errorObj.show_error_block(e.info,"info"),void 0!==e.success&&e.success.length>0&&t.properties.errorObj.show_error_block(e.success,"success"),void 0!==i&&i(e)}}),!1},t.Init(e)})},6571:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Associations=function(e){this.properties={siteUrl:"",profile_id:null,profile:{},lang:{},limits:10,compared:"0",rand:"",btn_id:"",link_id:"",association_content_id:"association_content",name_id:"",image_id:"",btn_compare_id:"",btn_more_id:"",last_association_id:"",next_association_id:"",association_action_id:"association_action_",association_id:"association_",association_action_class:"association-action",load_associations_url:"associations/ajaxLoadAssociations",view_associations_url:"associations/ajaxViewAssociations",set_compare_url:"associations/ajaxSetCompare",set_answer_url:"associations/ajaxSetAnswer",common_ancestor:"body",template:"",new_tab:0,errorObj:new Errors,contentObj:new loadingContent({loadBlockWidth:"400px",loadBlockLeftType:"center",loadBlockTopType:"top",loadBlockTopPoint:100,closeBtnClass:"w",draggable:!0})};var t=this,o={},r=null;this.Init=function(e){t.properties=$.extend(t.properties,e),t.initIds(),t.init_controls(),t.properties.template&&"function"==typeof twig&&(twig({id:"association"+t.properties.rand,href:t.properties.template,async:!1}),r=twig({ref:"association"}))},this.initIds=function(){t.properties.btn_data_id='[data-id="btn-association-'+t.properties.rand+'"]',t.properties.link_data_id='[data-id="link-association-'+t.properties.rand+'"]',t.properties.btn_id="btn-association-"+t.properties.rand,t.properties.link_id="link-association-"+t.properties.rand,t.properties.btn_compare_id="btn_compare_"+t.properties.rand,t.properties.btn_more_id="btn_more_"+t.properties.rand,t.properties.image_id="association_image_"+t.properties.rand,t.properties.last_association_id="last_association_"+t.properties.rand,t.properties.name_id="association_name_"+t.properties.rand,t.properties.next_association_id="next_association_"+t.properties.rand},this.uninit=function(){return $(t.properties.common_ancestor).off("click",t.properties.btn_data_id).off("click","#"+t.properties.btn_id).off("click","#"+t.properties.btn_more_id).off("click","#"+t.properties.btn_compare_id).off("click","#"+t.properties.last_association_id).off("click","#"+t.properties.next_association_id).off("click","."+t.properties.association_action_class),this},this.init_controls=function(){$(t.properties.common_ancestor).off("click",t.properties.btn_data_id).on("click",t.properties.btn_data_id,(function(){t.loadAssociations(this)})).off("click","#"+t.properties.btn_more_id).on("click","#"+t.properties.btn_more_id,(function(){t.getAssociation()})).off("click","#"+t.properties.btn_compare_id).on("click","#"+t.properties.btn_compare_id,(function(){t.setCompare($(this))})).off("click","#"+t.properties.last_association_id).on("click","#"+t.properties.last_association_id,(function(){t.getLastAssociation()})).off("click","#"+t.properties.next_association_id).on("click","#"+t.properties.next_association_id,(function(){t.getNextAssociation()})).off("click","."+t.properties.association_action_class+" li").on("click","."+t.properties.association_action_class+" li",(function(){t.answeAssociation($(this).data("id"),$(this).data("answer"))}))},this.loadAssociations=function(){"1"===o.compared||"1"===t.properties.compared||$(t.properties.btn_data_id).hasClass("link-disabled")?t.properties.errorObj.show_error_block(t.properties.lang.already_sent,"error"):$.ajax({type:"POST",dataType:"json",url:t.properties.siteUrl+t.properties.load_associations_url,success:function(e){return void 0!==e.errors&&e.errors.length>0?(t.properties.errorObj.show_error_block(e.errors,"info"),!1):void 0!==e.info.access_denied&&e.info.access_denied.length>0?(t.properties.new_tab&&locationHref(t.properties.siteUrl+"access_permissions",!0,!0),t.properties.contentObj.show_load_block(e.info.access_denied),!1):void t.getAssociation(e.html)},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.getAssociation=function(e){if(void 0===o.count_associations){var r={profile_id:t.properties.profile_id,limits:t.properties.limits};$.ajax({type:"POST",dataType:"json",url:t.properties.siteUrl+t.properties.view_associations_url,data:r,success:function(r){if(void 0!==r.errors&&r.errors.length>0)return t.properties.errorObj.show_error_block(r.errors,"error"),!1;if(void 0!==r.info.access_denied&&r.info.access_denied.length>0)return t.properties.contentObj.show_load_block(r.info.access_denied),!1;if(t.properties.contentObj.show_load_block(r.info),0!==r.images.length){for(var i in void 0!==e&&t.properties.contentObj.show_load_block(e),o.profile_id=r.profile_id,o.count_associations=r.images.length,o.association_obj=[],r.images)o.association_obj.push(r.images[i]);o.association_last_key=o.count_associations-1,t.viewAssociation(0)}else t.properties.contentObj.hide_load_block(),$(t.properties.btn_data_id).find("i").addClass("g"),$(t.properties.link_data_id).remove(),t.properties.errorObj.show_error_block(t.properties.lang.associations_empty,"error")},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})}else o.association_key>=o.count_associations?(o.association_last_key=o.count_associations-1,t.appendAssociations()):($("#"+t.properties.association_content_id).is(":visible")||t.properties.contentObj.show_load_block(e),t.viewAssociation(o.association_key))},this.getLastAssociation=function(){if(o.association_key<1)t.viewAssociation(o.association_last_key);else if(1===o.association_key)t.prependAssociations();else{var e=parseInt(o.association_key)-2;t.viewAssociation(e)}},this.getNextAssociation=function(){t.getAssociation()},this.viewAssociation=function(e){if(o.association_key=parseInt(e)+1,!0===t.checkImage(e)){var i="";$("#"+t.properties.association_content_id).html((function(){return r?r.render({properties:t.properties,obj:o,key:e}):(i+='<div class="mtb10 ib addHeight">',i+='<div id="'+t.properties.last_association_id+'" class="fa last-button"></div>',i+='<div id="'+t.properties.image_id+'" class="mlr20 fleft wdth180 helper"><img class="img-rounded img-responsive" src="'+o.association_obj[e].image.thumbs.big+'" ></div>',i+='<div id="'+t.properties.next_association_id+'" class="fa next-button"></div>',i+="</div>",i+='<div class="clr"></div>',i+='<div class="mtb10" id="'+t.properties.name_id+'">'+o.association_obj[e].name+"</div>",i+='<div class="mtb10"><input class="btn btn-primary" data-profile="'+o.profile_id+'" data-id="'+o.association_obj[e].id+'" type="button" id="'+t.properties.btn_compare_id+'" value="'+t.properties.lang.compare+'" name="compare" >&nbsp;<input class="btn btn-default" type="button" id="'+t.properties.btn_more_id+'" value="'+t.properties.lang.more+'" name="more" ></div>')})),$("#"+t.properties.association_content_id).find("img.img-rounded").on("load",(function(){$("#"+t.properties.last_association_id).css("margin-top",$(this).height()/2+"px"),$("#"+t.properties.next_association_id).css("margin-top",$(this).height()/2+"px")}))}else t.getNextAssociation()},this.appendAssociations=function(){var e={profile_id:t.properties.profile_id,limits:t.properties.limits,last_id:o.association_obj[o.association_last_key].id};$.ajax({type:"POST",dataType:"JSON",url:t.properties.siteUrl+t.properties.view_associations_url,data:e,success:function(e){if(e.images.length){for(var r in o.count_associations=o.count_associations+e.images.length,e.images)o.association_obj.push(e.images[r]);t.viewAssociation(o.association_last_key+1)}else t.viewAssociation(0)},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.prependAssociations=function(){var e={profile_id:t.properties.profile_id,limits:t.properties.limits,last_id:o.association_obj[o.association_last_key].id};$.ajax({type:"POST",dataType:"JSON",url:t.properties.siteUrl+t.properties.view_associations_url,data:e,success:function(e){if(e.images.length){for(var r in o.count_associations=o.count_associations+e.images.length,e.images)o.association_obj.push(e.images[r]);o.association_last_key=o.count_associations-1}t.viewAssociation(o.count_associations-1)},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.checkImage=function(e){var t=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;if(!t)throw new Error("XMLHttpRequest not supported");return t.open("HEAD",o.association_obj[e].image.thumbs.big,!1),t.send(null),200===t.status||(o.association_obj.splice(e,1),o.count_associations=o.count_associations>0?o.count_associations-1:0,!1)},this.setCompare=function(e){var r={association_id:$(e).data("id"),profile_id:$(e).data("profile")};$.ajax({type:"POST",dataType:"JSON",url:t.properties.siteUrl+t.properties.set_compare_url,data:r,success:function(e){e.errors?t.properties.errorObj.show_error_block(e.error,"error"):(o.compared="1",$(t.properties.btn_data_id).find("i").addClass("g"),$(t.properties.link_data_id).find("a").addClass("link-disabled"),t.properties.errorObj.show_error_block(e.success,"success"),sendAnalytics("associations_send_association","communication","user")),t.properties.contentObj.hide_load_block()},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.answeAssociation=function(e,o){var r={association_id:e,answer:o};$.ajax({type:"POST",dataType:"JSON",url:t.properties.siteUrl+t.properties.set_answer_url,data:r,success:function(r){if(r.success){var i=t.createAnswer(o);$("#"+t.properties.association_action_id+e).html(""),$("#"+t.properties.association_id+e).append(i)}},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.createAnswer=function(e){return'<div class="b-associations__item b-associations__item_right"><div class="b-associations__msg"><div class="b-associations__msg-content"><div class="b-associations__name">'+t.properties.profile.nickname+", "+t.properties.profile.age+"</div><div>"+t.properties.lang.answer[e]+'</div></div></div><div class="b-associations__photo"><span class="g-pic-border g-rounded"><img width="60" src="'+t.properties.profile.media.user_logo.thumbs.middle+'" alt="'+t.properties.profile.nickname+'" title="'+t.properties.profile.nickname+'" class="img-responsive" /></span></div>'},this.escapeRegExp=function(e){return e.replace(/[]/g,"\\$&")},this.addJSParams=function(e){var o=new RegExp(t.escapeRegExp("siteUrl: site_url,").replace(/[]/g,"|"),"gi");return e.replace(o,"$& singleton: 0,")},t.Init(e)})},2169:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.audio=function(e){this.properties={item_id:0,timelineWidth:"",duration:"",siteUrl:"",deleteUrl:"",timelineWidthWide:"",firstTrack:"",lastTrack:"",nextTrack:"",prevTrack:"",themeType:"",timelineItem:"timeline_",playheadItem:"playhead_",durationItem:"duration_",audionameItem:"audioname_",playheadBallItem:"playhead-ball_",wideBlockItem:"audio-wide-block",playButtonItem:"play-track",playGalleryButtonId:"#play_",playPopupButtonId:".play-track_",playWideButtonId:"#play_wide",playButtonIcon:"fa-play",pauseButtonIcon:"fa-pause",nextButtonItem:"next-track",prevButtonItem:"prev-track",volumeButtonItem:"volume-track",repeatButtonItem:"",repeat:""},this.objects={music:"",timeline:"",playhead:"",elem:"",timelineWide:"",playheadWide:"",elemWide:"",timelinePopup:"",playheadPopup:"",elemPopup:"",is_playing:0};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.setButtons()},this.setButtons=function(){$("html").off("click").on("click","."+t.properties.playButtonItem,(function(){var e=$(this).parent().data("id-media");void 0!==e&&(t.properties.item_id?e!=t.properties.item_id&&(t.reloadTimeline(),t.clearCurrentTrack(),t.setTrack(e)):($("."+t.properties.wideBlockItem).show(),t.setTrack(e))),t.properties.item_id&&t.changePlay()})),$("."+t.properties.nextButtonItem).off("click").on("click",(function(){t.playNext()})),$("."+t.properties.prevButtonItem).off("click").on("click",(function(){t.playPrev()})),$("."+t.properties.volumeButtonItem).off("click").on("click",(function(){t.volumeButton()}))},this.setTrack=function(e){t.properties.item_id=e,t.setCurrentAudio(),t.setWideBlock(),t.setTracks(),t.objects.music.addEventListener("timeupdate",t.timeUpdateEvents,!1),t.objects.music.addEventListener("ended",t.playEndedEvents,!1);var o=$(".repeat-track-option");o.on("click",(function(){$(this).children("p").hide(),$(this).removeClass("active");var e=$(this).next();"0"!=e.length?t.properties.repeat=e.addClass("active").attr("value"):t.properties.repeat=$(this).parent().children(":first-child").addClass("active").attr("value")})),o.hover((function(){$(this).children("p").show()}),(function(){$(this).children("p").hide()})),$("html").on("click",".timeline_"+t.properties.item_id,(function(e){var o=$(this).outerWidth(),r=$(this).offset(),i=100*(e.pageX-r.left)/o;$("."+t.properties.playheadItem+t.properties.item_id).width(i+"%");var n=i-.7;$("."+t.properties.timelineItem+t.properties.item_id+" ."+t.properties.playheadBallItem+t.properties.item_id).css("left",n+"%"),t.objects.music.currentTime=t.objects.music.duration*i/100}))},this.playTestEvents=function(){t.objects.is_playing&&t.playTrack()},this.playEndedEvents=function(){t.pauseTrack(),"one"==t.properties.repeat?(t.clearCurrentTrack(),t.playTrack()):"all"==t.properties.repeat&&t.playNext()},this.changePlay=function(){t.objects.is_playing?t.pauseTrack():t.playTrack()},this.pauseTrack=function(){t.objects.music.pause(),t.objects.is_playing=0,t.changePlayIcons()},this.playTrack=function(){t.objects.music.play(),t.objects.is_playing=1,t.changePlayIcons()},this.changePlayIcons=function(){var e=[t.properties.playGalleryButtonId+t.properties.item_id,t.properties.playPopupButtonId+t.properties.item_id,t.properties.playWideButtonId];t.objects.is_playing?$.each(e,(function(e,o){$(o).find("i").removeClass(t.properties.playButtonIcon).addClass(t.properties.pauseButtonIcon)})):$.each(e,(function(e,o){$(o).find("i").removeClass(t.properties.pauseButtonIcon).addClass(t.properties.playButtonIcon)}))},this.playNext=function(){t.clearCurrentTrack();var e=0;t.properties.nextTrack?e=t.properties.nextTrack:t.properties.firstTrack&&"all"==t.properties.repeat&&(e=t.properties.firstTrack),e&&(t.setTrack(e),t.playTrack())},this.playPrev=function(){t.clearCurrentTrack();var e=0;t.properties.prevTrack?e=t.properties.prevTrack:t.properties.lastTrack&&(e=t.properties.lastTrack),e&&(t.setTrack(e),t.playTrack())},this.clearCurrentTrack=function(){t.pauseTrack(),t.objects.music.currentTime=0,$("."+t.properties.playheadItem+t.properties.item_id).width(0),$("."+t.properties.timelineItem+t.properties.item_id+" ."+t.properties.playheadBallItem+t.properties.item_id).css("left","0"),$("#wall_events").find("."+t.properties.timelineItem+t.properties.item_id).addClass("timeline-hide")},this.reloadTimeline=function(){t.objects.timeline=document.getElementById("timeline_"+t.properties.item_id),t.objects.playhead=document.getElementById("playhead_"+t.properties.item_id)},this.setCurrentAudio=function(){"flatty"!==t.properties.themeType&&$("#player_"+t.properties.item_id).appendTo(".audio-wide-block"),$("#wall_events").find("."+t.properties.timelineItem+t.properties.item_id).removeClass("timeline-hide"),$(".duration-time").html(""),t.objects.music=document.getElementById("player_"+t.properties.item_id).cloneNode(!0),t.properties.deleteUrl=t.properties.siteUrl+"media/delete_media/"+t.properties.item_id,t.objects.music.duration?$("#duration_"+t.properties.item_id).html(t.readableDuration(t.objects.music.duration)):(t.objects.music.addEventListener("error",(function(e){alert("Audio decoding error"),location.reload()})),t.objects.music.addEventListener("loadedmetadata",(function(){t.properties.duration=t.objects.music.duration,$("#duration_"+t.properties.item_id).html(t.readableDuration(t.properties.duration))})))},this.setWideBlock=function(){$("."+t.properties.wideBlockItem).find(".current-track").html(t.objects.music),$("#timeline_wide").addClass(t.properties.timelineItem+t.properties.item_id),$("#playhead_wide").addClass(t.properties.playheadItem+t.properties.item_id),$("#duration_wide").addClass(t.properties.durationItem+t.properties.item_id),$("#playhead-ball").addClass(t.properties.playheadBallItem+t.properties.item_id),$("#audioname_wide").html($("."+t.properties.audionameItem+t.properties.item_id+":first").text()),$("#remove_wide").attr("href",t.properties.deleteUrl)},this.setPopupBlock=function(e){},this.setTracks=function(){var e,o=$(".audio-content").map((function(e,t){var o=$(t).data("id-media");if("number"==typeof o)return o})).get();for(t.properties.firstTrack=o[0],t.properties.lastTrack=o[o.length-1],e=0;;e++)if(o[e]==t.properties.item_id){t.properties.nextTrack=o[e+1],t.properties.prevTrack=o[e-1];break}},this.updateTimelines=function(){var e=100*t.objects.music.currentTime/t.objects.music.duration;$("."+t.properties.playheadItem+t.properties.item_id).width(e+"%");var o=e-.7;$("."+t.properties.timelineItem+t.properties.item_id+" ."+t.properties.playheadBallItem+t.properties.item_id).css("left",o+"%"),$("."+t.properties.durationItem+t.properties.item_id).html(t.readableDuration(t.objects.music.currentTime))},this.timeUpdateEvents=function(){t.changePlayIcons(),t.updateTimelines()},this.volumeButton=function(){t.objects.music.muted?($(".volume-track i").removeClass().addClass("fa fa-lg fa-volume-up"),t.objects.music.muted=!1):($(".volume-track i").removeClass().addClass("fa fa-lg fa-volume-off"),t.objects.music.muted=!0)},this.readableDuration=function(e){return sec=Math.floor(e),min=Math.floor(sec/60),min=min>=10?min:"0"+min,sec=Math.floor(sec%60),sec=sec>=10?sec:"0"+sec,min+":"+sec},t.Init(e)})},9857:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.AdminBanners=function(e){this.properties={siteUrl:"",loadFormUrl:"admin/banners/ajax_show_form/",loadImageFormUrl:"admin/banners/ajax_show_form/banner_image_form/",loadHtmlFormUrl:"admin/banners/ajax_show_form/banner_html_form/",loadGroupsUrl:"admin/banners/ajax_get_groups/",banner_id:"",init_banner_form:!1};var t={altFormat:"yy-mm-dd",dateFormat:"dd MM yy",firstDay:1},o=this;this.init=function(e){o.properties=$.extend(o.properties,e),o.properties.init_banner_form&&o.init_banner_form()},this.load_form=function(e){if(""!=e){var t=o.properties.siteUrl+o.properties.loadFormUrl+e+"/"+o.properties.banner_id;$("#second_form").load(t)}else $("#second_form").html("")},this.load_groups=function(e){if(e){var t=o.properties.siteUrl+o.properties.loadGroupsUrl+e;""!=o.properties.banner_id&&(t=t+"/"+o.properties.banner_id),$("#banner_groups").load(t)}},this.init_banner_form=function(){$("#banner_type").on("change",(function(){o.load_form($(this).val())})),$("#banner_place").on("change",(function(){o.load_groups($(this).val())}))},this.initImageForm=function(){var e=t;$(".datepicker").each((function(){var t=$(this).attr("id");$("#"+t).val(),e.altField="#"+t+"_hide",$("#"+t).datepicker(e),$.datepicker.setDefaults($.datepicker.regional["{{ _LANG.code }}"])}))},o.init(e)})},5550:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.BannerActivate=function(e){this.properties={mainID:"positions",data:{}};var t=this;this.init=function(e){t.properties=$.extend(t.properties,e),t.initialize_positions(),t.refresh_sum()},this.refresh_sum=function(){var e=0;$("#"+t.properties.mainID+" input").each((function(){var o=parseInt($(this).attr("id").substring(9)),r=parseInt($(this).val());r<0&&(r=0),r>t.properties.data[o].positions&&(r=t.properties.data[o].positions),isNaN(r)&&(r=""),$(this).val(r),e+=r*parseFloat(t.properties.data[o].price)})),$("#final_price").text(Math.round(100*e)/100)},this.initialize_positions=function(){$("#"+t.properties.mainID+" input").each((function(){$(this).on("change keydown keyup blur",(function(){t.refresh_sum()}));var e=parseInt($(this).attr("id").substring(9));t.properties.data[e]={},t.properties.data[e].price=parseFloat($("#price_"+e).attr("float")),t.properties.data[e].positions=parseInt($("#free_pos_"+e).attr("int"))}))},t.init(e)})},6274:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Banners=function(e){this.properties={siteUrl:""},this.bannerArea=new Array,this.bannerData=new Array,this.timeOuts=new Array;var t=this;this.init=function(e){t.properties=$.extend(t.properties,e)},this.create_banner_area=function(e,o){t.bannerArea[e.id]=e,t.bannerData[e.id]=o,$("#"+e.div_id).html("<div>&nbsp;</div>"),o.length>1?t.bannerArea[e.id].rotate=!0:t.bannerArea[e.id].rotate=!1,t.bannerArea[e.id].current_banner=-1,t.preload_images(e.id),t.show_banner(e.id)},this.preload_images=function(e){for(var o=t.bannerData[e].length,r=new Array,i=0;i<o;i++)"image"==t.bannerData[e][i].banner_type&&(r[i]=new Image,r[i].src=t.bannerData[e][i].banner_src)},this.show_banner=function(e){var o=t.bannerData[e].length,r=t.bannerArea[e].current_banner,i=(r+1)%o,n=!1;-1!=r&&t.bannerData[e][r].id==t.bannerData[e][i].id||(n=!0),n&&$("#"+t.bannerArea[e].div_id+" div").hide().html("").prepend(t.bannerData[e][i].html).show(),t.bannerArea[e].current_banner=i,t.bannerArea[e].rotate&&(t.timeOuts[e]=setTimeout((function(){t.show_banner(e)}),1e3*t.bannerArea[e].rotate_time))},this.uninit=function(){for(var e in t.timeOuts)t.timeOuts.hasOwnProperty(e)&&clearTimeout(t.timeOuts[e])},t.init(e)})},6669:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.blacklist=function(e){this.properties={siteUrl:"/",addUserButton:".add_to_blacklist",removeUserButton:".remove_from_blacklist",addUserUrl:"blacklist/ajax_add/",removeUserUrl:"blacklist/ajax_remove/",blockId:"#block_user_",toggle:!0};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_objects(),t.init_controls()},this.uninit=function(){t.add_user_btn.off("click"),t.remove_user_btn.off("click")},this.init_objects=function(){t.add_user_btn=$(t.properties.addUserButton),t.remove_user_btn=$(t.properties.removeUserButton)},this.init_controls=function(){t.add_user_btn.off("click").on("click",(function(){return t.add_user($(this).data("userid")),!1})),t.remove_user_btn.off("click").on("click",(function(){return t.remove_user($(this).data("userid")),!1}))};var o=function(e,o){"add"===o?($(e+" "+t.properties.addUserButton).closest("dd").removeClass("hide"),$(e+" "+t.properties.removeUserButton).closest("dd").addClass("hide")):"remove"===o&&($(e+" "+t.properties.addUserButton).closest("dd").addClass("hide"),$(e+" "+t.properties.removeUserButton).closest("dd").removeClass("hide"))};this.add_user=function(e){r(t.properties.addUserUrl,e,(function(){t.properties.toggle?(o(t.properties.blockId+e,"remove"),$(".likemecontrols").length>0&&$(".likemecontrols").addClass("hide")):$(t.properties.blockId+e).remove()}))},this.remove_user=function(e){r(t.properties.removeUserUrl,e,(function(){t.properties.toggle?(o(t.properties.blockId+e,"add"),$(".likemecontrols").length>0&&$(".likemecontrols").removeClass("hide")):$(t.properties.blockId+e).remove()}))};var r=function(e,o,r){$.ajax({url:t.properties.siteUrl+e+o,type:"GET",dataType:"json",cache:!1,success:function(e){e.errors?error_object.show_error_block(e.errors,"error"):(r(),error_object.show_error_block(e.success,"success"))}})};t.Init(e)})},9388:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.BonusesAdmin=function(e){this.properties={siteUrl:""};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$(document).off("change",'select[name="bonus_module"]').on("change",'select[name="bonus_module"]',(function(){t.changePrize()})).off("change",'select[name="action"]').on("change",'select[name="action"]',(function(){t.initActionsType(!1)}))},this.showLangs=function(e){$("#"+e).slideToggle()},this.refreshSelectors=function(e,o){t.changePeriods(e.available_period),t.changeAmount(e.once),t.changeUnit(e.is_percent,o)},this.changePrize=function(){var e=$('select[name="bonus_module"]').val();"fill_bonus_account"==e&&($("#fill_bonuses_amount").show(),$("#account_days").hide()),"get_premium_account"==e&&($("#fill_bonuses_amount").hide(),$("#account_days").show())},this.changeUnit=function(e,t){1===e?($('input[name="repetition"]').val("100"),$('input[name="repetition"]').show(),$("#bonus_percent").show(),$('input[name="repetition"]').prop("max","100"),$("#bonus_times").hide()):(t||$('input[name="repetition"]').val("1"),$("#bonus_percent").hide(),$('input[name="repetition"]').prop("max","1000"))},this.changeAmount=function(e){1==e?($('input[name="repetition"]').val("1"),$('input[name="repetition"]').hide(),$("#bonus_times").hide()):($("#bonus_times").show(),$('input[name="repetition"]').show())},this.changePeriods=function(e){var t=JSON.parse(e);"all"==t[0]?$('select[name="period_type"]').find("option").each((function(){var e=$(this).val().toString();$('option[value="'+e+'"]').show()})):$('select[name="period_type"]').find("option").each((function(){var e=$(this).val().toString();-1!=$.inArray(e,t)?$('option[value="'+e+'"]').show():$('option[value="'+e+'"]').hide()})),$('select[name="period_type"]').find("option").each((function(){var e=$(this).val().toString();if("none"!=$('option[value="'+e+'"]').css("display"))return $('option[value="'+e+'"]').attr("selected",!0),!1}))},this.initActionsType=function(e){var o=$('select[name="action"]').val(),r=JSON.parse($("#bonus_actions_config").attr("data"));for(conf in r)r[conf].action==o&&t.refreshSelectors(r[conf],e)},t.Init(e)})},3452:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.bonusesContent=function(e){this.properties={siteUrl:"",exchangeRate:"0.1",popupBlockClass:"exchange_center",noneBonusNotify:"",bonusContentClass:".bonus_content"};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.sendAjax(!1),$(document).off("click","#refresh_bonuses").on("click","#refresh_bonuses",(function(){t.sendAjax(!1)})).off("click",t.properties.bonusContentClass).on("click",t.properties.bonusContentClass,(function(){t.toggleBonusDescription($(this))}))},this.sendAjax=function(e){t.user_id=$("div[name='user_id']").attr("id_user"),$.ajax({url:t.properties.siteUrl+"bonuses/ajax_refresh_user_bonus_panel/"+t.user_id,type:"POST",dataType:"json",success:function(o){if(void 0!==o.info.access_denied&&o.info.access_denied.length>0);else{e&&t.exchangeBonuses(o),$("#bonuses_content").empty(),t.performed_text=o.performed_text,t.button_text=o.button_text,t.amount_text=o.amount_text,t.counter_times_text=o.counter_times_text,t.currency=o.currency;var r=o.account?o.account.bonus_account:null,i=o.bonuses?o.bonuses:[];i&&t.refreshBonusTable(i),t.refreshAccountTable(r)}},error:function(){}})},this.exchangeToMoney=function(e){if(e){(e=parseInt(e))>t.account&&(e=t.account),e<0&&(e=0),$("#exchange_points").val(e);var o=parseFloat(e*parseFloat(t.properties.exchangeRate)).toFixed(1),r="=  "+o+" "+t.currency.abbr;$("#exchange_cash").attr("value",o),$("#exchange_cash").html(r)}else $("#exchange_points").val(""),$("#exchange_cash").html("")},this.exchangeBonuses=function(e){var o=new loadingContent({otherClass:t.properties.popupBlockClass});o.show_load_block(JSON.parse(e.exchange_bonus_content)),t.exchange_popup=o;var r=0;void 0!==e.account&&e.account.bonus_account&&(r=e.account.bonus_account),t.account=r,$("#my_bonuses_points").attr("value",r),$("#my_bonuses_points").prepend(r),$("#my_bonuses_points").click((function(){$("#exchange_points").val($(this).attr("value")),$("#exchange_points").trigger("change")})),$("#exchange_points").change((function(){t.exchangeToMoney($(this).val())})),$("#exchange_points").keyup((function(){t.exchangeToMoney($(this).val())})),$("#exchange_save").click((function(e){$(this).prop("disabled",!0),e.preventDefault();var o=parseFloat($("#exchange_cash").attr("value"));o>0?t.cashOperation(o):error_object.show_error_block(t.properties.noneBonusNotify,"error")}))},this.cashOperation=function(e){$.ajax({url:t.properties.siteUrl+"bonuses/ajax_filled_account/"+t.user_id,type:"POST",dataType:"json",data:{data:e},success:function(e){var o=t.currency.abbr+parseFloat(e.account).toFixed(2);$(".user-short-inf__currency").children().first().html(o),t.sendAjax(!1),t.exchange_popup.destroy(),void 0!==e.errors&&""!=e.errors?error_object.show_error_block(e.error,"error"):void 0!==e.success&&""!=e.success&&error_object.show_error_block(e.success,"success")}})},this.refreshBonusTable=function(e){for(var o in e){var r=e[o];0!=r.status&&("multiple"!=r.period_type?1==r.user_counter_status?($("#bonuses_content").append(t.createNewElemAndSetValues(r)),$("#bonus_row_"+r.id).attr("data-toggle",""),$("#bonus_row_"+r.id).attr("title",""),$("#bonus_row_"+r.id).addClass("inactive"),$("#bonus_check_"+r.id).show(),$("#bonus_row_"+r.id).css("color","#aaa")):($("#bonuses_content").prepend(t.createNewElemAndSetValues(r)),$("#counter_block_"+r.id).addClass("bonus_bage"),t.isPersent(r),$("#data_counter_bonus_"+r.id).show()):($("#bonuses_content").prepend(t.createNewElemAndSetValues(r)),$("#counter_block_"+r.id).addClass("bonus_bage"),$("#counter_block_"+r.id).addClass("multiple_bonus_icon"),$("#infinity_"+r.id).show()))}var i="<button onclick=\"sendAnalytics('dp_user_home_bonuses_btn_exchange')\" id='exchange_bonus_btn' class='btn btn-primary exchange_bonus'>"+t.button_text+"</button>";$("#bonuses_content").append(i),$("#exchange_bonus_btn").on("click",(function(){t.sendAjax(!0)}))},this.createNewElemAndSetValues=function(e){return"<div class='bonus_content pointer' data-html='true' data-original-title=''' id='bonus_row_"+e.id+"' bonus_id='"+e.id+"'><div><span id='table_bonus_name_"+e.id+"'>"+e["name_"+e.cur_lang_id]+"</span><span class='fright' id='counter_block_"+e.id+"'><span hidden id='infinity_"+e.id+"'>&infin;</span><span hidden class='bonus_count' id='data_counter_bonus_"+e.id+"'></span><span hidden id='bonus_check_"+e.id+"'><i class='fa fa-check'></i></span><span hidden id='bonus_percent_"+e.id+"'>%</span></span></div><div id='bonus_description_"+e.id+"' class='bonus_description hide'><div>"+e["info_"+e.cur_lang_id]+"</div><div class='bonus_amount_text' id='bonus_amount_"+e.id+"'>"+e.amount+" "+t.amount_text+"</div></div></div><hr id='hr_bonuses_"+e.id+"'>"},this.isPersent=function(e){void 0!==e.config&&"1"==e.config.is_percent?($("#bonus_percent_"+e.id).show(),$("#data_counter_bonus_"+e.id).html(e.user_counter)):($("#bonus_percent_"+e.id).hide(),$("#data_counter_bonus_"+e.id).html(parseInt(e.repetition,10)-parseInt(e.user_counter,10)))},this.refreshAccountTable=function(e){e||(e=0),$("#data_account_bonus").text(e)},this.toggleBonusDescription=function(e){var t=e.attr("bonus_id");$("#bonus_description_"+t).toggle()},t.Init(e)})},6848:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Chatbox=function(e){this.properties={siteUrl:"",loadUsersFormLink:"chatbox/ajax_add_contact_form",startDialogLink:"chatbox/ajax_open_dialog",getDialogsLink:"chatbox/ajax_get_dialogs",deleteDialogLink:"chatbox/ajax_delete_dialog",sendMessageLink:"chatbox/ajax_send_message",loadMessagesLink:"chatbox/ajax_get_messages",deleteMessageLink:"chatbox/ajax_delete_message",lastMessagesStatusLink:"chatbox/ajax_messages_status",btnOk:"Ok",btnCancel:"Cancel",mini:!1,contactId:0,addNewContactBtn:".js-add-contact",sendMsgId:"chb_message",sendMsgBtnId:"chb_send_msg_btn",dialogStateClass:"dialog-opened",user_id:0,l_time:0,errorObj:new Errors,usersContentObj:new loadingContent({loadBlockTopType:"center",loadBlockWidth:"50%",closeBtnPadding:12,blockBody:!0,showAfterImagesLoad:!1}),langs:{text_your:"Вы",notice_clear_history:"Вы действительно хотите очистить историю сообщений с этим пользователем?",notice_delete_message:"Вы действительно хотите удалить это сообщение?"},isFocusPage:1,uploaded:!1,gallery:null,next_gallery_image:null,prev_gallery_image:null,images:[],image_lng:"Image",emojiPicker:null,check_is_read_mess:null,key_sent_btn:null};var t=this,o=null,r=null,i={dialogBox:"",emptyDialogBox:"",historyLoaded:!1,dialogsLoaded:!1};this.Init=function(e){t.properties=$.extend(t.properties,e),i.dialogBox=$("#chb_dialog"),i.emptyDialogBox=$(".chatbox-dialog__empty"),t.initActions(),t.initUsersActions(),t.properties.gallery=new loadingContent({loadBlockID:"chatbox_gallery",loadBlockBgID:"chatbox_gallery_bg",loadBlockWidth:"980px",loadBlockTopType:"top",loadBlockTopPoint:10,linkerObjID:null,blockBody:!0,showAfterImagesLoad:!0,closeBtnClass:"w"}),t.properties.check_is_read_mess||t.initMultiRequest(),0!=t.properties.contactId&&t.startDialog(t.properties.contactId),window.onfocus=function(){return t.properties.isFocusPage=1},window.onblur=function(){return t.properties.isFocusPage=0}},this.initActions=function(){$(t.properties.addNewContactBtn).off("click").click((function(){t.openAddContactForm()})),$(".chatbox-users__filter input[type=text]").off("change").change((function(){i.dialogsLoaded=!1;var e=t.trimStr($(".chatbox-users__filter input[type=text]").val());t.loadDialogs(e,!1,!0)}))},this.initUsersActions=function(){$(".chatbox-users__user").off("click").click((function(e){if(!$(e.target).hasClass("chatbox-users__delele")){var o=$(this).data("contact-id");t.startDialog(o)}return!1})),$(".chatbox-users__delele").off("click").click((function(){var e=$(this).data("contact-id");return t.viewAlert(t.properties.langs.notice_clear_history,"deleteDialog",e),!1})),$(".chatbox-users__list ul li").each((function(){var e=$(this).find(".chatbox-users__message:not(.emoji-rendered)");void 0!==e.html()&&(e.html(t.properties.emojiPicker.colonToImage(t.properties.emojiPicker.codeToColon(JSON.parse(JSON.stringify(e.html()).replace(/\\\\u/g,"\\u"))))),e.addClass("emoji-rendered"))}))},this.initDialogActions=function(){$("#chb_close_dialog").off("click").click((function(){return t.closeDialog(),!1})),t.properties.emojiPicker.discover(),void 0!==t.properties.emojiPicker?t.properties.emojiPicker.clearTextarea(".emoji-wysiwyg-editor",""):$("#"+t.properties.sendMsgId).val(""),$("#"+t.properties.sendMsgId).parent().find(".emoji-wysiwyg-editor").off("keypress").keypress((function(e){if("enter"!=t.properties.key_sent_btn){if(13==e.keyCode&&e.shiftKey)return $("#"+t.properties.sendMsgBtnId).click(),!1}else{if(13==e.keyCode&&e.shiftKey)return!0;if(13==e.keyCode)return e.preventDefault(),e.stopPropagation(),$("#"+t.properties.sendMsgBtnId).click(),!1}}))},this.viewAlert=function(e,o,r){var i=new loadingContent({loadBlockWidth:"50%",closeBtnClass:"w",scroll:!0,otherClass:"alert_load",closeBtnPadding:5,blockBody:!0}).show_load_block('<div class="center"><div class="alert_text">'+e+'</div><button class="alert_ok alert_ok_delete btn btn-primary mt20 mlr20">'+t.properties.btnOk+'</button> <button class="alert_cancel alert_cancel_delete btn btn-cancel mt20 mlr20">'+t.properties.btnCancel+"</button></div>");$(".alert_ok.alert_ok_delete").unbind("click").on("click",(function(){t[o](r),$(".load_content_close").click(),$("#"+i).parent().hide()})),$(".alert_cancel.alert_cancel_delete").unbind("click").on("click",(function(){$(".load_content_close").click(),$("#"+i).parent().hide()}))},this.initMessagesAction=function(){$(".chatbox-messages__message-image").off("click").click((function(){t.initGallery($(this))})),$(".chatbox-messages__delele").off("click").click((function(){var e=$(this).data("message-id");return t.viewAlert(t.properties.langs.notice_delete_message,"deleteMessage",e),!1})),$('.chatbox [data-toggle="tooltip"]').tooltip(),$(".chatbox-dialog__messages ul li").each((function(){var e=$(this).find(".chatbox-messages__message:not(.emoji-rendered)");void 0!==e.html()&&(e.html(t.properties.emojiPicker.colonToImage(t.properties.emojiPicker.codeToColon(JSON.parse(JSON.stringify(e.html()).replace(/\\\\u/g,"\\u"))))),e.addClass("emoji-rendered"))}))},this.loadDialogs=function(e,r,n){if(1!=o&&(n=n||!1,!(r=r||!1)||1!=i.dialogsLoaded)){var s=0,a="",c=0;if(r){var p=$(".chatbox-users__list li.chatbox-users__user:last");p&&(a=p.data("udate"),c=p.data("id")),s=1}return o=!0,$.ajax({url:t.properties.siteUrl+t.properties.getDialogsLink,type:"POST",data:{search:e,l_date:a,l_id:c},dataType:"json",cache:!1,backend:s,success:function(e){o=!1,r?e.count>0?t.renderDialogs(e.dialogs,!0,n):i.dialogsLoaded=!0:t.renderDialogs(e.dialogs,!1,n)}}),this}},this.renderDialogs=function(e,o,r){for(var i in o=o||!1,r=r||!1,$(".chatbox-users__list .empty").hide(),e.length||o||$(".chatbox-users__list .empty").show(),o||$(".chatbox-users__list li.chatbox-users__user").remove(),$dialogs_block=$(".chatbox-users__list ul"),e)$dialogs_block.find("#chb_user_"+e[i].contact_id).length||$dialogs_block.append(e[i].html);if(t.initUsersActions(),r)$(".chatbox-users__list").slimScroll({scrollTo:"0px"});else{var n=$(".chatbox-users__list").parent().find(".slimScrollBar");0==parseInt(n.css("top"))/($(".chatbox-users__list").outerHeight()-n.outerHeight())&&$(".chatbox-users__list").slimScroll({scrollTo:"0px"})}return this},this.deleteDialog=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.deleteDialogLink,type:"POST",data:{contact_id:e},dataType:"json",success:function(o){void 0!==o.success&&1==o.success&&(e==t.properties.contactId&&t.closeDialog(),$(".chatbox-users__list li#chb_user_"+e).remove())}}),this},this.loadHistory=function(){if(1!=r&&1!=i.historyLoaded){var e="",o=$(".chatbox-dialog__messages li.chatbox-messages__item:first");return o&&(e=o.data("date-added")),r=!0,$.ajax({url:t.properties.siteUrl+t.properties.loadMessagesLink,type:"POST",data:{contact_id:t.properties.contactId,f_adate:e},dataType:"json",cache:!1,backend:1,success:function(e){r=!1,e.count>0?t.renderMessages(e.messages,!0):i.historyLoaded=!0}}),this}},this.openAddContactForm=function(){$.ajax({url:t.properties.siteUrl+t.properties.loadUsersFormLink,type:"GET",cache:!1,success:function(e){t.properties.usersContentObj.show_load_block(e)}})},this.initMultiRequest=function(){var e=[{gid:"check_is_read_messages",params:{module:"chatbox",model:"ChatboxModel",method:"backendMessagesStatus"},paramsFunc:function(){var e=[];return $(".chatbox-users__user").length>0&&$(".chatbox-users__user").each((function(){parseInt($(this).data("contact-id"))!=parseInt(t.properties.user_id)&&$(this).find(".chatbox-users__your")&&($(this).find(".chatbox-users__message").hasClass("is_read")||e.push($(this).data("contact-id")))})),{contacts:e}},callback:function(e){if(e.last_status_messages)for(var o in e.last_status_messages)$('.chatbox-users__user[data-contact-id="'+e.last_status_messages[o].user_id+'"]').length>0&&"1"==e.last_status_messages[o].is_read&&($('.chatbox-users__user[data-contact-id="'+e.last_status_messages[o].user_id+'"] .chatbox-users__message').addClass("is_read"),o==t.properties.contactId&&$(".chatbox-messages__bubble-right").each((function(){$(this).parent().parent().addClass("is_read")})))},period:1,status:1}];return MultiRequest.initActions(e),this},this.startDialog=function(e,o){(o=o||!1)&&t.properties.usersContentObj.hide_load_block(),$.ajax({url:t.properties.siteUrl+t.properties.startDialogLink,type:"POST",data:{contact_id:e},dataType:"json",success:function(o){o.errors?t.properties.errorObj.show_error_block(o.errors,"error"):o.content&&(t.properties.contactId=o.contact_id,t.properties.user_id,$(".chatbox-users__user").removeClass("active"),$("#chb_user_"+t.properties.contactId).addClass("active"),$("#chb_user_"+t.properties.contactId).find(".chatbox-users__new_msg").html(""),i.dialogBox.html(o.content),i.emptyDialogBox.hide(),i.historyLoaded=!1,t.initDialogActions(),t.initMessagesAction(),i.dialogBox.show(),t.scrollToNewMsgs(),$(".emoji-wysiwyg-editor").focus(),$(".emoji-wysiwyg-editor").click(),t.properties.mini||history.pushState(null,null,t.properties.siteUrl+"chatbox/index/"+e),$("#chatbox").addClass(t.properties.dialogStateClass),$(".chatbox-dialog__footer").css("display","table"),t.properties.user_id==t.properties.contactId&&$(".chatbox-dialog__footer").css("display","none"),t.properties.check_is_read_mess||t.initMultiRequest())}})},this.scrollToNewMsgs=function(){var e=$(".chatbox-dialog__messages ul").height();$(".chatbox-dialog__messages ul > li.chatbox-messages__item_new:first").length>0&&(e=$(".chatbox-dialog__messages ul > li.chatbox-messages__item_new:first").offset().top-200),$(".chatbox-dialog__messages").animate({scrollTop:e},(function(){$(".chatbox-dialog__messages").scroll((function(){1===t.properties.isFocusPage&&setTimeout((function(){$(".chatbox-dialog__messages ul > li").removeClass("chatbox-messages__item_new")}),2e3)}))}))},this.closeDialog=function(){t.properties.contactId=0,t.properties.mini||history.pushState(null,null,"./"),$(".chatbox-users__user").removeClass("active"),i.dialogBox.html(""),i.dialogBox.hide(),i.emptyDialogBox.show(),i.historyLoaded=!1,$("#chatbox").removeClass(t.properties.dialogStateClass)},this.sendMessage=function(){if(t.properties.contactId){var e=$("#"+t.properties.sendMsgId).val();if(""!=t.trimStr(e)){var o="",r=$(".chatbox-dialog__messages li.chatbox-messages__item:last");r&&(o=r.data("date-added")),$.ajax({url:t.properties.siteUrl+t.properties.sendMessageLink,type:"POST",data:{contact_id:t.properties.contactId,message:e,l_adate:o},dataType:"json",cache:!1,success:function(e){return void 0!==e.errors&&""!=e.errors?t.properties.errorObj.show_error_block(e.errors,"error"):($("#"+t.properties.sendMsgId).val(""),$("#"+t.properties.sendMsgId).css("height","auto"),void 0!==t.properties.emojiPicker&&t.properties.emojiPicker.clearTextarea(".emoji-wysiwyg-editor"),$("#"+t.properties.sendMsgId).parent().find(".emoji-wysiwyg-editor").css("height","auto"),t.renderMessages(e.messages),$(".chatbox-dialog__messages").animate({scrollTop:$(".chatbox-dialog__messages ul").height()},"fast"),e.contact&&($("#chb_user_"+e.contact.id).replaceWith(e.contact.html),$("#chb_user_"+e.contact.id).removeClass("active"))),!1}})}}return!1},this.getMessages=function(e){e=e||0,$.ajax({url:t.properties.siteUrl+t.properties.loadMessagesLink,type:"POST",data:{contact_id:t.properties.contactId,only_new:e},dataType:"json",cache:!1,success:function(e){e.messages&&t.renderMessages(e.messages)}})},this.renderMessages=function(e,o){if(o=o||!1,e.length){$(".chatbox-dialog__messages-empty").hide(),$messages_block=$(".chatbox-dialog__messages ul"),$(".chatbox-dialog__messages").prop("scrollHeight");var r="";for(var i in e)$messages_block.find("#chb_msg_"+e[i].id).length||(o?r+=e[i].html:(last_msg=e[i],$messages_block.append(e[i].html)));return o&&""!=r&&$messages_block.prepend(r),t.initMessagesAction(),$(".chatbox-dialog__messages ul").height()-$(".chatbox-dialog__messages").scrollTop()-$(".chatbox-dialog__messages").height()<160&&$(".chatbox-dialog__messages").animate({scrollTop:$(".chatbox-dialog__messages ul").height()},"fast"),this}},this.deleteMessage=function(e){e&&$.ajax({url:t.properties.siteUrl+t.properties.deleteMessageLink,type:"POST",data:{message_id:e},dataType:"json",cache:!1,success:function(o){1==o.success&&($(".chatbox-dialog__messages li#chb_msg_"+e).remove(),0===o.msg_count&&($(".chatbox-dialog__messages-empty").show(),$(".chatbox-users__list li#chb_user_"+t.properties.contactId).remove()))}})},this.initGallery=function(e){if(e){var o=$(e).closest(".chatbox-dialog__messages").attr("gallery");t.properties.images=$('.chatbox-dialog__messages[gallery="'+o+'"]').find("img.chatbox-messages__message-image"),$(document).off("click","#chatbox_gallery [data-click=next_media]").on("click","[data-click=next_media]",(function(){t.nextGalleryImage()})),$(document).off("click","#chatbox_gallery [data-click=prev_media]").on("click","[data-click=prev_media]",(function(){t.prevGalleryImage()})),t.setGalleryImage(e.get(0))}return this},this.setGalleryImage=function(e){if(t.properties.images.length){var o=t.properties.images[0],r=t.properties.images[t.properties.images.length-1],i="1 / "+t.properties.images.length;for(var n in t.properties.images)t.properties.images[n]==e&&(void 0!==t.properties.images[+n+1]&&(o=t.properties.images[+n+1]),void 0!==t.properties.images[+n-1]&&(r=t.properties.images[+n-1]),i=+n+1+" / "+t.properties.images.length);t.properties.next_gallery_image=o,t.properties.prev_gallery_image=r;var s='<img class="hide" src="'+$(r).attr("gallery-src")+'" />',a='<img class="hide" src="'+$(o).attr("gallery-src")+'" />',c='<div class="media-gallery-editor"><div class="media-gallery-editor__media-box"><div class="media-gallery-editor__media-source-box container_"><div class="inner-image"><img class="img-responsive" src="'+$(e).attr("gallery-src")+'" /><div data-click="next_media" class="fas fa-angle-right load_content_right"></div><div data-click="prev_media" class="fas fa-angle-left load_content_left"></div></div>'+s+a+'</div><div class="media-gallery-editor__photo-menu">'+i+"</div></div></div>";t.properties.gallery.changeTemplate("gallery"),t.properties.gallery.update_css_styles({width:"962px"}),t.properties.gallery.show_load_block(c,!0)}},this.nextGalleryImage=function(){t.setGalleryImage(t.properties.next_gallery_image)},this.prevGalleryImage=function(){t.setGalleryImage(t.properties.prev_gallery_image)},t.trimStr=function(e){return(e=e.replace(/^\s+/g,"").replace(/&nbsp;/g,"")).replace(/\s+$/g,"")},t.nl2br=function(e){return e.replace(/([^>])\n/g,"$1<br/>")},t.br2nl=function(e){return e.replace(/<br\s*\/?>/gm,"\n")},t.getMessageText=function(e){return e=(e=e.replace(/<div>/gm,"\n")).replace(/<\/div>/gm,""),t.br2nl(e)},t.Init(e)})},1036:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.adminChats=function(e){this.properties={siteUrl:""};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),$("tr:odd","#chatsList").addClass("zebra"),t.bind_events()},this.bind_events=function(){},t.Init(e)})},7869:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.flashchatAdmin=function(e){this.properties={adminFile:""},this.chatSettings={},this.errors={};var t,o,r=this,i="#flashchat";this.changeServerType=function(e){"by_flashchat_free"===e||void 0===r.chatSettings.server_settings[e].client_location?t.hide():(o.attr("src",r.chatSettings.server_settings[e].client_location+r.properties.adminFile),t.show()),$(".server_settings",i).slideUp(),$("#settings_"+e,i).slideDown()},this.Init=function(e){r.properties=$.extend(r.properties,e),o=$("#embed",i),t=$("#admin_panel",i),r.bindEvents()},this.bindEvents=function(){$(".server_type",i).on("change",(function(){r.changeServerType($(this).val())})),$('[name="settings[server_settings][by_user][server_type]"]').change((function(){var e=$(this).val(),t=$("#client_location").val();"ppvsoftware"===e?($("#init_port").val("51212"),$("#init_port_h").val("31212"),$("#client_location").val(t.replace("35555","31212")),$("#client_type").hide()):"flashchat"===e&&($("#init_port").val("51127"),$("#init_port_h").val("35555"),$("#client_location").val(t.replace("31212","35555")),$("#client_type").show())}))},r.Init(e)})},4536:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Oovoochat=function(e){this.properties={conferenceId:"OOVOO_WEB_RTC",appToken:"",testMode:!1,sessionToken:"",participantId:"",participantName:"",localVideoId:"",remoteVideoId:"",saveSessionUrl:"",completeChatId:"complete-chat",pauseChatId:"",status:""};var t=this;return this.init=function(e){t.properties=$.extend(t.properties,e),t.properties.sessionToken?ooVoo.API.init({userToken:t.properties.sessionToken},t.onAPI_init):ooVoo.API.connect({token:t.properties.appToken,isSandbox:t.properties.testMode,userId:t.properties.participantId,callbackUrl:site_url+t.properties.saveSessionUrl}),$("#"+t.properties.completeChatId).unbind("click").on("click",(function(e){e.preventDefault(),t.conference&&t.conference.disconnect(),$("#his_info_block").show(),$("#chat_user_block").show(),$("#"+t.properties.pauseChatId).hide()}))},this.onAPI_init=function(e){t.conference=ooVoo.API.Conference.init({video:!0,audio:!0},t.onConference_init)},window.onStreamPublished=function(e){document.getElementById(t.properties.localVideoId).src=URL.createObjectURL(e.stream)},window.onParticipantLeft=function(e){e.uid&&(document.getElementById(t.properties.remoteVideoId).src="",$("#his_info_block").show(),$("#chat_user_block").show(),$("#"+t.properties.pauseChatId).hide())},window.onParticipantJoined=function(e){e.stream&&null!=e.uid&&(document.getElementById(t.properties.remoteVideoId).src=URL.createObjectURL(e.stream),$("#his_info_block").hide(),$("#chat_user_block").hide())},window.onConferenceStateChanged=function(e){},window.onRemoteVideoStateChanged=function(e){switch(e.state){case"PLAY":$("#his_info_block").hide(),$("#chat_user_block").hide();break;case"PAUSED":alert("Paused");break;case"STOPPED":$("#his_info_block").show(),$("#chat_user_block").show()}},this.onConference_init=function(e){e.error||(t.conference.onParticipantJoined=onParticipantJoined,t.conference.onParticipantLeft=onParticipantLeft,t.conference.onLocalStreamPublished=onStreamPublished,t.conference.onConferenceStateChanged=onConferenceStateChanged,t.conference.onRemoteVideoStateChanged=onRemoteVideoStateChanged,t.conference.setConfig({videoResolution:ooVoo.API.VideoResolution.HIGH,videoFrameRate:new Array(5,15)},(function(e){e.error||t.conference.join(t.properties.conferenceId,t.properties.participantId,t.properties.sessionToken,t.properties.participantName,(function(e){}))})))},t.init(e),this})},388:(e,t,o)=>{var r;function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}parcelRequire=function(n,s,a,c){var p,l="function"==typeof parcelRequire&&parcelRequire;function d(e,t){if(!s[e]){if(!n[e]){var r="function"==typeof parcelRequire&&parcelRequire;if(!t&&r)return r(e,!0);if(l)return l(e,!0);if("string"==typeof e)return o(9165)(e);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}c.resolve=function(t){return n[e][1][t]||t},c.cache={};var a=s[e]=new d.Module(e);n[e][0].call(a.exports,c,a,a.exports,this)}return s[e].exports;function c(e){return d(c.resolve(e))}}d.isParcelRequire=!0,d.Module=function(e){this.id=e,this.bundle=d,this.exports={}},d.modules=n,d.cache=s,d.parent=l,d.register=function(e,t){n[e]=[function(e,o){o.exports=t},{}]};for(var u=0;u<a.length;u++)try{d(a[u])}catch(n){p||(p=n)}if(a.length){var _=d(a[a.length-1]);"object"==i(t)?e.exports=_:void 0===(r=function(){return _}.call(t,o,t,e))||(e.exports=r)}if(parcelRequire=d,p)throw p;return d}({EgBh:[function(e,t,o){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=r;var i=t.exports.BlobBuilder;function n(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(i=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),n.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},n.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);r.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},n.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var e=new i,t=0,o=this._parts.length;t<o;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=n},{}],kdPp:[function(e,t,o){var r=e("./bufferbuilder").BufferBuilder,n=e("./bufferbuilder").binaryFeatures,s={unpack:function(e){return new a(e).unpack()},pack:function(e){var t=new c;return t.pack(e),t.getBuffer()}};function a(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function c(){this.bufferBuilder=new r}function p(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports=s,a.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:case 212:case 213:case 214:case 215:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},a.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},a.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},a.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},a.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},a.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},a.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},a.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},a.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},a.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},a.prototype.unpack_string=function(e){for(var t,o,r=this.read(e),i=0,n="";i<e;)(t=r[i])<128?(n+=String.fromCharCode(t),i++):(192^t)<32?(o=(192^t)<<6|63&r[i+1],n+=String.fromCharCode(o),i+=2):(o=(15&t)<<12|(63&r[i+1])<<6|63&r[i+2],n+=String.fromCharCode(o),i+=3);return this.index+=e,n},a.prototype.unpack_array=function(e){for(var t=new Array(e),o=0;o<e;o++)t[o]=this.unpack();return t},a.prototype.unpack_map=function(e){for(var t={},o=0;o<e;o++){var r=this.unpack(),i=this.unpack();t[r]=i}return t},a.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},a.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),o=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,o-20)+t*Math.pow(2,o-52))},a.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},c.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},c.prototype.pack=function(e){var t=i(e);if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var o=e.constructor;if(o==Array)this.pack_array(e);else if(o==Blob||o==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(o==ArrayBuffer)n.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)n.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(o==Object||o.toString().startsWith("class"))this.pack_object(e);else if(o==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+o.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},c.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},c.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,p).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},c.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var o=0;o<t;o++)this.pack(e[o])},c.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},c.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var o=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,o)-1,i=Math.floor(r*Math.pow(2,52)),n=Math.pow(2,32),s=t<<31|o+1023<<20|i/n&1048575,a=i%n;this.bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(a)},c.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var o in e)e.hasOwnProperty(o)&&(this.pack(o),this.pack(e[o]))},c.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},c.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},c.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},c.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),o=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&o)>>>24),this.bufferBuilder.append((16711680&o)>>>16),this.bufferBuilder.append((65280&o)>>>8),this.bufferBuilder.append(255&o)},c.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},c.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},c.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},c.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),o=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&o)>>>24),this.bufferBuilder.append((16711680&o)>>>16),this.bufferBuilder.append((65280&o)>>>8),this.bufferBuilder.append(255&o)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(e,t,o){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}Object.defineProperty(o,"__esModule",{value:!0}),o.extractVersion=a,o.wrapPeerConnectionEvent=function(e,t,o){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var n=function(e){var t=o(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=n,i.apply(this,[e,n])};var n=r.removeEventListener;r.removeEventListener=function(e,o){if(e!==t||!this._eventMap||!this._eventMap[o])return n.apply(this,arguments);var r=this._eventMap[o];return delete this._eventMap[o],n.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},o.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(n=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},o.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(s=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},o.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(n)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},o.deprecated=function(e,t){s&&console.warn(e+" is deprecated, please use "+t+" instead.")},o.detectBrowser=function(e){var t=e.navigator,o={browser:null,version:null};if(void 0===e||!e.navigator)return o.browser="Not a browser.",o;if(t.mozGetUserMedia)o.browser="firefox",o.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)o.browser="chrome",o.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))o.browser="edge",o.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return o.browser="Not a supported browser.",o;o.browser="safari",o.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),o.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return o},o.compactObject=function e(t){return c(t)?Object.keys(t).reduce((function(o,r){var i=c(t[r]),n=i?e(t[r]):t[r],s=i&&!Object.keys(n).length;return void 0===n||s?o:Object.assign(o,function(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}({},r,n))}),{}):t},o.walkStats=p,o.filterStats=function(e,t,o){var r=o?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var n=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&n.push(e)})),n.forEach((function(t){e.forEach((function(o){o.type===r&&o.trackId===t.id&&p(e,o,i)}))})),i};var n=!0,s=!0;function a(e,t,o){var r=e.match(t);return r&&r.length>=o&&parseInt(r[o],10)}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function p(e,t,o){t&&!o.has(t.id)&&(o.set(t.id,t),Object.keys(t).forEach((function(r){r.endsWith("Id")?p(e,e.get(t[r]),o):r.endsWith("Ids")&&t[r].forEach((function(t){p(e,e.get(t),o)}))})))}},{}],s6SN:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var o=r.detectBrowser(e),i=function(e){if("object"!==s(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(o){if("require"!==o&&"advanced"!==o&&"mediaSource"!==o){var r="object"===s(e[o])?e[o]:{ideal:e[o]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var n={};"number"==typeof r.ideal?(n[i("min",o)]=r.ideal,t.optional.push(n),(n={})[i("max",o)]=r.ideal,t.optional.push(n)):(n[i("",o)]=r.ideal,t.optional.push(n))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",o)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,o)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},n=function(e,r){if(o.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===s(e.audio)){var n=function(e,t,o){t in e&&!(o in e)&&(e[o]=e[t],delete e[t])};n((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),n(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===s(e.video)){var c=e.video.facingMode;c=c&&("object"===s(c)?c:{ideal:c});var p,l=o.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)&&(delete e.video.facingMode,"environment"===c.exact||"environment"===c.ideal?p=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(p=["front"]),p))return t.mediaDevices.enumerateDevices().then((function(t){var o=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return p.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!o&&t.length&&p.includes("back")&&(o=t[t.length-1]),o&&(e.video.deviceId=c.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e.video=i(e.video),a("chrome: "+JSON.stringify(e)),r(e)}));e.video=i(e.video)}return a("chrome: "+JSON.stringify(e)),r(e)},c=function(e){return o.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,o,r){n(e,(function(e){t.webkitGetUserMedia(e,o,(function(e){r&&r(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var p=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e,(function(e){return p(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=i(e)&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var a=r?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(o,s,a):o[s]=e[s]}return o.default=e,t&&t.set(e,o),o}(e("../utils.js"));function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}var a=r.log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(o){return t(o).then((function(t){var r=o.video&&o.video.width,i=o.video&&o.video.height,n=o.video&&o.video.frameRate;return o.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:n||3}},r&&(o.video.mandatory.maxWidth=r),i&&(o.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(o)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},o.shimOnTrack=function(e){if("object"!==p(e)||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var o=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?o.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var n=new Event("track");n.track=r.track,n.receiver=i,n.transceiver={receiver:i},n.streams=[t.stream],o.dispatchEvent(n)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?o.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var n=new Event("track");n.track=r,n.receiver=i,n.transceiver={receiver:i},n.streams=[t.stream],o.dispatchEvent(n)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},o.shimGetSendersWithDtmf=function(e){if("object"===p(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var o=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=o.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var o=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){o._senders.push(t(o,e))}))};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((function(e){var o=t._senders.find((function(t){return t.track===e}));o&&t._senders.splice(t._senders.indexOf(o),1)}))}}else if("object"===p(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},o.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,o=Array.prototype.slice.call(arguments),r=o[0],i=o[1],n=o[2];if(arguments.length>0&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var s=function(e){var t={};return e.result().forEach((function(e){var o={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){o[t]=e.stat(t)})),t[o.id]=o})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){i(a(s(e)))},r]):new Promise((function(o,r){t.apply(e,[function(e){o(a(s(e)))},r])})).then(i,n)}}},o.shimSenderReceiverGetStats=function(e){if("object"===p(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,o=t.apply(this,[]);return o.forEach((function(t){return t._pc=e})),o});var o=e.RTCPeerConnection.prototype.addTrack;o&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=o.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,o,r,i=arguments[0];return this.getSenders().forEach((function(e){e.track===i&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===i&&(o?r=!0:o=e),e.track===i})),r||t&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return n.apply(this,arguments)}}}},o.shimAddTrackRemoveTrackWithNative=l,o.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return l(e);var o=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=o.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var o=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(o.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}i.apply(this,[t])};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,o){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var n=this._streams[o.id];if(n)n.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[o.id]=s,this._reverseStreams[s.id]=o,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var o=e.RTCPeerConnection.prototype[t],r=c({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?o.apply(this,[function(o){var r=p(e,o);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):o.apply(this,arguments).then((function(t){return p(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,o=(t=arguments[0]).sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];o=o.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:o})),s.apply(this,arguments)):s.apply(this,arguments);var e,t,o};var a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:p(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,o=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(r){o._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=o._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function p(e,t){var o=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];o=o.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:o})}},o.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var o=e.RTCPeerConnection.prototype[t],r=c({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var o=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():o.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},o.fixNegotiationNeeded=function(e){r.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))},Object.defineProperty(o,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}}),Object.defineProperty(o,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var s=r?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(o,n,s):o[n]=e[n]}return o.default=e,t&&t.set(e,o),o}(e("../utils.js")),n=e("./getusermedia"),s=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function c(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function p(e){return(p="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}function l(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,o){if(!o)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[o.id]?-1===this._shimmedLocalStreams[o.id].indexOf(r)&&this._shimmedLocalStreams[o.id].push(r):this._shimmedLocalStreams[o.id]=[o,r],r};var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();o.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(o){var r=t._shimmedLocalStreams[o].indexOf(e);-1!==r&&t._shimmedLocalStreams[o].splice(r,1),1===t._shimmedLocalStreams[o].length&&delete t._shimmedLocalStreams[o]})),i.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.filterIceServers=function(e,t){var o=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!o?(o=!0,!0):t&&!o})),delete e.url,e.urls=i?t[0]:t,!!t.length}}))};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=i(e)&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var a=r?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(o,s,a):o[s]=e[s]}return o.default=e,t&&t.set(e,o),o}(e("../utils"));function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}},{"../utils":"iSxC"}],YHvh:[function(e,t,o){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,o={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":o.relatedAddress=t[r+1];break;case"rport":o.relatedPort=parseInt(t[r+1],10);break;case"tcptype":o.tcpType=t[r+1];break;case"ufrag":o.ufrag=t[r+1],o.usernameFragment=t[r+1];break;default:o[t[r]]=t[r+1]}return o},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var o=e.type;return t.push("typ"),t.push(o),"host"!==o&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),o={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),o.name=t[0],o.clockRate=parseInt(t[1],10),o.channels=3===t.length?parseInt(t[2],10):1,o.numChannels=o.channels,o},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var o=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==o?"/"+o:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,o={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)o[(t=r[i].trim().split("="))[0].trim()]=t[1];return o},r.writeFmtp=function(e){var t="",o=e.payloadType;if(void 0!==e.preferredPayloadType&&(o=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+o+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",o=e.payloadType;return void 0!==e.preferredPayloadType&&(o=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+o+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),o={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(o.attribute=e.substr(t+1,r-t-1),o.value=e.substr(r+1)):o.attribute=e.substr(t+1),o},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var o="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){o+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),o},r.getIceParameters=function(e,t){var o=r.splitLines(e);return{usernameFragment:(o=o.concat(r.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:o.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=r.splitLines(e)[0].split(" "),i=3;i<o.length;i++){var n=o[i],s=r.matchPrefix(e,"a=rtpmap:"+n+" ")[0];if(s){var a=r.parseRtpMap(s),c=r.matchPrefix(e,"a=fmtp:"+n+" ");switch(a.parameters=c.length?r.parseFmtp(c[0]):{},a.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+n+" ").map(r.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var o="";o+="m="+e+" ",o+=t.codecs.length>0?"9":"0",o+=" UDP/TLS/RTP/SAVPF ",o+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",o+="c=IN IP4 0.0.0.0\r\n",o+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){o+=r.writeRtpMap(e),o+=r.writeFmtp(e),o+=r.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(o+="a=maxptime:"+i+"\r\n"),o+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){o+=r.writeExtmap(e)})),o},r.parseRtpEncodingParameters=function(e){var t,o=[],i=r.parseRtpParameters(e),n=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,p=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));p.length>0&&p[0].length>1&&p[0][0]===c&&(t=p[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),o.push(r),n&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},o.push(r))}})),0===o.length&&c&&o.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,o.forEach((function(e){e.maxBitrate=l}))),o},r.parseRtcpParameters=function(e){var t={},o=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];o&&(t.cname=o.value,t.ssrc=o.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var n=r.matchPrefix(e,"a=rtcp-mux");return t.mux=n.length>0,t},r.parseMsid=function(e){var t,o=r.matchPrefix(e,"a=msid:");if(1===o.length)return{stream:(t=o[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,o=r.parseMLine(e),i=r.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var n=r.matchPrefix(e,"a=sctp-port:");if(n.length>0)return{port:parseInt(n[0].substr(12),10),protocol:o.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var s=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var o=[];return o="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&o.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),o.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,o){var i=void 0!==t?t:2;return"v=0\r\no="+(o||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,o,i){var n=r.writeRtpDescription(e.kind,t);if(n+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),n+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===o?"actpass":"active"),n+="a=mid:"+e.mid+"\r\n",e.direction?n+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?n+="a=sendrecv\r\n":e.rtpSender?n+="a=sendonly\r\n":e.rtpReceiver?n+="a=recvonly\r\n":n+="a=inactive\r\n",e.rtpSender){var s="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";n+="a="+s,n+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(n+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,n+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return n+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(n+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),n},r.getDirection=function(e,t){for(var o=r.splitLines(e),i=0;i<o.length;i++)switch(o[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),o=0;o<t.length;o++)if(t[o].length<2||"="!==t[o].charAt(1))return!1;return!0},"object"==i(t)&&(t.exports=r)},{}],NJ2u:[function(e,t,o){"use strict";var r=e("sdp");function i(e,t,o,i,n){var s=r.writeRtpDescription(e.kind,t);if(s+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===o?"actpass":n||"active"),s+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var c="msid:"+(i?i.id:"-")+" "+a+"\r\n";s+="a="+c,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),s}function n(e,t){var o={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var o=0;o<t.length;o++)if(t[o].payloadType===e||t[o].preferredPayloadType===e)return t[o]},i=function(e,t,o,i){var n=r(e.parameters.apt,o),s=r(t.parameters.apt,i);return n&&s&&n.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(r){for(var n=0;n<t.codecs.length;n++){var s=t.codecs[n];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!i(r,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),o.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){o.headerExtensions.push(i);break}}})),o}function s(e,t,o){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(o)}function a(e,t){var o=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return o||e.addRemoteCandidate(t),!o}function c(e,t){var o=new Error(t);return o.name=e,o.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],o}t.exports=function(e,t){function o(t,o){o.addTrack(t),o.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function p(t,o,r,i){var n=new Event("track");n.track=o,n.receiver=r,n.transceiver={receiver:r},n.streams=i,e.setTimeout((function(){t._dispatchEvent("track",n)}))}var l=function(o){var i=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=n[e].bind(n)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",o=JSON.parse(JSON.stringify(o||{})),this.usingBundle="max-bundle"===o.bundlePolicy,"negotiate"===o.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(o.rtcpMuxPolicy||(o.rtcpMuxPolicy="require"),o.iceTransportPolicy){case"all":case"relay":break;default:o.iceTransportPolicy="all"}switch(o.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:o.bundlePolicy="balanced"}if(o.iceServers=function(e,t){var o=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||o?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(o=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(o.iceServers||[],t),this._iceGatherers=[],o.iceCandidatePoolSize)for(var s=o.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:o.iceServers,gatherPolicy:o.iceTransportPolicy}));else o.iceCandidatePoolSize=0;this._config=o,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var o=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&o)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},l.prototype.addTrack=function(t,o){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(o)&&this.localStreams.push(o),r.track=t,r.stream=o,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var o=this;if(t>=15025)e.getTracks().forEach((function(t){o.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var o=r.getTracks()[t];e.addEventListener("enabled",(function(e){o.enabled=e.enabled}))})),r.getTracks().forEach((function(e){o.addTrack(e,r)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var o=this.transceivers.find((function(e){return e.rtpSender===t}));if(!o)throw c("InvalidAccessError","Sender was not created by this connection.");var r=o.stream;o.rtpSender.stop(),o.rtpSender=null,o.track=null,o.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var o=t.getSenders().find((function(t){return t.track===e}));o&&t.removeTrack(o)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,o){var r=this;if(o&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var o=!e.candidate||0===Object.keys(e.candidate).length;i.state=o?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,o){var i=this,n=this.transceivers[o].iceGatherer;if(!n.onlocalcandidate){var s=this.transceivers[o].bufferedCandidateEvents;this.transceivers[o].bufferedCandidateEvents=null,n.removeEventListener("localcandidate",this.transceivers[o].bufferCandidates),n.onlocalcandidate=function(e){if(!(i.usingBundle&&o>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:o};var a=e.candidate,c=!a||0===Object.keys(a).length;if(c)"new"!==n.state&&"gathering"!==n.state||(n.state="completed");else{"new"===n.state&&(n.state="gathering"),a.component=1,a.ufrag=n.getLocalParameters().usernameFragment;var p=r.writeCandidate(a);s.candidate=Object.assign(s.candidate,r.parseCandidate(p)),s.candidate.candidate=p,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var l=r.getMediaSections(i._localDescription.sdp);l[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+l.join("");var d=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",s),d&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){n.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,o=new e.RTCIceTransport(null);o.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(o);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:o,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var o=this.transceivers[e].iceTransport;o&&(delete o.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,o,i){var s=n(e.localCapabilities,e.remoteCapabilities);o&&e.rtpSender&&(s.encodings=e.sendEncodingParameters,s.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(s.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(s)),i&&e.rtpReceiver&&s.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?s.encodings=e.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(s.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(s.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(s))},l.prototype.setLocalDescription=function(e){var t,o,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),o=t.shift(),t.forEach((function(e,t){var o=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=o})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),o=t.shift();var a=r.matchPrefix(o,"a=ice-lite").length>0;t.forEach((function(e,t){var s=i.transceivers[t],c=s.iceGatherer,p=s.iceTransport,l=s.dtlsTransport,d=s.localCapabilities,u=s.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||s.rejected)){var _=r.getIceParameters(e,o),f=r.getDtlsParameters(e,o);a&&(f.role="server"),i.usingBundle&&0!==t||(i._gather(s.mid,t),"new"===p.state&&p.start(c,_,a?"controlling":"controlled"),"new"===l.state&&l.start(f));var h=n(d,u);i._transceive(s,h.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!s("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var d={};l.remoteStreams.forEach((function(e){d[e.id]=e}));var u=[],_=r.splitSections(i.sdp),f=_.shift(),h=r.matchPrefix(f,"a=ice-lite").length>0,m=r.matchPrefix(f,"a=group:BUNDLE ").length>0;l.usingBundle=m;var g=r.matchPrefix(f,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,_.forEach((function(s,c){var p=r.splitLines(s),_=r.getKind(s),g=r.isRejected(s)&&0===r.matchPrefix(s,"a=bundle-only").length,b=p[0].substr(2).split(" ")[2],v=r.getDirection(s,f),y=r.parseMsid(s),k=r.getMid(s)||r.generateIdentifier();if(g||"application"===_&&("DTLS/SCTP"===b||"UDP/DTLS/SCTP"===b))l.transceivers[c]={mid:k,kind:_,protocol:b,rejected:!0};else{var w,$,x,S,j,C,T,P,I;!g&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(_,!0));var M,B,O=r.parseRtpParameters(s);g||(M=r.getIceParameters(s,f),(B=r.getDtlsParameters(s,f)).role="client"),T=r.parseRtpEncodingParameters(s);var A=r.parseRtcpParameters(s),U=r.matchPrefix(s,"a=end-of-candidates",f).length>0,D=r.matchPrefix(s,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!g&&m&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||g)"answer"!==i.type||g||($=(w=l.transceivers[c]).iceGatherer,x=w.iceTransport,S=w.dtlsTransport,j=w.rtpReceiver,C=w.sendEncodingParameters,P=w.localCapabilities,l.transceivers[c].recvEncodingParameters=T,l.transceivers[c].remoteCapabilities=O,l.transceivers[c].rtcpParameters=A,D.length&&"new"===x.state&&(!h&&!U||m&&0!==c?D.forEach((function(e){a(w.iceTransport,e)})):x.setRemoteCandidates(D)),m&&0!==c||("new"===x.state&&x.start($,M,"controlling"),"new"===S.state&&S.start(B)),!n(w.localCapabilities,w.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&w.sendEncodingParameters[0].rtx&&delete w.sendEncodingParameters[0].rtx,l._transceive(w,"sendrecv"===v||"recvonly"===v,"sendrecv"===v||"sendonly"===v),!j||"sendrecv"!==v&&"sendonly"!==v?delete w.rtpReceiver:(I=j.track,y?(d[y.stream]||(d[y.stream]=new e.MediaStream),o(I,d[y.stream]),u.push([I,j,d[y.stream]])):(d.default||(d.default=new e.MediaStream),o(I,d.default),u.push([I,j,d.default]))));else{(w=l.transceivers[c]||l._createTransceiver(_)).mid=k,w.iceGatherer||(w.iceGatherer=l._createIceGatherer(c,m)),D.length&&"new"===w.iceTransport.state&&(!U||m&&0!==c?D.forEach((function(e){a(w.iceTransport,e)})):w.iceTransport.setRemoteCandidates(D)),P=e.RTCRtpReceiver.getCapabilities(_),t<15019&&(P.codecs=P.codecs.filter((function(e){return"rtx"!==e.name}))),C=w.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var E,R=!1;"sendrecv"===v||"sendonly"===v?(R=!w.rtpReceiver,j=w.rtpReceiver||new e.RTCRtpReceiver(w.dtlsTransport,_),R&&(I=j.track,y&&"-"===y.stream||(y?(d[y.stream]||(d[y.stream]=new e.MediaStream,Object.defineProperty(d[y.stream],"id",{get:function(){return y.stream}})),Object.defineProperty(I,"id",{get:function(){return y.track}}),E=d[y.stream]):(d.default||(d.default=new e.MediaStream),E=d.default)),E&&(o(I,E),w.associatedRemoteMediaStreams.push(E)),u.push([I,j,E]))):w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach((function(t){var o,r,i=t.getTracks().find((function(e){return e.id===w.rtpReceiver.track.id}));i&&(o=i,(r=t).removeTrack(o),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:o})))})),w.associatedRemoteMediaStreams=[]),w.localCapabilities=P,w.remoteCapabilities=O,w.rtpReceiver=j,w.rtcpParameters=A,w.sendEncodingParameters=C,w.recvEncodingParameters=T,l._transceive(l.transceivers[c],!1,R)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(d).forEach((function(t){var o=d[t];if(o.getTracks().length){if(-1===l.remoteStreams.indexOf(o)){l.remoteStreams.push(o);var r=new Event("addstream");r.stream=o,e.setTimeout((function(){l._dispatchEvent("addstream",r)}))}u.forEach((function(e){var t=e[0],r=e[1];o.id===e[2].id&&p(l,t,r,[o])}))}})),u.forEach((function(e){e[2]||p(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var o=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",o)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var o=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",o)}},l.prototype.createOffer=function(){var o=this;if(o._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var n=o.transceivers.filter((function(e){return"audio"===e.kind})).length,s=o.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(n=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(s=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(o.transceivers.forEach((function(e){"audio"===e.kind?--n<0&&(e.wantReceive=!1):"video"===e.kind&&--s<0&&(e.wantReceive=!1)}));n>0||s>0;)n>0&&(o._createTransceiver("audio"),n--),s>0&&(o._createTransceiver("video"),s--);var p=r.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++);o.transceivers.forEach((function(i,n){var s=i.track,a=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=o._createIceGatherer(n,o.usingBundle));var p=e.RTCRtpSender.getCapabilities(a);t<15019&&(p.codecs=p.codecs.filter((function(e){return"rtx"!==e.name}))),p.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),p.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*n+1)}];s&&t>=15019&&"video"===a&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,a)),i.localCapabilities=p,i.sendEncodingParameters=l})),"max-compat"!==o._config.bundlePolicy&&(p+="a=group:BUNDLE "+o.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),p+="a=ice-options:trickle\r\n",o.transceivers.forEach((function(e,t){p+=i(e,e.localCapabilities,"offer",e.stream,o._dtlsRole),p+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===o.iceGatheringState||0!==t&&o.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,p+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(p+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:p});return Promise.resolve(l)},l.prototype.createAnswer=function(){var o=this;if(o._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==o.signalingState&&"have-local-pranswer"!==o.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+o.signalingState));var s=r.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++);o.usingBundle&&(s+="a=group:BUNDLE "+o.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var a=r.getMediaSections(o._remoteDescription.sdp).length;o.transceivers.forEach((function(e,r){if(!(r+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var p=n(e.localCapabilities,e.remoteCapabilities);!p.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=i(e,p,"answer",e.stream,o._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var p=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(p)},l.prototype.addIceCandidate=function(e){var t,o=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,n){if(!o._remoteDescription)return n(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var s=e.sdpMLineIndex;if(e.sdpMid)for(var p=0;p<o.transceivers.length;p++)if(o.transceivers[p].mid===e.sdpMid){s=p;break}var l=o.transceivers[s];if(!l)return n(c("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var d=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return i();if(d.component&&1!==d.component)return i();if((0===s||s>0&&l.iceTransport!==o.transceivers[0].iceTransport)&&!a(l.iceTransport,d))return n(c("OperationError","Can not add ICE candidate"));var u=e.candidate.trim();0===u.indexOf("a=")&&(u=u.substr(2)),(t=r.getMediaSections(o._remoteDescription.sdp))[s]+="a="+(d.type?u:"end-of-candidates")+"\r\n",o._remoteDescription.sdp=r.getDescription(o._remoteDescription.sdp)+t.join("")}else for(var _=0;_<o.transceivers.length&&(o.transceivers[_].rejected||(o.transceivers[_].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(o._remoteDescription.sdp))[_]+="a=end-of-candidates\r\n",o._remoteDescription.sdp=r.getDescription(o._remoteDescription.sdp)+t.join(""),!o.usingBundle));_++);i()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var o=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?o=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(o=e.rtpReceiver)})),!o)throw c("InvalidAccessError","Invalid selector.");return o.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var o=e[t];if(o&&o.prototype&&o.prototype.getStats){var r=o.prototype.getStats;o.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(o){e[o].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[o]),t.set(o,e[o])})),t}))}}}));var d=["createOffer","createAnswer"];return d.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(d=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:"YHvh"}],YdKx:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimGetUserMedia=function(e){var t=e&&e.navigator,o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return o(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],P3bV:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var o=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){o.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var i=(0,s.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,n.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new i(e)},e.RTCPeerConnection.prototype=i.prototype},o.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(o,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),Object.defineProperty(o,"shimGetDisplayMedia",{enumerable:!0,get:function(){return c.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=i(e)&&"function"!=typeof e)return{default:e};var t=p();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var s=r?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(o,n,s):o[n]=e[n]}return o.default=e,t&&t.set(e,o),o}(e("../utils")),n=e("./filtericeservers"),s=function(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim")),a=e("./getusermedia"),c=e("./getdisplaymedia");function p(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return p=function(){return e},e}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimGetUserMedia=function(e){var t=r.detectBrowser(e),o=e&&e.navigator,i=e&&e.MediaStreamTrack;if(o.getUserMedia=function(e,t,i){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),o.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in o.mediaDevices.getSupportedConstraints())){var n=function(e,t,o){t in e&&!(o in e)&&(e[o]=e[t],delete e[t])},a=o.mediaDevices.getUserMedia.bind(o.mediaDevices);if(o.mediaDevices.getUserMedia=function(e){return"object"===s(e)&&"object"===s(e.audio)&&(e=JSON.parse(JSON.stringify(e)),n(e.audio,"autoGainControl","mozAutoGainControl"),n(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},i&&i.prototype.getSettings){var c=i.prototype.getSettings;i.prototype.getSettings=function(){var e=c.apply(this,arguments);return n(e,"mozAutoGainControl","autoGainControl"),n(e,"mozNoiseSuppression","noiseSuppression"),e}}if(i&&i.prototype.applyConstraints){var p=i.prototype.applyConstraints;i.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===s(e)&&(e=JSON.parse(JSON.stringify(e)),n(e,"autoGainControl","mozAutoGainControl"),n(e,"noiseSuppression","mozNoiseSuppression")),p.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=i(e)&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var a=r?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(o,s,a):o[s]=e[s]}return o.default=e,t&&t.set(e,o),o}(e("../utils"));function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(o){if(!o||!o.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===o.video?o.video={mediaSource:t}:o.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(o)})}},{}],Fzdr:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimOnTrack=function(e){"object"===c(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},o.shimPeerConnection=function(e){var t=r.detectBrowser(e);if("object"===c(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var o=e.RTCPeerConnection.prototype[t],r=function(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]})),t.version<68){var o=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():o.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),o=e[0],r=e[1],s=e[2];return n.apply(this,[o||null]).then((function(e){if(t.version<53&&!r)try{e.forEach((function(e){e.type=i[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,o){e.set(o,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(r,s)}}},o.shimSenderGetStats=function(e){if("object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,o=t.apply(this,[]);return o.forEach((function(t){return t._pc=e})),o});var o=e.RTCPeerConnection.prototype.addTrack;o&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=o.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},o.shimReceiverGetStats=function(e){if("object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,o=t.apply(this,[]);return o.forEach((function(t){return t._pc=e})),o}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},o.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(o){o.track&&e.getTracks().includes(o.track)&&t.removeTrack(o)}))})},o.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},o.shimAddTransceiver=function(e){if("object"===c(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],o=e&&"sendEncodings"in e;o&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(o){var i=r.sender,n=i.getParameters();"encodings"in n||(n.encodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(n).catch((function(){}))))}return r})}},o.shimCreateOffer=function(e){if("object"===c(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,o=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(o,e)})).finally((function(){o.setParametersPromises=[]})):t.apply(this,arguments)}}},o.shimCreateAnswer=function(e){if("object"===c(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,o=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(o,e)})).finally((function(){o.setParametersPromises=[]})):t.apply(this,arguments)}}},Object.defineProperty(o,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}}),Object.defineProperty(o,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var s=r?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(o,n,s):o[n]=e[n]}return o.default=e,t&&t.set(e,o),o}(e("../utils")),n=e("./getusermedia"),s=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function c(e){return(c="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimLocalStreamsAPI=function(e){if("object"===s(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var o=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(o,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(o,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var o=arguments[1];return o&&(this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var o=this._localStreams.indexOf(e);if(-1!==o){this._localStreams.splice(o,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}},o.shimRemoteStreamsAPI=function(e){if("object"===s(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var o=new Event("addstream");o.stream=e,t.dispatchEvent(o)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var o=new Event("addstream");o.stream=t,e.dispatchEvent(o)}}))}),t.apply(e,arguments)}}},o.shimCallbacksAPI=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,o=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,n=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=o.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var o=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[o]);return t?(i.then(e,t),Promise.resolve()):i};var c=function(e,t,o){var r=i.apply(this,[e]);return o?(r.then(t,o),Promise.resolve()):r};t.setLocalDescription=c,c=function(e,t,o){var r=n.apply(this,[e]);return o?(r.then(t,o),Promise.resolve()):r},t.setRemoteDescription=c,c=function(e,t,o){var r=a.apply(this,[e]);return o?(r.then(t,o),Promise.resolve()):r},t.addIceCandidate=c}},o.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var o=t.mediaDevices,r=o.getUserMedia.bind(o);t.mediaDevices.getUserMedia=function(e){return r(a(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,o,r){t.mediaDevices.getUserMedia(e).then(o,r)}.bind(t))},o.shimConstraints=a,o.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,o){if(e&&e.iceServers){for(var i=[],n=0;n<e.iceServers.length;n++){var s=e.iceServers[n];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(s=JSON.parse(JSON.stringify(s))).urls=s.url,delete s.url,i.push(s)):i.push(e.iceServers[n])}e.iceServers=i}return new t(e,o)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},o.shimTrackEventTransceiver=function(e){"object"===s(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},o.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var o=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&o?"sendrecv"===o.direction?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":"recvonly"===o.direction&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):!0!==e.offerToReceiveAudio||o||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=i(e)&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var a=r?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(o,s,a):o[s]=e[s]}return o.default=e,t&&t.set(e,o),o}(e("../utils"));function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&(!e.RTCIceCandidate||!("foundation"in e.RTCIceCandidate.prototype))){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===a(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var o=new t(e),i=r.default.parseCandidate(e.candidate),n=Object.assign(o,i);return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,n.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},o.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=n.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),i=e.sdpSemantics;"plan-b"===i&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=r.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var n,s=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var o=parseInt(t[1],10);return o!=o?-1:o}(arguments[0]),a=(l=s,d=65536,"firefox"===t.browser&&(d=t.version<57?-1===l?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),d),c=function(e,o){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var n=r.default.matchPrefix(e.sdp,"a=max-message-size:");return n.length>0?i=parseInt(n[0].substr(19),10):"firefox"===t.browser&&-1!==o&&(i=2147483637),i}(arguments[0],s);n=0===a&&0===c?Number.POSITIVE_INFINITY:0===a||0===c?Math.max(a,c):Math.min(a,c);var p={};Object.defineProperty(p,"maxMessageSize",{get:function(){return n}}),this._sctp=p}var l,d;return o.apply(this,arguments)}}},o.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return o(e,this),e},n.wrapPeerConnectionEvent(e,"datachannel",(function(e){return o(e.channel,e.target),e}))}function o(e,t){var o=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return o.apply(e,arguments)}}},o.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var o=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var o=new Event("connectionstatechange",e);t.dispatchEvent(o)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),o.apply(this,arguments)}}))}},o.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=n.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),o.apply(this,arguments)}}}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=i(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=r?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(o,n,a):o[n]=e[n]}return o.default=e,t&&t.set(e,o),o}(e("./utils"));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function a(e){return(a="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.adapterFactory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.window,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},i=r.log,l=r.detectBrowser(t),d={browserDetails:l,commonShim:p,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(l.browser){case"chrome":if(!n||!n.shimPeerConnection||!o.shimChrome)return i("Chrome shim is not included in this adapter release."),d;i("adapter.js shimming chrome."),d.browserShim=n,n.shimGetUserMedia(t),n.shimMediaStream(t),n.shimPeerConnection(t),n.shimOnTrack(t),n.shimAddTrackRemoveTrack(t),n.shimGetSendersWithDtmf(t),n.shimGetStats(t),n.shimSenderReceiverGetStats(t),n.fixNegotiationNeeded(t),p.shimRTCIceCandidate(t),p.shimConnectionState(t),p.shimMaxMessageSize(t),p.shimSendThrowTypeError(t),p.removeAllowExtmapMixed(t);break;case"firefox":if(!a||!a.shimPeerConnection||!o.shimFirefox)return i("Firefox shim is not included in this adapter release."),d;i("adapter.js shimming firefox."),d.browserShim=a,a.shimGetUserMedia(t),a.shimPeerConnection(t),a.shimOnTrack(t),a.shimRemoveStream(t),a.shimSenderGetStats(t),a.shimReceiverGetStats(t),a.shimRTCDataChannel(t),a.shimAddTransceiver(t),a.shimCreateOffer(t),a.shimCreateAnswer(t),p.shimRTCIceCandidate(t),p.shimConnectionState(t),p.shimMaxMessageSize(t),p.shimSendThrowTypeError(t);break;case"edge":if(!s||!s.shimPeerConnection||!o.shimEdge)return i("MS edge shim is not included in this adapter release."),d;i("adapter.js shimming edge."),d.browserShim=s,s.shimGetUserMedia(t),s.shimGetDisplayMedia(t),s.shimPeerConnection(t),s.shimReplaceTrack(t),p.shimMaxMessageSize(t),p.shimSendThrowTypeError(t);break;case"safari":if(!c||!o.shimSafari)return i("Safari shim is not included in this adapter release."),d;i("adapter.js shimming safari."),d.browserShim=c,c.shimRTCIceServerUrls(t),c.shimCreateOfferLegacy(t),c.shimCallbacksAPI(t),c.shimLocalStreamsAPI(t),c.shimRemoteStreamsAPI(t),c.shimTrackEventTransceiver(t),c.shimGetUserMedia(t),p.shimRTCIceCandidate(t),p.shimMaxMessageSize(t),p.shimSendThrowTypeError(t),p.removeAllowExtmapMixed(t);break;default:i("Unsupported browser!")}return d};var r=d(e("./utils")),n=d(e("./chrome/chrome_shim")),s=d(e("./edge/edge_shim")),a=d(e("./firefox/firefox_shim")),c=d(e("./safari/safari_shim")),p=d(e("./common_shim"));function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function d(e){if(e&&e.__esModule)return e;if(null===e||"object"!=i(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var s=r?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(o,n,s):o[n]=e[n]}return o.default=e,t&&t.set(e,o),o}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var r=(0,e("./adapter_factory.js").adapterFactory)({window});o.default=r},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});var i=r(e("webrtc-adapter"));o.webRTCAdapter=i.default},{"webrtc-adapter":"tI1X"}],I31f:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e("./adapter");o.Supports=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},e.prototype.getBrowser=function(){return r.webRTCAdapter.browserDetails.browser},e.prototype.getVersion=function(){return r.webRTCAdapter.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),o=r.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&o<72)return!1;if("firefox"===t&&o>=59)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var i=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),i=!0}catch(e){}finally{e&&e.close()}return i},e.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e}())},{"./adapter":"sXtV"}],BHXf:[function(e,t,o){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t};Object.defineProperty(o,"__esModule",{value:!0});var i=r(e("peerjs-js-binarypack")),n=e("./supports"),s={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};o.util=new(function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=s,this.browser=n.Supports.getBrowser(),this.browserVersion=n.Supports.getVersion(),this.supports=function(){var e,t={browser:n.Supports.isBrowserSupported(),webRTC:n.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(s),t.audioVideo=!0;var o=void 0;try{o=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!o.ordered;try{o.binaryType="blob",t.binaryBlob=!n.Supports.isIOS}catch(e){}}catch(e){}finally{o&&o.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=i.pack,this.unpack=i.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},e.prototype.chunk=function(e){for(var t=[],r=e.size,i=Math.ceil(r/o.util.chunkedMTU),n=0,s=0;s<r;){var a=Math.min(r,s+o.util.chunkedMTU),c=e.slice(s,a),p={__peerData:this._dataCount,n,data:c,total:i};t.push(p),s=a,n++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(e,t){var o=new FileReader;return o.onload=function(e){e.target&&t(e.target.result)},o.readAsArrayBuffer(e),o},e.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),o=0;o<e.length;o++)t[o]=255&e.charCodeAt(o);return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},e.prototype.isSecure=function(){return"https:"===location.protocol},e}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(e,t,o){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function n(){}function s(e,t,o){this.fn=e,this.context=t,this.once=o||!1}function a(e,t,o,r,n){if("function"!=typeof o)throw new TypeError("The listener must be a function");var a=new s(o,r||e,n),c=i?i+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function p(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),p.prototype.eventNames=function(){var e,t,o=[];if(0===this._eventsCount)return o;for(t in e=this._events)r.call(e,t)&&o.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},p.prototype.listeners=function(e){var t=i?i+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var r=0,n=o.length,s=new Array(n);r<n;r++)s[r]=o[r].fn;return s},p.prototype.listenerCount=function(e){var t=i?i+e:e,o=this._events[t];return o?o.fn?1:o.length:0},p.prototype.emit=function(e,t,o,r,n,s){var a=i?i+e:e;if(!this._events[a])return!1;var c,p,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,o),!0;case 4:return l.fn.call(l.context,t,o,r),!0;case 5:return l.fn.call(l.context,t,o,r,n),!0;case 6:return l.fn.call(l.context,t,o,r,n,s),!0}for(p=1,c=new Array(d-1);p<d;p++)c[p-1]=arguments[p];l.fn.apply(l.context,c)}else{var u,_=l.length;for(p=0;p<_;p++)switch(l[p].once&&this.removeListener(e,l[p].fn,void 0,!0),d){case 1:l[p].fn.call(l[p].context);break;case 2:l[p].fn.call(l[p].context,t);break;case 3:l[p].fn.call(l[p].context,t,o);break;case 4:l[p].fn.call(l[p].context,t,o,r);break;default:if(!c)for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l[p].fn.apply(l[p].context,c)}}return!0},p.prototype.on=function(e,t,o){return a(this,e,t,o,!1)},p.prototype.once=function(e,t,o){return a(this,e,t,o,!0)},p.prototype.removeListener=function(e,t,o,r){var n=i?i+e:e;if(!this._events[n])return this;if(!t)return c(this,n),this;var s=this._events[n];if(s.fn)s.fn!==t||r&&!s.once||o&&s.context!==o||c(this,n);else{for(var a=0,p=[],l=s.length;a<l;a++)(s[a].fn!==t||r&&!s[a].once||o&&s[a].context!==o)&&p.push(s[a]);p.length?this._events[n]=1===p.length?p[0]:p:c(this,n)}return this},p.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&c(this,t)):(this._events=new n,this._eventsCount=0),this},p.prototype.off=p.prototype.removeListener,p.prototype.addListener=p.prototype.on,p.prefixed=i,p.EventEmitter=p,void 0!==t&&(t.exports=p)},{}],WOs9:[function(e,t,o){"use strict";var r=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,i,n=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(o,"__esModule",{value:!0});var n,s="PeerJS: ";!function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"}(n=o.LogLevel||(o.LogLevel={}));var a=function(){function e(){this._logLevel=n.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!0,configurable:!0}),e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=n.All&&this._print.apply(this,i([n.All],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=n.Warnings&&this._print.apply(this,i([n.Warnings],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=n.Errors&&this._print.apply(this,i([n.Errors],e))},e.prototype.setLogFunction=function(e){this._print=e},e.prototype._print=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var r=i([s],t);for(var a in r)r[a]instanceof Error&&(r[a]="("+r[a].name+") "+r[a].message);e>=n.All?console.log.apply(console,i(r)):e>=n.Warnings?console.warn.apply(console,i(["WARNING"],r)):e>=n.Errors&&console.error.apply(console,i(["ERROR"],r))},e}();o.default=new a},{}],ZRYf:[function(e,t,o){"use strict";var r;Object.defineProperty(o,"__esModule",{value:!0}),(r=o.ConnectionEventType||(o.ConnectionEventType={})).Open="open",r.Stream="stream",r.Data="data",r.Close="close",r.Error="error",r.IceStateChanged="iceStateChanged",function(e){e.Data="data",e.Media="media"}(o.ConnectionType||(o.ConnectionType={})),function(e){e.Open="open",e.Close="close",e.Connection="connection",e.Call="call",e.Disconnected="disconnected",e.Error="error"}(o.PeerEventType||(o.PeerEventType={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(o.PeerErrorType||(o.PeerErrorType={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(o.SerializationType||(o.SerializationType={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(o.SocketEventType||(o.SocketEventType={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(o.ServerMessageType||(o.ServerMessageType={}))},{}],wJlv:[function(e,t,o){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,i,n=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return s},s=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],r=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});var p=e("eventemitter3"),l=c(e("./logger")),d=e("./enums"),u=function(e){function t(t,o,r,i,n,s){void 0===s&&(s=5e3);var a=e.call(this)||this;a.pingInterval=s,a._disconnected=!0,a._messagesQueue=[];var c=t?"wss://":"ws://";return a._baseUrl=c+o+":"+r+i+"peerjs?key="+n,a}return i(t,e),t.prototype.start=function(e,t){var o=this;this._id=e;var r=this._baseUrl+"&id="+e+"&token="+t;!this._socket&&this._disconnected&&(this._socket=new WebSocket(r),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),l.default.log("Server message received:",t)}catch(t){return void l.default.log("Invalid server message",e.data)}o.emit(d.SocketEventType.Message,t)},this._socket.onclose=function(e){o._disconnected||(l.default.log("Socket closed.",e),o._cleanup(),o._disconnected=!0,o.emit(d.SocketEventType.Disconnected))},this._socket.onopen=function(){o._disconnected||(o._sendQueuedMessages(),l.default.log("Socket open"),o._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout((function(){e._sendHeartbeat()}),this.pingInterval)},t.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:d.ServerMessageType.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else l.default.log("Cannot send heartbeat, because socket closed")},t.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},t.prototype._sendQueuedMessages=function(){var e,t,o=s(this._messagesQueue);this._messagesQueue=[];try{for(var r=a(o),i=r.next();!i.done;i=r.next()){var n=i.value;this.send(n)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(d.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(e)},t.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},t.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t}(p.EventEmitter);o.Socket=u},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(e,t,o){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(i,n){function s(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var o,r,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,r=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./util"),c=s(e("./logger")),p=e("./enums"),l=function(){function e(e){this.connection=e}return e.prototype.startConnection=function(e){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===p.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if(this.connection.type===p.ConnectionType.Data){var o=this.connection,r={ordered:!!e.reliable},i=t.createDataChannel(o.label,r);o.initialize(i)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},e.prototype._startPeerConnection=function(){c.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},e.prototype._setupListeners=function(e){var t=this,o=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,n=this.connection.provider;c.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(c.default.log("Received ICE candidates for "+o+":",e.candidate),n.socket.send({type:p.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:i,connectionId:r},dst:o}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":c.default.log("iceConnectionState is failed, closing connections to "+o),t.connection.emit(p.ConnectionEventType.Error,new Error("Negotiation of connection to "+o+" failed.")),t.connection.close();break;case"closed":c.default.log("iceConnectionState is closed, closing connections to "+o),t.connection.emit(p.ConnectionEventType.Error,new Error("Connection to "+o+" closed.")),t.connection.close();break;case"disconnected":c.default.log("iceConnectionState changed to disconnected on the connection with "+o);break;case"completed":e.onicecandidate=a.util.noop}t.connection.emit(p.ConnectionEventType.IceStateChanged,e.iceConnectionState)},c.default.log("Listening for data channel"),e.ondatachannel=function(e){c.default.log("Received data channel");var t=e.channel;n.getConnection(o,r).initialize(t)},c.default.log("Listening for remote stream"),e.ontrack=function(e){c.default.log("Received remote stream");var i=e.streams[0],s=n.getConnection(o,r);if(s.type===p.ConnectionType.Media){var a=s;t._addStreamToMediaConnection(i,a)}}},e.prototype.cleanup=function(){c.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var t="closed"!==e.signalingState,o=!1;if(this.connection.type===p.ConnectionType.Data){var r=this.connection.dataChannel;r&&(o=!!r.readyState&&"closed"!==r.readyState)}(t||o)&&e.close()}},e.prototype._makeOffer=function(){return i(this,void 0,Promise,(function(){var e,t,o,i,s,l,d;return n(this,(function(n){switch(n.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,n.label=1;case 1:return n.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:o=n.sent(),c.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(o.sdp=this.connection.options.sdpTransform(o.sdp)||o.sdp),n.label=3;case 3:return n.trys.push([3,5,,6]),[4,e.setLocalDescription(o)];case 4:return n.sent(),c.default.log("Set localDescription:",o,"for:"+this.connection.peer),i={sdp:o,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:a.util.browser},this.connection.type===p.ConnectionType.Data&&(s=this.connection,i=r(r({},i),{label:s.label,reliable:s.reliable,serialization:s.serialization})),t.socket.send({type:p.ServerMessageType.Offer,payload:i,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(l=n.sent())&&(t.emitError(p.PeerErrorType.WebRTC,l),c.default.log("Failed to setLocalDescription, ",l)),[3,6];case 6:return[3,8];case 7:return d=n.sent(),t.emitError(p.PeerErrorType.WebRTC,d),c.default.log("Failed to createOffer, ",d),[3,8];case 8:return[2]}}))}))},e.prototype._makeAnswer=function(){return i(this,void 0,Promise,(function(){var e,t,o,r,i;return n(this,(function(n){switch(n.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,n.label=1;case 1:return n.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:o=n.sent(),c.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(o.sdp=this.connection.options.sdpTransform(o.sdp)||o.sdp),n.label=3;case 3:return n.trys.push([3,5,,6]),[4,e.setLocalDescription(o)];case 4:return n.sent(),c.default.log("Set localDescription:",o,"for:"+this.connection.peer),t.socket.send({type:p.ServerMessageType.Answer,payload:{sdp:o,type:this.connection.type,connectionId:this.connection.connectionId,browser:a.util.browser},dst:this.connection.peer}),[3,6];case 5:return r=n.sent(),t.emitError(p.PeerErrorType.WebRTC,r),c.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return i=n.sent(),t.emitError(p.PeerErrorType.WebRTC,i),c.default.log("Failed to create answer, ",i),[3,8];case 8:return[2]}}))}))},e.prototype.handleSDP=function(e,t){return i(this,void 0,Promise,(function(){var o,r,i,s;return n(this,(function(n){switch(n.label){case 0:t=new RTCSessionDescription(t),o=this.connection.peerConnection,r=this.connection.provider,c.default.log("Setting remote description",t),i=this,n.label=1;case 1:return n.trys.push([1,5,,6]),[4,o.setRemoteDescription(t)];case 2:return n.sent(),c.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,i._makeAnswer()];case 3:n.sent(),n.label=4;case 4:return[3,6];case 5:return s=n.sent(),r.emitError(p.PeerErrorType.WebRTC,s),c.default.log("Failed to setRemoteDescription, ",s),[3,6];case 6:return[2]}}))}))},e.prototype.handleCandidate=function(e){return i(this,void 0,Promise,(function(){var t,o,r,i,s,a;return n(this,(function(n){switch(n.label){case 0:c.default.log("handleCandidate:",e),t=e.candidate,o=e.sdpMLineIndex,r=e.sdpMid,i=this.connection.peerConnection,s=this.connection.provider,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,i.addIceCandidate(new RTCIceCandidate({sdpMid:r,sdpMLineIndex:o,candidate:t}))];case 2:return n.sent(),c.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return a=n.sent(),s.emitError(p.PeerErrorType.WebRTC,a),c.default.log("Failed to handleCandidate, ",a),[3,4];case 4:return[2]}}))}))},e.prototype._addTracksToConnection=function(e,t){if(c.default.log("add tracks from stream "+e.id+" to peer connection"),!t.addTrack)return c.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((function(o){t.addTrack(o,e)}))},e.prototype._addStreamToMediaConnection=function(e,t){c.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},e}();o.Negotiator=l},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(e,t,o){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(t,o,r){var i=e.call(this)||this;return i.peer=t,i.provider=o,i.options=r,i._open=!1,i.metadata=r.metadata,i}return i(t,e),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),t}(e("eventemitter3").EventEmitter);o.BaseConnection=n},{eventemitter3:"JJlS"}],dbHP:[function(e,t,o){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],r=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./util"),p=a(e("./logger")),l=e("./negotiator"),d=e("./enums"),u=function(e){function t(o,r,i){var n=e.call(this,o,r,i)||this;return n._localStream=n.options._stream,n.connectionId=n.options.connectionId||t.ID_PREFIX+c.util.randomToken(),n._negotiator=new l.Negotiator(n),n._localStream&&n._negotiator.startConnection({_stream:n._localStream,originator:!0}),n}return i(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return d.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),t.prototype.addStream=function(t){p.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,d.ConnectionEventType.Stream,t)},t.prototype.handleMessage=function(e){var t=e.type,o=e.payload;switch(e.type){case d.ServerMessageType.Answer:this._negotiator.handleSDP(t,o.sdp),this._open=!0;break;case d.ServerMessageType.Candidate:this._negotiator.handleCandidate(o.candidate);break;default:p.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},t.prototype.answer=function(e,t){var o,r;if(void 0===t&&(t={}),this._localStream)p.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(n(n({},this.options._payload),{_stream:e}));var i=this.provider._getMessages(this.connectionId);try{for(var a=s(i),c=a.next();!c.done;c=a.next()){var l=c.value;this.handleMessage(l)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}this._open=!0}},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,d.ConnectionEventType.Close))},t.ID_PREFIX="mc_",t}(e("./baseconnection").BaseConnection);o.MediaConnection=u},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(e,t,o){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});var s=e("eventemitter3"),a=n(e("./logger")),c=function(e){function t(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){a.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}return i(t,e),Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),t.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(s.EventEmitter);o.EncodingQueue=c},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(e,t,o){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],r=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./util"),c=s(e("./logger")),p=e("./negotiator"),l=e("./enums"),d=e("./baseconnection"),u=e("./encodingQueue"),_=function(e){function t(o,r,i){var n=e.call(this,o,r,i)||this;return n.stringify=JSON.stringify,n.parse=JSON.parse,n._buffer=[],n._bufferSize=0,n._buffering=!1,n._chunkedData={},n._encodingQueue=new u.EncodingQueue,n.connectionId=n.options.connectionId||t.ID_PREFIX+a.util.randomToken(),n.label=n.options.label||n.connectionId,n.serialization=n.options.serialization||l.SerializationType.Binary,n.reliable=!!n.options.reliable,n._encodingQueue.on("done",(function(e){n._bufferedSend(e)})),n._encodingQueue.on("error",(function(){c.default.error("DC#"+n.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),n.close()})),n._negotiator=new p.Negotiator(n),n._negotiator.startConnection(n.options._payload||{originator:!0}),n}return i(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return l.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var e=this;a.util.supports.binaryBlob&&!a.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){c.default.log("DC#"+e.connectionId+" dc connection success"),e._open=!0,e.emit(l.ConnectionEventType.Open)},this.dataChannel.onmessage=function(t){c.default.log("DC#"+e.connectionId+" dc onmessage:",t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){c.default.log("DC#"+e.connectionId+" dc closed for:",e.peer),e.close()}},t.prototype._handleDataMessage=function(t){var o=this,r=t.data,i=r.constructor,n=r;if(this.serialization===l.SerializationType.Binary||this.serialization===l.SerializationType.BinaryUTF8){if(i===Blob)return void a.util.blobToArrayBuffer(r,(function(e){var t=a.util.unpack(e);o.emit(l.ConnectionEventType.Data,t)}));if(i===ArrayBuffer)n=a.util.unpack(r);else if(i===String){var s=a.util.binaryStringToArrayBuffer(r);n=a.util.unpack(s)}}else this.serialization===l.SerializationType.JSON&&(n=this.parse(r));n.__peerData?this._handleChunk(n):e.prototype.emit.call(this,l.ConnectionEventType.Data,n)},t.prototype._handleChunk=function(e){var t=e.__peerData,o=this._chunkedData[t]||{data:[],count:0,total:e.total};if(o.data[e.n]=e.data,o.count++,this._chunkedData[t]=o,o.total===o.count){delete this._chunkedData[t];var r=new Blob(o.data);this._handleDataMessage({data:r})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,l.ConnectionEventType.Close))},t.prototype.send=function(t,o){if(this.open)if(this.serialization===l.SerializationType.JSON)this._bufferedSend(this.stringify(t));else if(this.serialization===l.SerializationType.Binary||this.serialization===l.SerializationType.BinaryUTF8){var r=a.util.pack(t);if(!o&&r.size>a.util.chunkedMTU)return void this._sendChunks(r);a.util.supports.binaryBlob?this._bufferedSend(r):this._encodingQueue.enque(r)}else this._bufferedSend(t);else e.prototype.emit.call(this,l.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},t.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(e){var o=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){o._buffering=!1,o._tryBuffer()}),50),!1;try{this.dataChannel.send(e)}catch(e){return c.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},t.prototype._sendChunks=function(e){var t,o,r=a.util.chunk(e);c.default.log("DC#"+this.connectionId+" Try to send "+r.length+" chunks...");try{for(var i=n(r),s=i.next();!s.done;s=i.next()){var p=s.value;this.send(p,!0)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}},t.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case l.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case l.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:c.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(d.BaseConnection);o.DataConnection=_},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,o){"use strict";var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(i,n){function s(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var o,r,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,r=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./util"),a=n(e("./logger")),c=function(){function e(e){this._options=e}return e.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+"?ts="+(new Date).getTime()+Math.random()},e.prototype.retrieveId=function(){return r(this,void 0,Promise,(function(){var e,t,o,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("id"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status)throw new Error("Error. Status:"+t.status);return[2,t.text()];case 3:throw o=i.sent(),a.default.error("Error retrieving ID",o),r="","/"===this._options.path&&this._options.host!==s.util.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r);case 4:return[2]}}))}))},e.prototype.listAllPeers=function(){return r(this,void 0,Promise,(function(){var e,t,o,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("peers"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status){if(401===t.status)throw o=this._options.host===s.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+o);throw new Error("Error. Status:"+t.status)}return[2,t.json()];case 3:throw r=i.sent(),a.default.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r);case 4:return[2]}}))}))},e}();o.API=c},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(e,t,o){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],r=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,i,n=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return s},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});var p=e("eventemitter3"),l=e("./util"),d=c(e("./logger")),u=e("./socket"),_=e("./mediaconnection"),f=e("./dataconnection"),h=e("./enums"),m=e("./api"),g=function(e){function t(o,r){var i,s=e.call(this)||this;return s._id=null,s._lastServerId=null,s._destroyed=!1,s._disconnected=!1,s._open=!1,s._connections=new Map,s._lostMessages=new Map,o&&o.constructor==Object?r=o:o&&(i=o.toString()),r=n({debug:0,host:l.util.CLOUD_HOST,port:l.util.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:l.util.randomToken(),config:l.util.defaultConfig},r),s._options=r,"/"===s._options.host&&(s._options.host=window.location.hostname),s._options.path&&("/"!==s._options.path[0]&&(s._options.path="/"+s._options.path),"/"!==s._options.path[s._options.path.length-1]&&(s._options.path+="/")),void 0===s._options.secure&&s._options.host!==l.util.CLOUD_HOST?s._options.secure=l.util.isSecure():s._options.host==l.util.CLOUD_HOST&&(s._options.secure=!0),s._options.logFunction&&d.default.setLogFunction(s._options.logFunction),d.default.logLevel=s._options.debug||0,s._api=new m.API(r),s._socket=s._createServerConnection(),l.util.supports.audioVideo||l.util.supports.data?i&&!l.util.validateId(i)?(s._delayedAbort(h.PeerErrorType.InvalidID,'ID "'+i+'" is invalid'),s):(i?s._initialize(i):s._api.retrieveId().then((function(e){return s._initialize(e)})).catch((function(e){return s._abort(h.PeerErrorType.ServerError,e)})),s):(s._delayedAbort(h.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),s)}return i(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var e,t,o=Object.create(null);try{for(var r=s(this._connections),i=r.next();!i.done;i=r.next()){var n=a(i.value,2),c=n[0],p=n[1];o[c]=p}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return o},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),t.prototype._createServerConnection=function(){var e=this,t=new u.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(h.SocketEventType.Message,(function(t){e._handleMessage(t)})),t.on(h.SocketEventType.Error,(function(t){e._abort(h.PeerErrorType.SocketError,t)})),t.on(h.SocketEventType.Disconnected,(function(){e.disconnected||(e.emitError(h.PeerErrorType.Network,"Lost connection to server."),e.disconnect())})),t.on(h.SocketEventType.Close,(function(){e.disconnected||e._abort(h.PeerErrorType.SocketClosed,"Underlying socket is already closed.")})),t},t.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},t.prototype._handleMessage=function(e){var t,o,r=e.type,i=e.payload,n=e.src;switch(r){case h.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(h.PeerEventType.Open,this.id);break;case h.ServerMessageType.Error:this._abort(h.PeerErrorType.ServerError,i.msg);break;case h.ServerMessageType.IdTaken:this._abort(h.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case h.ServerMessageType.InvalidKey:this._abort(h.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case h.ServerMessageType.Leave:d.default.log("Received leave message from "+n),this._cleanupPeer(n),this._connections.delete(n);break;case h.ServerMessageType.Expire:this.emitError(h.PeerErrorType.PeerUnavailable,"Could not connect to peer "+n);break;case h.ServerMessageType.Offer:var a=i.connectionId;if((m=this.getConnection(n,a))&&(m.close(),d.default.warn("Offer received for existing Connection ID:"+a)),i.type===h.ConnectionType.Media)m=new _.MediaConnection(n,this,{connectionId:a,_payload:i,metadata:i.metadata}),this._addConnection(n,m),this.emit(h.PeerEventType.Call,m);else{if(i.type!==h.ConnectionType.Data)return void d.default.warn("Received malformed connection type:"+i.type);m=new f.DataConnection(n,this,{connectionId:a,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(n,m),this.emit(h.PeerEventType.Connection,m)}var c=this._getMessages(a);try{for(var p=s(c),l=p.next();!l.done;l=p.next()){var u=l.value;m.handleMessage(u)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(o=p.return)&&o.call(p)}finally{if(t)throw t.error}}break;default:if(!i)return void d.default.warn("You received a malformed message from "+n+" of type "+r);var m;a=i.connectionId,(m=this.getConnection(n,a))&&m.peerConnection?m.handleMessage(e):a?this._storeMessage(a,e):d.default.warn("You received an unrecognized message:",e)}},t.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},t.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},t.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return d.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var o=new f.DataConnection(e,this,t);return this._addConnection(e,o),o},t.prototype.call=function(e,t,o){if(void 0===o&&(o={}),this.disconnected)return d.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){o._stream=t;var r=new _.MediaConnection(e,this,o);return this._addConnection(e,r),r}d.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},t.prototype._addConnection=function(e,t){d.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},t.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var o=t.indexOf(e);-1!==o&&t.splice(o,1)}this._lostMessages.delete(e.connectionId)},t.prototype.getConnection=function(e,t){var o,r,i=this._connections.get(e);if(!i)return null;try{for(var n=s(i),a=n.next();!a.done;a=n.next()){var c=a.value;if(c.connectionId===t)return c}}catch(e){o={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return null},t.prototype._delayedAbort=function(e,t){var o=this;setTimeout((function(){o._abort(e,t)}),0)},t.prototype._abort=function(e,t){d.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(e,t){var o;d.default.error("Error:",t),(o="string"==typeof t?new Error(t):t).type=e,this.emit(h.PeerEventType.Error,o)},t.prototype.destroy=function(){this.destroyed||(d.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(h.PeerEventType.Close))},t.prototype._cleanup=function(){var e,t;try{for(var o=s(this._connections.keys()),r=o.next();!r.done;r=o.next()){var i=r.value;this._cleanupPeer(i),this._connections.delete(i)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},t.prototype._cleanupPeer=function(e){var t,o,r=this._connections.get(e);if(r)try{for(var i=s(r),n=i.next();!n.done;n=i.next())n.value.close()}catch(e){t={error:e}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}},t.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;d.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(h.PeerEventType.Disconnected,e)}},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)d.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");d.default.error("In a hurry? We're still trying to make the initial connection!")}},t.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then((function(t){return e(t)})).catch((function(e){return t._abort(h.PeerErrorType.ServerError,e)}))},t.DEFAULT_KEY="peerjs",t}(p.EventEmitter);o.Peer=g},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e("./util"),i=e("./peer");o.peerjs={Peer:i.Peer,util:r.util},o.default=i.Peer,window.peerjs=o.peerjs,window.Peer=i.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])},638:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}!function e(t,o,r){function i(s,a){if(!o[s]){if(!t[s]){if(n)return n(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var p=o[s]={exports:{}};t[s][0].call(p.exports,(function(e){return i(t[s][1][e]||e)}),p,p.exports,e,t,o,r)}return o[s].exports}for(var n=void 0,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t){t.exports.RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,t.exports.RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,t.exports.RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate},{}],2:[function(e,t){function o(e,t,s){return this instanceof o?(i.call(this),this.options=r.extend({serialization:"binary",reliable:!1},s),this.open=!1,this.type="data",this.peer=e,this.provider=t,this.id=this.options.connectionId||o._idPrefix+r.randomToken(),this.label=this.options.label||this.id,this.metadata=this.options.metadata,this.serialization=this.options.serialization,this.reliable=this.options.reliable,this._buffer=[],this._buffering=!1,this.bufferSize=0,this._chunkedData={},this.options._payload&&(this._peerBrowser=this.options._payload.browser),void n.startConnection(this,this.options._payload||{originator:!0})):new o(e,t,s)}var r=e("./util"),i=e("eventemitter3"),n=e("./negotiator"),s=e("reliable");r.inherits(o,i),o._idPrefix="dc_",o.prototype.initialize=function(e){this._dc=this.dataChannel=e,this._configureDataChannel()},o.prototype._configureDataChannel=function(){var e=this;r.supports.sctp&&(this._dc.binaryType="arraybuffer"),this._dc.onopen=function(){r.log("Data channel connection success"),e.open=!0,e.emit("open")},!r.supports.sctp&&this.reliable&&(this._reliable=new s(this._dc,r.debug)),this._reliable?this._reliable.onmessage=function(t){e.emit("data",t)}:this._dc.onmessage=function(t){e._handleDataMessage(t)},this._dc.onclose=function(){r.log("DataChannel closed for:",e.peer),e.close()}},o.prototype._handleDataMessage=function(e){var t=this,o=e.data,i=o.constructor;if("binary"===this.serialization||"binary-utf8"===this.serialization){if(i===Blob)return void r.blobToArrayBuffer(o,(function(e){o=r.unpack(e),t.emit("data",o)}));if(i===ArrayBuffer)o=r.unpack(o);else if(i===String){var n=r.binaryStringToArrayBuffer(o);o=r.unpack(n)}}else"json"===this.serialization&&(o=JSON.parse(o));if(o.__peerData){var s=o.__peerData,a=this._chunkedData[s]||{data:[],count:0,total:o.total};return a.data[o.n]=o.data,a.count+=1,a.total===a.count&&(delete this._chunkedData[s],o=new Blob(a.data),this._handleDataMessage({data:o})),void(this._chunkedData[s]=a)}this.emit("data",o)},o.prototype.close=function(){this.open&&(this.open=!1,n.cleanup(this),this.emit("close"))},o.prototype.send=function(e,t){if(this.open)if(this._reliable)this._reliable.send(e);else{var o=this;if("json"===this.serialization)this._bufferedSend(JSON.stringify(e));else if("binary"===this.serialization||"binary-utf8"===this.serialization){var i=r.pack(e);if((r.chunkedBrowsers[this._peerBrowser]||r.chunkedBrowsers[r.browser])&&!t&&i.size>r.chunkedMTU)return void this._sendChunks(i);r.supports.sctp?r.supports.binaryBlob?this._bufferedSend(i):r.blobToArrayBuffer(i,(function(e){o._bufferedSend(e)})):r.blobToBinaryString(i,(function(e){o._bufferedSend(e)}))}else this._bufferedSend(e)}else this.emit("error",new Error("Connection is not open. You should listen for the `open` event before sending messages."))},o.prototype._bufferedSend=function(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this.bufferSize=this._buffer.length)},o.prototype._trySend=function(e){try{this._dc.send(e)}catch(e){this._buffering=!0;var t=this;return setTimeout((function(){t._buffering=!1,t._tryBuffer()}),100),!1}return!0},o.prototype._tryBuffer=function(){if(0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this.bufferSize=this._buffer.length,this._tryBuffer())}},o.prototype._sendChunks=function(e){for(var t=r.chunk(e),o=0,i=t.length;i>o;o+=1)e=t[o],this.send(e,!0)},o.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case"ANSWER":this._peerBrowser=t.browser,n.handleSDP(e.type,this,t.sdp);break;case"CANDIDATE":n.handleCandidate(this,t.candidate);break;default:r.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.exports=o},{"./negotiator":5,"./util":8,eventemitter3:9,reliable:12}],3:[function(e){window.Socket=e("./socket"),window.MediaConnection=e("./mediaconnection"),window.DataConnection=e("./dataconnection"),window.Peer=e("./peer"),window.RTCPeerConnection=e("./adapter").RTCPeerConnection,window.RTCSessionDescription=e("./adapter").RTCSessionDescription,window.RTCIceCandidate=e("./adapter").RTCIceCandidate,window.Negotiator=e("./negotiator"),window.util=e("./util"),window.BinaryPack=e("js-binarypack")},{"./adapter":1,"./dataconnection":2,"./mediaconnection":4,"./negotiator":5,"./peer":6,"./socket":7,"./util":8,"js-binarypack":10}],4:[function(e,t){function o(e,t,s){return this instanceof o?(i.call(this),this.options=r.extend({},s),this.open=!1,this.type="media",this.peer=e,this.provider=t,this.metadata=this.options.metadata,this.localStream=this.options._stream,this.id=this.options.connectionId||o._idPrefix+r.randomToken(),void(this.localStream&&n.startConnection(this,{_stream:this.localStream,originator:!0}))):new o(e,t,s)}var r=e("./util"),i=e("eventemitter3"),n=e("./negotiator");r.inherits(o,i),o._idPrefix="mc_",o.prototype.addStream=function(e){r.log("Receiving stream",e),this.remoteStream=e,this.emit("stream",e)},o.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case"ANSWER":n.handleSDP(e.type,this,t.sdp),this.open=!0;break;case"CANDIDATE":n.handleCandidate(this,t.candidate);break;default:r.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},o.prototype.answer=function(e){if(this.localStream)r.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this.options._payload._stream=e,this.localStream=e,n.startConnection(this,this.options._payload);for(var t=this.provider._getMessages(this.id),o=0,i=t.length;i>o;o+=1)this.handleMessage(t[o]);this.open=!0}},o.prototype.close=function(){this.open&&(this.open=!1,n.cleanup(this),this.emit("close"))},t.exports=o},{"./negotiator":5,"./util":8,eventemitter3:9}],5:[function(e,t){var o=e("./util"),r=e("./adapter").RTCPeerConnection,i=e("./adapter").RTCSessionDescription,n=e("./adapter").RTCIceCandidate,s={pcs:{data:{},media:{}},queue:[],_idPrefix:"pc_",startConnection:function(e,t){var r=s._getPeerConnection(e,t);if("media"===e.type&&t._stream&&r.addStream(t._stream),e.pc=e.peerConnection=r,t.originator){if("data"===e.type){var i={};o.supports.sctp||(i={reliable:t.reliable});var n=r.createDataChannel(e.label,i);e.initialize(n)}o.supports.onnegotiationneeded||s._makeOffer(e)}else s.handleSDP("OFFER",e,t.sdp)},_getPeerConnection:function(e,t){var r;return s.pcs[e.type]||o.error(e.type+" is not a valid connection type. Maybe you overrode the `type` property somewhere."),s.pcs[e.type][e.peer]||(s.pcs[e.type][e.peer]={}),s.pcs[e.type][e.peer],t.pc&&(r=s.pcs[e.type][e.peer][t.pc]),r&&"stable"===r.signalingState||(r=s._startPeerConnection(e)),r},_startPeerConnection:function(e){o.log("Creating RTCPeerConnection.");var t=s._idPrefix+o.randomToken(),i={};"data"!==e.type||o.supports.sctp?"media"===e.type&&(i={optional:[{DtlsSrtpKeyAgreement:!0}]}):i={optional:[{RtpDataChannels:!0}]};var n=new r(e.provider.options.config,i);return s.pcs[e.type][e.peer][t]=n,s._setupListeners(e,n,t),n},_setupListeners:function(e,t){var r=e.peer,i=e.id,n=e.provider;o.log("Listening for ICE candidates."),t.onicecandidate=function(t){t.candidate&&(o.log("Received ICE candidates for:",e.peer),n.socket.send({type:"CANDIDATE",payload:{candidate:t.candidate,type:e.type,connectionId:e.id},dst:r}))},t.oniceconnectionstatechange=function(){switch(t.iceConnectionState){case"disconnected":case"failed":o.log("iceConnectionState is disconnected, closing connections to "+r),e.close();break;case"completed":t.onicecandidate=o.noop}},t.onicechange=t.oniceconnectionstatechange,o.log("Listening for `negotiationneeded`"),t.onnegotiationneeded=function(){o.log("`negotiationneeded` triggered"),"stable"==t.signalingState?s._makeOffer(e):o.log("onnegotiationneeded triggered when not stable. Is another connection being established?")},o.log("Listening for data channel"),t.ondatachannel=function(e){o.log("Received data channel");var t=e.channel;n.getConnection(r,i).initialize(t)},o.log("Listening for remote stream"),t.onaddstream=function(e){o.log("Received remote stream");var t=e.stream,s=n.getConnection(r,i);"media"===s.type&&s.addStream(t)}},cleanup:function(e){o.log("Cleaning up PeerConnection to "+e.peer);var t=e.pc;!t||"closed"===t.readyState&&"closed"===t.signalingState||(t.close(),e.pc=null)},_makeOffer:function(e){var t=e.pc;t.createOffer((function(r){o.log("Created offer."),!o.supports.sctp&&"data"===e.type&&e.reliable&&(r.sdp=Reliable.higherBandwidthSDP(r.sdp)),t.setLocalDescription(r,(function(){o.log("Set localDescription: offer","for:",e.peer),e.provider.socket.send({type:"OFFER",payload:{sdp:r,type:e.type,label:e.label,connectionId:e.id,reliable:e.reliable,serialization:e.serialization,metadata:e.metadata,browser:o.browser},dst:e.peer})}),(function(t){e.provider.emitError("webrtc",t),o.log("Failed to setLocalDescription, ",t)}))}),(function(t){e.provider.emitError("webrtc",t),o.log("Failed to createOffer, ",t)}),e.options.constraints)},_makeAnswer:function(e){var t=e.pc;t.createAnswer((function(r){o.log("Created answer."),!o.supports.sctp&&"data"===e.type&&e.reliable&&(r.sdp=Reliable.higherBandwidthSDP(r.sdp)),t.setLocalDescription(r,(function(){o.log("Set localDescription: answer","for:",e.peer),e.provider.socket.send({type:"ANSWER",payload:{sdp:r,type:e.type,connectionId:e.id,browser:o.browser},dst:e.peer})}),(function(t){e.provider.emitError("webrtc",t),o.log("Failed to setLocalDescription, ",t)}))}),(function(t){e.provider.emitError("webrtc",t),o.log("Failed to create answer, ",t)}))},handleSDP:function(e,t,r){r=new i(r);var n=t.pc;o.log("Setting remote description",r),n.setRemoteDescription(r,(function(){o.log("Set remoteDescription:",e,"for:",t.peer),"OFFER"===e&&s._makeAnswer(t)}),(function(e){t.provider.emitError("webrtc",e),o.log("Failed to setRemoteDescription, ",e)}))},handleCandidate:function(e,t){var r=t.candidate,i=t.sdpMLineIndex;e.pc.addIceCandidate(new n({sdpMLineIndex:i,candidate:r})),o.log("Added ICE candidate for:",e.peer)}};t.exports=s},{"./adapter":1,"./util":8}],6:[function(e,t){function o(e,t){return this instanceof o?(i.call(this),e&&e.constructor==Object?(t=e,e=void 0):e&&(e=e.toString()),t=r.extend({debug:0,host:r.CLOUD_HOST,port:r.CLOUD_PORT,key:"peerjs",path:"/",token:r.randomToken(),config:r.defaultConfig},t),this.options=t,"/"===t.host&&(t.host=window.location.hostname),"/"!==t.path[0]&&(t.path="/"+t.path),"/"!==t.path[t.path.length-1]&&(t.path+="/"),void 0===t.secure&&t.host!==r.CLOUD_HOST&&(t.secure=r.isSecure()),t.logFunction&&r.setLogFunction(t.logFunction),r.setLogLevel(t.debug),r.supports.audioVideo||r.supports.data?r.validateId(e)?r.validateKey(t.key)?t.secure&&"0.peerjs.com"===t.host?void this._delayedAbort("ssl-unavailable","The cloud server currently does not support HTTPS. Please run your own PeerServer to use HTTPS."):(this.destroyed=!1,this.disconnected=!1,this.open=!1,this.connections={},this._lostMessages={},this._initializeServerConnection(),void(e?this._initialize(e):this._retrieveId())):void this._delayedAbort("invalid-key",'API KEY "'+t.key+'" is invalid'):void this._delayedAbort("invalid-id",'ID "'+e+'" is invalid'):void this._delayedAbort("browser-incompatible","The current browser does not support WebRTC")):new o(e,t)}var r=e("./util"),i=e("eventemitter3"),n=e("./socket"),s=e("./mediaconnection"),a=e("./dataconnection");r.inherits(o,i),o.prototype._initializeServerConnection=function(){var e=this;this.socket=new n(this.options.secure,this.options.host,this.options.port,this.options.path,this.options.key),this.socket.on("message",(function(t){e._handleMessage(t)})),this.socket.on("error",(function(t){e._abort("socket-error",t)})),this.socket.on("disconnected",(function(){e.disconnected||(e.emitError("network","Lost connection to server."),e.disconnect())})),this.socket.on("close",(function(){e.disconnected||e._abort("socket-closed","Underlying socket is already closed.")}))},o.prototype._retrieveId=function(){var e=this,t=new XMLHttpRequest,o=(this.options.secure?"https://":"http://")+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/id";o+="?ts="+(new Date).getTime()+Math.random(),t.open("get",o,!0),t.onerror=function(t){r.error("Error retrieving ID",t);var o="";"/"===e.options.path&&e.options.host!==r.CLOUD_HOST&&(o=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),e._abort("server-error","Could not get an ID from the server."+o)},t.onreadystatechange=function(){return 4===t.readyState?200!==t.status?void t.onerror():void e._initialize(t.responseText):void 0},t.send(null)},o.prototype._initialize=function(e){this.id=e,this.socket.start(this.id,this.options.token)},o.prototype._handleMessage=function(e){var t,o=e.type,i=e.payload,n=e.src;switch(o){case"OPEN":this.emit("open",this.id),this.open=!0;break;case"ERROR":this._abort("server-error",i.msg);break;case"ID-TAKEN":this._abort("unavailable-id","ID `"+this.id+"` is taken");break;case"INVALID-KEY":this._abort("invalid-key",'API KEY "'+this.options.key+'" is invalid');break;case"LEAVE":r.log("Received leave message from",n),this._cleanupPeer(n);break;case"EXPIRE":this.emitError("peer-unavailable","Could not connect to peer "+n);break;case"OFFER":var c=i.connectionId;if(t=this.getConnection(n,c))r.warn("Offer received for existing Connection ID:",c);else{if("media"===i.type)t=new s(n,this,{connectionId:c,_payload:i,metadata:i.metadata}),this._addConnection(n,t),this.emit("call",t);else{if("data"!==i.type)return void r.warn("Received malformed connection type:",i.type);t=new a(n,this,{connectionId:c,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(n,t),this.emit("connection",t)}for(var p=this._getMessages(c),l=0,d=p.length;d>l;l+=1)t.handleMessage(p[l])}break;default:if(!i)return void r.warn("You received a malformed message from "+n+" of type "+o);var u=i.connectionId;(t=this.getConnection(n,u))&&t.pc?t.handleMessage(e):u?this._storeMessage(u,e):r.warn("You received an unrecognized message:",e)}},o.prototype._storeMessage=function(e,t){this._lostMessages[e]||(this._lostMessages[e]=[]),this._lostMessages[e].push(t)},o.prototype._getMessages=function(e){var t=this._lostMessages[e];return t?(delete this._lostMessages[e],t):[]},o.prototype.connect=function(e,t){if(this.disconnected)return r.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");var o=new a(e,this,t);return this._addConnection(e,o),o},o.prototype.call=function(e,t,o){if(this.disconnected)return r.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");if(t){(o=o||{})._stream=t;var i=new s(e,this,o);return this._addConnection(e,i),i}r.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},o.prototype._addConnection=function(e,t){this.connections[e]||(this.connections[e]=[]),this.connections[e].push(t)},o.prototype.getConnection=function(e,t){var o=this.connections[e];if(!o)return null;for(var r=0,i=o.length;i>r;r++)if(o[r].id===t)return o[r];return null},o.prototype._delayedAbort=function(e,t){var o=this;r.setZeroTimeout((function(){o._abort(e,t)}))},o.prototype._abort=function(e,t){r.error("Aborting!"),this._lastServerId?this.disconnect():this.destroy(),this.emitError(e,t)},o.prototype.emitError=function(e,t){r.error("Error:",t),"string"==typeof t&&(t=new Error(t)),t.type=e,this.emit("error",t)},o.prototype.destroy=function(){this.destroyed||(this._cleanup(),this.disconnect(),this.destroyed=!0)},o.prototype._cleanup=function(){if(this.connections)for(var e=Object.keys(this.connections),t=0,o=e.length;o>t;t++)this._cleanupPeer(e[t]);this.emit("close")},o.prototype._cleanupPeer=function(e){for(var t=this.connections[e],o=0,r=t.length;r>o;o+=1)t[o].close()},o.prototype.disconnect=function(){var e=this;r.setZeroTimeout((function(){e.disconnected||(e.disconnected=!0,e.open=!1,e.socket&&e.socket.close(),e.emit("disconnected",e.id),e._lastServerId=e.id,e.id=null)}))},o.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)r.log("Attempting reconnection to server with ID "+this._lastServerId),this.disconnected=!1,this._initializeServerConnection(),this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");r.error("In a hurry? We're still trying to make the initial connection!")}},o.prototype.listAllPeers=function(e){e=e||function(){};var t=this,o=new XMLHttpRequest,i=(this.options.secure?"https://":"http://")+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/peers";i+="?ts="+(new Date).getTime()+Math.random(),o.open("get",i,!0),o.onerror=function(){t._abort("server-error","Could not get peers from the server."),e([])},o.onreadystatechange=function(){if(4===o.readyState){var i;if(401===o.status)throw i=t.options.host!==r.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",e([]),new Error("It doesn't look like you have permission to list peers IDs. "+i);e(200!==o.status?[]:JSON.parse(o.responseText))}},o.send(null)},t.exports=o},{"./dataconnection":2,"./mediaconnection":4,"./socket":7,"./util":8,eventemitter3:9}],7:[function(e,t){function o(e,t,r,n,s){if(!(this instanceof o))return new o(e,t,r,n,s);i.call(this),this.disconnected=!1,this._queue=[];var a=e?"https://":"http://",c=e?"wss://":"ws://";this._httpUrl=a+t+":"+r+n+s,this._wsUrl=c+t+":"+r+n+"peerjs?key="+s}var r=e("./util"),i=e("eventemitter3");r.inherits(o,i),o.prototype.start=function(e,t){this.id=e,this._httpUrl+="/"+e+"/"+t,this._wsUrl+="&id="+e+"&token="+t,this._startXhrStream(),this._startWebSocket()},o.prototype._startWebSocket=function(){var e=this;this._socket||(this._socket=new WebSocket(this._wsUrl),this._socket.onmessage=function(t){try{var o=JSON.parse(t.data)}catch(e){return void r.log("Invalid server message",t.data)}e.emit("message",o)},this._socket.onclose=function(){r.log("Socket closed."),e.disconnected=!0,e.emit("disconnected")},this._socket.onopen=function(){e._timeout&&(clearTimeout(e._timeout),setTimeout((function(){e._http.abort(),e._http=null}),5e3)),e._sendQueuedMessages(),r.log("Socket open")})},o.prototype._startXhrStream=function(e){try{var t=this;this._http=new XMLHttpRequest,this._http._index=1,this._http._streamIndex=e||0,this._http.open("post",this._httpUrl+"/id?i="+this._http._streamIndex,!0),this._http.onerror=function(){clearTimeout(t._timeout),t.emit("disconnected")},this._http.onreadystatechange=function(){2==this.readyState&&this.old?(this.old.abort(),delete this.old):this.readyState>2&&200===this.status&&this.responseText&&t._handleStream(this)},this._http.send(null),this._setHTTPTimeout()}catch(e){r.log("XMLHttpRequest not available; defaulting to WebSockets")}},o.prototype._handleStream=function(e){var t=e.responseText.split("\n");if(e._buffer)for(;e._buffer.length>0;){var o=e._buffer.shift(),i=t[o];try{i=JSON.parse(i)}catch(t){e._buffer.shift(o);break}this.emit("message",i)}var n=t[e._index];if(n)if(e._index+=1,e._index===t.length)e._buffer||(e._buffer=[]),e._buffer.push(e._index-1);else{try{n=JSON.parse(n)}catch(e){return void r.log("Invalid server message",n)}this.emit("message",n)}},o.prototype._setHTTPTimeout=function(){var e=this;this._timeout=setTimeout((function(){var t=e._http;e._wsOpen()?t.abort():(e._startXhrStream(t._streamIndex+1),e._http.old=t)}),25e3)},o.prototype._wsOpen=function(){return this._socket&&1==this._socket.readyState},o.prototype._sendQueuedMessages=function(){for(var e=0,t=this._queue.length;t>e;e+=1)this.send(this._queue[e])},o.prototype.send=function(e){if(!this.disconnected){if(!this.id)return void this._queue.push(e);if(!e.type)return void this.emit("error","Invalid message");var t=JSON.stringify(e);if(this._wsOpen())this._socket.send(t);else{var o=new XMLHttpRequest,r=this._httpUrl+"/"+e.type.toLowerCase();o.open("post",r,!0),o.setRequestHeader("Content-Type","application/json"),o.send(t)}}},o.prototype.close=function(){!this.disconnected&&this._wsOpen()&&(this._socket.close(),this.disconnected=!0)},t.exports=o},{"./util":8,eventemitter3:9}],8:[function(e,t){var o={iceServers:[{url:"stun:stun.l.google.com:19302"}]},r=1,i=e("js-binarypack"),n=e("./adapter").RTCPeerConnection,s={noop:function(){},CLOUD_HOST:"0.peerjs.com",CLOUD_PORT:9e3,chunkedBrowsers:{Chrome:1},chunkedMTU:16300,logLevel:0,setLogLevel:function(e){var t=parseInt(e,10);s.logLevel=isNaN(parseInt(e,10))?e?3:0:t,s.log=s.warn=s.error=s.noop,s.logLevel>0&&(s.error=s._printWith("ERROR")),s.logLevel>1&&(s.warn=s._printWith("WARNING")),s.logLevel>2&&(s.log=s._print)},setLogFunction:function(e){e.constructor!==Function?s.warn("The log function you passed in is not a function. Defaulting to regular logs."):s._print=e},_printWith:function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e),s._print.apply(s,t)}},_print:function(){var e=!1,t=Array.prototype.slice.call(arguments);t.unshift("PeerJS: ");for(var o=0,r=t.length;r>o;o++)t[o]instanceof Error&&(t[o]="("+t[o].name+") "+t[o].message,e=!0);e?console.error.apply(console,t):console.log.apply(console,t)},defaultConfig:o,browser:window.mozRTCPeerConnection?"Firefox":window.webkitRTCPeerConnection?"Chrome":window.RTCPeerConnection?"Supported":"Unsupported",supports:function(){if(void 0===n)return{};var e,t,r=!0,i=!0,a=!1,c=!1,p=!!window.webkitRTCPeerConnection;try{e=new n(o,{optional:[{RtpDataChannels:!0}]})}catch(e){r=!1,i=!1}if(r)try{t=e.createDataChannel("_PEERJSTEST")}catch(e){r=!1}if(r){try{t.binaryType="blob",a=!0}catch(e){}var l=new n(o,{});try{c=l.createDataChannel("_PEERJSRELIABLETEST",{}).reliable}catch(e){}l.close()}if(i&&(i=!!e.addStream),!p&&r){var d=new n(o,{optional:[{RtpDataChannels:!0}]});d.onnegotiationneeded=function(){p=!0,s&&s.supports&&(s.supports.onnegotiationneeded=!0)},d.createDataChannel("_PEERJSNEGOTIATIONTEST"),setTimeout((function(){d.close()}),1e3)}return e&&e.close(),{audioVideo:i,data:r,binaryBlob:a,binary:c,reliable:c,sctp:c,onnegotiationneeded:p}}(),validateId:function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(e)},validateKey:function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(e)},debug:!1,inherits:function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},extend:function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e},pack:i.pack,unpack:i.unpack,log:function(){if(s.debug){var e=!1,t=Array.prototype.slice.call(arguments);t.unshift("PeerJS: ");for(var o=0,r=t.length;r>o;o++)t[o]instanceof Error&&(t[o]="("+t[o].name+") "+t[o].message,e=!0);e?console.error.apply(console,t):console.log.apply(console,t)}},setZeroTimeout:function(e){function t(t){t.source==e&&t.data==r&&(t.stopPropagation&&t.stopPropagation(),o.length&&o.shift()())}var o=[],r="zero-timeout-message";return e.addEventListener?e.addEventListener("message",t,!0):e.attachEvent&&e.attachEvent("onmessage",t),function(t){o.push(t),e.postMessage(r,"*")}}(window),chunk:function(e){for(var t=[],o=e.size,i=index=0,n=Math.ceil(o/s.chunkedMTU);o>i;){var a=Math.min(o,i+s.chunkedMTU),c=e.slice(i,a),p={__peerData:r,n:index,data:c,total:n};t.push(p),i=a,index+=1}return r+=1,t},blobToArrayBuffer:function(e,t){var o=new FileReader;o.onload=function(e){t(e.target.result)},o.readAsArrayBuffer(e)},blobToBinaryString:function(e,t){var o=new FileReader;o.onload=function(e){t(e.target.result)},o.readAsBinaryString(e)},binaryStringToArrayBuffer:function(e){for(var t=new Uint8Array(e.length),o=0;o<e.length;o++)t[o]=255&e.charCodeAt(o);return t.buffer},randomToken:function(){return Math.random().toString(36).substr(2)},isSecure:function(){return"https:"===location.protocol}};t.exports=s},{"./adapter":1,"js-binarypack":10}],9:[function(t,o){"use strict";function r(e,t,o){this.fn=e,this.context=t,this.once=o||!1}function i(){}i.prototype._events=void 0,i.prototype.listeners=function(e){if(!this._events||!this._events[e])return[];for(var t=0,o=this._events[e].length,r=[];o>t;t++)r.push(this._events[e][t].fn);return r},i.prototype.emit=function(e,t,o,r,i,n){if(!this._events||!this._events[e])return!1;var s,a,c,p=this._events[e],l=p.length,d=arguments.length,u=p[0];if(1===l){switch(u.once&&this.removeListener(e,u.fn,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,o),!0;case 4:return u.fn.call(u.context,t,o,r),!0;case 5:return u.fn.call(u.context,t,o,r,i),!0;case 6:return u.fn.call(u.context,t,o,r,i,n),!0}for(a=1,s=new Array(d-1);d>a;a++)s[a-1]=arguments[a];u.fn.apply(u.context,s)}else for(a=0;l>a;a++)switch(p[a].once&&this.removeListener(e,p[a].fn,!0),d){case 1:p[a].fn.call(p[a].context);break;case 2:p[a].fn.call(p[a].context,t);break;case 3:p[a].fn.call(p[a].context,t,o);break;default:if(!s)for(c=1,s=new Array(d-1);d>c;c++)s[c-1]=arguments[c];p[a].fn.apply(p[a].context,s)}return!0},i.prototype.on=function(e,t,o){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(new r(t,o||this)),this},i.prototype.once=function(e,t,o){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(new r(t,o||this,!0)),this},i.prototype.removeListener=function(e,t,o){if(!this._events||!this._events[e])return this;var r=this._events[e],i=[];if(t)for(var n=0,s=r.length;s>n;n++)r[n].fn!==t&&r[n].once!==o&&i.push(r[n]);return this._events[e]=i.length?i:null,this},i.prototype.removeAllListeners=function(e){return this._events?(e?this._events[e]=null:this._events={},this):this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prototype.setMaxListeners=function(){return this},i.EventEmitter=i,i.EventEmitter2=i,i.EventEmitter3=i,"object"==e(o)&&o.exports&&(o.exports=i)},{}],10:[function(t,o){function r(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function i(){this.bufferBuilder=new s}function n(e){var t=e.charCodeAt(0);return 2047>=t?"00":65535>=t?"000":2097151>=t?"0000":67108863>=t?"00000":"000000"}var s=t("./bufferbuilder").BufferBuilder,a=t("./bufferbuilder").binaryFeatures,c={unpack:function(e){return new r(e).unpack()},pack:function(e){var t=new i;return t.pack(e),t.getBuffer()}};o.exports=c,r.prototype.unpack=function(){var e,t=this.unpack_uint8();if(128>t)return t;if(32>(224^t))return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:case 212:case 213:case 214:case 215:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},r.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},r.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},r.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},r.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},r.prototype.unpack_int8=function(){var e=this.unpack_uint8();return 128>e?e:e-256},r.prototype.unpack_int16=function(){var e=this.unpack_uint16();return 32768>e?e:e-65536},r.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},r.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},r.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},r.prototype.unpack_string=function(e){for(var t,o,r=this.read(e),i=0,n="";e>i;)128>(t=r[i])?(n+=String.fromCharCode(t),i++):32>(192^t)?(o=(192^t)<<6|63&r[i+1],n+=String.fromCharCode(o),i+=2):(o=(15&t)<<12|(63&r[i+1])<<6|63&r[i+2],n+=String.fromCharCode(o),i+=3);return this.index+=e,n},r.prototype.unpack_array=function(e){for(var t=new Array(e),o=0;e>o;o++)t[o]=this.unpack();return t},r.prototype.unpack_map=function(e){for(var t={},o=0;e>o;o++){var r=this.unpack(),i=this.unpack();t[r]=i}return t},r.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},r.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),o=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,o-20)+t*Math.pow(2,o-52))},r.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},i.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},i.prototype.pack=function(t){var o=e(t);if("string"==o)this.pack_string(t);else if("number"==o)Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if("boolean"==o)!0===t?this.bufferBuilder.append(195):!1===t&&this.bufferBuilder.append(194);else if("undefined"==o)this.bufferBuilder.append(192);else{if("object"!=o)throw new Error('Type "'+o+'" not yet supported');if(null===t)this.bufferBuilder.append(192);else{var r=t.constructor;if(r==Array)this.pack_array(t);else if(r==Blob||r==File)this.pack_bin(t);else if(r==ArrayBuffer)this.pack_bin(a.useArrayBufferView?new Uint8Array(t):t);else if("BYTES_PER_ELEMENT"in t)this.pack_bin(a.useArrayBufferView?new Uint8Array(t.buffer):t.buffer);else if(r==Object)this.pack_object(t);else if(r==Date)this.pack_string(t.toString());else{if("function"!=typeof t.toBinaryPack)throw new Error('Type "'+r.toString()+'" not yet supported');this.bufferBuilder.append(t.toBinaryPack())}}}this.bufferBuilder.flush()},i.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(15>=t)this.pack_uint8(160+t);else if(65535>=t)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(4294967295>=t))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},i.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,n).length}(e);if(15>=t)this.pack_uint8(176+t);else if(65535>=t)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(4294967295>=t))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},i.prototype.pack_array=function(e){var t=e.length;if(15>=t)this.pack_uint8(144+t);else if(65535>=t)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(4294967295>=t))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var o=0;t>o;o++)this.pack(e[o])},i.prototype.pack_integer=function(e){if(e>=-32&&127>=e)this.bufferBuilder.append(255&e);else if(e>=0&&255>=e)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&127>=e)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&65535>=e)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&32767>=e)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&4294967295>=e)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&2147483647>=e)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&0x8000000000000000>=e)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&0x10000000000000000>=e))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},i.prototype.pack_double=function(e){var t=0;0>e&&(t=1,e=-e);var o=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,o)-1,i=Math.floor(r*Math.pow(2,52)),n=Math.pow(2,32),s=t<<31|o+1023<<20|i/n&1048575,a=i%n;this.bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(a)},i.prototype.pack_object=function(e){var t=Object.keys(e).length;if(15>=t)this.pack_uint8(128+t);else if(65535>=t)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(4294967295>=t))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var o in e)e.hasOwnProperty(o)&&(this.pack(o),this.pack(e[o]))},i.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},i.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},i.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},i.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),o=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&o)>>>24),this.bufferBuilder.append((16711680&o)>>>16),this.bufferBuilder.append((65280&o)>>>8),this.bufferBuilder.append(255&o)},i.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},i.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},i.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},i.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),o=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&o)>>>24),this.bufferBuilder.append((16711680&o)>>>16),this.bufferBuilder.append((65280&o)>>>8),this.bufferBuilder.append(255&o)}},{"./bufferbuilder":11}],11:[function(e,t){function o(){this._pieces=[],this._parts=[]}var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=r;var i=t.exports.BlobBuilder;"undefined"!=typeof window&&(i=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),o.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},o.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);r.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},o.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var e=new i,t=0,o=this._parts.length;o>t;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=o},{}],12:[function(e,t){function o(e,t){return this instanceof o?(this._dc=e,r.debug=t,this._outgoing={},this._incoming={},this._received={},this._window=1e3,this._mtu=500,this._interval=0,this._count=0,this._queue=[],void this._setupDC()):new o(e)}var r=e("./util");o.prototype.send=function(e){var t=r.pack(e);return t.size<this._mtu?void this._handleSend(["no",t]):(this._outgoing[this._count]={ack:0,chunks:this._chunk(t)},r.debug&&(this._outgoing[this._count].timer=new Date),this._sendWindowedChunks(this._count),void(this._count+=1))},o.prototype._setupInterval=function(){var e=this;this._timeout=setInterval((function(){var t=e._queue.shift();if(t._multiple)for(var o=0,r=t.length;r>o;o+=1)e._intervalSend(t[o]);else e._intervalSend(t)}),this._interval)},o.prototype._intervalSend=function(e){var t=this;e=r.pack(e),r.blobToBinaryString(e,(function(e){t._dc.send(e)})),0===t._queue.length&&(clearTimeout(t._timeout),t._timeout=null)},o.prototype._processAcks=function(){for(var e in this._outgoing)this._outgoing.hasOwnProperty(e)&&this._sendWindowedChunks(e)},o.prototype._handleSend=function(e){for(var t=!0,o=0,r=this._queue.length;r>o;o+=1){var i=this._queue[o];(i===e||i._multiple&&-1!==i.indexOf(e))&&(t=!1)}t&&(this._queue.push(e),this._timeout||this._setupInterval())},o.prototype._setupDC=function(){var e=this;this._dc.onmessage=function(t){var o=t.data;if(o.constructor===String){var i=r.binaryStringToArrayBuffer(o);o=r.unpack(i),e._handleMessage(o)}}},o.prototype._handleMessage=function(e){var t,o=e[1],i=this._incoming[o],n=this._outgoing[o];switch(e[0]){case"no":var s=o;s&&this.onmessage(r.unpack(s));break;case"end":if(t=i,this._received[o]=e[2],!t)break;this._ack(o);break;case"ack":if(t=n){var a=e[2];t.ack=Math.max(a,t.ack),t.ack>=t.chunks.length?(r.log("Time: ",new Date-t.timer),delete this._outgoing[o]):this._processAcks()}break;case"chunk":if(!(t=i)){if(!0===this._received[o])break;t={ack:["ack",o,0],chunks:[]},this._incoming[o]=t}var c=e[2],p=e[3];t.chunks[c]=new Uint8Array(p),c===t.ack[2]&&this._calculateNextAck(o),this._ack(o);break;default:this._handleSend(e)}},o.prototype._chunk=function(e){for(var t=[],o=e.size,i=0;o>i;){var n=Math.min(o,i+this._mtu),s={payload:e.slice(i,n)};t.push(s),i=n}return r.log("Created",t.length,"chunks."),t},o.prototype._ack=function(e){var t=this._incoming[e].ack;this._received[e]===t[2]&&(this._complete(e),this._received[e]=!0),this._handleSend(t)},o.prototype._calculateNextAck=function(e){for(var t=this._incoming[e],o=t.chunks,r=0,i=o.length;i>r;r+=1)if(void 0===o[r])return void(t.ack[2]=r);t.ack[2]=o.length},o.prototype._sendWindowedChunks=function(e){r.log("sendWindowedChunks for: ",e);for(var t=this._outgoing[e],o=t.chunks,i=[],n=Math.min(t.ack+this._window,o.length),s=t.ack;n>s;s+=1)o[s].sent&&s!==t.ack||(o[s].sent=!0,i.push(["chunk",e,s,o[s].payload]));t.ack+this._window>=o.length&&i.push(["end",e,o.length]),i._multiple=!0,this._handleSend(i)},o.prototype._complete=function(e){r.log("Completed called for",e);var t=this,o=this._incoming[e].chunks,i=new Blob(o);r.blobToArrayBuffer(i,(function(e){t.onmessage(r.unpack(e))})),delete this._incoming[e]},o.higherBandwidthSDP=function(e){var t=navigator.appVersion.match(/Chrome\/(.*?) /);if(t&&31>(t=parseInt(t[1].split(".").shift()))){var o=e.split("b=AS:30");if(o.length>1)return o[0]+"b=AS:102400"+o[1]}return e},o.prototype.onmessage=function(){},t.exports.Reliable=o},{"./util":13}],13:[function(e,t){var o=e("js-binarypack"),r={debug:!1,inherits:function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},extend:function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e},pack:o.pack,unpack:o.unpack,log:function(){if(r.debug){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift("Reliable: "),console.log.apply(console,e)}},setZeroTimeout:function(e){function t(t){t.source==e&&t.data==r&&(t.stopPropagation&&t.stopPropagation(),o.length&&o.shift()())}var o=[],r="zero-timeout-message";return e.addEventListener?e.addEventListener("message",t,!0):e.attachEvent&&e.attachEvent("onmessage",t),function(t){o.push(t),e.postMessage(r,"*")}}(this),blobToArrayBuffer:function(e,t){var o=new FileReader;o.onload=function(e){t(e.target.result)},o.readAsArrayBuffer(e)},blobToBinaryString:function(e,t){var o=new FileReader;o.onload=function(e){t(e.target.result)},o.readAsBinaryString(e)},binaryStringToArrayBuffer:function(e){for(var t=new Uint8Array(e.length),o=0;o<e.length;o++)t[o]=255&e.charCodeAt(o);return t.buffer},randomToken:function(){return Math.random().toString(36).substr(2)}};t.exports=r},{"js-binarypack":10}]},{},[3])},3670:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.PG_videochat=function(e){this.properties={site_url:"",settings:[],id_chat:0,id_inviter_user:0,id_invited_user:0,inviter_peer_id:"",invited_peer_id:"",video_id_you:"its_me",video_id_him:"its_him",video_you:null,video_him:null,pauseVideo:"pauseVideo",pauseAudio:"pauseAudio",pauseChat:"pauseChat",resumeChat:"resumeChat",completeChat:"completeChat",messagesChat:"messagesChat",is_inviter:!1,is_pauseVideo:!1,is_pauseAudio:!1,is_pauseChat:!1,is_pauseHisChat:!1,timeout_set_status:null,timeout_change_status:null,xhr_check_status:null,waiting_lang:"Waiting for other people...",pause_lang:"Pause",complete_lang:"Complete",close_alert_text:"You are going to finish chat session. Are you sure?",error_support:"Browser is not supported",connect_now:"Connect now",msg_input_obj:"videochatMessage",inviter_photo:"",invited_photo:"",my_user_id:0,message_max_id:0,is_sending:!1,getMassages:!1,change_status:"chats/ajax_change_status/",get_messages:"chats/ajax_get_messages/",send_messages:"chats/ajax_send_message/",send_command:"chats/send_command/",start_chat_id:"start-chat-link",close_chat_id:"close-chat",chat_block:"start-chat-block",try_connect:!1,chat_exists:null,errorObj:new Errors};var t=this;return this.init=function(e){return e=e||{},$.extend(!0,t.properties,e),t.properties.id_inviter_user&&t.properties.id_invited_user?(t.commands=[],t.peer=null,t.isCommand=!1,navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia)?(t.properties.video_you=$("#"+t.properties.video_id_you),t.properties.video_him=$("#"+t.properties.video_id_him),t.properties.close=!1,t.properties.is_inviter?t.properties.my_user_id=t.properties.id_inviter_user:t.properties.my_user_id=t.properties.id_invited_user,t.initControls(),t.initMyCam(),this):($("#my_info_block").html('<div style="padding:10px; font-size:20px">'+t.properties.error_support+"</div>"),void $("#my_info_block").show())):this},this.initMyCam=function(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((function(e){window.localStream=e,$("#"+t.properties.video_id_you).prop("srcObject",e),$("#my_info_block").hide(),$("#"+t.properties.pauseVideo).show(),$("#"+t.properties.pauseAudio).show(),t.initPeer()})).catch((function(e){error_object.show_error_block("something went wrong","error"),console.log(e.name+"---"+e.message)})):navigator.getUserMedia({audio:!0,video:!0},(function(e){window.localStream=e,$("#"+t.properties.video_id_you).prop("srcObject",e),$("#my_info_block").hide(),$("#"+t.properties.pauseVideo).show(),$("#"+t.properties.pauseAudio).show(),t.initPeer()}),(function(e){error_object.show_error_block("something went wrong","error"),console.log(e.name+"---"+e.message)}))},this.initPeer=function(){t.properties.inviter_peer_id="",t.properties.invited_peer_id="",t.peer=new Peer({host:"video.pilotgroup.net",port:9001,secure:!0,debug:0,logFunction:!1,config:{iceServers:[{urls:"stun:video.pilotgroup.net:3478"},{urls:"turn:video.pilotgroup.net:3478",username:"test",credential:"12345"}]}}),t.peer.off("open").on("open",(function(){t.properties.is_inviter?t.properties.inviter_peer_id=t.peer.id:t.properties.invited_peer_id=t.peer.id,t.checkStatus()})),t.peer.off("call").on("call",(function(e){e.answer(window.localStream),t.initHisCam(e)})),t.peer.off("error").on("error",(function(e){console.log("err: ",e),t.renderUser("approve"),t.reconnectChat()})),t.peer.off("connection").on("connection",(function(e){e.off("data").on("data",(function(o){t.appendMessage("peer",o),e.close()}))})),t.initConnect()},this.initConnect=function(){return t.properties.is_inviter?$(t).off().on("send",(function(e,o){var r=t.peer.connect(t.properties.invited_peer_id);r.on("open",(function(){r.send(o),t.appendMessage("send",o)}))})):$(t).off().on("send",(function(e,o){var r=t.peer.connect(t.properties.inviter_peer_id);r.on("open",(function(){r.send(o),t.appendMessage("send",o)}))})),this},this.initHisCam=function(e){window.existingCall&&window.existingCall.close(),e.on("stream",(function(e){$("#"+t.properties.video_id_him).prop("srcObject",e)})),window.existingCall=e},this.startChat=function(){t.sendCommand("start",(function(e){t.initHisCam(t.peer.call(e.invited_peer_id,window.localStream))}))},this.pauseChat=function(){t.sendCommand("pause",(function(){}))},this.resumeChat=function(){t.sendCommand("resume",(function(){}))},this.stopChat=function(){t.sendCommand("stop",(function(){t.closeChat()}))},this.reconnectChat=function(){t.sendCommand("reconnect",(function(){}))},this.muteVideo=function(){window.localStream.getVideoTracks().forEach((function(e){e.enabled=t.properties.is_pauseVideo})),$("#"+t.properties.pauseVideo).toggleClass("fa-video-camera fa-eye-slash fa-video"),t.properties.is_pauseVideo=!t.properties.is_pauseVideo},this.muteAudio=function(){window.localStream.getAudioTracks().forEach((function(e){e.enabled=t.properties.is_pauseAudio})),$("#"+t.properties.pauseAudio).toggleClass("fa-microphone fa-microphone-slash"),t.properties.is_pauseAudio=!t.properties.is_pauseAudio},this.closeChat=function(){window.existingCall&&window.existingCall.close(),t.renderUser("completed")},this.checkStatus=function(){var e={};return t.properties.is_inviter?e.inviter_peer_id=t.properties.inviter_peer_id:e.invited_peer_id=t.properties.invited_peer_id,$.ajax({type:"POST",url:t.properties.site_url+t.properties.change_status+t.properties.id_chat,data:e,success:function(e,o,r){if(e.errors&&t.properties.errorObj.show_error_block(e.errors,"error"),t.renderUser(e.chat.status),"approve"==e.chat.status){if(t.properties.is_inviter&&!e.chat.inviter_peer_id||!t.properties.is_inviter&&!e.chat.invited_peer_id)return void t.initPeer();t.properties.inviter_peer_id=e.chat.inviter_peer_id,t.properties.invited_peer_id=e.chat.invited_peer_id,t.properties.is_inviter&&e.chat.inviter_peer_id&&e.chat.invited_peer_id&&t.startChat()}else if("current"==e.chat.status)t.properties.inviter_peer_id=e.chat.inviter_peer_id,t.properties.invited_peer_id=e.chat.invited_peer_id,t.properties.video_him.muted=!1;else if("paused"==e.chat.status)t.properties.video_him.muted=!0;else if("completed"==e.chat.status)return void t.closeChat();setTimeout((function(){t.checkStatus()}),2e3)},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)},dataType:"json"}),!1},this.sendCommand=function(e,o){t.commands.push({command:e,callback:o}),t.execCommand()},this.execCommand=function(){if(0!=t.commands.length&&!t.isCommand){var e=t.commands.shift();t.isCommand=!0,$.ajax({type:"POST",url:site_url+t.properties.send_command+t.properties.id_chat,data:{command:e.command},dataType:"json",success:function(o){"function"==typeof e.callback&&e.callback(o.chat),t.isCommand=!1,t.execCommand()},complete:function(){}})}},this.initControls=function(){$("#"+t.properties.start_chat_id).on("click",(function(e){e.preventDefault(),$("#col-chat").animate({width:"80%"},300),$("#"+t.properties.chat_block).show(),$(".message-scroller").scrollTop($("#messagesChat")[0].scrollHeight)})),$("#"+t.properties.close_chat_id).on("click",(function(){$("#col-chat").animate({width:"100%"},300),$("#"+t.properties.chat_block).hide()})),$("#"+t.properties.pauseVideo).off("click").on("click",(function(e){e.preventDefault(),t.muteVideo()})),$("#"+t.properties.pauseAudio).off("click").on("click",(function(e){e.preventDefault(),t.muteAudio()})),$("#"+t.properties.pauseChat).off("click").on("click",(function(e){e.preventDefault(),t.pauseChat()})),$("#"+t.properties.resumeChat).off("click").on("click",(function(e){e.preventDefault(),t.resumeChat()})),$("#"+t.properties.completeChat).off("click").on("click",(function(){alerts.show({text:t.properties.close_alert_text,type:"confirm",ok_callback:function(){t.properties.close=!0,t.stopChat()}})})),$("#"+t.properties.msg_input_obj).off("keydown").on("keydown",(function(e){if(13===e.keyCode){var o=$("#"+t.properties.msg_input_obj).val();0!=o.length&&($(t).trigger("send",o),$("#"+t.properties.msg_input_obj).val(""))}})),$(".btn-send-msg").off("click").on("click",(function(e){var o=$("#"+t.properties.msg_input_obj).val();0!=o.length&&($(t).trigger("send",o),$("#"+t.properties.msg_input_obj).val(""))}))},this.renderUser=function(e){switch(e){case"approve":$("#its_him").hide(),$("#chat_user_block").show(),$("#his_info_block_text").html(t.properties.waiting_lang),$("#his_info_block").show(),$("#pauseChat").hide(),$("#resumeChat").hide(),$("#"+t.properties.start_chat_id).hide(),$("#"+t.properties.close_chat_id).trigger("click");break;case"current":$("#chat_user_block").hide(),$("#his_info_block").hide(),$("#pauseChat").show(),$("#resumeChat").hide(),$("#its_him").show(),$("#"+t.properties.start_chat_id).show();break;case"paused":$("#its_him").hide(),$("#his_info_block_text").html(t.properties.pause_lang),$("#his_info_block").show(),$("#chat_user_block").show(),$("#pauseChat").hide(),$("#resumeChat").show(),$("#"+t.properties.start_chat_id).hide(),$("#"+t.properties.close_chat_id).trigger("click");break;case"completed":$("#its_him").hide(),$("#his_info_block_text").html(t.properties.complete_lang),$("#his_info_block").show(),$("#chat_user_block").show(),$("#pauseChat").hide(),$("#resumeChat").hide(),$("#"+t.properties.start_chat_id).hide(),$("#"+t.properties.close_chat_id).trigger("click")}},this.appendMessage=function(e,o){var r="peer"==e,i=r?"left":"right";if(r&&$("#"+t.properties.start_chat_id).trigger("click"),r&&!t.properties.is_inviter||!r&&t.properties.is_inviter)var n=t.properties.inviter_photo;else n=t.properties.invited_photo;var s='<div class="vc-message vc-message--'+i+'"><img src="'+n+'" class="f'+i+'"/><div class="message">'+o+"</div></div>";$("#"+t.properties.messagesChat).append(s);var a=$("#messagesChat")[0].scrollHeight;$(".message-scroller").scrollTop(a)},t.init(e),this})},7162:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Comments=function e(t){if(e.instance){if(e.instance.properties.singleton)return e.instance}else e.instance=this;this.properties={siteUrl:"",addUrl:"",deleteUrl:"",loadUrl:"",append_comment:"",order_by:"",likeUrl:"",singleton:1,min_visible_comments:2,lng:{error:"Error!",error_comment_text:"Empty text!",error_user_name:"Enter your name!",added:"Comment successfully added",added_moderation:"Comment successfully added and awaiting administrator approval",deleted:"Comment successfully deleted"}};var r,i,n=this;this.Init=function(e){n.properties=$.extend(!0,n.properties,e),n.properties.addUrl||(n.properties.addUrl=n.properties.siteUrl+"comments/ajax_add_comment"),n.properties.deleteUrl||(n.properties.deleteUrl=n.properties.siteUrl+"comments/ajax_delete_comment"),n.properties.loadUrl||(n.properties.loadUrl=n.properties.siteUrl+"comments/ajax_load_comments"),n.properties.likeUrl||(n.properties.likeUrl=n.properties.siteUrl+"comments/ajax_like_comment"),$(document).on("keypress keyup change blur",".comments .form_wrapper textarea",(function(e){n.countChars(this)}))},this.uninit=function(){$(document).off("keypress keyup change blur",".comments .form_wrapper textarea"),e.instance=void 0},this.addComment=function(e,t){if(!i||"pending"!=i.state()){t=parseInt(t),jq_obj=n.getObjectsByGidObj(e,t);var o=n.getMinMaxId(e,t),r=a(jq_obj.textarea.val()),s=a(jq_obj.user_name.val()),c=a(jq_obj.email.val()),p=[];return r||p.push(n.properties.lng.error_comment_text),jq_obj.user_name.length&&!s&&p.push(n.properties.lng.error_user_name),t||p.push(n.properties.lng.error),p.length?(n.showNotice(p),n):(i=$.post(n.properties.addUrl,{gid:e,id_obj:t,text:r,user_name:s,email:c,max_id:o.max_id,min_id:o.min_id},(function(e){e.status&&e.id?(e.comments_html&&n.properties.append_comment.length>0?jq_obj.cont.append(e.comments_html):jq_obj.cont.prepend(e.comments_html),void 0!==e.comments.count_all&&jq_obj.counter.html(e.comments.count_all),jq_obj.textarea.val(""),n.countChars(jq_obj.textarea),jq_obj.user_name.val(""),e.moderation&&n.showNotice(n.properties.lng.added_moderation,"success")):!e.status&&e.errors&&n.showNotice(e.errors)}),"json"),n)}},this.deleteComment=function(e){e=parseInt(e);var t=n.getObjectsById(e),o=n.getGidObjById(e);return $.post(n.properties.deleteUrl,{id:e},(function(e){e.status&&e.is_deleted?(t.block.remove(),void 0!==e.count_all&&t.counter.html(e.count_all),(t=n.getObjectsByGidObj(o.gid,o.id_obj)).block.length<=n.properties.min_visible_comments&&t.more_button.length&&n.loadComments(o.gid,o.id_obj)):n.showNotice(n.properties.lng.error)}),"json"),n},this.loadComments=function(e,t,o){t=parseInt(t);var r=(o=o||!1)?1:0,i=n.getMinMaxId(e,t);return $.post(n.properties.loadUrl,{gid:e,id_obj:t,max_id:i.max_id,min_id:i.min_id,with_form:r,order_by:n.properties.order_by},(function(s){s.status&&s.comments_html?(r?($(o).html(s.comments_html),jq_obj=n.getObjectsByGidObj(e,t),jq_obj.slider.hide().slideDown(150)):(jq_obj=n.getObjectsByGidObj(e,t),jq_obj.cont.append(s.comments_html)),void 0!==s.comments.count_all&&jq_obj.counter.html(s.comments.count_all),(i=n.getMinMaxId(e,t)).min_id==s.comments.bd_min_id&&jq_obj.more_button.remove()):n.showNotice(n.properties.lng.error)}),"json"),n},this.like=function(e){if(!r||"pending"!=r.state())return e=parseInt(e),jq_obj=n.getObjectsById(e),r=$.post(n.properties.likeUrl,{id:e},(function(e){e.status&&void 0!==e.likes?jq_obj.likes_counter.fadeOut(50,(function(){$(this).html(e.likes).fadeIn(50)})):!e.status&&e.error&&n.showNotice(e.error),jq_obj.likes_counter.parents("a").attr("title",e.a_title)}),"json"),n},this.showNotice=function(e,t){t=t||"error";var r="";"object"===o(e)?r=e.join("<br/>"):"string"==typeof e&&(r=e),r&&error_object.show_error_block(r,t)},this.getMinMaxId=function(e,t){t=parseInt(t);var o=n.getObjectsByGidObj(e,t),r=o.cont.find(".comment_block:first").attr("id"),i=o.cont.find(".comment_block:last").attr("id"),s=0,a=0;return void 0!==r&&(s=parseInt(r.replace("comment_id_",""))),void 0!==i&&(a=parseInt(i.replace("comment_id_",""))),{min_id:s<a?s:a,max_id:s>a?s:a}},this.visibleCount=function(e,t){return t=parseInt(t),n.getObjectsByGidObj(e,t).block.length},this.countChars=function(e){var t=$(e).val().length,o=parseInt($(e).attr("maxcount"));t>o&&$(e).val($(e).val().substring(0,o)).scrollTop(1e3),t=$(e).val().length,$(e).parents(".edit_block").find(".char_counter").html(o-t)},this.getGidObjById=function(e){e=parseInt(e);var t=n.getObjectsById(e);return{gid:t.form_cont.attr("gid"),id_obj:t.form_cont.attr("id_obj")}},this.getObjectsByGidObj=function(e,t){t=parseInt(t);var o=$("#comments_form_cont_"+e+"_"+t).find(".comment_block"),r=$("#comments_form_cont_"+e+"_"+t);return s(o,r)},this.getObjectsById=function(e){e=parseInt(e);var t=$("#comment_id_"+e);return s(t)};var s=function(e,t){t=t||!1;var o={};return o.block=e,o.likes_counter=e.find(".likes_counter"),o.form_cont=t||!e.length?t:e.parents(".form_wrapper"),o.cont=o.form_cont.find(".comments_wrapper"),o.more_button=o.form_cont.find(".more_button"),o.slider=o.form_cont.find(".comments_slider"),o.counter=o.form_cont.find(".counter"),o.textarea=o.form_cont.find("textarea"),o.user_name=o.form_cont.find('input[name="user_name"]'),o.email=o.form_cont.find('input[name="email"]'),o},a=function(e){return"string"!=typeof e?"":(e=e.replace(/^\s+/g,"")).replace(/\s+$/g,"")};return n.Init(t),n})},4746:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.CompanionsAvatar=function(e){this.properties={site_url:"",load_avatar_url:"users/ajax_load_avatar/",photo_id:"user_photo",id_obj:0,recrop_url:"users/ajax_recrop_avatar/",recrop_container_id:"photo_source_recrop_box",recrop_img_id:"photo_source_recrop",photo_sizes_id:"photo_sizes",image_content_id:"image_content_avatar",menu_container_id:"media_menu",recropMenuContainer:"#recrop_menu",image_css_size:{width:700,height:500},selections:[],section:"",saveAfterSelect:!1,id_user:"",window_obj:new loadingContent({loadBlockWidth:"800px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1})};var t={},o=null;this.imageareaselect=null,this.selections=[],this.index=0,this.img=new Image,this.image_css_size={width:0,height:0};var r=this;return this.Init=function(e){return r.properties=$.extend(r.properties,e),t.avatar_obj=$("#"+r.properties.photo_id),t.avatar_obj.off("click").on("click",(function(){r.load_avatar()})),this},this.init_window_obj=function(){var e=new loadingContent({loadBlockWidth:"800px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1});r.properties.window_obj=e},this.destroy_window=function(){r.properties.window_obj.hide_load_block(),r.properties.window_obj.destroy()},this.uninit=function(){return r.uninit_imageareaselect(),t.avatar_obj.off(),this},this.load_avatar=function(){$.ajax({url:r.properties.site_url+r.properties.load_avatar_url,type:"POST",data:{id_obj:r.properties.id_obj,id_user:r.properties.id_user},dataType:"json",cache:!1,success:function(e){e.status?(r.properties.window_obj.changeTemplate("gallery"),r.properties.window_obj.show_load_block(e.data.html),r.selections=[],r.properties.selections=e.data.selections,r.add_selections(r.properties.selections)):e.errors.length&&error_object.show_error_block(e.errors,"error")}})},this.add_selection=function(e,t,o,i,n){return r.selections.push({prefix:e,x1:t,y1:o,width:i,height:n,orig_width:i,orig_height:n}),this},this.add_selections=function(e){for(var t in e)e.hasOwnProperty(t)&&r.add_selection(t,0,0,parseInt(e[t].width),parseInt(e[t].height))},this.recrop=function(){return o&&"pending"==o.state()?o:o=$.ajax({url:r.properties.site_url+r.properties.recrop_url,type:"POST",data:{selections:r.selections[r.index],id_obj:r.properties.id_obj},dataType:"json",cache:!1,success:function(e){e.status?e.data.img_url&&$('img[src^="'+e.data.img_url+'"]').attr("src",e.data.img_url+"?"+(new Date).getTime()):e.errors.length&&error_object.show_error_block(e.errors,"error"),e.msg.length&&error_object.show_error_block(e.msg,"success")}})},this.init_imageareaselect=function(){return t.img_obj=$("#"+r.properties.recrop_img_id),t.photo_sizes_obj=$("#"+r.properties.photo_sizes_id),t.image_content_obj=$("#"+r.properties.image_content_id),t.image_content_obj.off("click","#"+r.properties.menu_container_id+" [data-section]").on("click","#"+r.properties.menu_container_id+" [data-section]",(function(){if("recrop"===$(this).data("section")&&r.selections.length){for(var e in t.image_content_obj.find('[data-area="view"]').hide(),t.image_content_obj.find('[data-area="recrop"]').show(),r.index=0,t.photo_sizes_obj.html(""),r.selections)r.selections.hasOwnProperty(e)&&t.photo_sizes_obj.append('<li><span data-index="'+e+'">'+r.selections[e].orig_width+"x"+r.selections[e].orig_height+"</span></li>");if(t.photo_sizes_obj.find("li").removeClass("active").eq(r.index).addClass("active"),t.photo_sizes_obj.off("click","li span").on("click","li span",(function(){var e=$(this).data("index");return e>=r.selections.length||e==r.index||(r.index=e,r.change_selection(),t.photo_sizes_obj.find("li").removeClass("active"),$(this).parent().addClass("active")),!1})),$("#"+r.properties.recrop_container_id).off("recrop:do").on("recrop:do",(function(){r.recrop()})),$.isEmptyObject(r.selections))return;r.img.src=t.img_obj.attr("src"),r.img.onload=function(){r.img.width?t.image_ready():t.img_obj.off("load").on("load",(function(){t.image_ready()}))}}else t.image_content_obj.find('[data-area="view"]').show(),r.imageareaselect&&r.imageareaselect.setOptions({hide:!0});$(this).parents("ul").find("li").removeClass("active"),$(this).parent().addClass("active")})),$("#"+r.properties.menu_container_id).find('[data-section="'+r.properties.section+'"]').parent().addClass("active"),$("#"+r.properties.menu_container_id+" .active span").click(),t.image_content_obj.off("click",r.properties.recropMenuContainer+" [data-section]").on("click",r.properties.recropMenuContainer+" [data-section]",(function(){"view"===$(this).data("section")&&(t.image_content_obj.find('[data-area="recrop"]').hide(),t.image_content_obj.find('[data-area="view"]').show())})),this},t.image_ready=function(e){for(e=e||0;(!t.img_obj.width()||!t.img_obj.height())&&e<60;)return setTimeout((function(){t.image_ready(++e)}),50),this;r.image_css_size={width:t.img_obj.width(),height:t.img_obj.height()},r.selections=[],r.add_selections(r.properties.selections),r.recalc_selection(),r.imageareaselect=t.img_obj.imgAreaSelect({handles:!0,persistent:!0,aspectRatio:r.selections[r.index].width+":"+r.selections[r.index].height,minWidth:r.selections[r.index].width,minHeight:r.selections[r.index].height,imageWidth:r.img.width,imageHeight:r.img.height,instance:!0,parent:"#"+r.properties.recrop_container_id,x1:r.selections[r.index].x1,y1:r.selections[r.index].y1,x2:r.selections[r.index].x1+r.selections[r.index].width,y2:r.selections[r.index].y1+r.selections[r.index].height,zIndex:2,onSelectStart:function(e,o){t.hide_recrop_btn(this)},onSelectEnd:function(e,o){o.width&&o.height&&(r.properties.saveAfterSelect?r.recrop():t.show_recrop_btn(this),r.selections[r.index].x1=Math.min(o.x1,o.x2),r.selections[r.index].y1=Math.min(o.y1,o.y2),r.selections[r.index].width=o.width,r.selections[r.index].height=o.height)},onSelectChange:function(e,o){o.width&&o.height&&(t.hide_recrop_btn(this),r.selections[r.index].x1=Math.min(o.x1,o.x2),r.selections[r.index].y1=Math.min(o.y1,o.y2),r.selections[r.index].width=o.width,r.selections[r.index].height=o.height)},onInit:function(e,o){t.show_recrop_btn(this)}})},t.show_recrop_btn=function(e){var t=$(e.parent).find("."+e.classPrefix+"-selection"),o=$('<div class="selection-recrop-btn" onmouseup="$(\'#'+r.properties.recrop_container_id+"').trigger('recrop:do');\"></div>");t.html(o)},t.hide_recrop_btn=function(e){$(e.parent).find("."+e.classPrefix+"-selection").html("")},this.uninit_imageareaselect=function(){return t.img_obj&&t.img_obj.off(),t.photo_sizes_obj&&t.photo_sizes_obj.off(),t.image_content_obj&&t.image_content_obj.off(),$("#"+r.properties.recrop_container_id).off(),r.imageareaselect=null,r.selections=[],r.index=0,this},this.change_selection=function(){var e=r.selections[r.index];return r.imageareaselect.setOptions({aspectRatio:e.width+":"+e.height,minWidth:e.width,minHeight:e.height,x1:e.x1,y1:e.y1,x2:e.x1+e.width,y2:e.y1+e.height}),r.imageareaselect.update(!1),this},this.recalc_selection=function(){var e=r.img.height/r.image_css_size.height,t=r.img.width/r.image_css_size.width;for(var o in r.selections)if(r.selections.hasOwnProperty(o))if(r.img.width<r.selections[o].width||r.img.height<r.selections[o].height){var i;r.img.width<r.selections[o].width&&(i=r.img.width/r.selections[o].width,r.selections[o].width*=i,r.selections[o].height*=i),r.img.height<r.selections[o].height&&(i=r.img.height/r.selections[o].height,r.selections[o].width*=i,r.selections[o].height*=i)}else{var n=r.selections[o].width*t,s=r.selections[o].height*e;n>=r.selections[o].width&&n<r.img.width&&s>=r.selections[o].height&&s<r.img.height&&(r.selections[o].width=n,r.selections[o].height=s);var a=Math.round(r.img.width/2-r.selections[o].width/2);a<0&&(a=0);var c=Math.round(r.img.height/2-r.selections[o].height/2);c<0&&(c=0),r.selections[o].x1=a,r.selections[o].y1=c}return this},r.Init(e),this})},9870:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Companions=function(e){this.properties={siteUrl:"",request_id:0,sendResponseLink:"companions/ajaxAddResponse/",deleteResponseLink:"companions/ajaxDeleteResponse/",message_form_link:"companions/ajaxGetMessageForm/",answer_form_link:"companions/ajaxGetAnswerForm/",error_object,content_obj:new loadingContent({loadBlockWidth:"550px",loadBlockLeftType:"center",loadBlockTopType:"top",loadBlockTopPoint:100,closeBtnClass:"w",draggable:!0})};var t=this;this.Init=function(e){t.prop=$.extend(t.properties,e),t.sendResponse()},this.sendResponse=function(){$("#js_send_response").off("click").on("click",(function(){$.ajax({url:t.prop.siteUrl+t.prop.sendResponseLink+t.prop.request_id,dataType:"json",cache:!1,success:function(e){e.success?(error_object.show_error_block(e.success,"success"),locationHref(t.prop.siteUrl+"companions/viewRequest/"+t.prop.request_id)):e.errors&&error_object.show_error_block(e.errors,"error")}})})),$(".js_accept_response").off("click").on("click",(function(){var e=$(this).attr("data-id");$.ajax({url:t.prop.siteUrl+t.prop.answer_form_link+e+"/accept",dataType:"html",cache:!1,success:function(e){e&&t.prop.content_obj.show_load_block(e)}})})),$(".js_decline_response").off("click").on("click",(function(){var e=$(this).attr("data-id");$.ajax({url:t.prop.siteUrl+t.prop.answer_form_link+e+"/decline",dataType:"html",cache:!1,success:function(e){e&&t.prop.content_obj.show_load_block(e)}})})),$("#js_delete_response").off("click").on("click",(function(){$.ajax({url:t.prop.siteUrl+t.prop.deleteResponseLink+t.prop.request_id,dataType:"json",cache:!1,success:function(e){e.success?(error_object.show_error_block(e.success,"success"),locationHref(t.prop.siteUrl+"companions/viewRequest/"+t.prop.request_id)):e.errors&&error_object.show_error_block(e.errors,"error")}})}))},t.Init(e)})},751:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.requestSelect=function(e){this.properties={siteUrl:"",rand:"",load_user_link:"companions/ajaxGetRequestsData/",load_form:"companions/ajaxGetRequtestForm/",load_selected_data_link:"companions/ajaxGetSelectedRequest/",id_main:"",id_span:"",id_manage_link:"",id_items:"user_select_items",id_selected_items:"user_selected_items",id_search:"user_search",id_user_page:"user_page",id_close:"user_close_link",var_name:"",max:"",selected_items:[],contentObj:new loadingContent({loadBlockWidth:"680px",closeBtnPadding:15})};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.id_main="user_select_"+t.properties.rand,t.properties.id_span="user_text_"+t.properties.rand,t.properties.id_manage_link="user_link_"+t.properties.rand,t.properties.max=parseInt(t.properties.max),$("#"+t.properties.id_manage_link).on("click",(function(){return t.open_form(),!1}))},this.open_form=function(){var e=t.properties.siteUrl+t.properties.load_form+"/"+t.properties.max;$.ajax({url:e,type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),t.load_users("",1),$("#"+t.properties.id_search).unbind().on("keyup",(function(){t.load_users($(this).val(),1)})),1!=t.properties.max&&$("#"+t.properties.id_selected_items+" input:checkbox").on("click",(function(){t.unset_user($(this).val())})),$("#"+t.properties.id_close).on("click",(function(){return t.properties.contentObj.hide_load_block(),!1}))}})},this.load_users=function(e,o){var r={selected:t.properties.selected_items};""!=e&&(r.search=e),$.ajax({url:t.properties.siteUrl+t.properties.load_user_link+o,dataType:"json",type:"POST",data:r,cache:!1,success:function(o){for(var r in $("#"+t.properties.id_items+" option").unbind(),$("#"+t.properties.id_items).empty(),o.items){var i='<li index="'+o.items[r].id+'"';in_array(o.items[r].id,t.properties.selected_items)&&(i+='class="hide"'),i+=">"+o.items[r].title+"("+o.items[r].user.output_name+")</li>",$("#"+t.properties.id_items).append(i)}t.generate_user_pages(o.pages,o.current_page,e),$("#"+t.properties.id_items+" li").on("click",(function(){t.set_user($(this).attr("index"))}))}})},this.generate_user_pages=function(e,o,r){if($("#"+t.properties.id_user_page+" a").unbind(),$("#"+t.properties.id_user_page).empty(),e>1){var i=e-12,n=o>6?o-6:1;n>i&&(n=i),o>7&&($("#"+t.properties.id_user_page).append('<ins class="fleft"><a href="#">1</a></ins>'),$("#"+t.properties.id_user_page).append('<ins class="fleft">...</ins>')),function(e,o,r){r=parseInt(r);for(var i=e;i<=o;i++)i===r?$("#"+t.properties.id_user_page).append('<ins class="fleft current"><mark>'+i+"</mark></ins>"):$("#"+t.properties.id_user_page).append('<ins class="fleft"><a href="#">'+i+"</a></ins>")}(n,n+12,o),o<e-6&&($("#"+t.properties.id_user_page).append('<ins class="fleft">...</ins>'),$("#"+t.properties.id_user_page).append('<ins class="fleft"><a href="#">'+e+"</a></ins>")),$("#"+t.properties.id_user_page+" a").on("click",(function(){return t.load_users(r,$(this).text()),!1}))}},this.set_user=function(e){var o=!1,r=0;for(r in t.properties.selected_items)t.properties.selected_items[r]==e&&(o=!0);if(t.properties.max>1&&t.properties.selected_items.length>=t.properties.max)return t.properties.selected_items=t.properties.selected_items.splice(0,t.properties.max),void t.load_selected();1==t.properties.max&&t.properties.selected_items.length>0&&(t.properties.selected_items=[]),o||(r=parseInt(r)+1,t.properties.selected_items.length||(r=0),t.properties.selected_items[r]=e,1==t.properties.max?t.properties.contentObj.hide_load_block():t.hide_option(e),t.load_selected())},this.load_selected=function(){$.ajax({url:t.properties.siteUrl+t.properties.load_selected_data_link,dataType:"json",type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(e){t.reload_span(e),1!=t.properties.max&&t.reload_selected(e)}})},this.unset_user=function(e){var o=!1;for(var r in t.properties.selected_items)t.properties.selected_items[r]==e&&(o=!0,t.properties.selected_items.splice(r,1));o&&$.ajax({url:t.properties.siteUrl+t.properties.load_selected_data_link,dataType:"json",type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(o){t.reload_span(o),1!=t.properties.max&&t.reload_selected(o),t.show_option(e)}})},this.hide_option=function(e){$("#"+t.properties.id_items+" li[index="+e+"]").addClass("hide")},this.show_option=function(e){$("#"+t.properties.id_items+" li[index="+e+"]").removeClass("hide")},this.reload_span=function(e){for(var o in $("#"+t.properties.id_span).empty(),e)1!=t.properties.max?$("#"+t.properties.id_span).append(e[o].title+"("+e[o].user.output_name+')<br><input type="hidden" name="'+t.properties.var_name+'[]" value="'+e[o].id+'">'):$("#"+t.properties.id_span).append(e[o].title+"("+e[o].user.output_name+')<input type="hidden" name="'+t.properties.var_name+'" value="'+e[o].id+'">')},this.reload_selected=function(e){for(var o in $("#"+t.properties.id_selected_items).empty(),e)$("#"+t.properties.id_selected_items).append('<li><div class="user-block"><input type="checkbox" name="remove_users[]" value="'+e[o].id+'" checked>'+e[o].title+"("+e[o].user.output_name+")</div></li>");$("#"+t.properties.id_selected_items+" input:checkbox").on("click",(function(){t.unset_user($(this).val())}))},t.Init(e)})},6959:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.cookiePolicy=function(e){this.properties={siteUrl:"",blockId:"cookie_policy_block",linkId:"cookie_policy_link",closeId:"cookie_policy_close",name:"cookie_policy",expires:604800,path:"/",domain:"",secure:!1};var t=this;this.Init=function(e){if(t.properties=$.extend(t.properties,e),"number"==typeof t.properties.expires&&t.properties.expires){var o=new Date;o.setTime(o.getTime()+1e3*t.properties.expires),t.properties.expires=t.properties.expires=o}t.properties.expires&&t.properties.expires.toUTCString&&(t.properties.expires=t.properties.expires.toUTCString()),$(document).off("click","#"+t.properties.linkId).on("click","#"+t.properties.linkId,(function(){t.set_cookie()})).off("click","#"+t.properties.closeId).on("click","#"+t.properties.closeId,(function(){t.set_cookie()}))},this.set_cookie=function(){lightSetCookie(t.properties.name,1,t.properties.expires),$("#"+t.properties.blockId).hide()},t.Init(e)})},296:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.InstallLocations=function(e){"use strict";this.properties={siteUrl:null,data:{action:{checkAll:'[data-action="check-all"]',btnInstall:'[data-action="btn-install"]',getRegions:'[data-action="get-regions"]'}},url:{installRegions:"admin/countries/ajax_install_regions/",getRegions:"admin/countries/ajax_get_regions/"},lang:{},errorObj:new Errors,contentObj:null};var t=this,o={};return new XMLHttpRequest,this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),t.map(),t.properties.contentObj=new loadingContent({loadBlockWidth:"800px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,footerButtons:'<a class="btn btn-primary" data-action="btn-install" href="javascript:void(0)">'+t.properties.lang.field.countriesInstallLink+"</a>"})},this.initControls=function(){$(document).off("change",t.properties.data.action.checkAll).on("change",t.properties.data.action.checkAll,(function(){t.checkRegion(this)})).off("click",t.properties.data.action.btnInstall).on("click",t.properties.data.action.btnInstall,(function(){t.installRegions(this)})).off("click",t.properties.data.action.getRegions).on("click",t.properties.data.action.getRegions,(function(){var e=$(this).data("country");t.getRegions(e,!0)}))},this.checkRegion=function(e){$(e).is(":checked")?$(".grouping").iCheck("check"):$(".grouping").iCheck("uncheck")},this.installRegions=function(){if(0===$(".grouping:checked").length)return t.properties.errorObj.show_error_block(t.properties.lang.error.headerRegionSelect,"error"),!1;var e="",r=[];$(".region-js").each((function(t,o){if($(o).is(":checked")){e=$(o).data("country");var i=$(o).val();r.push(i)}})),o.query(t.properties.url.installRegions,{country_code:e,region:r},"json",(function(o){for(var r in o.install_regions)if(o.install_regions[r].status){$("#item_"+e+"_"+o.install_regions[r].id+" .icheckbox_flat-green").remove(),$("#item_"+e+"_"+o.install_regions[r].id).append('<i class="fa fa-check green lg"></i>');var i=$("#item_"+e+"_"+o.install_regions[r].id+" .region_name").text();t.properties.errorObj.show_error_block(i+" - "+t.properties.lang.field.countryInstalled,"info")}0===$(".grouping").length&&(t.properties.contentObj.hide_load_block(),t.properties.errorObj.show_error_block($('[data-country="'+e+'"] .country_name').text()+" - "+t.properties.lang.field.countryInstalled,"success"),$('[data-country="'+e+'"]').attr("data-action",""),$('[data-country="'+e+'"] .sparkline_discreet').hide(),$('[data-country="'+e+'"] .sparkline_discreet').before('<i class="fa fa-check green lg"></i>'))}))},this.getRegions=function(e,r){!0===r&&$("#vmap").vectorMap("select",e);var i={country_code:e};o.query(t.properties.url.getRegions,i,"JSON",(function(e){t.properties.contentObj.show_load_block(e.content)}))},this.map=function(){void 0!==$.fn.vectorMap&&$("#vmap").length&&$("#vmap").vectorMap({map:"world_en",backgroundColor:null,color:"#ffffff",hoverOpacity:.7,selectedColor:"#32b44a",enableZoom:!1,showTooltip:!0,values:sample_data,scaleColors:["#E6F2F0","#149B7E"],normalizeFunction:"polynomial",onRegionClick:function(e,o,r){t.getRegions(o.toUpperCase(),!1)}})},o.query=function(e,o,r,i){return/^(f|ht)tps?:\/\//i.test(e)||(e=t.properties.siteUrl+e),$.ajax({url:e,type:"POST",cache:!1,data:o,dataType:r,success:function(e){void 0!==i&&i(e)}}),!1},t.Init(e),this})},4015:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var r=function(e){this.properties={siteUrl:"",installBlockID:"region_reload",overallBarID:"regions_bar",country_code:"",urlInstallCities:"admin/countries/ajax_install_cities/",reloadTimeout:600,regions:[],current_region_index:0,progress_step:0};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e)},this.start_city_install=function(e){t.properties.regions.length>0&&(t.properties.progress_step=Math.floor(100/t.properties.regions.length),t.city_install(0,e))},this.city_install=function(e,o){var r=t.properties.regions[e],i=t.properties.siteUrl+t.properties.urlInstallCities+t.properties.country_code+"/"+r;e++,$.ajax({url:i,cache:!1,success:function(r){$("#region_"+t.properties.country_code+"_"+e).addClass("installed");var i=Math.round(100*e/t.properties.regions.length);t.update_overall_progress(i),e<t.properties.regions.length?setTimeout((function(){t.city_install(e,o)}),t.properties.reloadTimeout):(t.update_overall_progress(100),"function"==typeof o?o():$("#back_btn").show())}})},this.update_overall_progress=function(e){e>100&&(e=100),$("#"+t.properties.overallBarID+" div.bar").html(e+"%"),$("#"+t.properties.overallBarID+" div.bar").css("width",e+"%")},t.Init(e)};"object"===o(t)&&(t.__esModule=!0,t.adminCountriesSelected=function(e){this.properties={siteUrl:"",installBlockID:"countries_reload",overallBarID:"overall_bar",country_code:"",urlInstallCountries:"admin/countries/ajax_install_country/",reloadTimeout:600,countries:[],regions:[],regions_list:"",current_country_index:0,current_region_index:0,progress_step:0};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.regions=jQuery.parseJSON(t.properties.regions_list),t.properties.countries=jQuery.parseJSON(t.properties.countries)},this.start_country_install=function(){t.properties.countries.length>0&&(t.properties.progress_step=Math.floor(100/t.properties.countries.length),t.country_install(0))},this.country_install=function(e){var o=t.properties.countries[e],i=t.properties.siteUrl+t.properties.urlInstallCountries+o;e++,$.ajax({url:i,cache:!1,success:function(i){$("#country_"+e).addClass("installed");var n=Math.round(100*e/t.properties.countries.length);e<=t.properties.countries.length?setTimeout((function(){var i=t.properties.siteUrl,s=o,a=t.properties.regions[o];new r({siteUrl:i,regions:a,country_code:s}).start_city_install((function(){t.update_overall_progress(n),t.country_install(e)}))}),t.properties.reloadTimeout):(t.update_overall_progress(100),$("#back_btn").show())}})},this.update_overall_progress=function(e){e>100&&(e=100),$("#"+t.properties.overallBarID+" div.bar").html(e+"%"),$("#"+t.properties.overallBarID+" div.bar").css("width",e+"%")},t.Init(e)})},3126:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.adminCountries=function(e){this.properties={siteUrl:"",installBlockID:"region_reload",overallBarID:"overall_bar",country_code:"",urlInstallCities:"admin/countries/ajax_install_cities/",reloadTimeout:600,regions:[],current_region_index:0,progress_step:0};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e)},this.start_city_install=function(){t.properties.regions.length>0&&(t.properties.progress_step=Math.floor(100/t.properties.regions.length),t.city_install(0))},this.city_install=function(e){var o=t.properties.regions[e],r=t.properties.siteUrl+t.properties.urlInstallCities+t.properties.country_code+"/"+o;$.ajax({url:r,cache:!1,success:function(e){$("#region_"+t.properties.current_region_index).addClass("installed"),t.properties.current_region_index++;var o=Math.round(100*t.properties.current_region_index/t.properties.regions.length);t.update_overall_progress(o),t.properties.current_region_index<t.properties.regions.length?setTimeout((function(){t.city_install(t.properties.current_region_index)}),t.properties.reloadTimeout):(t.update_overall_progress(100),$("#back_btn").show())}})},this.update_overall_progress=function(e){e>100&&(e=100),$("#"+t.properties.overallBarID+" div.bar").html(e+"%"),$("#"+t.properties.overallBarID+" div.bar").css("width",e+"%")},t.Init(e)})},8372:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.sortLocations=function(e){this.properties={siteUrl:"",urlSaveSort:""};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.moveCountry(),t.change()},this.moveCountry=function(){$("#moveToSortList").on("click",(function(){$("#clsr0ul_sort option:selected").appendTo("#clsr0ul"),t.sortCountries(),t.saveSorter()})),$("#moveToDefault").on("click",(function(){$("#clsr0ul option:selected").appendTo("#clsr0ul_sort"),t.saveSorter()}))},this.change=function(){$("#moveUp").on("click",(function(){t.changePriority("up")})),$("#moveDown").on("click",(function(){t.changePriority("down")}))},this.sortCountries=function(){$("#clsr0ul").each((function(){$(this).html($(this).find("option").sort((function(e,t){return e.text==t.text?0:e.text<t.text?-1:1})))}))},this.changePriority=function(e){var o=$("#clsr0ul_sort option").length,r=new Array,i=new Array,n=new Array,s=0;if($("#clsr0ul_sort").find("option").each((function(e){r[e]=$(this).text(),i[e]=$(this).prop("id"),$(this).is(":selected")&&(n[s]=e,$(this).prop("selected",!1),s++)})),"up"==e)for(var a=0;a<n.length;a++)n[a]>0&&($("#clsr0ul_sort option:eq("+(n[a]-1)+")").text(r[n[a]]),$("#clsr0ul_sort option:eq("+(n[a]-1)+")").prop("id",i[n[a]]),$("#clsr0ul_sort option:eq("+n[a]+")").text(r[n[a]-1]),$("#clsr0ul_sort option:eq("+n[a]+")").prop("id",i[n[a]-1]),r[n[a]-1]=$("#clsr0ul_sort option:eq("+(n[a]-1)+")").val(),i[n[a]-1]=$("#clsr0ul_sort option:eq("+(n[a]-1)+")").prop("id"),r[n[a]]=$("#clsr0ul_sort option:eq("+n[a]+")").val(),i[n[a]]=$("#clsr0ul_sort option:eq("+n[a]+")").prop("id"),$("#clsr0ul_sort option:eq("+(n[a]-1)+")").prop("selected",!0));else if("down"==e)for(a=n.length;a>=0;a--)n[a]<o-1&&($("#clsr0ul_sort option:eq("+n[a]+")").text(r[n[a]+1]),$("#clsr0ul_sort option:eq("+n[a]+")").prop("id",i[n[a]+1]),$("#clsr0ul_sort option:eq("+(n[a]+1)+")").text(r[n[a]]),$("#clsr0ul_sort option:eq("+(n[a]+1)+")").prop("id",i[n[a]]),r[n[a]+1]=$("#clsr0ul_sort option:eq("+(n[a]+1)+")").val(),i[n[a]+1]=$("#clsr0ul_sort option:eq("+(n[a]+1)+")").prop("id"),r[n[a]]=$("#clsr0ul_sort option:eq("+n[a]+")").val(),i[n[a]]=$("#clsr0ul_sort option:eq("+n[a]+")").prop("id"),$("#clsr0ul_sort option:eq("+(n[a]+1)+")").prop("selected",!0));t.saveSorter()},this.saveSorter=function(){var e=new Object;$("#clsr0ul_sort").each((function(){var t=$(this).prop("id"),o=$(this).prop("name");$("#"+t+" > option").length>0&&(e[o]=new Object,$("#"+t+" > option").each((function(t){void 0!==$(this).prop("id")&&(e[o][$(this).prop("id")]=t+1)})))})),result=JSON.stringify(e),$.ajax({url:t.properties.siteUrl+t.properties.urlSaveSort,type:"POST",data:{sorter:result},cache:!1})},t.Init(e)})},9879:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.locationAutocomplete=function(e){this.properties={siteUrl:"",rand:"",id_country:"",id_region:"",id_city:"",lat:"",lon:"",isRadius:0,locationName:"",load_location_link:"countries/ajax_get_locations/",load_data:"countries/ajax_get_data/",getChangeLocationForm:"",isChangeLocation:0,locations:{},id_main:"",id_text:"",id_msg:"",class_msg:"country-msg",id_open:"",id_hidden_country:"",id_hidden_region:"",id_hidden_city:"",id_bg:"locationAutocompleteBg",id_select:"",id_items:"country_select_items",id_back:"country_select_back",id_clear:"country_select_clear",id_close:"country_select_close",id_search:"city_search",id_city_page:"city_page",timeout_obj:null,timeout:500,dropdownClass:"dropdown",type:"region",auto_detect:!1,inputClass:"",activeClass:"active",errorClass:"autocomplete-error",searchIcon:"fa-search",closeIcon:"fa-times",windowObj:new loadingContent({loadBlockWidth:"500px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0})};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.id_main="country_select_"+t.properties.rand,t.properties.id_text="country_text_"+t.properties.rand,t.properties.id_msg="country_msg_"+t.properties.rand,t.properties.id_hidden_country="country_hidden_"+t.properties.rand,t.properties.id_hidden_region="region_hidden_"+t.properties.rand,t.properties.id_hidden_city="city_hidden_"+t.properties.rand,t.properties.id_hidden_lat="lat_hidden_"+t.properties.rand,t.properties.id_hidden_lon="lon_hidden_"+t.properties.rand,t.properties.id_select="region_select_"+t.properties.rand,t.properties.inputClass="input-autocomplete-"+t.properties.rand,t.bindLoadLocations(),t.bindCloseButton(),t.initBg(),t.initBox()};var o=function(e,t){var o=e.toLowerCase().indexOf(t);if(-1===o)return e;var r=o+t.length,i="";return(i=e.substr(0,r)+"</span>"+e.substr(r)).substr(0,o)+'<span class="highlight">'+i.substr(o)};this.load_locations=function(e){$.ajax({url:t.properties.siteUrl+t.properties.load_location_link,data:{name:e},dataType:"json",type:"POST",cache:!1,success:function(i){t.properties.locations=i;var n,s=$("#"+t.properties.id_select+" ul"),a=[];if(i.all>0){for(var c in t.clearDropDown(),i.items.cities)n=$("<li>").attr({gid:"rs_"+c,lat:i.items.cities[c].latitude,lon:i.items.cities[c].longitude,city:i.items.cities[c].id,region:i.items.cities[c].id_region,country:i.items.cities[c].country_code}).html(o(i.items.cities[c].name,e)),a.push(n);for(var c in i.items.regions)n=$("<li>").attr({gid:"rs_"+c,region:i.items.regions[c].id,country:i.items.regions[c].country_code}).html(o(i.items.regions[c].name,e)),a.push(n);for(var c in i.items.countries)n=$("<li>").attr({gid:"rs_"+c,country:i.items.countries[c].code}).html(o(i.items.countries[c].name,e)),a.push(n);n=t.getLastMsg(),a.push(n),s.append(a),t.setActiveItemList()}else t.clearDropDown(),n=$('<div class="'+t.properties.errorClass+'">').html(i.error),a.push(n),n=t.getLastMsg(),a.push(n),s.append(a);t.initLastMsg(),t.openBox(),t.bindKeydown(),r()}})},this.setActiveItemList=function(){$("#"+t.properties.id_select+" ul").find("li:first").addClass(t.properties.activeClass)},this.bindLoadLocations=function(){$("#"+t.properties.id_text).on("click",(function(){$(this).val()&&(t.expandBg(),t.setCloseIcon(),$(this).select())}));try{document.getElementById(t.properties.id_text).addEventListener("input",(function(){return t.properties.timeout_obj&&clearTimeout(t.properties.timeout_obj),t.properties.timeout_obj=setTimeout((function(){var e=$("#"+t.properties.id_text).val();t.emptyValues(),e?t.load_locations(e):t.closeBox()}),t.properties.timeout),!0}))}catch(e){}},this.bindKeydown=function(){var e=t.properties.activeClass,o=$("#"+t.properties.id_select+" ul").find(".active:first");$("#"+t.properties.id_text).off("keydown").on("keydown",(function(t){switch(t.which){case 38:var r=o.prev("li");r.length&&(o.removeClass(e),(o=r).addClass(e));break;case 40:var i=o.next("li");i.length&&(o.removeClass(e),(o=i).addClass(e));break;case 13:o.click();break;default:return}t.preventDefault()}))},this.bindCloseButton=function(){$("."+t.properties.inputClass+" .button-search").on("click","."+t.properties.closeIcon,(function(){t.clearBox(),t.closeBox()}))};var r=function(){var e=!1,o="",r=0,n=0,s="";return $("li","#"+t.properties.id_select).each((function(){if(s=$("span",this).html(),$("#"+t.properties.id_text).val()===s)return o=$(this).attr("country"),r=$(this).attr("region"),n=$(this).attr("city"),lat=$(this).attr("lat"),lon=$(this).attr("lon"),e=!0,!1})),e&&(t.set_values_text(o,r,n,s,lat,lon),i(s)),e},i=function(e){var o="highlight",r={cities:"city",regions:"region",countries:"country"};for(var i in t.properties.locations.items)for(var n in t.properties.locations.items[i])if(t.properties.locations.items[i][n].name===e)return $("["+r[i]+'="'+n+'"]',"#"+t.properties.id_select).filter((function(){return $("span",this).text()===e})).find("span").addClass(o),!0;return $("li","#"+t.properties.id_select).removeClass(o),!1};this.set_values=function(e,o,r,i){var n="";"country"===e?($("#"+t.properties.id_hidden_country).val(o.toString()).change(),t.properties.id_country=o.toString(),$("#"+t.properties.id_hidden_region).val(0).change(),t.properties.id_region=0,$("#"+t.properties.id_hidden_city).val(0).change(),t.properties.id_city=0,$("#"+t.properties.id_hidden_lat).val(0).change(),t.properties.lat=0,$("#"+t.properties.id_hidden_lon).val(0).change(),t.properties.lon=0,n=r):"region"===e?($("#"+t.properties.id_hidden_region).val(o).change(),t.properties.id_region=o,$("#"+t.properties.id_hidden_city).val(0).change(),t.properties.id_city=0,$("#"+t.properties.id_hidden_lat).val(0).change(),t.properties.lat=0,$("#"+t.properties.id_hidden_lon).val(0).change(),t.properties.lon=0,n=i.country.name+", "+r):"city"===e&&($("#"+t.properties.id_hidden_city).val(o).change(),t.properties.id_city=o,$("#"+t.properties.id_hidden_lat).val(i.city.latitude).change(),t.properties.lat=i.city.latitude,$("#"+t.properties.id_hidden_lon).val(i.city.longitude).change(),t.properties.lon=i.city.longitude,n=i.country.name+", "+i.region.name+", "+r),""===n&&(n="..."),$("#"+t.properties.id_text).val(n)};var n=function(){$("#"+t.properties.id_hidden_country).val(t.properties.id_country).change(),$("#"+t.properties.id_hidden_region).val(t.properties.id_region).change(),$("#"+t.properties.id_hidden_city).val(t.properties.id_city).change(),$("#"+t.properties.id_hidden_lat).val(t.properties.lat).change(),$("#"+t.properties.id_hidden_lon).val(t.properties.lon).change()};this.set_values_text=function(e,o,r,i,s,a){void 0!==i&&($("#"+t.properties.id_text).val(i),$("#"+t.properties.id_text).attr("title",i)),t.properties.id_country=e,t.properties.id_region=o,t.properties.id_city=r,t.properties.lat=s,t.properties.lon=a,1===t.properties.isRadius&&$("#"+t.properties.id_hidden_city).change((function(){""!=t.properties.lon&&""!=t.properties.lat?$(".radius-block").removeClass("hide"):$(".radius-block").addClass("hide")})),n()},this.emptyValues=function(){t.properties.id_country="",t.properties.id_region="",t.properties.id_city="",t.properties.lat="",t.properties.lon="",n()},this.set_values_external=function(e,o){$.ajax({url:t.properties.siteUrl+t.properties.load_data+e+"/"+o,dataType:"json",cache:!1,success:function(r){"country"===e?t.set_values(e,o,r.country.name,r):"region"===e?t.set_values(e,o,r.region.name,r):"city"===e&&t.set_values(e,o,r.city.name,r)}})},this.initBg=function(){$("body").append('<div id="'+t.properties.id_bg+'"></div>'),$("#"+t.properties.id_bg).css({display:"none",position:"fixed","z-index":"998",width:"1px",height:"1px",left:"1px",top:"1px"})},this.expandBg=function(){$("#"+t.properties.id_bg).css({width:$(window).width()+"px",height:$(window).height()+"px",display:"block"}).on("click",(function(){t.closeBox()}))},this.collapseBg=function(){$("#"+t.properties.id_bg).css({width:"1px",height:"1px",display:"none"}).unbind()},this.initBox=function(){t.createDropDown(),$("#"+t.properties.id_select).on("click","li",(function(){t.set_values_text($(this).attr("country"),$(this).attr("region"),$(this).attr("city"),$(this).text(),$(this).attr("lat"),$(this).attr("lon")),t.closeBox()}))},this.unsetBox=function(){$("#"+t.properties.id_select).unbind().remove()},this.openBox=function(){t.expandBg(),t.resetDropDown(),$("#"+t.properties.id_select).slideDown(),t.setCloseIcon()},this.createDropDown=function(){$("body").append('<div class="'+t.properties.dropdownClass+' dropdown_location" id="'+t.properties.id_select+'"><ul></ul></div>'),t.resetDropDown()},this.resetDropDown=function(){var e=$("#"+t.properties.id_text).offset().top+$("#"+t.properties.id_text).outerHeight();$("#"+t.properties.id_select).css({width:$("#"+t.properties.id_text).outerWidth()-2+"px",left:$("#"+t.properties.id_text).offset().left+"px",top:e+"px",position:"absolute","z-index":"10001","border-radius":"5px"})},this.clearDropDown=function(){$("#"+t.properties.id_select+" ul").empty()},this.closeBox=function(){t.collapseBg(),$("#"+t.properties.id_select).slideUp(),t.setSearchIcon()},this.clearBox=function(){t.set_values_text("",0,0,"")},this.identifyLocation=function(){if("undefined"!=typeof Storage&&localStorage.getItem("userLocation")){var e=localStorage.getItem("userLocation");$.ajax({url:site_url+"countries/ajax_get_current_location",dataType:"json",type:"POST",data:{point:e},cache:!1,success:function(e){e.data.city&&(t.set_values_text(e.data.city.country_code,e.data.city.id_region,e.data.city.id,e.data.city.output_name,e.data.city.latitude,e.data.city.longitude),$("#"+t.properties.id_text).val(e.data.city.output_name))}})}},this.getLastMsg=function(){var e=$("#"+t.properties.id_msg).clone(),o=$("<li>").attr({class:t.properties.class_msg}).html(e);return e.removeClass("hide"),o},this.initLastMsg=function(){$("."+t.properties.class_msg).off("click").on("click",(function(e){e.preventDefault(),e.stopPropagation(),t.closeBox();var o="region";t.properties.id_country||(o="country"),t.requestLocation(o,t.properties.id_country)}))},this.requestLocation=function(e,o){t.properties.type=e,$.ajax({url:site_url+"countries/ajax_get_selector_form/"+e+"/"+o,dataType:"json",type:"POST",cache:!1,success:function(e){t.properties.windowObj.show_load_block(e.html),t.initFormButtons()}})},this.getLocationName=function(){$.ajax({url:site_url+"countries/ajax_get_location_name/",dataType:"json",type:"POST",data:{country_code:t.properties.id_country,region_id:t.properties.id_region,city_id:t.properties.id_city},cache:!1,success:function(e){e.output_name&&(t.properties.locationName=e.output_name,$("#"+t.properties.id_text).val(e.output_name))}})},this.initFormButtons=function(){$("#country_select_back").off("click").on("click",(function(){t.requestLocation("country"),$('[data-action="save-location"]').hide()})),$("#region_select_back").off("click").on("click",(function(){t.requestLocation("region",t.properties.id_country),$('[data-action="save-location"]').hide()})),$('[data-action="save-location"]').off("click").on("click",(function(){t.getLocationName(),t.changeLocation()})),$(".location-item").on("click",(function(){var e=t.properties.type;if("country"==e){var o=$(this).attr("code");t.requestLocation("region",o),t.set_values_text(o,"","")}else if("region"==e){var r=$(this).attr("gid");t.requestLocation("city",r),t.set_values_text(t.properties.id_country,r,"")}else"city"==e&&(t.set_values_text(t.properties.id_country,t.properties.id_region,$(this).attr("gid"),$(this).text(),$(this).attr("lat"),$(this).attr("lon")),t.getLocationName(),t.changeLocation())}))},this.setCloseIcon=function(){$("."+t.properties.inputClass+" .button-search").addClass("a"),$("."+t.properties.inputClass+" .button-search i").removeClass(t.properties.searchIcon).addClass(t.properties.closeIcon)},this.setSearchIcon=function(){$("."+t.properties.inputClass+" .button-search").removeClass("a"),$("."+t.properties.inputClass+" .button-search i").removeClass(t.properties.closeIcon).addClass(t.properties.searchIcon)},this.changeLocation=function(){0!=t.properties.isChangeLocation?$.ajax({type:"POST",dataType:"html",url:t.properties.siteUrl+t.properties.getChangeLocationForm,success:function(e){void 0!==e&&(t.properties.windowObj.show_load_block(e),$(".pg-modal").find('input[name="region_name"]').val(t.properties.locationName),$(".pg-modal").find('input[name="id_country"]').val(t.properties.id_country),$(".pg-modal").find('input[name="id_region"]').val(t.properties.id_region),$(".pg-modal").find('input[name="id_city"]').val(t.properties.id_city),$(".pg-modal").find('input[name="lat"]').val(t.properties.lat),$(".pg-modal").find('input[name="lon"]').val(t.properties.lon))}}):t.properties.windowObj.hide_load_block()},t.Init(e)})},2680:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.locationPopUp=function(e){this.properties={siteUrl:"",rand:"",id_country:"",id_region:"",id_city:"",lat:"",lon:"",load_country_link:"countries/ajax_get_countries",load_region_link:"countries/ajax_get_regions/",load_city_link:"countries/ajax_get_cities/",load_form:"countries/ajax_get_form/",load_data:"countries/ajax_get_data/",select_type:"city",id_main:"",id_span:"",id_open:"",id_hidden_country:"",id_hidden_region:"",id_hidden_city:"",id_items:"country_select_items",id_back:"country_select_back",id_clear:"country_select_clear",id_close:"country_select_close",id_search:"city_search",id_city_page:"city_page",isRadius:0,contentObj:new loadingContent({loadBlockWidth:"680px",closeBtnPadding:15})};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.id_main="country_select_"+t.properties.rand,t.properties.id_span="country_text_"+t.properties.rand,t.properties.id_open="country_open_"+t.properties.rand,t.properties.id_hidden_country="country_hidden_"+t.properties.rand,t.properties.id_hidden_region="region_hidden_"+t.properties.rand,t.properties.id_hidden_city="city_hidden_"+t.properties.rand,t.properties.id_hidden_lat="lat_hidden_"+t.properties.rand,t.properties.id_hidden_lon="lon_hidden_"+t.properties.rand,$("#"+t.properties.id_open).on("click",(function(){return"city"==t.properties.select_type?t.properties.id_region||t.properties.id_city?t.open_form("city",t.properties.id_region):t.properties.id_country?t.open_form("region",t.properties.id_country):t.open_form("country"):"region"==t.properties.select_type?t.properties.id_country||t.properties.id_region?t.open_form("region",t.properties.id_country):t.open_form("country"):"country"==t.properties.select_type&&t.open_form("country"),!1}))},this.open_form=function(e,o){var r=t.properties.siteUrl+t.properties.load_form+e;o&&(r+="/"+o),$.ajax({url:r,cache:!1,success:function(r){t.properties.contentObj.show_load_block(r),$("#"+t.properties.id_clear).unbind().on("click",(function(){t.clearBox()})),"country"==e?t.load_countries():"region"==e?(t.load_regions(o),$("#"+t.properties.id_back).unbind().on("click",(function(){return t.open_form("country",0),!1}))):"city"==e&&(t.load_cities(o,"",1),$("#"+t.properties.id_back).unbind().on("click",(function(){return t.open_form("region",t.properties.id_country),!1})),$("#"+t.properties.id_search).unbind().on("keyup",(function(){t.load_cities(o,$(this).val(),1)}))),$("#"+t.properties.id_close).on("click",(function(){t.properties.contentObj.hide_load_block()}))}})},this.load_countries=function(){$.ajax({url:t.properties.siteUrl+t.properties.load_country_link,dataType:"json",cache:!1,success:function(e){for(var o in $("#"+t.properties.id_items).unbind(),$("#"+t.properties.id_items).empty(),e.items)$("#"+t.properties.id_items).append('<li index="'+e.items[o].code+'">'+e.items[o].name+"</li>");$("#"+t.properties.id_items+" li").on("click",(function(){t.set_values("country",$(this).attr("index"),$(this).text(),e),"country"==t.properties.select_type?t.properties.contentObj.hide_load_block():t.open_form("region",$(this).attr("index"))}))}})},this.load_regions=function(e){$.ajax({url:t.properties.siteUrl+t.properties.load_region_link+e,dataType:"json",cache:!1,success:function(e){for(var o in $("#"+t.properties.id_items).unbind(),$("#"+t.properties.id_items).empty(),e.items)$("#"+t.properties.id_items).append('<li index="'+e.items[o].id+'">'+e.items[o].name+"</li>");$("#"+t.properties.id_items+" li").on("click",(function(){t.set_values("region",$(this).attr("index"),$(this).text(),e),"region"==t.properties.select_type?t.properties.contentObj.hide_load_block():t.open_form("city",$(this).attr("index"))}))}})},this.load_cities=function(e,o,r){if(""!=o)var i="POST",n={search:o};else i="GET",n={};$.ajax({url:t.properties.siteUrl+t.properties.load_city_link+e+"/"+r,dataType:"json",type:i,data:n,cache:!1,success:function(e){for(var r in $("#"+t.properties.id_items).unbind(),$("#"+t.properties.id_items).empty(),e.items)$("#"+t.properties.id_items).append('<li index="'+e.items[r].id+'">'+e.items[r].name+"</li>");t.generate_city_pages(e.pages,e.current_page,o),$("#"+t.properties.id_items+" li").on("click",(function(){t.set_values("city",$(this).attr("index"),$(this).text(),e),t.properties.contentObj.hide_load_block()}))}})},this.set_values=function(e,o,r,i){var n="";"country"==e?($("#"+t.properties.id_hidden_country).val(o.toString()).change(),t.properties.id_country=o.toString(),$("#"+t.properties.id_hidden_region).val(0).change(),t.properties.id_region=0,$("#"+t.properties.id_hidden_city).val(0).change(),t.properties.id_city=0,n=r):"region"==e?($("#"+t.properties.id_hidden_region).val(o).change(),t.properties.id_region=o,$("#"+t.properties.id_hidden_city).val(0).change(),t.properties.id_city=0,n=i.country.name+", "+r):"city"==e&&($("#"+t.properties.id_hidden_city).val(o).change(),t.properties.id_city=o,1===t.properties.isRadius&&$("#"+t.properties.id_hidden_city).change((function(){i.city.longitude>0&&i.city.latitude>0?$(".radius-block").removeClass("hide"):$(".radius-block").addClass("hide")})),n=i.country.name+", "+i.region.name+", "+r),""==n&&(n="..."),$("#"+t.properties.id_span).text(n)},this.set_values_external=function(e,o){$.ajax({url:t.properties.siteUrl+t.properties.load_data+e+"/"+o,dataType:"json",cache:!1,success:function(r){"country"==e?t.set_values(e,o,r.country.name,r):"region"==e?t.set_values(e,o,r.region.name,r):"city"==e&&t.set_values(e,o,r.city.name,r)}})},this.generate_city_pages=function(e,o,r){if($("#"+t.properties.id_city_page+" a").unbind(),$("#"+t.properties.id_city_page).empty(),e>1){for(var i=1;i<=e;i++)i==o?$("#"+t.properties.id_city_page).append("<strong>"+i+"</strong>"):$("#"+t.properties.id_city_page).append('<a href="#">'+i+"</a>");$("#"+t.properties.id_city_page+" a").on("click",(function(){return t.load_cities(t.properties.id_region,r,$(this).text()),!1}))}},this.clearBox=function(){$("#"+t.properties.id_span).text("..."),$("#"+t.properties.id_hidden_country).val(""),t.properties.id_country="",$("#"+t.properties.id_hidden_region).val(""),t.properties.id_region="",$("#"+t.properties.id_hidden_city).val(""),t.properties.id_city="",t.properties.contentObj.hide_load_block()},t.Init(e)})},4366:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.dashboardAdmin=function(e){"use strict";this.properties={siteUrl:"/",tempScrollTop:0,visibilityDashboard:"visibility-dashboard",cookiePath:"/",cookieDomain:"",trial:!1,position:"rtl"===site_rtl_settings?"left":"right",id:{dashboard:"#dashboard",topNav:"#top_nav",scrollTop:"#scroll-top",eventBlock:"#event-block-",dashboardVisibilityBtn:"#dashboard-visibility-btn"},cssClass:{dashboardAction:".js-dashboard-action",dashboardDeployed:".dashboard-deployed-js",dashboardMinimized:".dashboard-minimized-js",quickStats:".quick-stats-js",dashboardVisibilityBtn:".dashboard-visibility-btn"},dataAction:{event:'[data-action="event"]',top:'[data-action="top"]'},action:!1,langs:{},errorObj:new Errors,contentObj:null};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),t.scrollBlock(),t.scrollToEventBlock(),t.visibilityDashboard(),$(window).trigger("scroll")},this.initControls=function(){$(document).off("click",t.properties.cssClass.dashboardAction).on("click",t.properties.cssClass.dashboardAction,(function(e){t.dashboardAction(e,$(this))})).off("click",t.properties.id.scrollTop).on("click",t.properties.id.scrollTop,(function(){t.scrollToTop()})).off("click",t.properties.cssClass.dashboardVisibilityBtn).on("click",t.properties.cssClass.dashboardVisibilityBtn,(function(e){if($(e.target).closest(".modal").length)return!1;var o="1"===t.getCookie(t.properties.visibilityDashboard)?0:1;t.setCookie(t.properties.visibilityDashboard,o,{expires:3600,path:t.properties.cookiePath,domain:t.properties.cookieDomain}),t.visibilityDashboard()})).off("ifChanged",'input[name="rejection_reason"]').on("ifChanged",'input[name="rejection_reason"]',(function(){var e=$(this).val();$(".btn-moder-action-js").attr("href",t.properties.action+e+"/1"),$("#moderation_block").find(".alert-danger").addClass("hide")})).off("click",".btn-moder-action-js").on("click",".btn-moder-action-js",(function(e){if(!1===$('input[name="rejection_reason"]').is(":checked"))return $("#moderation_block").find(".alert-danger").removeClass("hide"),!1;e.preventDefault(),e.stopPropagation();var o=$(this);$.get(o.prop("href"),{},(function(){var e=o.closest(t.properties.dataAction.event).data("id");void 0!==e?(sessionStorage.eventId=e,location.reload()):locationHref(t.properties.siteUrl+"admin/"+t.properties.id.eventBlock+e)}))}))},this.dashboardAction=function(e,o){if(e.preventDefault(),e.stopPropagation(),o.data("moderation")&&"network_data"!=o.data("type")){var r='<div id="moderation_block">';for(var i in r+="<h3>"+t.properties.langs.moderation.headerReason+"</h3>",r+='<div class="load_content">',r+='<div class="form-group">',r+="<div>",t.properties.langs.moderation.rejectionReason)r+='<div class="checkbox">',r+='<input type="radio" value="'+i+'" name="rejection_reason" id="rejection-reason-'+i+'" class="flat"><label for="rejection-reason-'+i+'" class="reason-text"> '+t.properties.langs.moderation.rejectionReason[i],r+="</label></div>";r+="</div>",r+="</div>",r+="</div>",r+='<div class="alert alert-danger hide">'+t.properties.langs.moderation.emptyReason+"</div>",r+="</div>",t.properties.contentObj.show_load_block(r),t.properties.action=o.data("href");var n=o.data("title");return $(".btn-moder-action-js").text(n).attr("href",t.properties.action),!1}$.get(o.prop("href"),{is_not_redirect:1},(function(){var e=o.closest(t.properties.dataAction.event).data("id");void 0!==e?(sessionStorage.eventId=e,location.reload()):locationHref(t.properties.siteUrl+"admin/"+t.properties.id.eventBlock+e)}))},this.isScrolledIntoView=function(e){var t=$(window).scrollTop(),o=t+$(window).height(),r=$(e).offset().top;return r+$(e).height()<=o&&r>=t},this.scrollBlock=function(){var e=$(t.properties.id.topNav).height()-40;t.properties.trial;var o=$(t.properties.id.dashboard+" .dashboard__content");o.scroll((function(){$(this).scrollTop()>e?$(t.properties.id.scrollTop).fadeIn():$(t.properties.id.scrollTop).fadeOut()})),$(window).scroll((function(){t.isScrolledIntoView("footer")?$(t.properties.id.dashboard).css("bottom","20px"):$(t.properties.id.dashboard).css("bottom","-10px"),$(this).scrollTop()>e?($(t.properties.id.dashboard).css("top","0px"),o.css("margin-top","-"+e+"px")):(!1!==t.properties.trial&&"undefined"!=typeof isFramed?isFramed?$(t.properties.id.dashboard).css("top","40px"):$("#demo-panel").is(":visible")?$(t.properties.id.dashboard).css("top","167px"):$(t.properties.id.dashboard).css("top","70px"):$(t.properties.id.dashboard).css("top","40px"),o.css("margin-top","-"+$(this).scrollTop()+"px"))}))},this.scrollToTop=function(){$(t.properties.id.dashboard+" .dashboard__content").animate({scrollTop:$(t.properties.dataAction.top).offset().top},1e3)},this.scrollToEventBlock=function(){if(void 0!==sessionStorage.eventId){var e=sessionStorage.eventId;(navigator.userAgent.match(/Firefox/)?$("body, html"):$(t.properties.id.dashboard+" .dashboard__content")).animate({scrollTop:$(t.properties.id.eventBlock+e).offset().top-50},500),delete sessionStorage.eventId}},this.visibilityDashboard=function(){var e=$(window).width();if("1"===t.getCookie(t.properties.visibilityDashboard)){$(t.properties.id.dashboard).css(t.properties.position,"-350px"),$(t.properties.id.dashboard+" + div").css("padding-"+t.properties.position,"0"),$(t.properties.cssClass.dashboardMinimized).show(),$(t.properties.cssClass.dashboardDeployed).hide(),$(t.properties.cssClass.quickStats).removeClass("open");var o=8*$(t.properties.cssClass.dashboardMinimized+">div:first").text().length;$(t.properties.id.dashboardVisibilityBtn).css({position:"fixed","padding-top":o+"px"}),$(t.properties.id.dashboardVisibilityBtn).css(t.properties.position,"0")}else{if(e<="470"){var r=e-120;$(t.properties.id.dashboard).css("width",r+"px"),$(t.properties.id.dashboardVisibilityBtn).css({position:"absolute","padding-top":"0"}),$(t.properties.id.dashboardVisibilityBtn).css(t.properties.position,r+"px"),$(t.properties.id.dashboard+" + div").css("padding-"+t.properties.position,r+"px"),$(t.properties.id.dashboard).find("img").css("width",r-100+"px"),$(t.properties.cssClass.quickStats).removeClass("open")}else $(t.properties.id.dashboardVisibilityBtn).css({position:"absolute","padding-top":"0"}),$(t.properties.id.dashboardVisibilityBtn).css(t.properties.position,"349px"),$(t.properties.id.dashboard+" + div").css("padding-"+t.properties.position,"350px"),$(t.properties.cssClass.quickStats).addClass("open");$(t.properties.id.dashboard).css(t.properties.position,"0"),$(t.properties.cssClass.dashboardMinimized).hide(),$(t.properties.cssClass.dashboardDeployed).show()}},this.setCookie=function(e,t,o){var r=(o=o||{}).expires;if("number"==typeof r&&r){var i=new Date;i.setTime(i.getTime()+60*r*1e3),r=o.expires=i}r&&r.toUTCString&&(o.expires=r.toUTCString());var n=e+"="+(t=encodeURIComponent(t));for(var s in o){n+="; "+s;var a=o[s];!0!==a&&(n+="="+a)}document.cookie=n},this.getCookie=function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},t.Init(e)})},3636:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.EventsAvatar=function(e){this.properties={site_url:"",load_avatar_url:"events/ajaxLoadAvatar/",photo_id:"event_photo",id_event:0,recrop_url:"events/ajaxRecropAvatar/",recrop_container_id:"photo_source_recrop_box",recrop_img_id:"photo_source_recrop",photo_sizes_id:"photo_sizes",image_content_id:"image_content_avatar",menu_container_id:"media_menu",recropMenuContainer:"#recrop_menu",image_css_size:{width:700,height:500},selections:[],section:"",saveAfterSelect:!1,window_obj:new loadingContent({loadBlockWidth:"800px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1})};var t={},o=null;this.imageareaselect=null,this.selections=[],this.index=0,this.img=new Image,this.image_css_size={width:0,height:0};var r=this;return this.Init=function(e){return r.properties=$.extend(r.properties,e),r.init_window_obj(),t.avatar_obj=$("#"+r.properties.photo_id),t.avatar_obj.off("click").on("click",(function(){r.load_avatar()})),this},this.init_window_obj=function(){var e=new loadingContent({loadBlockWidth:"800px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1});r.properties.window_obj=e},this.destroy_window=function(){r.properties.window_obj.hide_load_block(),r.properties.window_obj.destroy()},this.uninit=function(){return r.uninit_imageareaselect(),t.avatar_obj.off(),this},this.load_avatar=function(){$.ajax({url:r.properties.site_url+r.properties.load_avatar_url,type:"POST",data:{id_event:r.properties.id_event},dataType:"json",cache:!1,success:function(e){e.status&&(r.properties.window_obj.changeTemplate("gallery"),r.properties.window_obj.show_load_block(e.data.html),r.selections=[],r.properties.selections=e.data.selections,r.add_selections(r.properties.selections)),e.errors.length&&error_object.show_error_block(e.errors,"error")}})},this.add_selection=function(e,t,o,i,n){return r.selections.push({prefix:e,x1:t,y1:o,width:i,height:n,orig_width:i,orig_height:n}),this},this.add_selections=function(e){for(var t in e)e.hasOwnProperty(t)&&r.add_selection(t,0,0,parseInt(e[t].width),parseInt(e[t].height))},this.recrop=function(){return o&&"pending"==o.state()?o:o=$.ajax({url:r.properties.site_url+r.properties.recrop_url,type:"POST",data:{selections:r.selections[r.index],event_id:r.properties.id_event},dataType:"json",cache:!1,success:function(e){e.status?e.data.img_url&&$('img[src^="'+e.data.img_url+'"]').attr("src",e.data.img_url+"?"+(new Date).getTime()):e.errors.length&&error_object.show_error_block(e.errors,"error"),e.msg.length&&error_object.show_error_block(e.msg,"success")}})},this.init_imageareaselect=function(){return t.img_obj=$("#"+r.properties.recrop_img_id),t.photo_sizes_obj=$("#"+r.properties.photo_sizes_id),t.image_content_obj=$("#"+r.properties.image_content_id),t.image_content_obj.off("click","#"+r.properties.menu_container_id+" [data-section]").on("click","#"+r.properties.menu_container_id+" [data-section]",(function(){if("recrop"===$(this).data("section")&&r.selections.length){for(var e in t.image_content_obj.find('[data-area="view"]').hide(),t.image_content_obj.find('[data-area="recrop"]').show(),r.index=0,t.photo_sizes_obj.html(""),r.selections)r.selections.hasOwnProperty(e)&&t.photo_sizes_obj.append('<li><span data-index="'+e+'">'+r.selections[e].orig_width+"x"+r.selections[e].orig_height+"</span></li>");if(t.photo_sizes_obj.find("li").removeClass("active").eq(r.index).addClass("active"),t.photo_sizes_obj.off("click","li span").on("click","li span",(function(){var e=$(this).data("index");return e>=r.selections.length||e==r.index||(r.index=e,r.change_selection(),t.photo_sizes_obj.find("li").removeClass("active"),$(this).parent().addClass("active")),!1})),$("#"+r.properties.recrop_container_id).off("recrop:do").on("recrop:do",(function(){r.recrop()})),$.isEmptyObject(r.selections))return;r.img.src=t.img_obj.attr("src"),r.img.onload=function(){r.img.width?t.image_ready():t.img_obj.off("load").on("load",(function(){t.image_ready()}))}}else t.image_content_obj.find('[data-area="view"]').show(),r.imageareaselect&&r.imageareaselect.setOptions({hide:!0});$(this).parents("ul").find("li").removeClass("active"),$(this).parent().addClass("active")})),$("#"+r.properties.menu_container_id).find('[data-section="'+r.properties.section+'"]').parent().addClass("active"),$("#"+r.properties.menu_container_id+" .active span").click(),t.image_content_obj.off("click",r.properties.recropMenuContainer+" [data-section]").on("click",r.properties.recropMenuContainer+" [data-section]",(function(){"view"===$(this).data("section")&&(t.image_content_obj.find('[data-area="recrop"]').hide(),t.image_content_obj.find('[data-area="view"]').show())})),this},t.image_ready=function(e){for(e=e||0;(!t.img_obj.width()||!t.img_obj.height())&&e<60;)return setTimeout((function(){t.image_ready(++e)}),50),this;r.image_css_size={width:t.img_obj.width(),height:t.img_obj.height()},r.selections=[],r.add_selections(r.properties.selections),r.recalc_selection(),r.imageareaselect=t.img_obj.imgAreaSelect({handles:!0,persistent:!0,aspectRatio:r.selections[r.index].width+":"+r.selections[r.index].height,minWidth:r.selections[r.index].width,minHeight:r.selections[r.index].height,imageWidth:r.img.width,imageHeight:r.img.height,instance:!0,parent:"#"+r.properties.recrop_container_id,x1:r.selections[r.index].x1,y1:r.selections[r.index].y1,x2:r.selections[r.index].x1+r.selections[r.index].width,y2:r.selections[r.index].y1+r.selections[r.index].height,zIndex:2,onSelectStart:function(e,o){t.hide_recrop_btn(this)},onSelectEnd:function(e,o){o.width&&o.height&&(r.properties.saveAfterSelect?r.recrop():t.show_recrop_btn(this),r.selections[r.index].x1=Math.min(o.x1,o.x2),r.selections[r.index].y1=Math.min(o.y1,o.y2),r.selections[r.index].width=o.width,r.selections[r.index].height=o.height)},onSelectChange:function(e,o){o.width&&o.height&&(t.hide_recrop_btn(this),r.selections[r.index].x1=Math.min(o.x1,o.x2),r.selections[r.index].y1=Math.min(o.y1,o.y2),r.selections[r.index].width=o.width,r.selections[r.index].height=o.height)},onInit:function(e,o){t.show_recrop_btn(this)}})},t.show_recrop_btn=function(e){var t=$(e.parent).find("."+e.classPrefix+"-selection"),o=$('<div class="selection-recrop-btn" onmouseup="$(\'#'+r.properties.recrop_container_id+"').trigger('recrop:do');\"></div>");t.html(o)},t.hide_recrop_btn=function(e){$(e.parent).find("."+e.classPrefix+"-selection").html("")},this.uninit_imageareaselect=function(){return t.img_obj&&t.img_obj.off(),t.photo_sizes_obj&&t.photo_sizes_obj.off(),t.image_content_obj&&t.image_content_obj.off(),$("#"+r.properties.recrop_container_id).off(),r.imageareaselect=null,r.selections=[],r.index=0,this},this.change_selection=function(){var e=r.selections[r.index];return r.imageareaselect.setOptions({aspectRatio:e.width+":"+e.height,minWidth:e.width,minHeight:e.height,x1:e.x1,y1:e.y1,x2:e.x1+e.width,y2:e.y1+e.height}),r.imageareaselect.update(!1),this},this.recalc_selection=function(){var e=r.img.height/r.image_css_size.height,t=r.img.width/r.image_css_size.width;for(var o in r.selections)if(r.selections.hasOwnProperty(o))if(r.img.width<r.selections[o].width||r.img.height<r.selections[o].height){var i;r.img.width<r.selections[o].width&&(i=r.img.width/r.selections[o].width,r.selections[o].width*=i,r.selections[o].height*=i),r.img.height<r.selections[o].height&&(i=r.img.height/r.selections[o].height,r.selections[o].width*=i,r.selections[o].height*=i)}else{var n=r.selections[o].width*t,s=r.selections[o].height*e;n>=r.selections[o].width&&n<r.img.width&&s>=r.selections[o].height&&s<r.img.height&&(r.selections[o].width=n,r.selections[o].height=s);var a=Math.round(r.img.width/2-r.selections[o].width/2);a<0&&(a=0);var c=Math.round(r.img.height/2-r.selections[o].height/2);c<0&&(c=0),r.selections[o].x1=a,r.selections[o].y1=c}return this},r.Init(e),this})},7417:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Events=function(e){this.properties={siteUrl:"",profile_id:null,is_admin:null,profile:{},lang:{},limits:10,compared:0,btn_id:"btn-event",event_content_id:"event_content",name_id:"event_name",image_id:"event_image",btn_compare_id:"btn_compare",btn_more_id:"btn_more",btn_conversation_class:"chatbox_connect",btn_invite_users:"invite_users_block",last_event_id:"last_event",next_event_id:"next_event",event_action_id:"event_action_",event_id:"event_",actions_block:"event-actions",event_action_class:"event-action",btn_delete_user:"delete-user",load_events_url:"events/ajaxLoadEvents",view_events_url:"events/ajaxViewEvents",set_compare_url:"events/ajaxSetCompare",set_answer_url:"events/ajaxSetAnswer",change_status_url:"events/ajaxChangeStatus",set_chatbox_url:"chatbox/chat/",set_invite_users_url:"events/ajaxLoadUsers",approve_users_block_url:"events/ajaxGetApprovedList",approve_users_block:"participants_block",common_ancestor:"body",lang_delete_confirm:"",contentObj:new loadingContent({loadBlockWidth:"400px",loadBlockLeftType:"center",loadBlockTopType:"top",loadBlockTopPoint:100,closeBtnClass:"w",draggable:!0}),mailboxObj:new loadingContent({loadBlockWidth:"800px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1})},this.data={event_id:""};var t=this,o={};this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_controls()},this.init_controls=function(){$("#"+t.properties.btn_id).off("click").on("click",(function(){t.loadEvents()})),$("#"+t.properties.btn_more_id).off("click").on("click",(function(){t.getEvent()})),$("#"+t.properties.btn_compare_id).off("click").on("click",(function(){t.setCompare($(this).data("id"))})),$("#"+t.properties.last_event_id).off("click").on("click",(function(){t.getLastEvent()})),$("#"+t.properties.next_event_id).off("click").on("click",(function(){t.getNextEvent()})),$("."+t.properties.event_action_class+">a").off("click").on("click",(function(){t.answeEvent($(this).data("id"),$(this).data("answer"))})),$("."+t.properties.btn_conversation_class).off("click").on("click",(function(){if(t.properties.is_admin)e=t.properties.siteUrl+"tickets",window.open(e);else{var e=t.properties.siteUrl+t.properties.set_chatbox_url+t.properties.profile_id;window.open(e)}})),$("."+t.properties.actions_block).off().on("click",'[data-click="change-status"]',(function(){t.changeStatus($(this).attr("data-status"))})),$("#"+t.properties.btn_invite_users).off().on("click",(function(){t.loadUsers()})),t.initDeleteUserButton()},this.initDeleteUserButton=function(){$("."+t.properties.btn_delete_user).off().on("click",(function(e){e.preventDefault();var o=$(this).attr("href"),r=t.properties.lang_delete_confirm;return alerts.show({text:r,type:"confirm",ok_callback:function(){t.deleteUser(o)}}),!1}))},this.loadEvents=function(){t.properties.compared?error_object.show_error_block(t.properties.lang.already_sent,"error"):$.ajax({type:"POST",dataType:"html",url:t.properties.siteUrl+t.properties.load_events_url,success:function(e){t.getEvent(e)},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.getEvent=function(e){if(void 0===o.count_events){var r={profile_id:t.properties.profile_id,limits:t.properties.limits};$.ajax({type:"POST",dataType:"JSON",url:t.properties.siteUrl+t.properties.view_events_url,data:r,success:function(r){if(0!=r.length){for(var i in void 0!==e&&t.properties.contentObj.show_load_block(e),o.count_events=r.length,o.event_obj=[],r)o.event_obj.push(r[i]);o.event_last_key=o.count_events-1,t.viewEvent(0)}else t.properties.contentObj.hide_load_block(),$("#"+t.properties.btn_id).find("i").addClass("g"),error_object.show_error_block(t.properties.lang.events_empty,"error")},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})}else o.event_key>=o.count_events?(o.event_last_key=o.count_events-1,t.appendEvents()):t.viewEvent(o.event_key)},this.getLastEvent=function(){if(o.event_key<=1)t.viewEvent(o.event_last_key);else{var e=parseInt(o.event_key)-2;t.viewEvent(e)}},this.getNextEvent=function(){t.getEvent()},this.viewEvent=function(e){if(o.event_key=parseInt(e)+1,1==t.checkImage(e)){var r="";$("#"+t.properties.event_content_id).html((function(i,n){return r+='<div class="mtb10 ib">',r+='<div id="'+t.properties.last_event_id+'" class="icon-chevron-left hover fleft pointer"></div>',r+='<div id="'+t.properties.image_id+'" class="mlr20 fleft"><img src="'+o.event_obj[e].image.thumbs.big+'"></div>',r+='<div id="'+t.properties.next_event_id+'" class="icon-chevron-right hover fleft pointer"></div>',r+="</div>",r+='<div class="clr"></div>',r+='<div class="mtb10" id="'+t.properties.name_id+'">'+o.event_obj[e].name+"</div>",r+='<div class="mtb10"><input data-id="'+o.event_obj[e].id+'" type="button" id="'+t.properties.btn_compare_id+'" value="'+t.properties.lang.compare+'" name="compare" >&nbsp;<input type="button" id="'+t.properties.btn_more_id+'" value="'+t.properties.lang.more+'" name="more" ></div>'})),$("#"+t.properties.last_event_id).css("margin-top","35%"),$("#"+t.properties.next_event_id).css("margin-top","35%")}else t.getNextEvent()},this.appendEvents=function(){var e={profile_id:t.properties.profile_id,limits:t.properties.limits,last_id:o.event_obj[o.event_last_key].id};$.ajax({type:"POST",dataType:"JSON",url:t.properties.siteUrl+t.properties.view_events_url,data:e,success:function(e){if(e.length){for(var r in o.count_events=o.count_events+e.length,e)o.event_obj.push(e[r]);t.viewEvent(o.event_last_key+1)}else t.viewEvent(0)},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.checkImage=function(e){var t=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;if(!t)throw new Error("XMLHttpRequest not supported");return t.open("HEAD",o.event_obj[e].image.thumbs.big,!1),t.send(null),200==t.status||(o.event_obj.splice(e,1),o.count_events=o.count_events>0?o.count_events-1:0,!1)},this.setCompare=function(e){var o={event_id:e,profile_id:t.properties.profile_id};$.ajax({type:"POST",dataType:"JSON",url:t.properties.siteUrl+t.properties.set_compare_url,data:o,success:function(e){e.error||($("#"+t.properties.btn_id).find("i").addClass("g"),t.properties.compared=1),t.properties.contentObj.hide_load_block(),error_object.show_error_block(e,"error")},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.answeEvent=function(e,o){var r={event_id:e,answer:o};$.ajax({type:"POST",dataType:"JSON",url:t.properties.siteUrl+t.properties.set_answer_url,data:r,success:function(r){if(r.success){var i=t.createAnswer(o);$("#"+t.properties.event_action_id+e).html(""),$("#"+t.properties.event_id+e).append(i)}},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.createAnswer=function(e){return'<div class="fright answer"><div class="content fleft"><i class="icon-caret-right icon-4x fltr"></i><div class="event-block">'+t.properties.lang.answer[e]+'</div></div><div class="image small fright"><img src="'+t.properties.profile.media.user_logo.thumbs.small+'" alt="'+t.properties.profile.nickname+'" title="'+t.properties.profile.nickname+'" /><div>'+t.properties.profile.nickname+", "+t.properties.profile.age+"</div></div></div>"},this.escapeRegExp=function(e){return e.replace(/[]/g,"\\$&")},this.addJSParams=function(e){var o=new RegExp(t.escapeRegExp("siteUrl: site_url,").replace(/[]/g,"|"),"gi");return e.replace(o,"$& singleton: 0,")},this.changeStatus=function(e){$.ajax({type:"POST",dataType:"json",url:t.properties.siteUrl+t.properties.change_status_url+"/"+t.data.event_id+"/"+e,success:function(e){e.success&&error_object.show_error_block(e.success,"success"),locationHref(t.properties.siteUrl+"events/view/"+t.data.event_id)}})},this.loadUsers=function(){$.ajax({type:"POST",dataType:"json",url:t.properties.siteUrl+t.properties.set_invite_users_url+"/"+t.data.event_id,success:function(e){e.content&&t.properties.contentObj.show_load_block(e.content)}})},this.deleteUser=function(e){$.ajax({type:"POST",dataType:"json",url:e,success:function(e){e.success&&(t.updateUsersBlock(),error_object.show_error_block(e.success,"success"))}})},this.updateUsersBlock=function(){$.ajax({type:"POST",dataType:"json",url:t.properties.siteUrl+t.properties.approve_users_block_url+"/"+this.data.event_id,success:function(e){e.content&&($("#"+t.properties.approve_users_block).html(e.content),t.initDeleteUserButton())}})},t.Init(e)})},5032:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.eventsCalendar=function(e){this.properties={siteUrl:"/",current_month:0,calendar_block_class:"events-list",btn_prev_month:"btn_prev_month",btn_curr_month:"btn_curr_month",btn_next_month:"btn_next_month",change_month_url:"events/ajaxChangeMonth",searchType:""};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_controls()},this.init_controls=function(){$("#"+t.properties.btn_prev_month).off("click").on("click",(function(){t.prevMonth()})),$("#"+t.properties.btn_curr_month).off("click").on("click",(function(){t.currMonth()})),$("#"+t.properties.btn_next_month).off("click").on("click",(function(){t.nextMonth()}))},this.prevMonth=function(){t.properties.current_month--,t.changeMonth()},this.currMonth=function(){t.properties.current_month=0,t.changeMonth()},this.nextMonth=function(){t.properties.current_month++,t.changeMonth()},this.changeMonth=function(){$.ajax({type:"POST",dataType:"json",data:{month:t.properties.current_month,search_type:t.properties.searchType},url:t.properties.siteUrl+t.properties.change_month_url,success:function(e){$("."+t.properties.calendar_block_class).html(e.content)}})},t.Init(e)})},2972:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.events_media=function(e){this.properties={gallery_name:"mediagallery",siteUrl:"/",idUser:0,is_guest:!1,addPhotoID:"add_photo",addPhotoUrl:"media/ajax_add_images",deleteMediaUrl:"media/delete_",deleteMediaUrlReplace:"media/ajax_delete_",viewMediaUrl:"media/ajax_view_media",galleryContentDiv:"gallery_content",galleryContentUrl:"media/ajax_get_list",recentMediaUrl:"media/ajax_get_recent_media",galleryContentParam:"all",galleryContentPage:1,galleryPageContent:".media-button-content",galleryPageButton:"#media_button",filterObj:"#filters",menuAlbumItem:"albums",albumSelectorContainer:"#album_id_container",albumSelector:"#album_id",albumId:0,addVideoID:"add_video",addVideoUrl:"media/ajax_add_video",uploadVideoForm:"#upload_video",addAudioID:"add_audio",addAudioUrl:"media/ajax_add_audio",uploadVAudioForm:"#upload_audio",sorterId:"media_sorter",refreshRecentPhotosButton:"#refresh_recent_photos",refreshRecentPhotosDiv:"#recent_photo",load_on_scroll:0,all_loaded:0,loading_status:0,lang_delete_confirm:"Are you sure you want to delete this file?",lang_delete_confirm_album:"Do you really want to delete the album?",order:"date_add",direction:"desc",post_data:{},place:"user_gallery",windowObj:null};var t=null,o={},r=this;this.Init=function(e){r.properties=$.extend(r.properties,e),r.properties.windowObj||(r.properties.windowObj=new loadingContent({loadBlockWidth:"500px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1})),r.init_links(),r.init_filters(),r.init_sorter(),r.init_global_events(),r.properties.load_on_scroll&&setTimeout((function(){r.setLoadOnScroll()}),500),r.init_item_block_info()},this.uninit=function(){$(window).unbind("scroll.media").off("changeParam.gallery"),$("#"+r.properties.galleryContentDiv).off(),$("#"+r.properties.addPhotoID).unbind(),$("#"+r.properties.addVideoID).unbind(),$("#"+r.properties.addAudioID).unbind(),$(r.properties.galleryPageButton).unbind(),$(r.properties.filterObj).find("li").unbind(),$(r.properties.albumSelectorContainer).off(),$("#"+r.properties.sorterId).off()},this.init_item_block_info=function(){$("#"+r.properties.galleryContentDiv).off("click",'[data-click="album"]').on("click",'[data-click="album"]',(function(e){e.preventDefault();var t=$(this).parents("[data-album-id]").attr("data-album-id");return r.properties.idUser=$(this).data("user-id")||r.properties.idUser,t&&$(r.properties.albumSelector).val(t).prop("selected","selected").change(),!1})).off("click",'[data-click="view-media"]').on("click",'[data-click="view-media"]',(function(e){e.preventDefault(),r.properties.idUser=$(this).data("user-id")||r.properties.idUser,$(this).data("id-album")&&(r.properties.albumId=$(this).data("id-album")),$(this).data("place")&&(r.properties.place=$(this).data("place"));var t=$(this).data("id-media");return r.display_edit_view_form(t),!1})).off("click",".delete-media").on("click",".delete-media",(function(e){e.preventDefault();var t=$(this).attr("href");if($(this).attr("data-album-id"))o=r.properties.lang_delete_confirm_album;else var o=r.properties.lang_delete_confirm;var i=t.replace(r.properties.deleteMediaUrl,r.properties.deleteMediaUrlReplace);return alerts.show({text:o,type:"confirm",ok_callback:function(){r.delete_media(i)}}),!1})).off("mouseenter",".photo").on("mouseenter",".photo",(function(){$(this).find(".info").stop().slideDown(100)})).off("mouseleave",".photo").on("mouseleave",".photo",(function(){$(this).find(".info").stop(!0).delay(100).slideUp(100)})),$("#remove_wide").off("click").on("click",(function(e){e.preventDefault();var t=$(this).attr("href");if($(this).attr("data-album-id"))o=r.properties.lang_delete_confirm_album;else var o=r.properties.lang_delete_confirm;var i=t.replace(r.properties.deleteMediaUrl,r.properties.deleteMediaUrlReplace);return alerts.show({text:o,type:"confirm",ok_callback:function(){r.delete_media(i)}}),!1}))},this.init_links=function(){$("#"+r.properties.addPhotoID).unbind("click").on("click",(function(){r.display_upload_photos_form()})),$("#"+r.properties.addVideoID).unbind("click").on("click",(function(){r.display_upload_video_form()})),$("#"+r.properties.addAudioID).unbind("click").on("click",(function(){r.display_upload_audio_form()})),$(r.properties.galleryPageButton).unbind("click").on("click",(function(){r.next_page()})),$(r.properties.refreshRecentPhotosButton).unbind("click").on("click",(function(){r.refresh_recent_photos()}))},this.init_filters=function(){$(r.properties.filterObj).find("li").each((function(){var e=$(this).attr("data-param");r.properties.galleryContentParam==e&&$(this).addClass("active"),$(this).on("click",(function(){$(r.properties.filterObj).find("li").removeClass("active"),$(this).addClass("active");var e=$(this).attr("data-param");e==r.properties.menuAlbumItem?($(r.properties.albumSelectorContainer).stop(!0).fadeIn(),$("#"+r.properties.sorterId).hide()):($(r.properties.albumSelectorContainer).hide(),$("#"+r.properties.sorterId).stop(!0).fadeIn()),r.properties.galleryContentParam=e,r.properties.albumId=0,r.reload()}))})),$(r.properties.albumSelectorContainer).off("change",r.properties.albumSelector).on("change",r.properties.albumSelector,(function(){r.properties.albumId=$(this).val(),r.properties.albumId>0?$("#"+r.properties.sorterId).stop(!0).fadeIn():$("#"+r.properties.sorterId).hide(),r.reload()}))},this.init_sorter=function(){$("#"+r.properties.sorterId).off("change","select").on("change","select",(function(){r.load_content(1,!0)})),$("#"+r.properties.sorterId).off("click",'[data-role="sorter-dir"]').on("click",'[data-role="sorter-dir"]',(function(){$(this).hasClass("up")?$(this).removeClass("up").addClass("down"):$(this).removeClass("down").addClass("up"),r.load_content(1,!0)}))},this.init_global_events=function(){$(window).off("changeParam.gallery").on("changeParam.gallery",(function(e,t){r.properties.galleryContentParam=t}))},this.get_post_data=function(){var e=$.extend(r.properties.post_data,{order:r.properties.order,direction:r.properties.direction,gallery_name:r.properties.gallery_name,place:r.properties.place});return $("#"+r.properties.sorterId).length&&(e.order=$("#"+r.properties.sorterId).find("select").val(),e.direction=$("#"+r.properties.sorterId).find('[data-role="sorter-dir"]').hasClass("up")?"asc":"desc"),e},this.next_page=function(){r.properties.galleryContentPage++,r.load_content()},this.display_edit_view_form=function(e){var t=r.get_post_data();$.ajax({url:r.properties.siteUrl+r.properties.viewMediaUrl+"/"+e+"/"+r.properties.idUser+"/"+r.properties.galleryContentParam+"/"+r.properties.albumId,type:"POST",data:t,dataType:"html",cache:!1,success:function(e){r.properties.windowObj.changeTemplate("gallery"),r.properties.windowObj.update_css_styles({width:"962px"}),r.properties.windowObj.show_load_block(e)}})},this.delete_media=function(e){var t=r.get_post_data();$.ajax({url:e,type:"POST",data:t,dataType:"json",cache:!1,success:function(e){1==e.status?(error_object.show_error_block(e.message,"success"),r.refresh_recent_photos()):error_object.show_error_block(e.message,"error")}})},this.reload=function(){r.properties.galleryContentPage=1,r.properties.all_loaded=0,r.load_content(1)},this.display_upload_photos_form=function(){o.display_upload_form("image")},this.display_upload_video_form=function(){o.display_upload_form("video")},this.display_upload_audio_form=function(){o.display_upload_form("audio")},o.display_upload_form=function(e){if(r.properties.is_guest)error_object.errors_access();else{var t,o=r.get_post_data();switch(o.id_album=r.properties.albumId,e){case"image":t=r.properties.addPhotoUrl;break;case"video":t=r.properties.addVideoUrl;break;case"audio":t=r.properties.addAudioUrl}$.ajax({url:r.properties.siteUrl+t,type:"POST",data:o,dataType:"html",cache:!1,success:function(e){r.properties.windowObj.changeTemplate("default"),r.properties.windowObj.update_css_styles({width:"500px"}),r.properties.windowObj.show_load_block(e)}})}},this.load_content=function(e,o){if(o=o||!1)t&&t.abort(),r.properties.galleryContentPage=1;else if(1==r.properties.all_loaded||r.properties.loading_status)return!0;r.properties.loading_status=1;var i=r.get_post_data();t=$.ajax({url:r.properties.siteUrl+r.properties.galleryContentUrl+"/"+r.properties.idUser+"/"+r.properties.galleryContentParam+"/"+r.properties.galleryContentPage+"/"+r.properties.albumId,type:"POST",data:i,dataType:"json",cache:!1,success:function(t){$(r.properties.albumSelector).val(r.properties.albumId).prop("selected","selected"),e?$("#"+r.properties.galleryContentDiv).html(t.content):$("#"+r.properties.galleryContentDiv).append(t.content),t.albums_select&&$(r.properties.albumSelectorContainer).html(t.albums_select),t.have_more?$(r.properties.galleryPageContent).show():(r.properties.load_on_scroll=0,r.properties.all_loaded=1,$(r.properties.galleryPageContent).hide())},complete:function(){r.properties.loading_status=0}})},this.set_properties=function(e){r.properties=$.extend(r.properties,e)},this.setLoadOnScroll=function(){r.properties.load_on_scroll?($(window).scrollTop(0),$(window).on("scroll.media",(function(){var e=$(r.properties.galleryPageContent).offset(),t=window.innerHeight?window.innerHeight:$(window).height();e&&$(window).scrollTop()>=e.top-t+100&&r.next_page()}))):$(window).unbind("scroll.media")},this.refresh_recent_photos=function(){$.ajax({url:r.properties.siteUrl+r.properties.recentMediaUrl,type:"POST",data:{count:16,upload_gid:"photo"},dataType:"html",cache:!1,success:function(e){$(r.properties.refreshRecentPhotosDiv).html(e)}})},r.Init(e)})},5634:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.events_users=function(e){this.properties={siteUrl:"",btnInviteAllId:"invite_users",btnInviteUserClass:"btn-invite-user",checkboxId:"invite_user_",checkboxClass:"events-user-checkbox",checkboxAllId:"invite_user_all",setInviteUrl:"events/ajaxInviteSelect",checkedUsersFieldId:"checked_users",event_id:null,user_id:"",checkedUsersList:new Array,invitedButtonText:""};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_links()},this.init_links=function(){$("#"+t.properties.btnInviteAllId).off("click").on("click",(function(){var e=new Array;$("."+t.properties.checkboxClass+" > input:checked").each((function(t,o){e.push($(o).val())})),t.properties.checkedUsersList=e,t.inviteUsers()})),$("."+t.properties.btnInviteUserClass).off("click").on("click",(function(){var e=$(this).attr("data-user-id");e&&(t.properties.checkedUsersList=e,t.inviteUsers())})),$("."+t.properties.checkboxClass+" > input").off().on("click",(function(){t.toggleInviteButton()})),$("#"+t.properties.checkboxAllId).off().on("click",(function(){t.checkedAll($(this).prop("checked")),t.toggleInviteButton()}))},this.inviteUsers=function(){t.properties.checkedUsersList&&$.ajax({url:t.properties.siteUrl+t.properties.setInviteUrl+"/"+t.properties.event_id,type:"POST",dataType:"json",data:{invited:t.properties.checkedUsersList},cache:!1,success:function(e){var o;if(e.success)for(error_object.show_error_block(e.success,"success"),o=0;o<e.data.users_ids.length;o++)t.setDisabled(e.data.users_ids[o])}})},this.checkedAll=function(e){e?$("."+t.properties.checkboxClass+" > input:enabled").prop("checked",!0):$("."+t.properties.checkboxClass+" > input:enabled").prop("checked",!1)},this.toggleInviteButton=function(){$("."+t.properties.checkboxClass+" > input:checked").length?$("#"+t.properties.btnInviteAllId).prop("disabled",!1):$("#"+t.properties.btnInviteAllId).prop("disabled",!0)},this.setDisabled=function(e){$("."+t.properties.btnInviteUserClass+'[data-user-id="'+e+'"]').prop("disabled",!0).removeClass("btn-primary").val(t.properties.invitedButtonText),$("#"+t.properties.checkboxId+e).prop("disabled",!0).prop("checked",!1)},t.Init(e)})},534:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.fastNavigationAdmin=function(e){this.properties={siteUrl:"/",id:{fastBlock:"fastBlock"},dataAction:{search:'[data-action="fast_search"]',searchLong:'[data-action="fast_search_long"]'},url:{search:"admin/fast_navigation/search/"},langs:{header:"Search",placeholder:"Start typing...",close:"Close"},errorObj:new Errors,contentObj:null};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),t.properties.contentObj=new loadingContent({closeBtnPadding:15,loadBlockSize:"lg",loadBlockTopType:"top",closeBtnLabel:t.properties.langs.close})},this.initControls=function(){$(document).off("keyup",t.properties.dataAction.search).on("keyup",t.properties.dataAction.search,(function(){t.search($(this))})).off("keyup",t.properties.dataAction.searchLong).on("keyup",t.properties.dataAction.searchLong,(function(){t.searchResults($(this))}))},this.searchResults=function(e){var o=e.val();o.length>2?t.query(t.properties.url.search,{keyword:o,send:1},"json",(function(e){$("#"+t.properties.id.fastBlock).html(e.html)})):(t.properties.contentObj.hide_load_block(),$(t.properties.dataAction.search).focus())},this.search=function(e){var o=e.val();o.length>2&&(t.properties.contentObj.show_load_block(t.wrapBlock()),$(t.properties.dataAction.searchLong).focus().val(o))},this.wrapBlock=function(){var e="<div>";return e+="  <h3>"+t.properties.langs.header+"</h3>",e+='  <div class="load_content"><div class="mb20">',e+='      <input data-action="fast_search_long" type="text" name="keyword" class="form-control" placeholder="'+t.properties.langs.placeholder+'" required>',e+="  </div>",(e+='  <div class="x_panel" id="'+t.properties.id.fastBlock+'"></div></div>')+"</div>"},this.query=function(e,o,r,i){return/^(f|ht)tps?:\/\//i.test(e)||(e=t.properties.siteUrl+e),$.ajax({url:e,type:"POST",cache:!1,data:o,dataType:r,success:function(e){void 0!==e.error&&e.error.length>0&&t.properties.errorObj.show_error_block(e.errors,"error"),void 0!==e.success&&e.success.length>0&&t.properties.errorObj.show_error_block(e.success,"success"),void 0!==i&&i(e)}}),!1},t.Init(e)})},3145:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.favorites=function(e){this.properties={siteUrl:"/",addUserButton:".add_to_fav",removeUserButton:".remove_from_fav",addUserUrl:"favorites/ajax_add/",removeUserUrl:"favorites/ajax_remove/",favId:"#fav_",toggle:!0,contentObj:new loadingContent({loadBlockWidth:"50%",closeBtnClass:"w",scroll:!0,closeBtnPadding:5,blockBody:!0})};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_objects(),t.init_controls()},this.uninit=function(){t.add_user_btn.off("click"),t.remove_user_btn.off("click")},this.init_objects=function(){t.add_user_btn=$(t.properties.addUserButton),t.remove_user_btn=$(t.properties.removeUserButton)},this.init_controls=function(){t.add_user_btn.off("click").on("click",(function(){return t.add_user($(this).data("user_id")),!1})),t.remove_user_btn.off("click").on("click",(function(){return t.remove_user($(this).data("user_id")),!1}))},this.setBtn=function(e,o){"add"===o?($(e+" "+t.properties.addUserButton).removeClass("hide"),$(e+" "+t.properties.removeUserButton).addClass("hide")):"remove"===o&&($(e+" "+t.properties.addUserButton).addClass("hide"),$(e+" "+t.properties.removeUserButton).removeClass("hide"))},this.add_user=function(e){o(t.properties.addUserUrl,e,(function(){t.properties.toggle?t.setBtn(t.properties.favId+e,"remove"):$(t.properties.favId+e).remove()}))},this.remove_user=function(e){o(t.properties.removeUserUrl,e,(function(){t.properties.toggle?t.setBtn(t.properties.favId+e,"add"):$(t.properties.favId+e).remove()}))};var o=function(e,o,r){$.ajax({url:t.properties.siteUrl+e+o,type:"GET",dataType:"json",cache:!1,success:function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return t.properties.contentObj.show_load_block(e.info.access_denied),!1;e.errors?error_object.show_error_block(e.errors,"error"):(r(),error_object.show_error_block(e.success,"success"))}})};t.Init(e)})},3800:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.fieldEditorSelect=function(e){this.properties={addLinkID:"add_option_link",btnCancelID:"btn_cancel",btnSaveID:"btn_save",contentObj:new loadingContent({closeBtnClass:"w"}),defaultHiddenID:"hidden_block",defaultHiddenName:"settings_data[default_value]",defaultMultiple:!1,defaultValues:[],errorObj:new Errors,fieldID:"",itemsBlockID:"select_options_block",itemsUlID:"select_options",onActionUpdate:!0,optionFormID:"change_option_block",siteUrl:"",urlSaveSort:"admin/field_editor/ajax_save_select_option_sorter/",urlDeleteItem:"admin/field_editor/ajax_delete_select_option/",urlFormItem:"admin/field_editor/ajax_get_select_option_form/",urlSaveItem:"admin/field_editor/ajax_set_select_option/",urlGetBlock:"admin/field_editor/ajax_get_field_select_options/",useDefaultOptions:!0};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.set_sortable(),$("#"+t.properties.addLinkID).on("click",(function(){return t.get_option_form(""),!1})),t.properties.useDefaultOptions&&t.update_default_block()},this.set_sortable=function(){$("#"+t.properties.itemsUlID).sortable({items:"li",scroll:!0,forcePlaceholderSize:!0,placeholder:"limiter",revert:!0,update:function(e,o){t.properties.onActionUpdate&&t.update_sorting()}}),$("#"+t.properties.itemsUlID+" > li").each((function(){var e=$(this).attr("id").substring(7);$(this).find(".edit_link").on("click",(function(){return t.get_option_form(e),!1})),$(this).find(".delete_link").on("click",(function(){return t.delete_option(e),!1})),$(this).find(".active_link").on("click",(function(){return t.set_default_option(e,"activate"),!1})),$(this).find(".deactive_link").on("click",(function(){return t.set_default_option(e,"deactivate"),!1}))}))},this.reload_block=function(){$.ajax({url:t.properties.siteUrl+t.properties.urlGetBlock+t.properties.fieldID,type:"GET",cache:!1,success:function(e){$("#"+t.properties.itemsBlockID).html(e),t.set_sortable(),t.update_default_block()}})},this.update_sorting=function(){var e=new Object;$("#"+t.properties.itemsUlID+" > li").each((function(t){e[$(this).attr("id")]=t+1})),$.ajax({url:t.properties.siteUrl+t.properties.urlSaveSort+t.properties.fieldID,type:"POST",data:{sorter:e},cache:!1,success:function(e){}})},this.get_option_form=function(e){$.ajax({url:t.properties.siteUrl+t.properties.urlFormItem+t.properties.fieldID+"/"+e,cache:!1,success:function(o){var r=t.properties.contentObj.show_load_block(o),i=r.replace("user_load_content","user_load_content_close");$("#"+r+"_footer").hide(),$("#"+r+" .js-btn-actions").append($("#"+i).clone().prop("id",i+"_in_content")),$("#"+i+"_in_content").off("click").click((function(){return t.properties.contentObj.hide_load_block(),!1})),$("#"+t.properties.btnCancelID).off("click").click((function(){return t.properties.contentObj.hide_load_block(),!1})),$("#"+t.properties.btnSaveID).on("click",(function(){t.save_option_form(e)}))}})},this.save_option_form=function(e){var o=new Object;$("#"+t.properties.optionFormID+" input").each((function(e){o[$(this).attr("name")]=$(this).val()})),$.ajax({url:t.properties.siteUrl+t.properties.urlSaveItem+t.properties.fieldID+"/"+e,type:"POST",data:{data:o},dataType:"json",cache:!1,success:function(e){1==parseInt(e.is_error)?t.properties.errorObj.show_error_block(e.errors,"error"):(t.properties.contentObj.hide_load_block(),t.reload_block())}})},this.delete_option=function(e){$.ajax({url:t.properties.siteUrl+t.properties.urlDeleteItem+t.properties.fieldID+"/"+e,cache:!1,success:function(e){t.reload_block()}})},this.set_default_option=function(e,o){if("activate"===o)t.properties.defaultMultiple||(t.properties.defaultValues=[]),t.properties.defaultValues.push(e);else if("deactivate"===o)if(t.properties.defaultMultiple)for(var r in t.properties.defaultValues)t.properties.defaultValues[r]==e&&t.properties.defaultValues.splice(r,1);else t.properties.defaultValues=[];t.update_default_block()},this.update_default_block=function(){$("#"+t.properties.defaultHiddenID).empty();var e=t.properties.defaultHiddenName;for(var o in t.properties.defaultMultiple&&(e+="[]"),$("#"+t.properties.itemsUlID+" > li .active_link").show(),$("#"+t.properties.itemsUlID+" > li .deactive_link").hide(),t.properties.defaultValues)$("#"+t.properties.defaultHiddenID).append('<input type="hidden" name="'+e+'" value="'+t.properties.defaultValues[o]+'">'),$("#option_"+t.properties.defaultValues[o]+" .active_link").hide(),$("#option_"+t.properties.defaultValues[o]+" .deactive_link").show()},t.Init(e)})},3408:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.formFields=function(e){this.properties={siteUrl:"",fieldsID:"menu_items",btnAddFieldID:"add_field_form",btnAddSectionID:"add_section_form",selectSectionsID:"section_select",selectFieldsID:"field_select",saveSectionsID:"save_section_btn",cancelSectionsID:"cancel_save_section",field_data:{},field_names:{},formId:0,urlSaveSort:"admin/field_editor/ajax_form_fields_sorter/",urlSave:"admin/field_editor/ajax_save_form_fields/",urlDeleteSection:"admin/field_editor/ajax_delete_form_section/",urlAddSectionForm:"admin/field_editor/ajax_get_add_section_form/",urlAddFieldForm:"admin/field_editor/ajax_get_add_field_form/",urlGetSectionData:"admin/field_editor/ajax_get_section_data/",urlGetFieldData:"admin/field_editor/ajax_get_field_data/",urlFieldSettingsForm:"admin/field_editor/ajax_get_field_settings_form/",curFieldSectionGid:"",curFieldGid:"",onActionUpdate:!0,contentObj:new loadingContent({closeBtnClass:"w"}),errorObj:new Errors,empty_fields:"Empty default langs",textDelete:"Delete",textEdit:"Edit",textAdd:"Add"};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.bild_data(),t.set_sortable(),t.activate_buttons()},this.bild_data=function(){var e=0,o={};for(e in t.properties.field_data)"field"==(o=t.properties.field_data[e]).type?t.build_field(o.field.gid,o.field.type,t.properties.field_names["field_"+o.field.gid],""):(t.build_section(o.section.gid,t.properties.field_names["section_"+o.section.gid],o.section.fields),t.set_sortable(o.section.gid))},this.build_field=function(e,o,r,i){r=""!==r?r:"&nbsp;",$("#"+(""!=i?"sfields_"+i:"form_root")).append('<li id="field_'+e+'"><div id="field_'+e+'_actions" class="pull-right"></div><span class="field_type">'+o+": "+r+"</span></li>"),$("#field_"+e).addClass("type_"+o),"select"!=o&&"text"!=o&&"range"!=o||($("#field_"+e+"_actions").append(' <a href="javascript:;" class="edit-btn">'+t.properties.textEdit+"</a>"),$("#field_"+e+"_actions .edit-btn").on("click",(function(){t.field_settings_form(e)}))),$("#field_"+e+"_actions").append(' <a href="javascript:;" class="delete-btn">'+t.properties.textDelete+"</a>"),$("#field_"+e+"_actions .delete-btn").on("click",(function(){t.delete_field(e,i)}))},this.unbuild_field=function(e,t){$("#field_"+e).remove()},this.build_section=function(e,o,r){$("#form_root").append('<li id="section_'+e+'"><div id="section_'+e+'_actions" class="pull-right"></div><span class="field_type">section: '+o+"</span></li>"),$("#section_"+e+"_actions").append(' <a href="javascript:;" class="add-btn">'+t.properties.textAdd+"</a>"),$("#section_"+e+"_actions .add-btn").on("click",(function(){t.add_field_section_form(e)})),$("#section_"+e+"_actions").append(' <a href="javascript:;" class="edit-btn">'+t.properties.textEdit+"</a>"),$("#section_"+e+"_actions .edit-btn").on("click",(function(){t.add_section_form(e)})),$("#section_"+e+"_actions").append(' <a href="javascript:;" class="delete-btn">'+t.properties.textDelete+"</a>"),$("#section_"+e+"_actions .delete-btn").on("click",(function(){t.delete_section(e)})),$("#section_"+e).append('<ul id="sfields_'+e+'" class="sortable to_do"></ul>'),$("#section_"+e).addClass("type_section");var i=0,n={};for(i in r)n=r[i],t.build_field(n.field.gid,n.field.type,t.properties.field_names["field_"+n.field.gid],e)},this.unbuild_section=function(e){$("#section_"+e).remove()},this.set_sortable=function(e){section_ul_gid=e?"sfields_"+e:"form_root",$("#"+section_ul_gid).sortable({scroll:!0,forcePlaceholderSize:!0,placeholder:"limiter",revert:!0,update:function(e,o){var r="form_root"==$(this).attr("id")?"":$(this).attr("id").substring(8);t.properties.onActionUpdate&&t.update_sorting(r)}})},this.update_sorting=function(e){section_ul_gid=e?"sfields_"+e:"form_root";var o=[],r="",i="",n="";$("#"+section_ul_gid+" > li").each((function(e){"field_"==(r=$(this).attr("id")).substring(0,6)?(i=r.substring(6),n="field"):(i=r.substring(8),n="section"),o.push(t.tree_find_element(n,i))})),e?t.tree_find_element("section",e).section.fields=o:t.properties.field_data=o,t.save_data()},this.delete_field=function(e,o){t.unbuild_field(e,o),t.tree_find_element("field",e,"delete"),t.save_data()},this.delete_section=function(e){t.unbuild_section(e),t.tree_find_element("section",e,"delete"),t.save_data(),$.ajax({url:t.properties.siteUrl+t.properties.urlDeleteSection+t.properties.formId+"/"+e})},this.activate_buttons=function(){$("#"+t.properties.btnAddFieldID).on("click",(function(){t.add_field_section_form("")})),$("#"+t.properties.btnAddSectionID).on("click",(function(){t.add_section_form()}))},this.save_data=function(){$.ajax({url:t.properties.siteUrl+t.properties.urlSave+t.properties.formId,type:"POST",data:{field_data:t.properties.field_data},cache:!1,success:function(e){}})},this.add_section_form=function(e){return e||(e=0),$.ajax({url:t.properties.siteUrl+t.properties.urlAddSectionForm+t.properties.formId+"/"+e,cache:!1,success:function(e){return t.properties.contentObj.show_load_block(e),$("#"+t.properties.cancelSectionsID).on("click",(function(){t.properties.contentObj.hide_load_block()})),$("#"+t.properties.saveSectionsID).on("click",(function(){var e=$("#ajax_section_gid").val();default_lang_val=$('input[name^="langs"]').val(),default_lang_val?$.ajax({url:t.properties.siteUrl+t.properties.urlGetSectionData+t.properties.formId+"/"+e,cache:!1,type:"POST",data:$("#save_section_name").serialize(),dataType:"json",success:function(e){e&&(t.properties.field_names=$.extend(t.properties.field_names,e.names),"add"==e.action?(t.build_section(e.data.section.gid,e.names["section_"+e.data.section.gid],e.data.section.fields),t.properties.field_data.push(e.data),t.save_data()):$("#section_"+e.data.section.gid+" > span.section_name").html(e.names["section_"+e.data.section.gid]),t.properties.contentObj.hide_load_block())}}):t.properties.errorObj.show_error_block(t.properties.empty_fields,"error")})),!1}}),!1},this.add_field_section_form=function(e){e||(e=""),t.properties.curFieldSectionGid=e,$.ajax({url:t.properties.siteUrl+t.properties.urlAddFieldForm+t.properties.formId,cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),$("#"+t.properties.selectSectionsID+" li").on("click",(function(){$(this).attr("gid")&&t.add_field_form($(this).attr("gid"))})),$("#fields_close").on("click",(function(){t.properties.contentObj.hide_load_block()}))}})},this.add_field_form=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.urlAddFieldForm+t.properties.formId+"/"+e,cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),$("#fields_back").on("click",(function(){t.add_field_section_form(t.properties.curFieldSectionGid)})),$("#fields_close").on("click",(function(){t.properties.contentObj.hide_load_block()})),$("#"+t.properties.selectFieldsID+" li").on("click",(function(){if(null===$(this).attr("gid"))return!1;$.ajax({url:t.properties.siteUrl+t.properties.urlGetFieldData+t.properties.formId+"/"+$(this).attr("gid"),cache:!1,dataType:"json",success:function(e){if(e){if(t.properties.field_names=$.extend(t.properties.field_names,e.names),t.build_field(e.data.field.gid,e.data.field.type,e.names["field_"+e.data.field.gid],t.properties.curFieldSectionGid),""!=t.properties.curFieldSectionGid){var o=t.tree_find_element("section",t.properties.curFieldSectionGid);void 0===o.section.fields&&(o.section.fields=[]),o.section.fields.push(e.data)}else t.properties.field_data.push(e.data);t.properties.contentObj.hide_load_block(),t.save_data()}}})}))}}),!1},this.field_settings_form=function(e){return t.properties.curFieldGid=e,$.ajax({url:t.properties.siteUrl+t.properties.urlFieldSettingsForm+t.properties.formId+"/"+e,cache:!1,success:function(e){e&&(t.properties.contentObj.show_load_block(e),$("#cancel_save_settings").on("click",(function(){t.properties.contentObj.hide_load_block()})),$("#save_settings_btn").on("click",(function(){var e={search_type:$("#field_search_type").val(),view_type:$("#field_view_type_"+$("#field_search_type").val()+" select").val()};t.tree_find_element("field",t.properties.curFieldGid).settings=e,t.properties.contentObj.hide_load_block(),t.save_data()})))}}),!1},this.tree_find_element=function(e,o,r){var i=0,n={},s=0;for(i in t.properties.field_data)if(n=t.properties.field_data[i],"field"==e){if("field"==n.type){if(n.field.gid==o){if("delete"!=r)return n;delete t.properties.field_data[i]}}else for(s in n.section.fields)if("field"==n.section.fields[s].type&&n.section.fields[s].field.gid==o){if("delete"!=r)return n.section.fields[s];delete t.properties.field_data[i].section.fields[s]}}else if("section"==n.type&&n.section.gid==o){if("delete"!=r)return n;delete t.properties.field_data[i]}return[]},t.Init(e)})},7092:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.formFields=function(e){this.properties={siteUrl:"",fieldsID:"menu_items",btnAddFieldID:"add_field_form",btnAddSectionID:"add_section_form",selectSectionsID:"section_select",selectFieldsID:"field_select",saveSectionsID:"save_section_btn",cancelSectionsID:"cancel_save_section",field_data:{},field_names:{},formId:0,urlSaveSort:"admin/field_editor/ajax_form_fields_sorter/",urlSave:"admin/field_editor/ajax_save_form_fields/",urlDeleteSection:"admin/field_editor/ajax_delete_form_section/",urlAddSectionForm:"admin/field_editor/ajax_get_add_section_form/",urlAddFieldForm:"admin/field_editor/ajax_get_add_field_form/",urlGetSectionData:"admin/field_editor/ajax_get_section_data/",urlGetFieldData:"admin/field_editor/ajax_get_field_data/",urlFieldSettingsForm:"admin/field_editor/ajax_get_field_settings_form/",curFieldSectionGid:"",curFieldGid:"",onActionUpdate:!0,contentObj:new loadingContent({closeBtnClass:"w"}),errorObj:new Errors,empty_fields:"Empty default langs"};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.bild_data(),t.set_sortable(),t.activate_buttons()},this.bild_data=function(){var e=0,o={};for(e in t.properties.field_data)"field"==(o=t.properties.field_data[e]).type?t.build_field(o.field.gid,o.field.type,t.properties.field_names["field_"+o.field.gid],""):(t.build_section(o.section.gid,t.properties.field_names["section_"+o.section.gid],o.section.fields),t.set_sortable(o.section.gid))},this.build_field=function(e,o,r,i){r=""!==r?r:"&nbsp;",$("#"+(""!=i?"sfields_"+i:"form_root")).append('<li id="field_'+e+'"><div class="field_type">'+o+":</div> "+r+"</li>"),$("#field_"+e).addClass("type_"+o),$("#field_"+e).append('<div class="delete-btn"></div>'),$("#field_"+e+" .delete-btn").on("click",(function(){t.delete_field(e,i)})),"select"!=o&&"text"!=o&&"range"!=o||($("#field_"+e).append('<div class="edit-btn"></div>'),$("#field_"+e+" .edit-btn").on("click",(function(){t.field_settings_form(e)})))},this.unbuild_field=function(e,t){$("#field_"+e).remove()},this.build_section=function(e,o,r){$("#form_root").append('<li id="section_'+e+'"><div class="field_type">section:</div> <span class="section_name">'+o+"</span></li>"),$("#section_"+e).append('<div class="delete-btn"></div>'),$("#section_"+e+" .delete-btn").on("click",(function(){t.delete_section(e)})),$("#section_"+e).append('<div class="edit-btn"></div>'),$("#section_"+e+" .edit-btn").on("click",(function(){t.add_section_form(e)})),$("#section_"+e).append('<div class="add-btn"></div>'),$("#section_"+e+" .add-btn").on("click",(function(){t.add_field_section_form(e)})),$("#section_"+e).append('<ul id="sfields_'+e+'" class="sortable"></ul>'),$("#section_"+e).addClass("type_section");var i=0,n={};for(i in r)n=r[i],t.build_field(n.field.gid,n.field.type,t.properties.field_names["field_"+n.field.gid],e)},this.unbuild_section=function(e){$("#section_"+e).remove()},this.set_sortable=function(e){section_ul_gid=e?"sfields_"+e:"form_root",$("#"+section_ul_gid).sortable({scroll:!0,forcePlaceholderSize:!0,placeholder:"limiter",revert:!0,update:function(e,o){var r="form_root"==$(this).attr("id")?"":$(this).attr("id").substring(8);t.properties.onActionUpdate&&t.update_sorting(r)}})},this.update_sorting=function(e){section_ul_gid=e?"sfields_"+e:"form_root";var o=[],r="",i="",n="";$("#"+section_ul_gid+" > li").each((function(e){"field_"==(r=$(this).attr("id")).substring(0,6)?(i=r.substring(6),n="field"):(i=r.substring(8),n="section"),o.push(t.tree_find_element(n,i))})),e?t.tree_find_element("section",e).section.fields=o:t.properties.field_data=o,t.save_data()},this.delete_field=function(e,o){t.unbuild_field(e,o),t.tree_find_element("field",e,"delete"),t.save_data()},this.delete_section=function(e){t.unbuild_section(e),t.tree_find_element("section",e,"delete"),t.save_data(),$.ajax({url:t.properties.siteUrl+t.properties.urlDeleteSection+t.properties.formId+"/"+e})},this.activate_buttons=function(){$("#"+t.properties.btnAddFieldID).on("click",(function(){t.add_field_section_form("")})),$("#"+t.properties.btnAddSectionID).on("click",(function(){t.add_section_form()}))},this.save_data=function(){$.ajax({url:t.properties.siteUrl+t.properties.urlSave+t.properties.formId,type:"POST",data:{field_data:t.properties.field_data},cache:!1,success:function(e){}})},this.add_section_form=function(e){return e||(e=0),$.ajax({url:t.properties.siteUrl+t.properties.urlAddSectionForm+t.properties.formId+"/"+e,cache:!1,success:function(e){return t.properties.contentObj.show_load_block(e),$("#"+t.properties.cancelSectionsID).on("click",(function(){t.properties.contentObj.hide_load_block()})),$("#"+t.properties.saveSectionsID).on("click",(function(){var e=$("#ajax_section_gid").val();default_lang_val=$('input[name^="langs"]').val(),default_lang_val?$.ajax({url:t.properties.siteUrl+t.properties.urlGetSectionData+t.properties.formId+"/"+e,cache:!1,type:"POST",data:$("#save_section_name").serialize(),dataType:"json",success:function(e){e&&(t.properties.field_names=$.extend(t.properties.field_names,e.names),"add"==e.action?(t.build_section(e.data.section.gid,e.names["section_"+e.data.section.gid],e.data.section.fields),t.properties.field_data.push(e.data),t.save_data()):$("#section_"+e.data.section.gid+" > span.section_name").html(e.names["section_"+e.data.section.gid]),t.properties.contentObj.hide_load_block())}}):t.properties.errorObj.show_error_block(t.properties.empty_fields,"error")})),!1}}),!1},this.add_field_section_form=function(e){e||(e=""),t.properties.curFieldSectionGid=e,$.ajax({url:t.properties.siteUrl+t.properties.urlAddFieldForm+t.properties.formId,cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),$("#"+t.properties.selectSectionsID+" li").on("click",(function(){$(this).attr("gid")&&t.add_field_form($(this).attr("gid"))})),$("#fields_close").on("click",(function(){t.properties.contentObj.hide_load_block()}))}})},this.add_field_form=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.urlAddFieldForm+t.properties.formId+"/"+e,cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),$("#fields_back").on("click",(function(){t.add_field_section_form(t.properties.curFieldSectionGid)})),$("#fields_close").on("click",(function(){t.properties.contentObj.hide_load_block()})),$("#"+t.properties.selectFieldsID+" li").on("click",(function(){if(null===$(this).attr("gid"))return!1;$.ajax({url:t.properties.siteUrl+t.properties.urlGetFieldData+t.properties.formId+"/"+$(this).attr("gid"),cache:!1,dataType:"json",success:function(e){if(e){if(t.properties.field_names=$.extend(t.properties.field_names,e.names),t.build_field(e.data.field.gid,e.data.field.type,e.names["field_"+e.data.field.gid],t.properties.curFieldSectionGid),""!=t.properties.curFieldSectionGid){var o=t.tree_find_element("section",t.properties.curFieldSectionGid);void 0===o.section.fields&&(o.section.fields=[]),o.section.fields.push(e.data)}else t.properties.field_data.push(e.data);t.properties.contentObj.hide_load_block(),t.save_data()}}})}))}}),!1},this.field_settings_form=function(e){return t.properties.curFieldGid=e,$.ajax({url:t.properties.siteUrl+t.properties.urlFieldSettingsForm+t.properties.formId+"/"+e,cache:!1,success:function(e){e&&(t.properties.contentObj.show_load_block(e),$("#cancel_save_settings").on("click",(function(){t.properties.contentObj.hide_load_block()})),$("#save_settings_btn").on("click",(function(){var e={search_type:$("#field_search_type").val(),view_type:$("#field_view_type_"+$("#field_search_type").val()+" select").val()};t.tree_find_element("field",t.properties.curFieldGid).settings=e,t.properties.contentObj.hide_load_block(),t.save_data()})))}}),!1},this.tree_find_element=function(e,o,r){var i=0,n={},s=0;for(i in t.properties.field_data)if(n=t.properties.field_data[i],"field"==e){if("field"==n.type){if(n.field.gid==o){if("delete"!=r)return n;delete t.properties.field_data[i]}}else for(s in n.section.fields)if("field"==n.section.fields[s].type&&n.section.fields[s].field.gid==o){if("delete"!=r)return n.section.fields[s];delete t.properties.field_data[i].section.fields[s]}}else if("section"==n.type&&n.section.gid==o){if("delete"!=r)return n;delete t.properties.field_data[i]}return[]},t.Init(e)})},3519:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.friendsInput=function(e){this.properties={siteUrl:"",rand:"",id_user:"",load_user_link:"friendlist/ajax_get_friends_data/",load_form:"friendlist/ajax_get_friends_form/",load_data:"friendlist/ajax_get_selected_friends/",id_main:"",id_text:"",id_open:"",id_hidden_user:"",id_bg:"",id_select:"",id_items:"user_select_items",id_clear:"user_clear_link",id_close:"user_close_link",id_search:"user_search",id_page:"user_page",values_callback:function(){},contentObj:new loadingContent({loadBlockWidth:"680px",closeBtnPadding:15})};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.id_main="user_select_"+t.properties.rand,t.properties.id_open="user_open_"+t.properties.rand,t.properties.id_hidden_user="user_hidden_"+t.properties.rand,$("#"+t.properties.id_open).on("click",(function(){return t.open_form(),!1}))},this.open_form=function(){$.ajax({url:t.properties.siteUrl+t.properties.load_form,cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),$("#"+t.properties.id_clear).unbind().on("click",(function(){return t.set_values_text("",0,0,""),t.properties.contentObj.hide_load_block(),!1})),t.load_users(),$("#"+t.properties.id_search).unbind().on("keyup",(function(){t.load_users($(this).val(),1)})),$("#"+t.properties.id_close).unbind().on("click",(function(){return t.properties.contentObj.hide_load_block(),!1}))}})},this.load_users=function(e,o){var r={page:o=o||1};(e=e||"")&&(r.name=e),$.ajax({url:t.properties.siteUrl+t.properties.load_user_link,dataType:"json",type:"POST",data:r,cache:!1,success:function(e){t.display_select(e)}})},this.display_select=function(e){for(var o in $("#"+t.properties.id_items).unbind(),$("#"+t.properties.id_items).empty(),e.items)1!=e.items[o].is_deleted&&$("#"+t.properties.id_items).append('<li index="'+e.items[o].id+'">'+e.items[o].output_name+(e.items[o].output_name!=e.items[o].nickname?" ("+e.items[o].nickname+")":"")+"</li>");t.generate_pages(e.pages,e.current_page,name),$("#"+t.properties.id_items+" li").on("click",(function(){t.properties.values_callback($(this).attr("index"),$(this).text(),e),t.properties.contentObj.hide_load_block()}))},this.emptyValues=function(){t.properties.id_user="",$("#"+t.properties.id_hidden_user).val(t.properties.id_user).change()},this.generate_pages=function(e,o,r){if($("#"+t.properties.id_page+" a").unbind(),$("#"+t.properties.id_page).empty(),e>1){for(var i=Math.max(o-2,1),n=Math.min(e,5),s=i;s<=n;s++)s==o?$("#"+t.properties.id_page).append('<ins class="current">'+s+"</ins>"):$("#"+t.properties.id_page).append('<ins><a href="#">'+s+"</a></ins>");$("#"+t.properties.id_page+" a").on("click",(function(){return t.load_users(r,$(this).text()),!1}))}},t.Init(e)})},7952:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.usersSelect=function(e){this.properties={siteUrl:"",rand:"",load_user_link:"friendlist/ajax_get_friends_data/",load_form:"friendlist/ajax_get_friends_form/",load_selected_data_link:"friendlist/ajax_get_selected_friends/",id_main:"",id_span:"",id_manage_link:"",id_items:"user_select_items",id_selected_items:"user_selected_items",id_search:"user_search",id_user_page:"user_page",id_close:"user_close_link",user_type:0,var_name:"",max:"",selected_items:[],contentObj:new loadingContent({loadBlockWidth:"680px",closeBtnPadding:15})};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.id_main="user_select_"+t.properties.rand,t.properties.id_span="user_text_"+t.properties.rand,t.properties.id_manage_link="user_link_"+t.properties.rand,t.properties.max=parseInt(t.properties.max),$("#"+t.properties.id_manage_link).on("click",(function(){return t.open_form(),!1}))},this.open_form=function(){var e=t.properties.siteUrl+t.properties.load_form+"/"+t.properties.max;$.ajax({url:e,type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),t.load_users("",1),$("#"+t.properties.id_search).unbind().on("keyup",(function(){return t.load_users($(this).val(),1),!1})),1!=t.properties.max&&$("#"+t.properties.id_selected_items+" input:checkbox").unbind().on("click",(function(){t.unset_user($(this).val())})),$("#"+t.properties.id_close).unbind().on("click",(function(){return t.properties.contentObj.hide_load_block(),!1}))}})},this.load_users=function(e,o){var r={selected:t.properties.selected_items,user_type:t.properties.user_type};""!=e&&(r.search=e),$.ajax({url:t.properties.siteUrl+t.properties.load_user_link+o,dataType:"json",type:"POST",data:r,cache:!1,success:function(o){for(var r in $("#"+t.properties.id_items+" option").unbind(),$("#"+t.properties.id_items).empty(),o.items)console.log(o.items[r].is_deleted),$("#"+t.properties.id_items).append('<li index="'+o.items[r].id+'">'+o.items[r].nickname+"("+o.items[r].fname+" "+o.items[r].sname+")</li>");t.generate_user_pages(o.pages,o.current_page,e),$("#"+t.properties.id_items+" li").on("click",(function(){t.set_user($(this).attr("index"))}))}})},this.generate_user_pages=function(e,o,r){if($("#"+t.properties.id_user_page+" a").unbind(),$("#"+t.properties.id_user_page).empty(),e>1){for(var i=1;i<=e;i++)i==o?$("#"+t.properties.id_user_page).append('<ins class="current">'+i+"</ins>"):$("#"+t.properties.id_user_page).append('<ins><a href="#">'+i+"</a></ins>");$("#"+t.properties.id_user_page+" a").on("click",(function(){return t.load_users(r,$(this).text()),!1}))}},this.set_user=function(e){var o=!1,r=0;for(r in t.properties.selected_items)t.properties.selected_items[r]==e&&(o=!0);if(t.properties.max>1&&t.properties.selected_items.length>=t.properties.max)return t.properties.selected_items=t.properties.selected_items.splice(0,t.properties.max),void t.load_selected();1==t.properties.max&&t.properties.selected_items.length>0&&(t.properties.selected_items=[]),o||(r=parseInt(r)+1,t.properties.selected_items.length||(r=0),t.properties.selected_items[r]=e,1==t.properties.max?t.properties.contentObj.hide_load_block():t.remove_option(e),t.load_selected())},this.load_selected=function(){$.ajax({url:t.properties.siteUrl+t.properties.load_selected_data_link,dataType:"json",type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(e){t.reload_span(e),1!=t.properties.max&&t.reload_selected(e)}})},this.unset_user=function(e){var o=!1;for(var r in t.properties.selected_items)t.properties.selected_items[r]==e&&(o=!0,t.properties.selected_items.splice(r,1));o&&$.ajax({url:t.properties.siteUrl+t.properties.load_selected_data_link,dataType:"json",type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(e){t.reload_span(e),1!=t.properties.max&&t.reload_selected(e)}})},this.remove_option=function(e){$("#"+t.properties.id_items+" li[index="+e+"]").remove()},this.reload_span=function(e){for(var o in $("#"+t.properties.id_span).empty(),e)1!=t.properties.max?$("#"+t.properties.id_span).append(e[o].output_name+(e[o].output_name!=e[o].nickname?" ("+e[o].nickname+")":"")+'<br><input type="hidden" name="'+t.properties.var_name+'[]" value="'+e[o].id+'">'):$("#"+t.properties.id_span).append(e[o].output_name+(e[o].output_name!=e[o].nickname?" ("+e[o].nickname+")":"")+'<input type="hidden" name="'+t.properties.var_name+'" value="'+e[o].id+'">')},this.reload_selected=function(e){for(var o in $("#"+t.properties.id_selected_items).empty(),e)$("#"+t.properties.id_selected_items).append('<li><div class="user-block"><input type="checkbox" name="remove_users[]" value="'+e[o].id+'" checked>'+e[o].nickname+"</div></li>");$("#"+t.properties.id_selected_items+" input:checkbox").on("click",(function(){t.unset_user($(this).val())}))},t.Init(e)})},6282:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.ListsLinks=function e(t){if(e.instance){if(e.instance.properties.singleton)return e.instance}else e.instance=this;this.properties={id_dest_user:"",button_rand:"",siteUrl:"",singleton:1,url:"",request_window:null,view_type:"button",css:{jsFriendlistLink:".js-friendlist-link"}};var o=this;return this.Init=function(e){o.properties=$.extend(!0,o.properties,e),o.countButton(),o.properties.request_window=new loadingContent({linkerObjID:"friendlist_links_"+o.properties.button_rand,loadBlockWidth:"300px",loadBlockLeftType:"center",loadBlockTopType:"top",loadBlockTopPoint:100,closeBtnClass:"w"}),$(document).off("click",o.properties.css.jsFriendlistLink).on("click",o.properties.css.jsFriendlistLink,(function(e){e.preventDefault();var t=$(this).attr("method");o.properties.id_dest_user=$(this).data("id_dest_user"),o.properties.button_rand=$(this).data("rand"),"request"===t?o.friendsRequest(t):o.ajaxAction(t)})).off("click",'[data-id="friendlist_links_request_'+o.properties.id_dest_user+'"] .js-send').on("click",'[data-id="friendlist_links_request_'+o.properties.id_dest_user+'"] .js-send',(function(e){e.preventDefault(),o.properties.request_window.hide_load_block();var t=$('[data-id="friendlist_links_request_'+o.properties.id_dest_user+'"]').find(".text").find("textarea").val();o.ajaxAction("request",t)})).on("keypress keyup change blur",".text textarea",(function(e){o.countChars(this)}))},this.uninit=function(){$('[data-id="friendlist_links_'+o.properties.button_rand+'"]').off("click","a").find('[data-id="friendlist_links_request_'+o.properties.id_dest_user+'"]'),$(document).off("click",".js-send").off("keypress keyup change blur",".text textarea"),o.properties.request_window.destroy(),e.instance=void 0},this.ajaxAction=function(e,t,r){t=t||"";var i=o.properties.siteUrl+o.properties.url+"ajax_"+e+"/"+o.properties.id_dest_user+"/"+o.properties.view_type;return $.ajax({url:i,data:{comment:t},success:function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return o.properties.request_window.show_load_block(e.info.access_denied),!1;if(e.html){var t=$(e.html).html().replace(/(\r\n|\n|\r|\t)/gm,"");$('[data-id="friendlist_'+o.properties.button_rand+'"]').html(t),$("#friendlist_links_").attr({id:"friendlist_links_"+o.properties.button_rand,"data-id":"friendlist_links_"+o.properties.button_rand}),$("[id^=friendlist_links_]").each((function(){if(o.properties.id_dest_user==$(this).find("a").data("user_id")){var e=$('[data-id="friendlist_links_'+o.properties.button_rand+'"]').html();$('[data-id="'+$(this).attr("data-id")+'"]').html(e)}}))}e.errors&&error_object.show_error_block(e.errors,"error"),e.success&&error_object.show_error_block(e.success,"success")},type:"POST",dataType:"json",async:!1}),this},this.friendsRequest=function(e){return $.ajax({url:o.properties.siteUrl+o.properties.url+"ajax_request_block/"+o.properties.id_dest_user,success:function(e){if(o.isJson(e)){var t=JSON.parse(e);if(void 0!==t.info.access_denied&&t.info.access_denied.length>0)return o.properties.request_window.show_load_block(t.info.access_denied),!1}else o.properties.request_window.show_load_block(e)},dataType:"html",type:"POST"}),this},this.countChars=function(e){var t=$(e).val().length,o=parseInt($(e).attr("maxcount"));return t>o&&$(e).val($(e).val().substring(0,o)).scrollTop(1e3),t=$(e).val().length,$(e).parents(".popup-form").find(".char-counter").html(o-t),this},this.countButton=function(){$("span[id^=friendlist_links_]").length>1&&(o.properties.singleton=0)},this.isJson=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},o.Init(t),o})},6370:()=>{},6647:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.BingMapsv7_Geocoder=function(e){this.properties={site_url:""};var t=this;return this.init=function(e){t.properties=$.extend(t.properties,e)},this.geocodeLocation=function(e,o){var r="http://dev.virtualearth.net/REST/v1/Locations?query="+e+"&maxResults=1&output=json&jsonp=?&key="+t.prop.map_key;$.getJSON(r,(function(e){if(t.wait_requests--,e&&e.resourceSets&&e.resourceSets.length>0&&e.resourceSets[0].resources&&e.resourceSets[0].resources.length>0){var r=e.resourceSets[0].resources[0].point.coordinates;o&&o(r[0],r[1])}}))},this.geocodeCoordinates=function(e,o,r){var i="http://dev.virtualearth.net/REST/v1/Locations/"+e+","+o+"?maxResults=1&output=json&jsonp=?&key="+t.prop.map_key;$.getJSON(i,(function(e){t.wait_requests--,e&&e.resourceSets&&e.resourceSets.length>0&&e.resourceSets[0].resources&&e.resourceSets[0].resources.length>0&&r&&r(e.resourceSets[0].resources[0].name)}))},this.getLocationFromAddress=function(e,t,o,r,i){var n=[];return e&&n.push(e),t&&n.push(t),o&&n.push(o),r&&n.push(r),n.join(", ")},t.init(e),t})},9895:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.GoogleMapsv3_Geocoder=function(e){this.properties={site_url:""};var t=this;return this.init=function(e){t.properties=$.extend(t.properties,e)},this.geocodeLocation=function(e,o){(new google.maps.Geocoder).geocode({address:e},(function(e,r){if(t.wait_requests--,r==google.maps.GeocoderStatus.OK){var i=e[0].geometry.location.lat(),n=e[0].geometry.location.lng();o&&o(i,n)}}))},this.geocodeCoordinates=function(e,o,r){(new google.maps.Geocoder).geocode({location:new google.maps.LatLng(e,o)},(function(e,o){t.wait_requests--,o==google.maps.GeocoderStatus.OK&&r&&r(e[0].address_components.long_name)}))},this.getLocationFromAddress=function(e,t,o,r,i){var n=[];return e&&n.push(e),t&&n.push(t),o&&n.push(o),r&&n.push(r),n.join(", ")},t.init(e),t})},7611:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.YandexMapsv2_Geocoder=function(e){this.properties={site_url:""};var t=this;return this.init=function(e){t.properties=$.extend(t.properties,e)},this.geocodeLocation=function(e,o){ymaps.geocode(e,{results:1}).then((function(e){if(t.wait_requests--,e.geoObjects.getLength()){var r=e.geoObjects.get(0).geometry.getCoordinates();o&&o(r[0],r[1])}}),(function(e){alert("error"),t.wait_requests--}))},this.geocodeCoordinates=function(e,o,r){ymaps.geocode([e,o],{results:1}).then((function(e){t.wait_requests--,e.geoObjects.get(0).properties.get("name"),r&&r(name)}),(function(e){t.wait_requests--}))},this.getLocationFromAddress=function(e,t,o,r,i){var n=[];return e&&n.push(e),t&&n.push(t),o&&n.push(o),r&&n.push(r),n.join(", ")},t.init(e),t})},8827:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}"object"===o(t)&&(t.__esModule=!0,t.BingMapsv7=function(e){this.prop={site_url:"",save_location_url:"/admin/admin_settings.php",map_container:"map_container",routes_container:"",use_smart_zoom:!1,use_searchbox:!1,use_router:!1,use_type_selector:!1,amenities:[],icon:null,default_zoom:10,default_map_type:2,map_key:"",lat:56.614607,lon:47.863757,width:0,height:0,geocode_listener:!1,zoom_listener:!1,type_listener:!1,useModules:{advanced_shapes:!1,directions:!1,overlays:!1,search:!1,themes:!1,traffic:!1,venue_maps:!1}},this.MAP_TYPES=[Microsoft.Maps.MapTypeId.aerial,Microsoft.Maps.MapTypeId.auto,Microsoft.Maps.MapTypeId.birdseye,Microsoft.Maps.MapTypeId.collinsBart,Microsoft.Maps.MapTypeId.mercator,Microsoft.Maps.MapTypeId.ordnanceSurvey,Microsoft.Maps.MapTypeId.road],this.ADVANCED_MODULES={advanced_shapes:{namespace:"Microsoft.Maps.AdvancedShapes",is_loaded:!1},directions:{namespace:"Microsoft.Maps.Directions",is_loaded:!1},overlays:{namespace:"Microsoft.Maps.Overlays.Style",is_loaded:!1},search:{namespace:"Microsoft.Maps.Search",is_loaded:!1},themes:{namespace:"Microsoft.Maps.Themes.BingTheme",is_loaded:!1},traffic:{namespace:"Microsoft.Maps.Traffic",is_loaded:!1},venue_maps:{namespace:"Microsoft.Maps.VenueMaps",is_loaded:!1}},this.is_loaded=!1,this.directions_module_is_loaded=!1,this.min_zoom=1,this.max_zoom=19,this.map=null,this.map_container=null,this.markers=[],this.routes=[],this.amenities={},this.infobox_visible=[],this.zoom=null,this.wait_requests=0,this.smart_zoom_request=!1,this.smart_zoom_direction=!1,this.bounds=null;var t=this;function o(e,t,o,i){var n;this.prop=(r(n={draggable:!1,width:30,height:39,icon:null,info:null,showInfo:!0,infoWidth:"430",infoHeight:"250"},"info",null),r(n,"state","none"),r(n,"gid","default"),r(n,"drag",null),r(n,"dragend",null),r(n,"drag_listener",!1),n),this.map=e,this.marker=null,this.infobox=null,this.prop.icon=e.prop.icon;var s=this;this.init=function(e,t,o){s.prop=$.extend(s.prop,o),s.prop.info||(s.prop.showInfo=!1),s.marker=new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(e,t),{draggable:s.prop.draggable,icon:s.prop.icon,width:s.prop.width,height:s.prop.height}),Microsoft.Maps.Events.addHandler(s.marker,"drag",(function(e){if(s.infobox){var t=s.map.getInfoboxLocation(s.getLocation());s.infobox.setLocation(t)}s.prop.drag&&s.prop.drag()})),s.prop.showInfo&&Microsoft.Maps.Events.addHandler(s.marker,"click",(function(e){s.displayInfobox()})),s.prop.draggable&&Microsoft.Maps.Events.addHandler(s.marker,"dragend",(function(e){if(s.prop.drag_listener){var t=s.getLocation();s.prop.drag_listener(s.prop.gid,t.latitude,t.longitude)}s.prop.dragend&&s.prop.dragend()})),s.map.addEntry(s.marker)},this.displayInfobox=function(){if(!s.infobox){var e='<div class="info_box">',t=s.getLocation();for(var o in s.map.markers){var r=s.map.markers[o].getLocation();r.latitude==t.latitude&&r.longitude==t.longitude&&(e+='<div class="info_item">'+s.map.markers[o].prop.info+"</div>")}e+="</div>",s.infobox=new Microsoft.Maps.Infobox(s.map.getInfoboxLocation(s.marker.getLocation()),{width:s.prop.infoWidth,height:s.prop.infoHeight,title:'<div style="width: '+s.prop.infoWidth+"px; max-height: "+s.prop.infoHeight+'px; overflow-x: hidden;">'+e+"</div>",htmlContent:'<div style="width: '+s.prop.infoWidth+"px; max-height: "+s.prop.infoHeight+'px; overflow-x: hidden;">'+e+"</div>",showPointer:!0,showCloseButton:!0,zIndex:0,visible:!1}),s.map.addEntry(s.infobox)}var i=s.infobox.getOptions();i.visible=!0,s.infobox.setOptions(i)},this.getGUID=function(){return s.prop.gid},this.getLocation=function(){var e=s.marker.getLocation();return{latitude:e.latitude,longitude:e.longitude}},this.clear=function(){s.infobox&&s.map.removeEntry(s.infobox),s.map.removeEntry(s.marker)},this.move=function(e,t){var o=new Microsoft.Maps.Location(e,t);s.marker.setLocation(o)},s.init(t,o,i)}function n(e,t,r){this.prop={},this.ROUTE_TYPES=["Driving","Walking","Transit"],this.map=e,this.start=null,this.end=null,this.routeshape=null;var n=this;this.init=function(e,t){if(n.prop=$.extend(n.prop,t),e.length){for(i in routes_str="",e)routes_str+="waypoint."+i+"="+encodeURI(e[i])+"&";var r="http://dev.virtualearth.net/REST/v1/Routes/Driving?"+routes_str+"routePathOutput=Points&output=json&jsonp=?&key="+n.map.getKey();$.getJSON(r,(function(e){if(e&&e.resourceSets&&e.resourceSets.length>0&&e.resourceSets[0].resources&&e.resourceSets[0].resources.length>0){var t=e.resourceSets[0].resources[0],r=t.bbox,i=Microsoft.Maps.LocationRect.fromLocations(new Microsoft.Maps.Location(r[0],r[1]),new Microsoft.Maps.Location(r[2],r[3]));n.map.setView({bounds:i});for(var s=t.routePath.line,a=new Array,c=0;c<s.coordinates.length;c++)a[c]=new Microsoft.Maps.Location(s.coordinates[c][0],s.coordinates[c][1]);var p=t.routeLegs[0].actualStart,l=t.routeLegs[0].actualEnd,d=p.coordinates.toString().split(",");n.start=new o(n.map,d[0],d[1],{draggable:!0,info:p.name,infoWidth:250,infoHeight:60,drag:function(){var e=n.routeshape.getLocations();e[0]=n.start.getLocation(),n.routeshape.setLocations(e)},dragend:function(){n.map.deleteRoute();var e=n.start.getLocation(),t=n.end.getLocation();n.map.calcRoute([e.latitude.toFixed(3)+","+e.longitude.toFixed(3),t.latitude.toFixed(3)+","+t.longitude.toFixed(3)])}}),d=l.coordinates.toString().split(","),n.end=new o(n.map,d[0],d[1],{draggable:!0,info:l.name,infoWidth:250,infoHeight:60,drag:function(){var e=n.routeshape.getLocations();e[e.length-1]=n.end.getLocation(),n.routeshape.setLocations(e)},dragend:function(){n.map.deleteRoute();var e=n.start.getLocation(),t=n.end.getLocation();n.map.calcRoute([e.latitude.toFixed(3)+","+e.longitude.toFixed(3),t.latitude.toFixed(3)+","+t.longitude.toFixed(3)])}}),n.routeshape=new Microsoft.Maps.Polyline(a,{strokeColor:new Microsoft.Maps.Color(200,0,0,200)}),n.map.addEntry(n.routeshape),n.map.renderRoute(t)}}))}},this.clear=function(){n.start.clear(),n.end.clear(),n.map.removeEntry(n.routeshape)},n.init(t,r)}return this.init=function(e){if(t.prop=$.extend(t.prop,e),t.prop.lat=parseFloat(t.prop.lat),t.prop.lon=parseFloat(t.prop.lon),t.map_container=$("#"+t.prop.map_container),!t.map_container.length)return alert("map container not exists!"),!1;t.map_container.html("");try{t.map=new Microsoft.Maps.Map(t.map_container[0],{credentials:t.prop.map_key,mapTypeId:t.MAP_TYPES[t.prop.default_map_type-1],width:t.prop.width,height:t.prop.height,center:new Microsoft.Maps.Location(t.prop.lat,t.prop.lon),zoom:t.prop.default_zoom,enableClickableLogo:!1,enableSearchLogo:t.prop.use_searchbox,showMapTypeSelector:t.prop.use_type_selector})}catch(e){return alert("map initialize is failed!"),!1}var o=t.map.getZoomRange();t.min_zoom=Math.max(t.min_zoom,o.min),t.max_zoom=Math.min(t.max_zoom,o.max),t.prop.default_zoom<t.min_zoom?(t.zoom=t.min_zoom,t.setZoom(t.zoom)):t.prop.default_zoom>=t.max_zoom?(t.zoom=t.max_zoom,t.setZoom(t.zoom)):t.zoom=t.prop.default_zoom,t.prop.use_router&&($("#"+t.prop.routes_container).length||(t.prop.use_router=!1)),Microsoft.Maps.Events.addHandler(t.map,"viewchangeend",(function(e){var o=t.getZoom();if(o!=t.zoom){for(i in t.markers)if(t.markers[i].infobox){var r=t.getInfoboxLocation(t.markers[i].getLocation());t.markers[i].infobox.setLocation(r)}0!=t.prop.zoom_listener&&t.prop.zoom_listener(o),t.zoom=o}for(i in t.infobox_visible){var n=t.infobox_visible[i];if(t.markers[n].infobox){var s=t.markers[n].infobox.getOptions();s.visible=!0,t.markers[n].infobox.setOptions(s)}}if(t.smart_zoom_direction){var a=t.smart_zoom_direction,c=t.mapContains(t.bounds,t.smart_zoom_direction);1!=t.smart_zoom_direction||c?-1==t.smart_zoom_direction&&c||t.zoom<=1||t.zoom>=t.max_zoom?(t.smart_zoom_direction=0,t.bounds=null):t.changeZoom(a):(t.smart_zoom_direction=0,t.bounds=null,t.changeZoom(-a))}})),Microsoft.Maps.Events.addHandler(t.map,"viewchangestart",(function(e){for(i in t.infobox_visible=[],t.markers)if(t.markers[i].infobox){var o=t.markers[i].infobox.getOptions();o.visible&&(o.visible=!1,t.markers[i].infobox.setOptions(o),t.infobox_visible.push(i))}})),t.prop.type_listener&&Microsoft.Maps.Events.addHandler(t.map,"maptypechanged",(function(){if(t.is_loaded){var e=t.MAP_TYPES.indexOf(t.map.getMapTypeId());t.prop.type_listener(e+1);var o=t.map.getZoomRange();t.min_zoom=Math.max(t.min_zoom,o.min),t.max_zoom=Math.min(t.max_zoom,o.max),t.zoom<t.min_zoom?(t.zoom=t.min_zoom,t.setZoom(t.zoom)):t.zoom>=t.max_zoom&&(t.zoom=t.max_zoom,t.setZoom(t.zoom))}})),t.is_loaded=!0},this.renderControl=function(){var e='<div style="position: absolute; right:5px; top:5px; background:#fff; opacity:0.5; z-index:1000;"><select id="map_type" style="margin:5px;">',o=t.map.getMapTypeId(),r=[];for(var i in t.MAP_TYPES)if(t.MAP_TYPES[i]){t.map.setMapType(t.MAP_TYPES[i]);var n="auto"==t.MAP_TYPES[i]?"Auto":t.map.getImageryId();$.inArray(n,r)&&(r.push(n),e+='<option value="'+i+'"'+(o==t.MAP_TYPES[i]?'selected="selected"':"")+">"+n+"</option>")}$.inArray(n,r)||(o=t.MAP_TYPES[1]),t.map.setMapType(o),e+='</select><div id="zoom_out" style="float:right; width:30px; height:30px;text-align:center;vertical-align:middle;margin:5px;border:1px solid #ccc; cursor:pointer;">-</div><div style="float:right; width:30px; height:30px; text-align:center;vertical-align:middle;margin:5px;border:1px solid #ccc;cursor:pointer;" id="zoom_in">+</div></div>',$("#"+t.prop.map_container).css("position","relative").append(e),$("#zoom_in").on("click",(function(){t.zoom<t.max_zoom&&t.setZoom(t.zoom+1)})),$("#zoom_out").on("click",(function(){t.zoom>t.min_zoom&&t.setZoom(t.zoom-1)})),$("#map_type").on("change",(function(){t.map.setMapType(t.MAP_TYPES[$(this).val()])}))},this.addMarker=function(e,r,i){var n=new o(t,e,r,i);t.markers.push(n),t.wait_requests||(t.setSmartCenter(),t.addAmenities())},this.setType=function(e){t.MAP_TYPES[e]&&t.map.setMapType(t.MAP_TYPES[e])},this.getZoom=function(){return t.map.getZoom()},this.setZoom=function(e){var o=t.map.getOptions();o.zoom=e,t.map.setView(o)},this.changeZoom=function(e){return t.zoom=t.zoom+e,t.setZoom(t.zoom),t.zoom},this.getCenter=function(){var e=t.map.getCenter();return{latitude:e.latitude,longitude:e.longitude}},this.setCenter=function(e,o){var r=t.map.getOptions();r.center=new Microsoft.Maps.Location(e,o),t.map.setView(r)},this.getMarkersBounds=function(){var e=[];if(t.markers.length)for(i in t.markers)e.push(t.markers[i].getLocation());else e.push(new Microsoft.Maps.Location(t.prop.lat,t.prop.lon));return new Microsoft.Maps.LocationRect.fromLocations(e)},this.setCenterFromLocation=function(e){this.geocodeLocation(e,{},t.setCenter)},this.setSmartCenter=function(){if(t.bounds=t.getMarkersBounds(),t.setCenter(t.bounds.center.latitude,t.bounds.center.longitude),!t.prop.use_smart_zoom)return!1;var e;e=t.mapContains(t.bounds)?1:-1,t.smart_zoom_direction=e,t.changeZoom(e)},this.getInfoboxLocation=function(e){var o=t.map.tryLocationToPixel(e);return o?(o.x+=5,o.y-=25,t.map.tryPixelToLocation(o)):null},this.mapContains=function(e){var o=t.map.getBounds(),r=t.map.tryLocationToPixel(o.getNorthwest());return r.y+=$("#"+t.prop.map_container+" .OverlaysTL").height()+2,t.map.tryPixelToLocation(r).latitude,o.getEast()>=e.getEast()&&o.getNorth()>=e.getNorth()&&o.getSouth()<=e.getSouth()&&o.getWest()<=e.getWest()},this.clear=function(){for(i in t.markers)t.markers[i].clear(),t.markers[i]=null;t.markers=[]},this.remove=function(){t.clear(),t.map.dispose(),t.map=null},this.getKey=function(){return t.prop.map_key},this.getLocationFromAddress=function(e,t,o,r,i){var n=[];return e&&n.push(e),t&&n.push(t),o&&n.push(o),r&&n.push(r),n.join(", ")},this.addEntry=function(e){t.map.entities.push(e)},this.removeEntry=function(e){t.map.entities.remove(e)},this.setView=function(e){t.map.setView(e)},this.startRoute=function(){if(t.markers.length){var e=t.markers[0].getLocation(),o=t.map.getBounds();t.calcRoute([e.latitude.toFixed(3)+","+e.longitude.toFixed(3),(e.latitude+(o.getNorth()-o.getSouth())/10).toFixed(3)+","+(e.longitude+(o.getEast()-o.getWest())/10).toFixed(3)])}},this.calcRoute=function(e){if(!t.prop.use_router)return!1;if(!e.length)return!1;$("#"+t.prop.routes_container);var o=new n(t,e,{});t.routes.push(o)},this.renderRoute=function(e){var o="",r=0,i=0;for(var n in e.routeLegs){for(var s in e.routeLegs[n].itineraryItems)e.routeLegs[n].itineraryItems[s].instruction.text&&(o+="<p>"+e.routeLegs[n].itineraryItems[s].instruction.text+"</p>");r+=e.routeLegs[n].travelDistance||0,i+=e.routeLegs[n].travelDuration||0}r&&(o+="Total distance: "+r.toFixed(2)+" "+e.distanceUnit+" <br>"),i&&(o+="Total duration: "+i.toFixed(2)+" "+e.durationUnit+"<br>"),$("#"+t.prop.routes_container).html(o)},this.deleteRoute=function(){if(t.routes){for(i in t.routes)t.routes[i].clear(),t.routes[i]=null;t.routes=[],$("#"+t.prop.routes_container).html("")}},this.addAmenities=function(){t.map.getBounds();var e="http://spatial.virtualearth.net/REST/v1/data/c2ae584bbccc4916a0acf75d1e6947b4/NavteqEU/NavteqPOIs?spatialFilter=nearby%2850.1120796203613,8.68340969085693,100%29&$select=EntityID,Latitude,Longitude,DisplayName,__Distance,LanguageCode&$top=3&$format=json&jsonp=?&key="+t.prop.map_key;console.log(e),$.getJSON(e,(function(e){t.wait_requests--,e&&e.resourceSets&&e.resourceSets.length>0&&e.resourceSets[0].resources&&e.resourceSets[0].resources.length>0&&(console.log(e.resourceSets[0].resources[0]),e.resourceSets[0].resources[0].point.coordinates)}))},this.moveMarker=function(e,o,r){for(var i in t.markers)if(t.markers[i].getGUID()==e){t.markers[i].move(o,r);break}t.setCenter(o,r)},this.moveMarkers=function(e,o){for(var r in t.markers)t.markers[r].move(e,o);t.setCenter(e,o)},t.init(e),t})},7470:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.geomapAmenitySelect=function(e){this.properties={siteUrl:"",rand:"",amenities:{},load_form:"admin/geomap/ajax_get_amenity_form/",load_data:"admin/geomap/ajax_get_amenity_data/",id_main:"",id_span:"",id_text:"",id_open:"",id_hidden_amenity:"",id_items:"amenity_select_items",id_back:"amenity_select_back",id_close:"amenity_close_link",id_left:"amenity_max_left_block",hidden_name:"id_amenity",raw_data:{},max:5,gid:"",output:"max",errors:{max_items_reached:"Max items count is reached"},contentObj:new loadingContent({loadBlockWidth:"60%",closeBtnClass:"load_content_controller_close",closeBtnPadding:15})},this.errors={};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.id_main="amenity_select_"+t.properties.rand,t.properties.id_span="amenity_text_"+t.properties.rand,t.properties.id_text="amenity_list_"+t.properties.rand,t.properties.id_open="amenity_open_"+t.properties.rand,t.properties.id_hidden_amenity="amenity_hidden_"+t.properties.rand,$("#"+t.properties.id_open).unbind().on("click",(function(){return t.open_form(),!1})),$(document).off("click","#"+t.properties.id_back).on("click","#"+t.properties.id_back,(function(){return t.clear_selection(),!1})),$(document).off("click","#"+t.properties.id_items+" li").on("click","#"+t.properties.id_items+" li",(function(){return t.set_value($(this).attr("index"),"toggle"),!1}))},this.open_form=function(){var e=t.properties.siteUrl+t.properties.load_form+t.properties.gid+"/"+t.properties.max;$.ajax({url:e,cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),t.load_amenities(),$("#"+t.properties.id_close).unbind().on("click",(function(){return t.properties.contentObj.hide_load_block(),!1})),t.update_selected_count()}})},this.load_amenities=function(){$.ajax({url:t.properties.siteUrl+t.properties.load_data+t.properties.gid,dataType:"json",cache:!1,success:function(e){for(var o in e.amenities)t.properties.raw_data[e.amenities[o].id]=e.amenities[o],$("#"+t.properties.id_items).append('<li index="'+e.amenities[o].id+'">'+e.amenities[o].name+"</li>"),1==t.properties.amenities[e.amenities[o].id]&&t.set_value(e.amenities[o].id,"no-toggle")}})},this.set_value=function(e,o){if("toggle"==o&&$("#sel_"+t.properties.rand+"_"+e).length>0)t.unset_value(e);else{if(1==t.properties.max)for(var r in t.properties.amenities)t.unset_value(r);var i=t.get_all_sum();if(!(t.properties.max-i<1&&1!=t.properties.amenities[e])){if(1==t.properties.max)var n=t.properties.hidden_name;else n=t.properties.hidden_name+"[]";return $("#sel_"+t.properties.rand+"_"+e).length||($("#"+t.properties.id_main).append('<input type="hidden" name="'+n+'" value="'+e+'" id="sel_'+t.properties.rand+"_"+e+'" >'),$("#sel_"+t.properties.rand+"_"+e).change()),t.properties.amenities[e]=1,$("#"+t.properties.id_items+" li[index="+e+"]").addClass("selected"),t.update_selected_count(),!1}}},this.unset_value=function(e){return $("#sel_"+t.properties.rand+"_"+e).remove(),t.properties.amenities[e]=0,$("#"+t.properties.id_items+" li[index="+e+"]").removeClass("selected"),t.update_selected_count(),!1},this.clear_selection=function(){for(i in t.properties.amenities)1==t.properties.amenities[i]&&t.unset_value(i)},this.update_selected_count=function(){var e=t.get_all_sum();if("1"==t.properties.max){var o=$("#"+t.properties.id_items+" li.selected:first").text();$("#"+t.properties.id_span).html(o)}else{$("#"+t.properties.id_span).html(e);var r=t.get_all_text();$("#"+t.properties.id_text).html(r)}$("#"+t.properties.id_left).html(t.properties.max-e)},this.get_all_sum=function(){var e=0;for(id in t.properties.amenities)1==t.properties.amenities[id]&&(e+=1);return e},this.get_all_text=function(){var e=[];for(id in t.properties.amenities)1==t.properties.amenities[id]&&e.push(t.properties.raw_data[id].name);return e.join(", ")},this.sum=function(e){var t=0;for(i in e)t+=parseInt(e[i]);return t},t.Init(e)})},9557:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.GoogleMapsv3=function(e){if("undefined"==typeof google)return!1;this.prop={site_url:"",save_location_url:"/admin/admin_settings.php",map_container:"map_container",panorama_container:"pano_container",routes_container:"routes",default_zoom:10,default_map_type:2,lat:56.614607,lon:47.863757,width:0,height:0,icon:null,use_search_by_area:!1,use_smart_zoom:!1,use_searchbox:!1,use_search_auto:!1,use_search_radius:!1,search_radius_default:1,use_show_details:!1,use_panorama:!1,use_router:!1,use_type_selector:!1,use_amenities:!1,amenities:[],amenities_names:{},rtl:!1,geocode_listener:!1,zoom_listener:!1,type_listener:!1,radius_listener:!1,position_listener:!1,search_figure_stroke_color:"#FF0000",search_figure_stroke_opacity:.8,search_figure_stroke_weight:2,search_figure_fill_color:"#FF0000",search_figure_fill_opacity:.35,search_figure_editable:!1,default_circle_search_radius:100,circle_search_radius:0,circle_search_radius_unit:"km",circle_center_lat:0,circle_center_lon:0,circle_slider_step:10,circle_slider_min:10,langs:[]},this.MAP_TYPES=[google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.TERRAIN],this.ANIMATION_TYPES=[google.maps.Animation.DROP],this.is_loaded=!1,this.min_zoom=1,this.max_zoom=19,this.map=null,this.searchCircle=null,this.panorama=null,this.markers=[],this.amenities=[],this.places=[],this.zoom=null,this.place_service=null,this.directions_service=null,this.directions_display=null,this.wait_requests=0,this.amenities_loaded=!1;var t=this;function o(e,t,o,r){this.prop={draggable:!1,icon:null,info:null,teaserInfo:null,showInfo:!0,state:"none",gid:"default",drag:null,dragend:null,drag_listener:!1},this.map=e,this.marker=null,this.infobox=null,this.prop.icon=e.prop.icon;var i=this;return this.init=function(e,t,o){i.prop=$.extend(i.prop,o),i.marker=new google.maps.Marker({draggable:i.prop.draggable,icon:i.prop.icon,map:i.map.getControl(),position:new google.maps.LatLng(e,t),zIndex:100}),i.prop.draggable&&(google.maps.event.addListener(i.marker,"drag",(function(e){if(i.prop.infobox){var t=i.map.getInfoboxLocation(i.getLocation());i.infobox.setLocation(t)}i.prop.drag&&i.prop.drag()})),google.maps.event.addListener(i.marker,"dragend",(function(e){if(i.prop.drag_listener){var t=i.getLocation();window[i.prop.drag_listener](i.prop.gid,t.latitude,t.longitude)}i.prop.dragend&&i.prop.dragend()}))),i.prop.showInfo&&google.maps.event.addListener(i.marker,"click",(function(e){i.displayInfobox()}))},this.displayInfobox=function(){if(!i.infobox){var e='<div class="info_box">',t=i.getLocation();for(var o in i.map.markers){var r=i.map.markers[o].getLocation();r.latitude==t.latitude&&r.longitude==t.longitude&&(e+='<div class="info_item">'+i.map.markers[o].prop.info+"</div>")}e+="</div>",i.infobox=new google.maps.InfoWindow({content:e})}i.infobox.open(i.map.getControl(),i.marker)},this.getGUID=function(){return i.prop.gid},this.getLocation=function(){var e=i.marker.getPosition();return{latitude:e.lat(),longitude:e.lng()}},this.clear=function(){i.infobox&&i.infobox.close(),i.marker.setMap(null),i.map=null},this.move=function(e,t){var o=new google.maps.LatLng(e,t);i.marker.setPosition(o)},i.init(t,o,r),i}function r(e,t){this.marker=null,this.types=[];var o=this;return this.init=function(e,t){o.marker=e,o.types=t},this.getMarker=function(){return o.marker},this.clear=function(e){return(e=e||[]).length?o.types=$.grep(o.types,(function(t){return-1==$.inArray(t,e)})):o.types=[],!o.types.length&&(o.marker.clear(),o.marker=null,!0)},o.init(e,t),o}return this.init=function(e){t.prop=$.extend(t.prop,e),t.prop.lat=parseFloat(t.prop.lat),t.prop.lon=parseFloat(t.prop.lon);var o=$("#"+t.prop.map_container);if(!o.length)return alert("map container not exists!"),!1;o.html(""),o.css({width:t.prop.width,height:t.prop.height});try{t.map=new google.maps.Map(o[0],{center:new google.maps.LatLng(t.prop.lat,t.prop.lon),mapTypeId:t.MAP_TYPES[t.prop.default_map_type-1],zoom:parseInt(t.prop.default_zoom),mapTypeControl:t.prop.use_type_selector,streetViewControl:t.prop.use_panorama,scrollwheel:t.prop.use_search_by_area})}catch(e){return alert("map initialize is failed!"),!1}t.min_zoom=Math.max(t.min_zoom,t.MAP_TYPES[t.prop.default_map_type-1].minZoom),t.max_zoom=Math.min(t.max_zoom,t.MAP_TYPES[t.prop.default_map_type-1].maxZoom),t.prop.default_zoom<t.min_zoom?(t.zoom=t.min_zoom,t.setZoom(t.zoom)):t.prop.default_zoom>=t.max_zoom?(t.zoom=t.max_zoom,t.setZoom(t.zoom)):t.zoom=t.prop.default_zoom,t.prop.use_router&&($("#"+t.prop.routes_container).length?(t.directions_service=new google.maps.DirectionsService,t.directions_display=new google.maps.DirectionsRenderer({draggable:!0,preserveViewport:!0}),google.maps.event.addListener(t.directions_display,"directions_changed",(function(){t.renderRoute()}))):t.prop.use_router=!1),(t.prop.use_searchbox||t.prop.use_amenities)&&(t.place_service=new google.maps.places.PlacesService(t.map),t.prop.use_searchbox&&t.addSearchbox()),google.maps.event.addListener(t.map,"zoom_changed",(function(){if(!t.is_loaded)return!1;var e=t.getZoom();e!=t.zoom&&(0!=t.prop.zoom_listener&&t.prop.zoom_listener(e),t.zoom=e)})),t.prop.type_listener&&google.maps.event.addListener(t.map,"maptypeid_changed",(function(){if(t.is_loaded){var e=t.MAP_TYPES.indexOf(t.map.getMapTypeId());t.prop.type_listener(e+1)}})),t.prop.use_search_by_area&&t.drawSearchCircle(),t.is_loaded=!0},this.renderControl=function(){var e='<div style="position: absolute; right:5px; top:5px; background:#fff; opacity:0.5; z-index:1000;"><select id="map_type" style="margin:5px;">',o=t.map.getMapTypeId(),r=[];for(var i in t.MAP_TYPES)if(t.MAP_TYPES[i]){t.map.setMapTypeId(t.MAP_TYPES[i]);var n=t.MAP_TYPES[i];r.push(n),e+='<option value="'+i+'"'+(o==t.MAP_TYPES[i]?'selected="selected"':"")+">"+n+"</option>"}$.inArray(n,r)||(o=t.MAP_TYPES[1]),t.map.setMapTypeId(o),e+='</select><div id="zoom_out" style="float:right; width:30px; height:30px;text-align:center;vertical-align:middle;margin:5px;border:1px solid #ccc; cursor:pointer;">-</div><div style="float:right; width:30px; height:30px; text-align:center;vertical-align:middle;margin:5px;border:1px solid #ccc;cursor:pointer;" id="zoom_in">+</div></div>',$("#"+t.prop.map_container).css("position","relative").append(e),$("#zoom_in").on("click",(function(){t.zoom<t.max_zoom&&t.setZoom(t.zoom+1)})),$("#zoom_out").on("click",(function(){t.zoom>t.min_zoom&&t.setZoom(t.zoom-1)})),$("#map_type").on("change",(function(){t.map.setMapType(t.MAP_TYPES[$(this).val()])}))},this.getControl=function(){return t.map},this.addMarker=function(e,r,i){var n=new o(t,e,r,i);if(t.markers.push(n),!t.wait_requests){if(t.setSmartCenter(),t.prop.use_panorama&&!t.panorama){var s=n.getLocation();t.addPanorama(s.latitude,s.longitude)}t.prop.use_amenities&&t.prop.amenities.length&&!t.amenities.length&&t.addAmenities()}},this.drawSearchCircle=function(e,o,r){var i,n,s;i=0==e||null==e?parseFloat(t.prop.circle_search_radius):e,n=0==o||null==o?t.prop.circle_center_lat:o,s=0==r||null==r?t.prop.circle_center_lon:r;var a={strokeColor:t.prop.search_figure_stroke_color,strokeOpacity:t.prop.search_figure_stroke_opacity,strokeWeight:t.prop.search_figure_stroke_weight,fillColor:t.prop.search_figure_fill_color,fillOpacity:t.prop.search_figure_fill_opacity,editable:t.prop.search_figure_editable,map:t.map,center:new google.maps.LatLng(n,s),radius:i};t.searchCircle=new google.maps.Circle(a),$("#circle_center_lat").val(n),$("#circle_center_lon").val(s),t.setCenter(n,s),0!=e&&null!=e||t.addCircleSlider(i),google.maps.event.addListener(t.searchCircle,"radius_changed",(function(){t.circleSliderChange()})),google.maps.event.addListener(t.searchCircle,"center_changed",(function(){t.circlePositionChange()}))},this.addCircleSlider=function(e){view_radius=t.convertDistanceUnits(e);var o=$('<div class="nearest_users_input_block">\t<div class="circle_slider_block" id="circle_radius_slider">\t\t<a href="#" class="ui-slider-handle ui-state-default ui-corner-all">\t\t\t<span id="circle_radius_span" style="position: inherit; margin: 25px -40px; width: 100px;">'+t.prop.langs.radius+" "+view_radius.toFixed()+" "+t.prop.langs.unit+"</span>\t\t</a>\t</div></div>");o.find("#circle_radius_slider").slider({orientation:"horizontal",step:t.prop.circle_slider_step,max:t.prop.default_circle_search_radius,min:t.prop.circle_slider_min,value:e,range:!1,animate:"slow",change:function(e,o){t.setCircleRadius(o.value)}});var r=t.prop.rtl?google.maps.ControlPosition.LEFT_BOTTOM:google.maps.ControlPosition.RIGHT_BOTTOM;t.map.controls[r].push(o[0]),$(".map_container").on("click",(function(){$("#circle_radius_slider a").removeClass("ui-state-focus"),$("#circle_radius_slider a").removeClass("ui-state-hover")}))},this.circleSliderChange=function(){var e=t.searchCircle.getRadius();$("#circle_radius_slider").slider("value")!=e&&($("#circle_radius_slider").slider("value",e),0!=t.prop.radius_listener&&t.prop.radius_listener(e))},this.circlePositionChange=function(){var e=t.searchCircle.getCenter(),o=t.searchCircle.getRadius();$("#circle_center_lat").val(e.lat()),$("#circle_center_lon").val(e.lng()),t.setCenter(e.lat(),e.lng()),t.searchCircle.setMap(null),t.searchCircle=null,t.drawSearchCircle(o,e.lat(),e.lng()),t.prop.position_listener()},this.setCircleRadius=function(e){var o=t.searchCircle.getCenter();t.searchCircle.setMap(null),t.searchCircle=null,t.drawSearchCircle(e,o.lat(),o.lng()),t.prop.circle_search_radius=e,$("#circle_radius").val(e),e=t.convertDistanceUnits(e),$("#circle_radius_span").text(t.prop.langs.radius+" "+e.toFixed()+" "+t.prop.langs.unit)},this.convertDistanceUnits=function(e){return"km"==t.prop.circle_search_radius_unit?e/1e3:e/1609.344},this.setType=function(e){t.MAP_TYPES[e]&&t.map.setMapTypeId(t.MAP_TYPES[e])},this.getZoom=function(){return t.map.getZoom()},this.setZoom=function(e){t.map.setZoom(e)},this.changeZoom=function(e){return t.zoom=t.zoom+e,t.setZoom(t.zoom),t.zoom},this.getCenter=function(){var e=t.map.getCenter();return{latitude:e.lat(),longitude:e.lng()}},this.setCenter=function(e,o){t.map.setCenter(new google.maps.LatLng(e,o))},this.getMarkersBounds=function(){var e=t.markers;for(var o in t.places)e.push(t.places[o]);for(var o in t.amenities)e.push(t.amenities[o].getMarker());if(!e.length)return new google.maps.LatLngBounds(new google.maps.LatLng(t.prop.lat,t.prop.lon),new google.maps.LatLng(t.prop.lat,t.prop.lon));var r=e[0].getLocation();if(1==e.length)return new google.maps.LatLngBounds(new google.maps.LatLng(r.latitude,r.longitude),new google.maps.LatLng(r.latitude,r.longitude));var i=e[1].getLocation(),n=new google.maps.LatLngBounds(new google.maps.LatLng(Math.min(r.latitude,i.latitude),Math.min(r.longitude,i.longitude)),new google.maps.LatLng(Math.max(r.latitude,i.latitude),Math.max(r.longitude,i.longitude)));for(o=2;o<e.length;o++){var s=e[o].getLocation();n.extend(new google.maps.LatLng(s.latitude,s.longitude))}return n},this.setCenterFromLocation=function(e){this.geocodeLocation(e,{},t.setCenter)},this.setSmartCenter=function(){var e=t.getMarkersBounds();if(t.prop.use_smart_zoom)t.map.fitBounds(e);else{var o=e.getCenter();t.setCenter(o.lat(),o.lng())}},this.getInfoboxLocation=function(e){var o=t.map.tryLocationToPixel(e);return o?(o.x+=5,o.y-=25,t.map.tryPixelToLocation(o)):null},this.clear=function(){for(i in t.markers)t.markers[i].clear(),t.markers[i]=null;for(i in t.markers=[],t.places)t.places[i].clear(),t.places[i]=null;for(i in t.places=[],t.amenities)t.amenities[i].clear();t.amenities=[]},this.remove=function(){t.clear(),t.panorama=null,t.map=null},this.addPanorama=function(e,o){var r=$("#"+t.prop.panorama_container);if(r.length){r.css({width:t.prop.width,height:t.prop.height,position:"absolute",opacity:0});var i=new google.maps.LatLng(e,o),n=new google.maps.StreetViewService;t.addPanoramaFromLocation(n,i,50)}},this.addPanoramaFromLocation=function(e,o,r){e.getPanoramaByLocation(o,r,(function(i,n){if(n==google.maps.StreetViewStatus.OK){var s=$("#"+t.prop.panorama_container);t.panorama=new google.maps.StreetViewPanorama(s[0],{position:i.location.latLng,pov:{heading:0,pitch:0,zoom:1}}),t.map.setStreetView(t.panorama),s.css({position:"relative",opacity:1})}else 200!=r?t.addPanoramaFromLocation(e,o,200):(s=$("#"+t.prop.panorama_container)).css({position:"relative",opacity:1,display:"none"})}))},this.createRoute=function(){if(t.markers.length){var e=t.markers[0].getLocation(),o=t.map.getBounds();t.directions_display.setMap(t.map),t.calcRoute([new google.maps.LatLng(e.latitude,e.longitude),new google.maps.LatLng(e.latitude+(o.getNorthEast().lat()-o.getSouthWest().lat())/10,e.longitude+(o.getSouthWest().lng()-o.getSouthWest().lng())/10)])}},this.calcRoute=function(e){return!!t.prop.use_router&&!!e.length&&void t.directions_service.route({origin:e[0],destination:e[e.length-1],travelMode:google.maps.DirectionsTravelMode.DRIVING},(function(e,o){o==google.maps.DirectionsStatus.OK&&t.directions_display.setDirections(e)}))},this.renderRoute=function(){for(var e="",o=0,r=0,i=t.directions_display.getDirections().routes[0].legs[0],n=0;n<i.steps.length;n++)i.steps[n].instructions&&(e+="<p>"+i.steps[n].instructions+"</p>"),o+=i.steps[n].distance.value||0,r+=i.steps[n].duration.value||0;if(o&&(e+="Total distance: "+(o/=1e3).toFixed(2)+" km <br>"),r){var s="minutes";(r/=60)>=60&&(r/=60,s="hours"),e+="Total duration: "+r.toFixed(2)+" "+s+"<br>"}$("#"+t.prop.routes_container).html(e)},this.deleteRoute=function(){t.directions_display.setMap(null),$("#"+t.prop.routes_container).html("")},this.searchByKeyword=function(e,o){if(!e||!o)return!1;if(t.places.length){for(var r in t.places)t.places[r].clear();t.places=[]}var i=t.getCenter(),n={location:new google.maps.LatLng(i.latitude,i.longitude),radius:1e3*o,keyword:e};t.place_service.search(n,(function(e,o){if(o==google.maps.places.PlacesServiceStatus.OK)for(var r in e)t.prop.use_show_details?(t.getDetailedInfo(e[r].reference,t.addPlace),t.wait_requets++):t.addPlace(e[r]),t.setSmartCenter();else o==google.maps.places.PlacesServiceStatus.ZERO_RESULTS?alert("no results"):alert("Error: "+o)}))},this.searchByTypes=function(e){var o=[];for(var r in t.amenities)t.amenities[r].clear(e)||o.push(t.amenities[r]);t.amenities=o;var i={types:e};i.location=t.map.getCenter(),i.radius="500",t.place_service.search(i,(function(e,o){if(o!=google.maps.places.PlacesServiceStatus.OK)return!1;for(var r in e)t.prop.use_show_details?(t.getDetailedInfo(e[r].reference,t.addAmenity),t.wait_requests++):t.addAmenity(e[r]);t.setSmartCenter()}))},this.addPlace=function(e,r){(r=r||!1)&&t.wait_requests--;var i={info:t.getPlaceInfo(e),showInfo:!0,icon:{url:e.icon?e.icon:t.prop.search_icon,scaledSize:new google.maps.Size(16,16)},reference:e.reference},n=new o(t,e.geometry.location.lat(),e.geometry.location.lng(),i);t.places.push(n)},this.getPlaceInfo=function(e){var t="";if(e.name&&(e.url?t+="<p><b><a href='"+e.url+"' target='_blank'>"+e.name+"</a></b>":t+="<p><b>"+e.name+"</b>",e.rating&&(t+="&nbsp;(Rating:&nbsp;"+e.rating+")"),t+="</p>",e.name),e.vicinity&&(t+="<p>"+e.vicinity+"</p>",e.vicinity),e.international_phone_number&&(t+="<p>"+e.international_phone_number+"</p>"),e.website){var o=/(http[s]*:\/\/)+(.*?)[\/]+/i;o.exec(e.website)||(e.website="http://"+e.website);var r=o.exec(e.website)[2]?o.exec(e.website)[2]:e.website;r&&(t+="<p><a href='"+e.website+"' target='_blank'>"+r+"</a></p>")}return e.icon||(e.icon="http://maps.google.com/mapfiles/kml/pal3/icon43.png"),'<div>\t\x3c!-- div class="marker_img"><img src="'+e.icon+'" width="30" height="30"></div --\x3e\t<div id="marker_info_td">'+t+"</div></div>"},this.getDetailedInfo=function(e,o){var r={reference:e};t.place_service.getDetails(r,(function(e,t){t==google.maps.places.PlacesServiceStatus.OK&&o(e,!0)}))},this.addSearchbox=function(){var e=$('<div class="map_search_box">\t<input type="text" class="map_search_keyword">\t<input type="button" value="Search"></div>');t.prop.use_search_radius&&e.find(".map_search_keyword").after('\tWithin:\t<select class="map_search_radius">\t\t<option value="0.5">0.5</option>\t\t<option value="1" selected>1</option>\t\t<option value="3">3</option>\t\t<option value="5">5</option>\t\t<option value="10">10</option>\t\t<option value="20">20</option>\t\t<option value="50">50</option>\t</select> km'),e.find(".map_search_keyword").on("keyup",(function(e){return 13==(e=e||window.event).keyCode&&t.searchByKeyword($(this).val(),t.prop.use_search_radius?$("#"+t.prop.map_container+" .map_search_radius").val():t.prop.search_radius_default),!1})),e.find('input[type="button"]').on("click",(function(){t.searchByKeyword($("#"+t.prop.map_container+" .map_search_keyword").val(),t.prop.use_search_radius?$("#"+t.prop.map_container+" .map_search_radius").val():t.prop.search_radius_default)}));var o=t.prop.rtl?google.maps.ControlPosition.LEFT_BOTTOM:google.maps.ControlPosition.RIGHT_BOTTOM;t.map.controls[o].push(e[0]),t.prop.use_search_auto&&(G.autocomplete=new google.maps.places.Autocomplete($("#"+t.prop.map_container+" .map_search_keyword")[0],{bounds:G.map.getBounds(),types:["establishment"]}))},this.addAmenities=function(){if(t.amenities_loaded||!t.prop.amenities.length)return!1;t.amenities_loaded=!0,t.searchByTypes(t.prop.amenities);var e='<div class="amenities_goolgemaps">\t<div class="amenities_header">\t\t<a class="amenities_switch"></a>Local amenity\t</div>\t<div class="amenities_body">';for(var o in t.prop.amenities)e+='\t<div id="div_'+t.prop.amenities[o]+'">\t\t<table cellpadding="0" cellspacing="0">\t\t\t<tr>\t\t\t\t<td>\t\t\t\t\t<input type="checkbox" id="id_'+t.prop.amenities[o]+'" value="'+t.prop.amenities[o]+'" checked>\t\t\t\t</td>\t\t\t\t\x3c!-- td width="16">\t\t\t\t\t<img src="/uploades/gmap/'+t.prop.amenities[o]+' style="padding: 0 2px;">\t\t\t\t</td --\x3e\t\t\t\t<td style="font-weight:bold; color:#000;">'+t.prop.amenities_names[t.prop.amenities[o]]+"</td>\t\t\t</tr>\t\t</table>\t</div>";e+="\t</div></div>",(e=$(e)).find('input[type="checkbox"]').on("click",(function(){this.checked?t.searchByTypes([this.value]):t.clearAmenity(this.value)})),e.find("#"+t.prop.map_container+" .amenities_switch").on("click",(function(){$(this).toggleClass("expand"),$("#"+t.prop.map_container+" .amenities_goolgemaps .amenities_body").toggle()}));var r=t.prop.rtl?google.maps.ControlPosition.LEFT_TOP:google.maps.ControlPosition.RIGHT_TOP;t.map.controls[r].push(e[0])},this.addAmenity=function(e,i){(i=i||!1)&&t.wait_requests--;var n={info:t.getPlaceInfo(e),showInfo:!0,icon:{url:e.icon?e.icon:t.prop.search_icon,scaledSize:new google.maps.Size(16,16)},reference:e.reference},s=new o(t,e.geometry.location.lat(),e.geometry.location.lng(),n);e=new r(s,$.grep(e.types,(function(e){return-1!=$.inArray(e,t.prop.amenities)}))),t.amenities.push(e)},this.clearAmenity=function(e){var o=[];for(var r in t.amenities)t.amenities[r].clear([e])||o.push(t.amenities[r]);t.amenities=o},this.moveMarker=function(e,o,r){for(var i in t.markers)if(t.markers[i].getGUID()==e){t.markers[i].move(o,r);break}t.setCenter(o,r)},this.moveMarkers=function(e,o){for(var r in t.markers)t.markers[r].move(e,o);t.setCenter(e,o)},t.init(e),t})},9367:()=>{eval(function(e,t,o,r,i,n){if(i=function(e){return(e<62?"":i(parseInt(e/62)))+((e%=62)>35?String.fromCharCode(e+29):e.toString(36))},!"".replace(/^/,String)){for(;o--;)n[i(o)]=r[o]||i(o);r=[function(e){return n[e]}],i=function(){return"\\w+"},o=1}for(;o--;)r[o]&&(e=e.replace(new RegExp("\\b"+i(o)+"\\b","g"),r[o]));return e}('(5(){7 d=32,f=33,g=34;5 j(a){8 5(b){3[a]=b}}5 k(a){8 5(){8 3[a]}}7 l;5 m(a,b,c){3.1f(m,13.12.22);3.b=a;3.a=[];3.m=[];3.$=[31,2X,2Y,35,3c];3.i=[];3.z=g;c=c||{};3.f=c.3b||37;3.V=c.1A||f;3.i=c.39||[];3.U=c.2V||3.O;3.T=c.2K||3.N;3.M=d;6(c.23!=25)3.M=c.23;3.p=g;6(c.21!=25)3.p=c.21;n(3);3.18(a);3.I=3.b.1t();7 e=3;13.12.1m.1x(3.b,"2M",5(){7 h=e.b.1P[e.b.1R()].1A,o=e.b.1t();6(!(o<0||o>h))6(e.I!=o){e.I=e.b.1t();e.k()}});13.12.1m.1x(3.b,"2U",5(){e.h()});b&&b.14&&3.B(b,g)}l=m.4;l.O="3E://13-12-3C-3B-3G.3M.3H/3I/3x/3l/3m/m";l.N="3k";l.1f=5(a,b){8 5(c){15(7 e 3g c.4)3.4[e]=c.4[e];8 3}.2D(a,[b])};l.1j=5(){6(!3.z){3.z=d;q(3)}};l.1k=5(){};5 n(a){6(!a.i.14)15(7 b=0,c;c=a.$[b];b++)a.i.16({1B:a.U+(b+1)+"."+a.T,1c:c,1l:c})}l.w=k("i");l.q=k("a");l.S=5(){8 3.a.14};l.H=5(){8 3.V||3.b.1P[3.b.1R()].1A};l.F=5(a,b){15(7 c=0,e=a.14,h=e;h!==0;){h=1y(h/10,10);c++}c=9.24(c,b);8{1e:e,1C:c}};l.Y=j("F");l.G=k("F");l.B=5(a,b){15(7 c=0,e;e=a[c];c++)t(3,e);b||3.h()};5 t(a,b){b.1g(g);b.18(f);b.r=g;b.2s&&13.12.1m.1x(b,"2t",5(){b.r=g;a.k();a.h()});a.a.16(b)}l.o=5(a,b){t(3,a);b||3.h()};5 u(a,b){7 c=-1;6(a.a.1n)c=a.a.1n(b);17 15(7 e=0,h;h=a.a[e];e++)6(h==b){c=e;27}6(c==-1)8 g;a.a.2z(c,1);b.1g(g);b.18(f);8 d}l.W=5(a,b){7 c=u(3,a);6(!b&&c){3.k();3.h();8 d}17 8 g};l.X=5(a,b){15(7 c=g,e=0,h;h=a[e];e++){h=u(3,h);c=c||h}6(!b&&c){3.k();3.h();8 d}};l.R=5(){8 3.m.14};l.1d=k("b");l.18=j("b");l.v=k("f");l.Z=j("f");l.u=5(a){7 b=3.1X(),c=1a 13.12.1F(a.1I().19(),a.1I().1i()),e=1a 13.12.1F(a.1J().19(),a.1J().1i());c=b.1v(c);c.x+=3.f;c.y-=3.f;e=b.1v(e);e.x-=3.f;e.y+=3.f;c=b.1Z(c);b=b.1Z(e);a.1f(c);a.1f(b);8 a};l.P=5(){3.k();3.a=[]};l.k=5(){15(7 a=0,b;b=3.m[a];a++)b.1p();15(a=0;b=3.a[a];a++){b.r=g;b.18(f);b.1g(g)}3.m=[]};l.h=5(){q(3)};5 q(a){6(a.z)15(7 b=a.u(1a 13.12.1z(a.b.1r().1J(),a.b.1r().1I())),c=0,e;e=a.a[c];c++)6(!e.r&&b.26(e.1b())){7 h=a;e=e;15(7 o=3h,r=f,x=0,p=2c 0;p=h.m[x];x++){7 i=p.1u();6(i){i=i;7 s=e.1b();6(!i||!s)i=0;17{7 y=(s.19()-i.19())*9.1q/1o,z=(s.1i()-i.1i())*9.1q/1o;i=9.1s(y/2)*9.1s(y/2)+9.2b(i.19()*9.1q/1o)*9.2b(s.19()*9.1q/1o)*9.1s(z/2)*9.1s(z/2);i=2h*2*9.2g(9.2a(i),9.2a(1-i))}6(i<o){o=i;r=p}}}6(r&&r.D.26(e.1b()))r.o(e);17{p=1a v(h);p.o(e);h.m.16(p)}}}5 v(a){3.j=a;3.b=a.1d();3.f=a.v();3.p=a.p;3.d=f;3.a=[];3.D=f;3.l=1a w(3,a.w(),a.v())}l=v.4;l.o=5(a){7 b;a:6(3.a.1n)b=3.a.1n(a)!=-1;17{b=0;15(7 c;c=3.a[b];b++)6(c==a){b=d;27 a}b=g}6(b)8 g;6(3.d){6(3.p){c=3.a.14+1;b=(3.d.19()*(c-1)+a.1b().19())/c;c=(3.d.1i()*(c-1)+a.1b().1i())/c;3.d=1a 13.12.1F(b,c);A(3)}}17{3.d=a.1b();A(3)}6(3.a.14==0){a.18(3.b);a.1g(d)}17 6(3.a.14==1){3.a[0].18(f);3.a[0].1g(g)}a.r=d;3.a.16(a);6(3.b.1t()>3.j.H())15(a=0;b=3.a[a];a++){b.18(3.b);b.1g(d)}17 6(3.a.14<2)B(3.l);17{b=3.j.G()(3.a,3.j.w().14);3.l.20(3.d);a=3.l;a.A=b;a.2i=b.1e;a.2e=b.1C;6(a.c)a.c.1Y=b.1e;b=9.2j(0,a.A.1C-1);b=9.24(a.i.14-1,b);b=a.i[b];a.L=b.1B;a.g=b.1c;a.n=b.1l;a.J=b.2d;a.e=b.2x;a.K=b.2k;a.C=b.2v;3.l.1W()}8 d};l.1r=5(){15(7 a=1a 13.12.1z(3.d,3.d),b=3.q(),c=0,e;e=b[c];c++)a.1f(e.1b());8 a};l.1p=5(){3.l.1p();3.a.14=0;2y 3.a};l.Q=5(){8 3.a.14};l.q=k("a");l.1u=k("d");5 A(a){a.D=a.j.u(1a 13.12.1z(a.d,a.d))}l.1d=k("b");5 w(a,b,c){a.j.1f(w,13.12.22);3.i=b;3.2B=c||0;3.t=a;3.d=f;3.b=a.1d();3.A=3.c=f;3.s=g;3.18(3.b)}l=w.4;l.1j=5(){3.c=1Q.2A("2u");6(3.s){3.c.1h.1M=C(3,D(3,3.d));3.c.1Y=3.A.1e}3.2n().2m.2l(3.c);7 a=3;13.12.1m.2o(3.c,"2p",5(){7 b=a.t.j;13.12.1m.2q(b,"2w",a.t);b.M&&a.b.2r(a.t.1r())})};5 D(a,b){7 c=a.1X().1v(b);c.x-=1y(a.n/2,10);c.y-=1y(a.g/2,10);8 c}l.1k=5(){6(3.s){7 a=D(3,3.d);3.c.1h.1D=a.y+"E";3.c.1h.1G=a.x+"E"}};5 B(a){6(a.c)a.c.1h.1N="2C";a.s=g}l.1W=5(){6(3.c){3.c.1h.1M=C(3,D(3,3.d));3.c.1h.1N=""}3.s=d};l.1p=5(){3.18(f)};l.1E=5(){6(3.c&&3.c.1O){B(3);3.c.1O.2f(3.c);3.c=f}};l.20=j("d");5 C(a,b){7 c=[];6(1Q.3r)c.16(\'3q:3p:3s.3t.3v(3u=3o,3n="\'+a.L+\'");\');17{c.16("1S-3i:1B("+a.L+");");c.16("1S-28:"+(a.C?a.C:"0 0")+";")}6(1H a.e==="3j"){1H a.e[0]==="1V"&&a.e[0]>0&&a.e[0]<a.g?c.16("1c:"+(a.g-a.e[0])+"E; 1U-1D:"+a.e[0]+"E;"):c.16("1c:"+a.g+"E; 1T-1c:"+a.g+"E;");1H a.e[1]==="1V"&&a.e[1]>0&&a.e[1]<a.n?c.16("1l:"+(a.n-a.e[1])+"E; 1U-1G:"+a.e[1]+"E;"):c.16("1l:"+a.n+"E; 1e-1K:1L;")}17 c.16("1c:"+a.g+"E; 1T-1c:"+a.g+"E; 1l:"+a.n+"E; 1e-1K:1L;");c.16("3w:3A; 1D:"+b.y+"E; 1G:"+b.x+"E; 3L:"+(a.J?a.J:"3F")+"; 28:3z; 1w-3y:"+(a.K?a.K:11)+"E; 1w-3D:3J,3K-3f; 1w-3e:2Q");8 c.2P("")}2O.2R=m;m.4.2S=m.4.o;m.4.2T=m.4.B;m.4.2N=m.4.P;m.4.2G=m.4.G;m.4.2F=m.4.v;m.4.2E=m.4.u;m.4.1d=m.4.1d;m.4.29=m.4.q;m.4.2H=m.4.H;m.4.2I=m.4.w;m.4.2L=m.4.R;m.4.2J=m.4.S;m.4.2W=m.4.h;m.4.38=m.4.W;m.4.3a=m.4.X;m.4.3d=m.4.k;m.4.36=m.4.Y;m.4.2Z=m.4.Z;m.4.1j=m.4.1j;m.4.1k=m.4.1k;v.4.1u=v.4.1u;v.4.30=v.4.Q;v.4.29=v.4.q;w.4.1j=w.4.1j;w.4.1k=w.4.1k;w.4.1E=w.4.1E})();',0,235,"|||this|prototype|function|if|var|return|Math|||||||||||||||||||||||||||||||px||||||||||||||||||||||||maps|google|length|for|push|else|setMap|lat|new|getPosition|height|getMap|text|extend|setVisible|style|lng|onAdd|draw|width|event|indexOf|180|remove|PI|getBounds|sin|getZoom|getCenter|fromLatLngToDivPixel|font|addListener|parseInt|LatLngBounds|maxZoom|url|index|top|onRemove|LatLng|left|typeof|getNorthEast|getSouthWest|align|center|cssText|display|parentNode|mapTypes|document|getMapTypeId|background|line|padding|number|show|getProjection|innerHTML|fromDivPixelToLatLng|setCenter|averageCenter|OverlayView|zoomOnClick|min|undefined|contains|break|position|getMarkers|sqrt|cos|void|textColor|aa|removeChild|atan2|6371|ca|max|textSize|appendChild|overlayImage|getPanes|addDomListener|click|trigger|fitBounds|draggable|dragend|DIV|backgroundPosition|clusterclick|anchor|delete|splice|createElement|ba|none|apply|getExtendedBounds|getGridSize|getCalculator|getMaxZoom|getStyles|getTotalMarkers|imageExtension|getTotalClusters|zoom_changed|clearMarkers|window|join|bold|MarkerClusterer|addMarker|addMarkers|idle|imagePath|redraw|56|66|setGridSize|getSize|53|true|null|false|78|setCalculator|60|removeMarker|styles|removeMarkers|gridSize|90|resetViewport|weight|serif|in|4E4|image|object|png|markerclusterer|images|src|scale|progid|filter|all|DXImageTransform|Microsoft|sizingMethod|AlphaImageLoader|cursor|trunk|size|absolute|pointer|library|utility|family|http|black|v3|com|svn|Arial|sans|color|googlecode".split("|"),0,{}))},2240:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.YandexMapsv2=function(e){this.prop={site_url:"",save_location_url:"/admin/admin_settings.php",map_container:"map_container",routes_container:"",amenities:[],icon:null,use_smart_zoom:!1,use_searchbox:!1,use_tools:!1,use_router:!1,use_type_selector:!1,use_clusterer:!1,use_click_zoom:!1,default_zoom:10,default_map_type:2,lat:56.614607,lon:47.863757,width:0,height:0,geocode_listener:!1,zoom_listener:!1,type_listener:!1},this.MAP_TYPES=["yandex#map","yandex#satellite","yandex#hybrid","yandex#publicMap","yandex#publicMapHybrid"],this.is_loaded=!1,this.min_zoom=1,this.max_zoom=19,this.map=null,this.map_container=null,this.markers=[],this.clusterer=null,this.route=null,this.zoom=null,this.bounds=null,this.wait_requests=0,this.amenities={};var t=this;function o(e,t,o,r){this.prop={draggable:!1,icon:null,highlightIcon:null,info:null,showInfo:!0,htmlContent:null,state:"none",gid:"default",drag:null,dragend:null,drag_listener:!1},this.map=e,this.marker=null,this.infobox=null,this.prop.icon=e.prop.icon;var i=this;this.init=function(e,t,o){i.prop=$.extend(i.prop,o);var r={clusterCaption:i.prop.info,hintContent:i.prop.info,balloonContent:i.prop.info};i.marker=new ymaps.Placemark([e,t],r,{balloonOffset:[5,-25],draggable:i.prop.draggable,hasBallon:i.prop.showInfo,hideIconOnBalloonOpen:!1,zIndex:1,zIndexActive:1}),o.icon&&i.marker.options.set({iconImageHref:o.icon}),i.marker.events.add("drag",(function(e){i.prop.drag&&i.prop.drag()})),i.prop.draggable&&i.marker.events.add("dragend",(function(e){if(i.prop.drag_listener){var t=i.getLocation();i.prop.drag_listener(i.prop.gid,t.latitude,t.longitude)}i.prop.dragend&&i.prop.dragend()})),i.map.addEntry(i.marker)},this.displayInfobox=function(){},this.getGUID=function(){return i.prop.gid},this.getLocation=function(){var e=i.marker.geometry.getCoordinates();return{latitude:e[0],longitude:e[1]}},this.clear=function(){i.infobox&&i.infobox.close(),i.map=null},this.move=function(e,t){i.marker.geometry.setCoordinates([e,t])},i.init(t,o,r)}return this.init=function(e){if(t.prop=$.extend(t.prop,e),t.prop.lat=parseFloat(t.prop.lat),t.prop.lon=parseFloat(t.prop.lon),t.map_container=$("#"+t.prop.map_container),!t.map_container.length)return alert("map container not exists!"),!1;t.map_container.html(""),t.map_container.css({width:t.prop.width,height:t.prop.height});try{t.map=new ymaps.Map(t.map_container.attr("id"),{behaviors:["default","scrollZoom"],center:[t.prop.lat,t.prop.lon],type:t.MAP_TYPES[t.prop.default_map_type-1],zoom:t.prop.default_zoom})}catch(e){return alert("map initialize is failed!"),!1}t.map.controls.add("smallZoomControl"),t.prop.use_type_selector&&t.map.controls.add("typeSelector"),t.prop.use_tools&&t.map.controls.add(new ymaps.control.MapTools),t.prop.use_searchbox&&t.map.controls.add(new ymaps.control.SearchControl({noPopup:!0,position:{left:5,bottom:25},width:220})),t.prop.use_clusterer&&(t.clusterer=new ymaps.Clusterer,t.prop.use_click_zoom||t.clusterer.options.set("clusterDisableClickZoom",!0),t.map.geoObjects.add(t.clusterer)),t.min_zoom=Math.max(t.min_zoom,t.map.zoomRange.getCurrent()[0]),t.max_zoom=Math.min(t.max_zoom,t.map.zoomRange.getCurrent()[1]),t.prop.default_zoom<t.min_zoom?(t.zoom=t.min_zoom,t.setZoom(t.zoom)):t.prop.default_zoom>=t.max_zoom?(t.zoom=t.max_zoom,t.setZoom(t.zoom)):t.zoom=t.prop.default_zoom,t.prop.use_router&&($("#"+t.prop.routes_container).length||(t.prop.use_router=!1)),t.map.events.add("boundschange",(function(e){e.get("newZoom")!=e.get("oldZoom")&&(0!=t.prop.zoom_listener&&t.prop.zoom_listener(e.get("newZoom")),t.zoom=e.get("newZoom"))})),t.prop.type_listener&&t.map.events.add("typechange",(function(e){if(t.is_loaded){var o=t.MAP_TYPES.indexOf(e.get("newType"));t.prop.type_listener(o+1)}})),t.is_loaded=!0},this.renderControl=function(){var e='<div style="position: absolute; right:5px; top:5px; background:#fff; opacity:0.5; z-index:1000;"><select id="map_type" style="margin:5px;">',o=t.map.getType(),r=[];for(var i in t.MAP_TYPES)if(t.MAP_TYPES[i]){t.map.setType(t.MAP_TYPES[i]);var n=t.MAP_TYPES[i];r.push(n),e+='<option value="'+i+'"'+(o==t.MAP_TYPES[i]?'selected="selected"':"")+">"+n+"</option>"}$.inArray(n,r)||(o=t.MAP_TYPES[1]),t.map.setType(o),e+='</select><div id="zoom_out" style="float:right; width:30px; height:30px;text-align:center;vertical-align:middle;margin:5px;border:1px solid #ccc; cursor:pointer;">-</div><div style="float:right; width:30px; height:30px; text-align:center;vertical-align:middle;margin:5px;border:1px solid #ccc;cursor:pointer;" id="zoom_in">+</div></div>',$("#"+t.prop.map_container).css("position","relative").append(e),$("#zoom_in").on("click",(function(){t.zoom<t.max_zoom&&t.setZoom(t.zoom+1)})),$("#zoom_out").on("click",(function(){t.zoom>t.min_zoom&&t.setZoom(t.zoom-1)})),$("#map_type").on("change",(function(){t.map.setMapType(t.MAP_TYPES[$(this).val()])}))},this.addMarker=function(e,r,i){var n=new o(t,e,r,i);t.markers.push(n),t.wait_requests||t.setSmartCenter()},this.setType=function(e){t.MAP_TYPES[e]&&t.map.setType(t.MAP_TYPES[e])},this.getZoom=function(){return t.map.getZoom()},this.setZoom=function(e){t.map.setZoom(e)},this.changeZoom=function(e){return t.zoom=t.zoom+e,t.setZoom(t.zoom),t.zoom},this.getCenter=function(){var e=t.map.getCenter();return{latitude:e[0],longitude:e[1]}},this.setCenter=function(e,o){t.map.setCenter([e,o])},this.setCenterFromLocation=function(e){this.geocodeLocation(e,{},t.setCenter)},this.getMarkersBounds=function(){if(!t.markers.length)return[[t.prop.lat,t.prop.lon]];var e=t.markers[0].getLocation();if(1==t.markers.length)return[[e.latitude,e.longitude]];for(var o=t.markers[1].getLocation(),r=[[Math.min(e.latitude,o.latitude),Math.min(e.longitude,o.longitude)],[Math.max(e.latitude,o.latitude),Math.max(e.longitude,o.longitude)]],i=2;i<t.markers.length;i++){var n=t.markers[i].getLocation();r[0][0]=Math.min(n.latitude,r[0][0]),r[0][1]=Math.min(n.longitude,r[0][1]),r[1][0]=Math.max(n.latitude,r[1][0]),r[1][1]=Math.max(n.longitude,r[1][1])}return r},this.setSmartCenter=function(){var e=t.getMarkersBounds();if(2==e.length)if(t.prop.use_smart_zoom)t.map.setBounds(e);else{var o=e[1],r=e[0];t.setCenter(o[0]!=r[0]?r[0]+(o[0]-r[0])/2:o[0],o[1]!=r[1]?r[1]+(o[1]-r[1])/2:o[1])}else t.setCenter(e[0][0],e[0][1])},this.getInfoboxLocation=function(e){var o=t.map.tryLocationToPixel(e);return o?(o.x+=5,o.y-=25,t.map.tryPixelToLocation(o)):null},this.clear=function(){for(i in t.prop.use_clusterer&&t.clusterer.removeAll(),t.markers)t.prop.use_clusterer||t.removeEntry(t.markers[i]),t.markers[i]=null;t.markers=[]},this.remove=function(){t.clear(),t.prop.use_clusterer&&t.removeEntry(t.clusterer),t.clusterer=null,t.router_editor=null,t.map=null},this.getLocationFromAddress=function(e,t,o,r,i){var n=[];return e&&n.push(e),t&&n.push(t),o&&n.push(o),r&&n.push(r),n.join(", ")},this.getControl=function(){return t.map},this.addEntry=function(e,o){o=o||!1,t.prop.use_clusterer&&!o?t.clusterer.add(e):t.map.geoObjects.add(e)},this.removeEntry=function(e,o){o=o||!1,t.prop.use_clusterer&&!o?t.clusterer.remove(e):t.map.geoObjects.remove(e)},this.createRoute=function(){if(t.markers.length){var e=t.markers[0].getLocation(),o=t.map.getBounds();t.calcRoute([[e.latitude,e.longitude],[e.latitude+(o[1][0]-o[0][0])/10,e.longitude+(o[1][1]-o[0][1])/10]])}},this.calcRoute=function(e){if(!t.prop.use_router)return!1;if(!e.length)return!1;var o=ymaps.route(e,{mapStateAutoApply:!0});new ymaps.control.RouteEditor(o,{addWayPoints:!0,removeWayPoints:!0}),o.then((function(e){e.getPaths().options.set({balloonContenBodyLayout:ymaps.templateLayoutFactory.createClass("$[properties.humanJamsTime]"),strokeColor:"0000ffff",opacity:.9}),e.getWayPoints().options.set({draggable:!1}),t.route=e,t.route.editor.events.add("routeupdate",(function(e){var o=t.route.getPaths().get(0);segments=o.getSegments();for(var r="",i=0;i<segments.length;i++){var n=segments[i].getStreet();r+=segments[i].getHumanAction()+(n?" "+n:"")+", "+segments[i].getLength()+" м.,",r+="<br>"}$("#"+t.prop.routes_conteiner).html(r)})),t.addEntry(t.route,!0),t.route.editor.start()}),(function(e){alert(e.message)}))},this.deleteRoute=function(){t.route.editor.stop(),t.route.editor=null,t.removeEntry(t.route,!0),t.route=null},this.addAmenities=function(){if(!t.prop.amenities.length)return!1;var e=t.getCenter();ymaps.getZoomRange(t.map.getType(),[e.latitude,e.longitude]).then((function(e){t.setZoom(e[1]),t.wait_requests++,t.geocodeLocation("кафе",{},t.addAmenity)}))},this.addAmenity=function(e,r,i){var n=new o(t,e,r,i);t.markers.push(n),t.wait_requests||t.setSmartCenter()},this.moveMarker=function(e,o,r){for(var i in t.markers)if(t.markers[i].getGUID()==e){t.markers[i].move(o,r);break}t.setCenter(o,r)},this.moveMarkers=function(e,o){for(var r in t.markers)t.markers[r].move(e,o);t.setCenter(e,o)},t.init(e),t})},4740:()=>{!function(e){jQuery.fn.extend({slimScroll:function(o){var r=e.extend({width:"auto",height:"250px",size:"7px",color:"",position:"right",distance:"0px",start:"top",opacity:.4,alwaysVisible:!0,disableFadeOut:!0,railVisible:!0,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:2,touchScrollStep:5,borderRadius:"7px",railBorderRadius:"7px",frameId:"",endScrollY:function(){}},o);return this.each((function(){var i,n,s,a,c,p,l,d,u="<div></div>",_=!1,f=e(this);if(f.parent().hasClass(r.wrapperClass)){var h=f.scrollTop();if(v=f.parent().find("."+r.barClass),b=f.parent().find("."+r.railClass),$(),e.isPlainObject(o)){if("height"in o&&"auto"==o.height){f.parent().css("height","auto"),f.css("height","auto");var m=f.parent().parent().height();f.parent().css("height",m),f.css("height",m)}if("scrollTo"in o)h=parseInt(r.scrollTo);else if("scrollBy"in o)h+=parseInt(r.scrollBy);else if("destroy"in o)return v.remove(),b.remove(),void f.unwrap();w(h,!1,!0)}}else{r.height="auto"==r.height?f.parent().height():r.height;var g=e(u).addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height});f.css({overflow:"hidden",width:r.width,height:r.height});var b=e(u).addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.railBorderRadius,opacity:r.railOpacity,zIndex:90}),v=e(u).addClass(r.barClass).css({width:r.size,position:"absolute",top:0,display:r.alwaysVisible?"block":"none","border-radius":r.borderRadius,BorderRadius:r.borderRadius,MozBorderRadius:r.borderRadius,WebkitBorderRadius:r.borderRadius,zIndex:99,"background-color":r.color}),y="right"==r.position?{right:r.distance}:{left:r.distance};b.css(y),v.css(y),f.wrap(g),f.parent().append(v),f.parent().append(b),r.railDraggable&&v.on("mousedown",(function(o){var r=e(document);return s=!0,t=parseFloat(v.css("top")),pageY=o.pageY,r.on("mousemove.slimscroll",(function(e){currTop=t+e.pageY-pageY,v.css("top",currTop),w(0,v.position().top,!1)})),r.on("mouseup.slimscroll",(function(e){s=!1,S(),r.unbind(".slimscroll")})),!1})).on("selectstart.slimscroll",(function(e){return e.stopPropagation(),e.preventDefault(),!1})),b.hover((function(){x()}),(function(){S()})),v.hover((function(){n=!0}),(function(){n=!1})),f.hover((function(){i=!0,x(),S()}),(function(){i=!1,S()})),f.on("touchstart",(function(e,t){e.originalEvent.touches.length&&(c=e.originalEvent.touches[0].pageY)})),f.on("touchmove",(function(e){_||e.originalEvent.preventDefault(),e.originalEvent.touches.length&&(w((c-e.originalEvent.touches[0].pageY)/r.touchScrollStep,!0),c=e.originalEvent.touches[0].pageY)})),$(),"bottom"===r.start?(v.css({top:f.outerHeight()-v.outerHeight()}),w(0,!0)):"top"!==r.start&&(w(e(r.start).position().top,null,!0),r.alwaysVisible||v.hide()),function(){if(window.addEventListener){if(this.addEventListener("DOMMouseScroll",k,!1),this.addEventListener("mousewheel",k,!1),this.addEventListener("MozMousePixelScroll",k,!1),r.frameId){var e=document.getElementById(r.frameId).contentWindow;e.addEventListener("mousewheel",k,!1),e.addEventListener("DOMMouseScroll",k,!1),e.addEventListener("MozMousePixelScroll",k,!1)}}else document.attachEvent("onmousewheel",k)}()}function k(t){if(i){var o=0;(t=t||window.event).wheelDelta&&(o=-t.wheelDelta/120),t.detail&&(o=t.detail/3);var n=t.target||t.srcTarget||t.srcElement;e(n).closest("."+r.wrapperClass).is(f.parent())&&w(o,!0)}}function w(e,t,o){_=!1;var i=e,n=f.outerHeight()-v.outerHeight();if(t&&(i=parseInt(v.css("top"))+e*parseInt(r.wheelStep)/100*v.outerHeight(),i=Math.min(Math.max(i,0),n),i=e>0?Math.ceil(i):Math.floor(i),v.css({top:i+"px"})),i=(l=parseInt(v.css("top"))/(f.outerHeight()-v.outerHeight()))*(f[0].scrollHeight-f.outerHeight()),1==l&&r.endScrollY(),o){var s=(i=e)/f[0].scrollHeight*f.outerHeight();s=Math.min(Math.max(s,0),n),v.css({top:s+"px"})}f.scrollTop(i),f.trigger("slimscrolling",~~i),x(),S()}function $(){p=Math.max(f.outerHeight()/f[0].scrollHeight*f.outerHeight(),30),v.css({height:p+"px"});var e=p==f.outerHeight()?"none":"block";v.css({display:e})}function x(){if($(),clearTimeout(a),l==~~l){if(_=r.allowPageScroll,d!=l){var e=0==~~l?"top":"bottom";f.trigger("slimscroll",e)}}else _=!1;d=l,p>=f.outerHeight()?_=!0:(v.stop(!0,!0).fadeIn("fast"),r.railVisible&&b.stop(!0,!0).fadeIn("fast"))}function S(){r.alwaysVisible||(a=setTimeout((function(){r.disableFadeOut&&i||n||s||(v.fadeOut("slow"),b.fadeOut("slow"))}),1e3))}})),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery)},250:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.GuidedSetup=function(e){this.properties={siteUrl:"",btnGuidePage:"#btn-guide_page",urlGetMainPage:"admin/guided_setup/ajaxGetMain",urlGetGuidePage:"admin/guided_setup/ajaxGetGuidePage",urlPageConfigure:"admin/guided_setup/ajaxPageConfigure",navBlock:".guided-navigation",currentPage:"guided-current-page",guidedMenuId:null,useFrame:1,frameName:"",frameObj:"",navScroll:{top:null,left:null},navIndex:null,popoverObj:"",page_id:null,navHeight:"600px",contentHeight:"444px",errorObj:new Errors,contentObj:new loadingContent({loadBlockWidth:"50%",closeBtnClass:"close_window",scroll:!1,closeBtnPadding:20,blockBody:!0,loadBlockTopType:"bottom",loadBlockSize:"big",loadBlockLgClass:"modal fade bs-example-modal-lg guided-popup"})};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$(t.properties.btnGuidePage).on("click",(function(){t.getMainPage()})),$(document).on("click","#guided_close_page",(function(){t.properties.contentObj.hide_load_block()}))},this.getMainPage=function(){$.ajax({url:t.properties.siteUrl+t.properties.urlGetMainPage,type:"POST",data:{menu_id:t.properties.guidedMenuId,menu_gid:t.properties.frameName,is_frame:t.properties.useFrame},cache:!1,dataType:"json",success:function(e){e.content&&(t.properties.contentObj.show_load_block(e.content),t.properties.navHeight=$("#guided-navigation").css("height"),t.properties.contentHeight=$(".iframe-block").css("height"),t.setFrame(),t.setNavigation())}})},this.getGuidePage=function(e){$.ajax({url:t.properties.siteUrl+t.properties.urlGetGuidePage+"/"+e,type:"POST",cache:!1,dataType:"html",success:function(e){e&&$("#guided_content").html(e)}})},this.setFrame=function(){t.properties.frameObj=$("iframe[name="+t.properties.frameName+"]"),$(t.properties.frameObj).load((function(){t.loadFrame()})),t.setPopover()},this.setPopover=function(){t.properties.popoverObj=$("#guided_popover"),t.properties.popoverObj.popover().on("shown.bs.popover",(function(){$("#guided_popover_configure").off().on("click",(function(){t.closePopover();var e=$('[data-page_id="'+t.properties.page_id+'"]');parseInt(e.attr("data-page_configured"))||$.ajax({url:t.properties.siteUrl+t.properties.urlPageConfigure+"/"+t.properties.page_id,type:"POST",cache:!1,dataType:"json",success:function(o){o.success&&(o.success&&t.properties.errorObj.show_error_block(o.success,"success"),e.children(".page-configured").removeClass("invisible hide"),e.attr("data-page_configured","1"),$("#progress_text").text(o.progress_bar.text_setup_indicator),$("#progress_value").width(o.progress_bar.percent+"%"))}})})),$("#hide_guided_popover").off().on("click",(function(){t.closePopover()}))}))},this.setPopoverContent=function(){var e=$("#guided-navigation").children("li").eq(t.properties.navIndex).children(".guided-description").html();(e=$.trim(e))?$("#guided_popover").show():$("#guided_popover").hide(),t.properties.popoverObj.data("bs.popover").options.content=e},this.showPopover=function(){t.properties.popoverObj.data("bs.popover").options.content&&t.properties.popoverObj.popover("show")},this.closePopover=function(){t.properties.popoverObj.popover("hide")},this.setNavigation=function(){t.properties.page_id=$("."+t.properties.currentPage).attr("data-page_id"),$("#guided-navigation").slimScroll({height:t.properties.navHeight,allowPageScroll:!0}),t.properties.useFrame||$("#guided_content").slimScroll({height:t.properties.contentHeight,color:"rgba(170, 170, 170, 0.4)"}),$(t.properties.navBlock).on("click","li",(function(){t.closePopover(),t.hideFrameBlock(),t.showLoadingBlock(),t.setActiveNav(this);var e=$(this).attr("data-page_link");$("#guided_page_link").attr("href",e);var o=$(this).attr("data-page_id");t.properties.page_id=o,t.properties.useFrame?$(t.properties.frameObj).attr("src",e):t.getGuidePage(o)})),$("#guided_prev_page").off().on("click",(function(){t.goPrevPage()})),$("#guided_next_page").off().on("click",(function(){t.goNextPage()}))},this.setBeforeUnload=function(){var e=document.getElementById("guided_frame"),o=e.contentWindow||e.contentDocument;$(o).off().on("unload",(function(){t.hideFrameBlock()}))},this.setActiveNav=function(e){$(t.properties.navBlock+" > li").removeClass(t.properties.currentPage),t.properties.navIndex=$(e).index(),$(t.properties.navBlock).each((function(e,o){$(o).children("li").eq(t.properties.navIndex).addClass(t.properties.currentPage)}));var o=$(e).data("page_id"),r=$(t.properties.navBlock+" > li:last").data("page_id");o>1?$("#guided_prev_page").removeClass("hide"):$("#guided_prev_page").addClass("hide"),o<r?($("#guided_next_page").removeClass("hide"),$("#guided_close_page").addClass("hide")):($("#guided_next_page").addClass("hide"),$("#guided_close_page").removeClass("hide")),t.scrollNavBlock()},this.loadFrame=function(){t.setBeforeUnload(),t.setPopoverContent();var e=t.properties.frameObj.contents();t.formatFrame(e),t.hideLoadingBlock(),t.showFrameBlock(),$("html",e).addClass("customscrollbar"),$("html",e).find("#btn-show-help").off("click").on("click",(function(){$(this).closest(".instruction-block").hasClass("popover_info")||$(this).closest(".instruction-block").addClass("popover_info")}));var o=$('[data-page_id="'+t.properties.page_id+'"]');parseInt(o.attr("data-page_configured"))||t.showPopover()},this.formatFrame=function(e){$("#top_nav, footer, .back",e).remove(),$(".networkinkg-status",e).attr("target","_blank")},this.scrollNavBlock=function(){$(t.properties.navBlock).each((function(e,o){var r=o.querySelectorAll("li")[t.properties.navIndex].offsetTop-5;$(o).animate({scrollTop:r},500,"swing",(function(){$(o).slimScroll({scrollTo:r})}))}))},this.goPrevPage=function(){$("."+t.properties.currentPage).prev("li").click()},this.goNextPage=function(){$("."+t.properties.currentPage).next("li").click()},this.showLoadingBlock=function(){t.properties.useFrame&&$("#guided_loading_block").show()},this.hideLoadingBlock=function(){$("#guided_loading_block").hide()},this.hideFrameBlock=function(){$(t.properties.frameObj).css("visibility","hidden")},this.showFrameBlock=function(){$(t.properties.frameObj).css("visibility","visible")},t.Init(e)})},4295:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Im=function(e){this.properties={site_url:"",age_lng:"[age] years old",history_lng:"Show history",clear_confirm_lng:"Are you sure you want to clear history?",active_ajax_timeout:3,inactive_ajax_timeout:6,contact_list_time:0,statuses:{},id_user:0,user_name:"",active_contact_id:0,site_status:0,get_contact_list_url:"im/ajax_get_contact_list",set_site_status_url:"im/ajax_set_site_status",get_messages_url:"im/ajax_get_messages",post_message_url:"im/ajax_post_message",get_history_url:"im/ajax_get_history",clear_history_url:"im/ajax_clear_history",get_status_url:"im/ajax_get_im_status",get_init_url:"im/ajax_get_init",available_view_url:"/application/js/available_view.js",available_status:0,new_msgs:{contacts:{},count_new:0},chat_id:"im_chat",chat_btn_id:"im_chat_btn",contact_list_btn_id:"im_chat_contact_list_btn",im_panel_id:"im_panel",im_contact_list_id:"im_contact_list",im_messages_window_id:"im_messages_window",im_contact_list_search_id:"im_contact_list_search",im_info_popup_id:"im_info_popup",im_msg_btns_id:"im_msg_btns",imMobileBlock:".im-mobile-block",bottomBtns:"#bottom-btns",imPanelBottom:"#im_panel-bottom",toggleBlock:".js-toggle-block",toggleSearch:".js-toggle-search",is_dom_init:!1,is_opened:!1,errorObj:new Errors,emojiPicker:null,position:"rtl"===site_rtl_settings?"left":"right"};var t={chat_obj:{},chat_btn_obj:{},contact_list_btn_obj:{},panel_obj:{},contact_list_obj:{},msg_window_obj:{},contact_list_search_obj:{},info_popup_obj:{},msg_close_btn_obj:{},msg_nick_obj:{},msg_textarea_obj:{},msg_chat_obj:{},msg_btns_obj:{},message_window_state:0,ajax_site_status_to:null,info_popup_to:null,flash_to:null,xhr_site_status:null,xhr_history:null,xhr_clear_history:null,xhr_send_message:null,im_available_view:null,isset_service:!1,access_denided:{get_messages:!1,post_message:!1}};this.init_vars=function(){t.message_window_state=0,t.ajax_site_status_to=null,t.info_popup_to=null,t.flash_to=null,t.xhr_site_status=null,t.xhr_history=null,t.xhr_clear_history=null,t.xhr_send_message=null,t.im_available_view=null,t.isset_service=!1,this.contact_users={},this.contact_list={},this.contact_temp={},this.active_contact={},this.contacts_drafts={},this.contacts_messages={}};var o=this;return o.init_vars(),$(document).on("users:login",(function(){})).on("users:logout, session:guest",(function(){t.onLogout()})),this.init=function(e){return"undefined"==typeof im||im.uninit(),e=e||{},$.extend(!0,o.properties,e),o.properties.id_user?(t.initDomObjects(),t.initChatBtns(),o.setFlashingNewMessages(),o.getContactList(1),t.initMultiRequest(),$(document).off("im:hide").on("im:hide",(function(){MultiRequest.properties.actions.im_get_contact_list.period=o.properties.inactive_ajax_timeout,t.info_popup_obj.hide()})).off("im:show").on("im:show",(function(){MultiRequest.properties.actions.im_get_contact_list.period=o.properties.active_ajax_timeout})).off("click",".mobile-menu-item[data-id=im_panel-bottom]").on("click",".mobile-menu-item[data-id=im_panel-bottom]",(function(){t.info_popup_obj.hide(),o.checkImAvailable()})).off("click",o.properties.toggleSearch).on("click",o.properties.toggleSearch,(function(){$(".js-header__search").show().focusout((function(){$(this).hide()})).find("input").focus()})),this):this},this.uninit=function(){return o.properties.is_dom_init&&(t.chat_btn_obj.off("click"),t.contact_list_obj.off("click",".im-contact").off("mouseenter",".im-contact").off("mouseleave",".im-contact").off("change keyup",'.im-bottom select[name="site_status"]'),t.msg_close_btn_obj.off("click"),t.contact_list_search_obj.off("change keydown keyup blur"),t.msg_btns_obj.off("click",'input[name="sendbtn"]').off("click",'[data-button="profile"]').off("click",'[data-button="block"]').off("click",'[data-button="clear"]').off("click","[data-mblock-id=im_panel-bottom]"),t.msg_textarea_obj.off("keydown"),t.msg_chat_obj.off("click",".history a"),t.contact_list_btn_obj.off("click"),t.panel_obj.hide(),t.chat_btn_obj.hide(),t.contact_list_obj.hide(),t.msg_window_obj.hide(),t.info_popup_obj.hide()),$(document).trigger("im:hide"),o.properties.contact_list_time=0,o.properties.active_contact_id=0,o.properties.new_msgs={contacts:{},count_new:0},o.init_vars(),this},t.onLogin=function(){$.ajax({type:"POST",url:o.properties.site_url+o.properties.get_init_url,data:{},success:function(e,r,i){if(e&&e.id_user){o.properties.id_user=e.id_user,o.properties.site_status=parseInt(e.user_status.site_status),o.properties.new_msgs=e.new_msgs,o.properties.user_name=e.user_name,o.uninit().init(),t.contact_list_obj.find('.im-bottom select[name="site_status"]').val(o.properties.site_status);var n=t.chat_btn_obj.attr("data-status-class");t.chat_btn_obj.removeClass(n).addClass(o.properties.statuses[o.properties.site_status].text).attr("data-status-class",o.properties.statuses[o.properties.site_status].text),"offline"===o.properties.statuses[o.properties.site_status].text?t.chat_btn_obj.addClass("bg-delimiter_color"):t.chat_btn_obj.removeClass("bg-delimiter_color")}},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)},complete:function(){},dataType:"json",backend:0,async:!0})},t.onLogout=function(){o.properties.id_user=0,o.properties.site_status=0,o.properties.user_name="",MultiRequest.disableAction("im_get_contact_list"),MultiRequest.disableAction("im_new_msgs"),o.uninit()},this.die=function(){return MultiRequest.disableAction("im_get_contact_list"),MultiRequest.disableAction("im_new_msgs"),o.uninit(),t.chat_obj.length>0&&t.chat_obj.remove(),this},t.setService=function(){t.isset_service||(t.isset_service=!0)},t.unsetService=function(){t.isset_service&&t.chat_btn_obj.off("click").on("click",(function(){t.chat_btn_obj.fadeOut(),o.showChat()})),t.isset_service=!1},t.getStatus=function(e,r){r=r||function(){},e=e||function(){},$.ajax({type:"POST",url:o.properties.site_url+o.properties.get_status_url,data:{},success:function(o){if(o){if(!t.checkStatus(o))return e(),!1;r()}},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)},dataType:"json",backend:0,async:!1})},this.showChat=function(){return t.panel_obj.fadeIn(),t.message_window_state?t.msg_window_obj.fadeIn():t.msg_window_obj.hide(),$(document).trigger("im:show"),this},this.hideChat=function(){return t.panel_obj.fadeOut({duration:300,done:function(){$(document).trigger("im:hide"),t.chat_btn_obj.fadeIn(300)}}),t.msg_window_obj.fadeOut(300),o.properties.active_contact_id=0,this},this.sendMessage=function(){if(t.xhr_send_message&&4!==t.xhr_send_message.readyState)return this;var e="";void 0!==o.properties.emojiPicker?($(".emoji-wysiwyg-editor").find("img").each((function(){var e=$(this).attr("alt");$(this).replaceWith(e)})),void 0===(e=$(".emoji-wysiwyg-editor").html())&&(e=t.trimStr(t.msg_textarea_obj.val()))):e=t.trimStr(t.msg_textarea_obj.val());var r=parseInt(o.properties.active_contact_id);if(!e||!r)return this;var i=t.getMinMaxId(r);t.xhr_send_message=$.ajax({type:"POST",url:o.properties.site_url+o.properties.post_message_url,data:{id_contact:r,text:e,min_id:i.min_id,max_id:i.max_id},beforeSend:function(){},success:function(e){return void 0!==e.info.access_denied&&e.info.access_denied.length>0?(!1===t.access_denided.post_message&&(t.access_denided.post_message=!0),o.properties.errorObj.show_error_block(e.info.access_denied,"error"),!1):(t.access_denided.post_message=!1,!(e.im_status&&!t.checkStatus(e.im_status))&&(e.errors.length?o.properties.errorObj.show_error_block(e.errors,"error"):(t.msg_textarea_obj.val(""),void 0!==o.properties.emojiPicker&&o.properties.emojiPicker.clearTextarea(".emoji-wysiwyg-editor"),e.messages.msg.length&&(t.setContactsMessages(r,e.messages),t.renderMessages(r,e.messages.msg,"replace",!0),sendAnalytics("im_send_message","communication","user"))),void(e.notices&&e.notices.length&&o.properties.errorObj.show_error_block(e.notices,"info"))))},dataType:"json",async:!0,backend:0})},this.getContactList=function(e){return e=e||0,$.ajax({type:"POST",url:o.properties.site_url+o.properties.get_contact_list_url,data:{formatted:e},success:function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return t.panel_obj.find(".js-contact-window").html('<div class="p20">'+e.info.access_denied+"</div>"),!1;if(e.im_status){if(!t.checkStatus(e.im_status))return!1;o.updateContactList(e)}else e.list&&o.updateContactList(e)},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)},complete:function(){MultiRequest.enableAction("im_get_contact_list")},dataType:"json"}),this},this.setActiveContact=function(e){return o.active_contact=void 0!==o.contact_users[e]?o.contact_users[e]:{},t.contact_list_obj.find(".im-contact").removeClass("selected"),$("#im_contact_list_contact_"+e).addClass("selected"),this},this.resetActiveContact=function(){t.contact_list_obj.find(".im-contact").removeClass("selected")},this.setActiveMessagesWindow=function(e){var r=0,i=setInterval((function(){if(t.message_window_state=$("#im_contact_list_contact_"+e).length,r++,t.message_window_state||3==r){clearInterval(i),o.properties.emojiPicker.discover(),o.properties.active_contact_id&&(o.contacts_drafts[o.properties.active_contact_id]=t.msg_textarea_obj.val());var n=o.contacts_drafts[e]?o.contacts_drafts[e]:"";return o.properties.active_contact_id=e,t.message_window_state?(t.access_denided.post_message=!1,t.getContactsMessages(e),t.msg_nick_obj.html(o.active_contact.output_name),t.msg_window_obj.show(),void 0!==o.properties.emojiPicker?o.properties.emojiPicker.clearTextarea(".emoji-wysiwyg-editor",n):t.msg_textarea_obj.val(n)):t.msg_window_obj.hide(),this}}),500)},this.updateNewMessages=function(e){o.properties.new_msgs={count_new:e.count_new,contacts:{}};for(var r=0;r<e.contacts.length;r++)e.contacts[r].id_contact===o.properties.active_contact_id?t.getContactsMessages(e.contacts[r].id_contact,!0):o.properties.new_msgs.contacts[e.contacts[r].id_contact]=e.contacts[r];return o.setContactListFlashState(),this},this.openContact=function(e){t.getStatus((function(){if(!o.properties.available_status)return t.chat_btn_obj.fadeOut(),o.showChat(),!1}),(function(){$(document).width()<768&&$(o.properties.imMobileBlock).is(":visible"),o.contact_temp=e.list[0],o.contact_users[e.list[0].contact_user.id]=e.list[0].contact_user,o.updateContactList({list:o.contact_list}),t.chat_btn_obj.fadeOut(),o.showChat(),o.setActiveContact(e.list[0].id_contact),o.setActiveMessagesWindow(e.list[0].id_contact)})),t.isset_service,$(document).width()<768&&(t.info_popup_obj.hide(),o.checkImAvailable())},this.updateContactList=function(e){var r=o.contact_list,i=e.list,n=t.isContactListsEquals(r,i);if(i&&i.length){o.contact_list=i;for(var s=0;s<i.length;s++)i[s].contact_user&&(o.contact_users[i[s].contact_user.id]=i[s].contact_user)}var a=!1;if(!n){t.contact_list_obj.find(".im-scroller").html("");for(var c=0;c<o.contact_list.length;c++){var p=o.contact_users[o.contact_list[c].id_contact]||!1;if(p){var l=p.age?o.properties.age_lng.replace("[age]",p.age):"&nbsp;",d="";void 0!==o.contact_list[c].site_status&&(p.site_status=o.contact_list[c].site_status,d=o.properties.statuses[o.contact_list[c].site_status].lang),t.renderContact(p,l,d)}}a=!0}if(!$.isEmptyObject(o.contact_temp)){var u=o.contact_users[o.contact_temp.id_contact];if(!$("#im_contact_list_contact_"+u.id).length){var _=u.age?o.properties.age_lng.replace("[age]",u.age):"",f=o.properties.statuses[0].lang;t.renderContact(u,_,f,"prepend"),a=!0}}return a&&(o.setActiveContact(o.properties.active_contact_id),o.setContactListFlashState(),o.searchContacts()),this},t.renderContact=function(e,o,r,i){i=i||"append";var n='<div id="im_contact_list_contact_'+e.id+'" class="im-contact box-sizing"><div class="im-contact__image"><img src="'+e.thumbs.small+'" />';1==e.site_status&&(n+='<div class="im-contact__status">'+r+"</div>"),n+='</div><div class="im-contact__info">'+e.output_name+"</div>","undefined"!==e.location&&e.location.length>0?n+='<div class="im-contact__more-info hide">':n+='<div class="im-contact__more-info hide is_blocked">',n+="<div>"+o+"</div><div>"+e.location+"</div></div></div>","append"===i?t.contact_list_obj.find(".im-scroller").append(n):t.contact_list_obj.find("#im_contact_list_contact_"+e.id).length||t.contact_list_obj.find(".im-scroller").prepend(n)},t.isContactListsEquals=function(e,t){if(e.length!==t.length)return!1;for(var o in e)if(e.hasOwnProperty(o)){if(!t.hasOwnProperty(o))return!1;if(e[o].count_new!==t[o].count_new||e[o].id_contact!==t[o].id_contact||e[o].site_status!==t[o].site_status)return!1}for(var r in t)if(t.hasOwnProperty(r)&&!e.hasOwnProperty(r))return!1;return!0},this.searchContacts=function(e){if(e=e||t.trimStr(t.contact_list_search_obj.val()))for(var r=0;r<o.contact_list.length;r++){var i=o.contact_users[o.contact_list[r].id_contact];new RegExp(e,"i").test(i.output_name)?$("#im_contact_list_contact_"+i.id).show():$("#im_contact_list_contact_"+i.id).hide()}else t.contact_list_obj.find(".im-contact").show();return this},this.setSiteStatus=function(e){return o.properties.site_status!==e&&(t.ajax_site_status_to&&clearTimeout(t.ajax_site_status_to),t.ajax_site_status_to=setTimeout((function(){t.xhr_site_status&&t.xhr_site_status.abort(),t.xhr_site_status=$.ajax({type:"POST",url:o.properties.site_url+o.properties.set_site_status_url,data:{site_status:e},success:function(r,i,n){if(r){var s=t.chat_btn_obj.attr("data-status-class");t.chat_btn_obj.removeClass(s).addClass(o.properties.statuses[e].text).attr("data-status-class",o.properties.statuses[e].text),"offline"===o.properties.statuses[e].text?t.chat_btn_obj.addClass("bg-delimiter_color"):t.chat_btn_obj.removeClass("bg-delimiter_color"),o.properties.site_status=e}},error:function(e,t,o){},dataType:"json",async:!0,backend:1})}),300),this)},this.setContactListFlashState=function(){if(t.contact_list_obj.find(".im-contact [data-flash]").attr("data-flash","0"),o.properties.new_msgs.contacts&&!$.isEmptyObject(o.properties.new_msgs.contacts))for(var e in o.properties.new_msgs.contacts){var r=o.properties.new_msgs.contacts[e];$("#im_contact_list_contact_"+r.id_contact).find("[data-flash]").length?$("#im_contact_list_contact_"+r.id_contact).find("[data-flash]").attr("data-flash","1"):$("#im_contact_list_contact_"+r.id_contact).append('<s class="new-msg"><i class="fa fa-comment" data-flash="1"></i></s>')}return t.contact_list_obj.find('.im-contact .new-msg [data-flash="0"]').remove(),this},this.setFlashingNewMessages=function(){t.flash_to&&clearTimeout(t.flash_to);var e=t.chat_obj.find("[data-flash]");return o.properties.new_msgs.count_new>0?(t.chat_btn_obj.find("[data-flash]").attr("data-flash","1"),(e=t.chat_obj.find('[data-flash="1"]')).hasClass("fa-comment")?e.removeClass("fa-comment"):(e.addClass("fa-comment"),e.removeClass("fa-comments"))):(e.attr("data-flash","0").removeClass("fa-comment"),e.addClass("fa-comments")),1==$("#"+o.properties.chat_btn_id+'[data-im-id="'+t.chat_obj_rand_id+'"]').length&&(t.flash_to=setTimeout((function(){o.setFlashingNewMessages()}),500)),this},this.getHistory=function(){if(t.xhr_history&&4!==t.xhr_history.readyState)return this;var e=o.properties.active_contact_id,r=t.getMinMaxId(e);return t.xhr_history=$.ajax({type:"POST",url:o.properties.site_url+o.properties.get_history_url,data:{id_contact:e,max_id:r.max_id,min_id:r.min_id},success:function(o,r,i){if(o.im_status&&!t.checkStatus(o.im_status))return!1;o.msg&&(t.setContactsMessages(e,o),t.renderMessages(e,o.msg,"prepend",!0))},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)},dataType:"json",backend:0}),this},this.clearHistory=function(){if(t.xhr_clear_history&&4!==t.xhr_clear_history.readyState)return this;if(0!==o.properties.active_contact_id){var e=o.properties.active_contact_id,r=t.getMinMaxId(e);return t.xhr_clear_history=$.ajax({type:"POST",url:o.properties.site_url+o.properties.clear_history_url,data:{id_contact:e,max_id:r.max_id,min_id:r.min_id},success:function(r,i,n){delete o.contacts_messages[e],t.renderMessages(e,{},""),t.getContactsMessages(e)},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)},dataType:"json",backend:0}),this}},t.getContactsMessages=function(e,r){r=r||!1;var i={},n=t.getMinMaxId(e);return o.contacts_messages[e]?i=o.contacts_messages[e].msg:o.contacts_messages[e]={min_id:n.min_id,max_id:n.max_id,msg:[],loaded:0},t.renderMessages(e,i,""),o.setContactListFlashState(),r||!o.contacts_messages[e].loaded||o.properties.new_msgs.contacts[e]?($.ajax({type:"POST",url:o.properties.site_url+o.properties.get_messages_url,data:{id_contact:e,max_id:n.max_id,min_id:n.min_id},success:function(r){if(void 0!==r.info.access_denied&&r.info.access_denied.length>0)return!1===t.access_denided.get_messages&&(t.access_denided.get_messages=!0,o.properties.errorObj.show_error_block(r.info.access_denied,"error")),!1;if(t.access_denided.get_messages=!1,r.im_status&&!t.checkStatus(r.im_status))return!1;if(r.msg){t.setContactsMessages(e,r),o.properties.new_msgs.contacts[e]&&(delete o.properties.new_msgs.contacts[e],o.setContactListFlashState());var i=o.contacts_messages[e].loaded?"replace":"";t.renderMessages(e,o.contacts_messages[e].msg,i),o.contacts_messages[e].loaded=1}},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)},dataType:"json",backend:1}),this):this},t.setContactsMessages=function(e,t){o.contacts_messages[e]?((o.contacts_messages[e].min_id>t.min_id&&t.min_id>0||0===o.contacts_messages[e].min_id)&&(o.contacts_messages[e].min_id=t.min_id),o.contacts_messages[e].max_id<t.max_id&&(o.contacts_messages[e].max_id=t.max_id),t.hasOwnProperty("history_exists")&&(o.contacts_messages[e].history_exists=t.history_exists)):o.contacts_messages[e]={min_id:t.min_id,max_id:t.max_id,history_exists:t.hasOwnProperty("history_exists")?t.history_exists:0,msg:[]};for(var r=0;r<t.msg.length;r++){var i=parseInt(t.msg[r].id);o.contacts_messages[e].msg[i]=t.msg[r]}},t.renderMessages=function(e,r,i,n){if(e!=o.properties.active_contact_id)return this;if(n=n||!1){var s=[];for(var a in r)r.hasOwnProperty(a)&&(s[parseInt(r[a].id)]=r[a]);r=s}var c,p="",l=null,d=null;for(var u in r)if(r.hasOwnProperty(u)){if(c=o.contact_users[parseInt(r[u].id_contact)],"replace"===i&&t.msg_chat_obj.html()){var _=t.msg_chat_obj.find('[data-msg-id="'+r[u].id+'"]');_.length&&(l=_.prev("[data-msg-id]"),d=_.next("[data-msg-id]"),_.remove())}"o"===r[u].dir?o.properties.user_name:(c.link,c.output_name),r[u].text=o.properties.emojiPicker.codeToColon(JSON.parse(JSON.stringify(r[u].text))),p+='<div class="im-msg clearfix '+r[u].dir+'" data-msg-id="'+r[u].id+'"><div class="im-msg__date">'+r[u].date_add_format+'</div><div class="im-msg__photo g-pic-border g-rounded-small"><img src="'+c.thumbs.small+'" /></div><div class="im-msg__body"><div class="text" id="m'+r[u].id+'">'+o.properties.emojiPicker.colonToImage(r[u].text)+"</div></div></div>"}var f=t.msg_chat_obj.get(0).scrollHeight;switch(i){case"replace":if(l&&l.length)l.after(p);else{if(!d||!d.length){t.msg_chat_obj.append(p);break}d.before(p)}break;case"append":t.msg_chat_obj.append(p).scrollTop(t.msg_chat_obj.get(0).scrollHeight);break;case"prepend":t.msg_chat_obj.prepend(p);break;default:t.msg_chat_obj.html(p).scrollTop(t.msg_chat_obj.get(0).scrollHeight)}return t.msg_chat_obj.find(".history").remove(),o.contacts_messages[e]&&o.contacts_messages[e].history_exists&&t.msg_chat_obj.prepend('<div class="history"><a href="javascript:;">'+o.properties.history_lng+"</a></div>"),"prepend"===i?(t.msg_chat_obj.scrollTop(t.msg_chat_obj.get(0).scrollHeight-f),t.msg_chat_obj.animate({scrollTop:t.msg_chat_obj.get(0).scrollHeight-f-t.msg_chat_obj.height()+80},500)):t.msg_chat_obj.scrollTop(t.msg_chat_obj.get(0).scrollHeight),this},t.initDomObjects=function(){return t.chat_obj_rand_id=Math.floor(Math.random()*Math.floor(99999999999)),$("#"+o.properties.chat_btn_id).attr("data-im-id",t.chat_obj_rand_id),$("#"+o.properties.chat_id).attr("data-im-id",t.chat_obj_rand_id),t.chat_btn_obj=$("#"+o.properties.chat_btn_id+'[data-im-id="'+t.chat_obj_rand_id+'"]'),t.chat_obj=$("#"+o.properties.chat_id+'[data-im-id="'+t.chat_obj_rand_id+'"]'),t.contact_list_btn_obj=$("#"+o.properties.contact_list_btn_id),t.panel_obj=$("#"+o.properties.im_panel_id),t.contact_list_obj=$("#"+o.properties.im_contact_list_id),t.msg_window_obj=$("#"+o.properties.im_messages_window_id),t.contact_list_search_obj=$("#"+o.properties.im_contact_list_search_id),t.info_popup_obj=$("#"+o.properties.im_info_popup_id),t.msg_close_btn_obj=t.msg_window_obj.find(".im-header>ins.im__close"),t.msg_nick_obj=t.msg_window_obj.find(".im-header>span"),t.msg_textarea_obj=t.msg_window_obj.find(".im-bottom textarea.im-textarea-js"),t.msg_chat_obj=t.msg_window_obj.find(".im-content .im-scroller"),t.msg_btns_obj=$("."+o.properties.im_msg_btns_id),t.contact_list_obj.off("click",".im-contact").on("click",".im-contact",(function(){var e=$(this).attr("id"),r=e.substr(e.lastIndexOf("_")+1);o.setActiveContact(r),o.setActiveMessagesWindow(r),t.message_window_state=0})).off("mouseenter",".im-contact").on("mouseenter",".im-contact",(function(){if($(o.properties.imMobileBlock).is(":hidden")&&void 0!==$(this).find(".im-contact__more-info:not(.is_blocked)").html()){t.info_popup_obj.html($(this).find(".im-contact__more-info").html());var e=t.panel_obj.position().top+$(this).position().top+$(this).outerHeight()/2,r=t.contact_list_obj.width();t.info_popup_obj.css("top",e+"px"),t.info_popup_obj.css(o.properties.position,r+"px"),t.info_popup_obj.is(":visible")?t.info_popup_obj.stop().show():(t.info_popup_to&&clearTimeout(t.info_popup_to),t.info_popup_to=setTimeout((function(){t.panel_obj.is(":visible")&&t.info_popup_obj.stop().fadeIn(100)}),500))}})).off("mouseleave",".im-contact").on("mouseleave",".im-contact",(function(){t.info_popup_to&&clearTimeout(t.info_popup_to),$("#im_info_popup").fadeOut(200)})).off("change keyup",'.im-bottom select[name="site_status"]').on("change keyup",'.im-bottom select[name="site_status"]',(function(){var e=$(this).val();o.setSiteStatus(e)})),t.contact_list_search_obj.off("change keydown keyup blur").on("change keydown keyup blur",(function(){o.searchContacts()})),t.msg_btns_obj.off("click",'input[name="sendbtn"]').on("click",'input[name="sendbtn"]',(function(){o.sendMessage()})).off("click",'[data-button="profile"]').on("click",'[data-button="profile"]',(function(){locationHref(o.active_contact.link)})).off("click",'[data-button="block"]').on("click",'[data-button="block"]',(function(){locationHref(o.active_contact.link,!0)})).off("click",'[data-button="clear"]').on("click",'[data-button="clear"]',(function(){alerts.show({text:o.properties.clear_confirm_lng,type:"confirm",ok_callback:function(){o.clearHistory()}})})),t.msg_close_btn_obj.off("click").on("click",(function(){o.setActiveContact(0),o.setActiveMessagesWindow(0)})),$("#im_msg_btns").off("keydown",".emoji-wysiwyg-editor").on("keydown",".emoji-wysiwyg-editor",(function(e){e.ctrlKey&&13===e.keyCode&&o.sendMessage()})),t.msg_chat_obj.off("click",".history a").on("click",".history a",(function(){o.getHistory()})),t.contact_list_obj.show(),o.properties.is_dom_init=!0,this},t.initChatBtns=function(){return t.chat_btn_obj.off("click").on("click",(function(){t.chat_btn_obj.fadeOut(),o.showChat()})).show(),t.contact_list_btn_obj.off("click").on("click",(function(){o.resetActiveContact(),o.hideChat()})),this},t.initMultiRequest=function(){var e=[{gid:"im_new_msgs",params:{module:"im",model:"ImContactListModel",method:"backendCheckNewMessages"},paramsFunc:function(){return{}},callback:function(e){e&&(o=im,e.im_status&&(o.properties.available_status=e.im_status.im_service_access),o.updateNewMessages(e),o.updateCountMessages(e.count_new))},period:3,status:1},{gid:"im_get_contact_list",params:{module:"im",model:"ImContactListModel",method:"backendGetContactList"},paramsFunc:function(){var e={loaded_contact_ids:""},t=[];for(var r in o.contact_users)t.push(o.contact_users[r].id);return e.loaded_contact_ids=t.join(","),e},callback:function(e){if(e.im_status&&(o.properties.available_status=e.im_status.im_service_access,!t.checkStatus(e.im_status)))return!1;e.list&&o.properties.available_status&&o.updateContactList(e)},period:o.properties.inactive_ajax_timeout,status:0}];return MultiRequest.initActions(e),this},t.getMinMaxId=function(e){var t=0,r=0;return o.contacts_messages[e]&&(t=o.contacts_messages[e].min_id,r=o.contacts_messages[e].max_id),{min_id:t,max_id:r}},t.checkStatus=function(e){return 0===e.id_user?t.onLogout():0===o.properties.id_user&&t.onLogin(),0===e.im_on?(o.die(),!1):e.im_service_access?(t.isset_service&&t.unsetService(),!0):(t.setService(),!1)},t.trimStr=function(e){return(e=e.replace(/^\s+/g,"")).replace(/\s+$/g,"")},this.createMobileBlock=function(e,r){return!1===o.properties.available_status&&locationHref(o.properties.site_url+"access_permissions/"),null!==t.im_available_view&&1!==r||(void 0===e&&(e=$(window).width()),e<768?$(o.properties.imPanelBottom).find("div").length||(o.showChat(),t.chat_btn_obj.hide(),t.chat_obj.appendTo(o.properties.imPanelBottom)):$(o.properties.imPanelBottom).find("div").length&&(o.resetActiveContact(),o.hideChat(),t.chat_btn_obj.show(),t.chat_obj.prependTo(o.properties.bottomBtns))),this},this.updateCountMessages=function(e){return e>0?$(".mobile-top-menu").find("[data-mblock-id=im_panel-bottom]").html('<span class="badge">'+e+"</span>"):$(".mobile-top-menu").find("[data-mblock-id=im_panel-bottom]").html(""),this},this.checkImAvailable=function(){return t.im_available_view&&!o.properties.available_status?(t.im_available_view=new available_view({siteUrl:o.properties.site_url,checkAvailableAjaxUrl:"im/ajax_available_im/",buyAbilityAjaxUrl:"im/ajax_activate_im/",buyAbilityFormId:"ability_form",buyAbilitySubmitId:"ability_form_submit",success_request:function(e){o.properties.errorObj.show_error_block(e,"success")},fail_request:function(e){o.properties.errorObj.show_error_block(e,"error")},windowObj:new loadingContent({loadBlockWidth:"520px",destroyOnReload:!1,closeBtnClass:"w"})}),t.getStatus((function(){t.im_available_view.check_available()}))):($(o.properties.toggleBlock).hide(),o.createMobileBlock($(window).width()),o.properties.available_status&&$(o.properties.imMobileBlock).parent("div").show(),t.initDomObjects()),this},this.scrollToIm=function(){return $(window).width()<768&&$("html, body").animate({scrollTop:$(o.properties.imMobileBlock).offset().top},800),this},o.init(e),this})},4137:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.registerFormInput=function(e){this.properties={siteUrl:"",send_form_data:"incomplete_signup/ajaxGetRegisterFormData/",timeout:15e3,intervalid:"",fieldsName:{user_type:"data[user_type]",looking_user_type:"data[looking_user_type]",email:"data[email]",nickname:"data[nickname]",birth_date:"data[birth_date]",id_country:"data[id_country]",id_region:"data[id_region]",id_city:"data[id_city]",fname:"data[fname]",sname:"data[sname]",user_logo:"data[user_logo]"}},this.fields={user_type:"",looking_user_type:"",email:"",nickname:"",birth_date:"",id_country:"",id_region:"",id_city:"",fname:"",sname:"",user_logo:""};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.intervalid=setInterval((function(){return t.fields.email=$("input[name='"+t.properties.fieldsName.email+"']").val(),t.IsEmail(t.fields.email)&&(t.fields.user_type=$("input[name='"+t.properties.fieldsName.user_type+"']").val(),t.fields.looking_user_type=$("input[name='"+t.properties.fieldsName.looking_user_type+"']").val(),t.fields.nickname=$("input[name='"+t.properties.fieldsName.nickname+"']").val(),t.fields.birth_date=$("input[name='"+t.properties.fieldsName.birth_date+"']").val(),t.fields.id_country=$("input[name='"+t.properties.fieldsName.id_country+"']").val(),t.fields.id_region=$("input[name='"+t.properties.fieldsName.id_region+"']").val(),t.fields.id_city=$("input[name='"+t.properties.fieldsName.id_city+"']").val(),t.fields.fname=$("input[name='"+t.properties.fieldsName.fname+"']").val(),t.fields.sname=$("input[name='"+t.properties.fieldsName.sname+"']").val(),t.fields.user_logo=$("input[name='"+t.properties.fieldsName.user_logo+"']").val(),"couple"===t.fields.user_type&&(t.fields.nickname_couple=$("input[name='data[nickname_couple]']").val(),t.fields.birth_date_couple=$("input[name='data[birth_date_couple]']").val()),$.ajax({url:t.properties.siteUrl+t.properties.send_form_data,type:"POST",data:{data_fields:t.fields},cache:!1})),!1}),t.properties.timeout)},this.IsEmail=function(e){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)},t.Init(e)})},9281:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.productInstall=function(e){this.properties={siteUrl:"",installType:"product",installBlockID:"modules_reload",actionsBlockID:"actions_reload",overallBarID:"overall_bar",moduleBarID:"module_bar",modules:"",currentModule:"",currentModuleNum:"",currentLang:"",update_file:"",update_path:"product_updates",urlRefreshOverallProduct:"admin/install/ajax_overall_product",urlRefreshOverallProductUpdate:"admin/install/ajax_overall_product_update",urlRefreshOverallModule:"admin/install/ajax_overall_module/",urlStartInstallModule:"admin/install/ajax_start_install/",urlDependenciesModule:"admin/install/ajax_dependencies/",urlPermissionsModule:"admin/install/ajax_permissions/",urlRequirementsModule:"admin/install/ajax_requirements/",urlSqlModule:"admin/install/ajax_sql/",urlFilesModule:"admin/install/ajax_files/",urlChmodModule:"admin/install/ajax_chmod/",urlLinkedModule:"admin/install/ajax_linked/",urlSettingsModule:"admin/install/ajax_settings/",urlPublicModule:"admin/install/ajax_public/",urlLangs:"admin/install/langs/",urlLangsUpdate:"admin/install/langs_update_block/",urlModulesList:"admin/install/modules_list/",urlModuleDelete:"admin/install/ajax_module_delete/",urlDemoContent:"admin/install/ajax_demo_content/",urlUpdateStartInstallModule:"admin/install/ajax_update_sql/",urlUpdateFilesModule:"admin/install/ajax_files/",urlUpdateChmodModule:"admin/install/ajax_chmod/",urlUpdateSettingsModule:"admin/install/ajax_update_settings/",urlUpdatePublicModule:"admin/install/ajax_update_public/",reloadTimeout:10};var t=this,o=!1;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e)},this.request=function(e){"overall_product"===e&&(url=t.properties.siteUrl+t.properties.urlRefreshOverallProduct),"overall_product_update"===e&&(url=t.properties.siteUrl+t.properties.urlRefreshOverallProductUpdate,"product_update"===t.properties.installType&&(url+="/"+t.properties.update_file+"/"+t.properties.update_path)),"overall_module"===e&&(url=t.properties.siteUrl+t.properties.urlRefreshOverallModule+t.properties.currentModule),"start_install"===e&&(url=t.properties.siteUrl+t.properties.urlStartInstallModule+t.properties.currentModule+"/"+t.properties.installType),"start_update"===e&&(url=t.properties.siteUrl+t.properties.urlUpdateStartInstallModule+t.properties.currentModule+"/"+t.properties.installType),"dependencies"===e&&(url=t.properties.siteUrl+t.properties.urlDependenciesModule+t.properties.currentModule+"/"+t.properties.installType),"permissions"===e&&(url=t.properties.siteUrl+t.properties.urlPermissionsModule+t.properties.currentModule+"/"+t.properties.installType),"requirements"===e&&(url=t.properties.siteUrl+t.properties.urlRequirementsModule+t.properties.currentModule+"/"+t.properties.installType),"sql"===e&&(url=t.properties.siteUrl+t.properties.urlSqlModule+t.properties.currentModule+"/"+t.properties.installType),"files"===e&&(url=t.properties.siteUrl+t.properties.urlFilesModule+t.properties.currentModule+"/"+t.properties.installType),"update_files"===e&&(url=t.properties.siteUrl+t.properties.urlUpdateFilesModule+t.properties.currentModule+"/"+t.properties.installType),"chmod"===e&&(url=t.properties.siteUrl+t.properties.urlChmodModule+t.properties.currentModule+"/"+t.properties.installType),"update_chmod"===e&&(url=t.properties.siteUrl+t.properties.urlUpdateChmodModule+t.properties.currentModule+"/"+t.properties.installType),"linked"===e&&(url=t.properties.siteUrl+t.properties.urlLinkedModule+t.properties.currentModule+"/"+t.properties.installType),"settings"===e&&(url=t.properties.siteUrl+t.properties.urlSettingsModule+t.properties.currentModule+"/"+t.properties.installType),"update_settings"===e&&(url=t.properties.siteUrl+t.properties.urlUpdateSettingsModule+t.properties.currentModule+"/"+t.properties.installType),"public"===e&&(url=t.properties.siteUrl+t.properties.urlPublicModule+t.properties.currentModule+"/"+t.properties.installType,"product_update"===t.properties.installType&&(url+="/"+t.properties.update_file+"/"+t.properties.update_path)),"update_public"===e&&(url=t.properties.siteUrl+t.properties.urlUpdatePublicModule+t.properties.currentModule+"/"+t.properties.installType,"product_update"===t.properties.installType&&(url+="/"+t.properties.update_file+"/"+t.properties.update_path)),"langs_update"===e&&(url=t.properties.siteUrl+t.properties.urlLangsUpdate+t.properties.currentLang+"/"+t.properties.currentModule),"module_delete"===e&&(url=t.properties.siteUrl+t.properties.urlModuleDelete+t.properties.currentModule+"/"+t.properties.installType,"product_update"===t.properties.installType&&(url+="/"+t.properties.update_file+"/"+t.properties.update_path)),"demo_content"===e&&(url=t.properties.siteUrl+t.properties.urlDemoContent+t.properties.currentModule+"/"+t.properties.installType),$.ajax({dataType:"html",url,cache:!1,success:function(e){$("#"+t.properties.installBlockID).html(e)}})},this.submit_settings=function(){!0!==o&&(o=!0,url=t.properties.siteUrl+t.properties.urlSettingsModule+t.properties.currentModule,$.ajax({url,type:"POST",cache:!1,data:$("#settings-submit-form").serialize(),success:function(e){$("#"+t.properties.installBlockID).html(e),o=!1}}))},this.delayed_request=function(e,o){o=o||t.properties.reloadTimeout,setTimeout((function(){t.request(e)}),o)},this.update_overall_progress=function(e){if(document.title=e+"%",parent)try{parent.postMessage(JSON.stringify({progress:e}),"*")}catch(e){}$("#"+t.properties.overallBarID+" div.bar").html(e+"%"),$("#"+t.properties.overallBarID+" div.bar").css("width",e+"%")},this.update_module_progress=function(e){document.title=e+"%",$("#"+t.properties.moduleBarID+" div.bar").html(e+"%"),$("#"+t.properties.moduleBarID+" div.bar").css("width",e+"%")},this.test_overall_progress=function(){var e=parseInt($("#"+t.properties.overallBarID+" div.bar").html());(e+=5)>100&&(e=0),t.update_overall_progress(e),setTimeout((function(){t.test_overall_progress()}),t.properties.reloadTimeout)},this.test_module_progress=function(){var e=parseInt($("#"+t.properties.moduleBarID+" div.bar").html());(e+=10)>100&&(e=0),t.update_module_progress(e),setTimeout((function(){t.test_module_progress()}),t.properties.reloadTimeout)},this.langs_init=function(){t.langs_bind_events(),t.langs_set_default()},this.langs_bind_events=function(){$("#install_langs").find(":checkbox").on("change",(function(){var e=$(this).parent().next("td").find(":radio");if($(this).is(":checked"))e.attr("disabled",null);else{if(0===$("#install_langs").find(":checkbox:checked").length)return void $(this).prop("checked",!0);e.attr("disabled","disabled").prop("checked",!1)}t.langs_set_default()}))},this.langs_set_default=function(){void 0===$("[name=default]:checked").val()&&$("[name=default]:enabled:first").prop("checked",!0)},this.get_modules=function(){$.ajax({url:t.properties.siteUrl+t.properties.urlModulesList,dataType:"json",cache:!1,async:!1,success:function(e){return e},error:function(){return!1}})},this.langs_update=function(){t.properties.currentLang&&($.ajax({url:t.properties.siteUrl+t.properties.urlModulesList,dataType:"json",cache:!1,async:!1,success:function(e){t.properties.modules=e.modules},error:function(e){return console.error("error while getting modules list"),!1}}),t.langs_update_module())},this.langs_update_module=function(){if(""===t.properties.currentModule)t.properties.currentModuleNum=0;else if(Object.keys(t.properties.modules).length<=t.properties.currentModuleNum)return document.location.href=t.properties.siteUrl+t.properties.urlLangs,!0;t.properties.currentModule=Object.keys(t.properties.modules)[t.properties.currentModuleNum];var e=100/Object.keys(t.properties.modules).length*(Object.keys(t.properties.modules).indexOf(t.properties.currentModule)+1);t.update_overall_progress(Math.round(e)),$("#module_name").html(t.properties.modules[t.properties.currentModule].module_name),$("#module_desc").html(t.properties.modules[t.properties.currentModule].module_description),t.delayed_request("langs_update"),t.properties.currentModuleNum++},t.Init(e)})},2975:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Kisses=function(e){this.properties={siteUrl:"",use_form:!0,btnForm:"btn-kisses",cFormId:"kisses_form",urlGetForm:"",urlSendForm:"",id_close:"btn_send_kisses",errorObj:new Errors,dataType:"json",messageId:"message",kiss:'input[name="kiss"]',objectId:'input[name="object_id"]',langs:{},contentObj:new loadingContent({loadBlockWidth:"50%",closeBtnClass:"w",scroll:!0,closeBtnPadding:5,blockBody:!0})};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$("#"+t.properties.btnForm).unbind("click").on("click",(function(e){e.preventDefault(),t.properties.use_form&&t.get_form()})).show()},this.get_form=function(){return $.ajax({url:t.properties.siteUrl+t.properties.urlGetForm,type:"POST",cache:!1,dataType:t.properties.dataType,success:function(e){if(void 0!==e.errors&&e.errors.length>0)t.properties.errorObj.show_error_block(e.errors,"error");else{if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return t.properties.contentObj.show_load_block(e.info.access_denied),!1;t.properties.contentObj.show_load_block(e.html),$("#"+t.properties.id_close).unbind().on("click",(function(){return t.clearBox(),!1}))}}}),!1},this.send_form=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.urlSendForm,type:"POST",data:e,dataType:t.properties.dataType,cache:!1,success:function(e){void 0!==e.error&&e.error.length>0?t.properties.errorObj.show_error_block(e.error,"error"):(t.properties.errorObj.show_error_block(e.success,"success"),t.properties.contentObj.hide_load_block(),sendAnalytics("kisses_send_kiss","communication","user"))}}),!1},this.clearBox=function(){if(void 0!==$(t.properties.kiss+":checked").val()){var e=$("#"+t.properties.cFormId).serialize();t.send_form(e)}else t.properties.errorObj.show_error_block(t.properties.langs.kiss_empty,"error")},t.Init(e)})},8631:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Landings=function(e){this.properties={siteUrl:"",ajax_delete_select_url:"admin/landings/ajaxDeleteSelect/",index_page_url:"admin/landings/index/",id_upload_delete:"landing_upload_delete",id_grouping_all:"landing_grouping_all",id_delete_all:"landings_link_delete",id_landing_file:"landing_file",lang_data:{},error_object:new Errors};var t=this;this.Init=function(e){t.prop=$.extend(t.properties,e),t.bindEvents()},this.bindEvents=function(){$(document).off("click","#"+t.prop.id_upload_delete).on("click","#"+t.prop.id_upload_delete,(function(){t.deleteLandingUpload($(this).prop("checked"))})),$(document).off("click","#"+t.prop.id_grouping_all).on("click","#"+t.prop.id_grouping_all,(function(){t.groupingLandings($(this).prop("checked"))})),$(document).off("click","#"+t.prop.id_delete_all).on("click","#"+t.prop.id_delete_all,(function(){t.deleteSelected()}))},this.deleteSelected=function(){var e=new Array;if($("input[type=checkbox]:checked:not(#landing_grouping_all)").each((function(t){e[t]=$(this).val()})),!confirm(t.prop.lang_data.btn_delete_confirm))return!1;$.ajax({url:t.prop.siteUrl+t.prop.ajax_delete_select_url,data:{landings_ids:e},type:"POST",dataType:"json",cache:!1,success:function(e){error_object.show_error_block(e.message,e.status),"error"!=e.status&&(location.href=t.prop.siteUrl+t.prop.index_page_url)}})},this.deleteLandingUpload=function(e){1==e?$("#"+t.prop.id_landing_file).prop("disabled","disabled"):$("#"+t.prop.id_landing_file).prop("disabled","")},this.groupingLandings=function(e){e?$("input[type=checkbox]").prop("checked",!0):$("input[type=checkbox]").prop("checked",!1)},t.Init(e)})},2404:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.langEditor=function(e){this.properties={siteUrl:"",BlockID:"lang_editor_js_block",HandleID:"lang_handle",ContentID:"lang_editor_content",hightlightTextClass:"lang-mark",hightlightButtonClass:"lang-button-mark",data:{}};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.create_editor()},this.create_editor=function(){for(var e in $("#"+t.properties.HandleID).on("click",(function(){t.toggle_block()})),t.properties.data){$("#"+t.properties.ContentID+"> div[langid="+e+"]").on("mouseenter",(function(){var e=$(this).attr("langid");t.hightlight_text(e,t.properties.data[e].edit_type)})).on("mouseleave",(function(){var e=$(this).attr("langid");t.unhightlight_text(e,t.properties.data[e].edit_type)}));var o=t.properties.siteUrl+"languages/ajax_pages_save/"+t.properties.data[e].module_gid+"/"+t.properties.data[e].gid+"/"+t.properties.data[e].lang_id;$("#"+t.properties.ContentID+" > div[langid="+e+"] > div.value").editable(o,{type:"textarea",tooltip:"Edit...",placeholder:'<font class="hide_text">Edit...</font>',name:"text",submit:"Save",height:"auto",width:200,callback:function(e,o){$(this).html(e);var r=$(this).attr("langid");"text"==t.properties.data[r].edit_type?$("span[langid="+r+"]").each((function(){$(this).html(e)})):$("input[langid="+r+"]").each((function(){$(this).val(e)}))}})}},this.toggle_block=function(){$("#"+t.properties.ContentID).slideToggle()},this.hightlight_text=function(e,o){"text"==o?$("span[langid="+e+"]").addClass(t.properties.hightlightTextClass):$("input[langid="+e+"]").addClass(t.properties.hightlightButtonClass)},this.unhightlight_text=function(e,o){"text"==o?$("span[langid="+e+"]").removeClass(t.properties.hightlightTextClass):$("input[langid="+e+"]").removeClass(t.properties.hightlightButtonClass)},t.Init(e)})},689:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.LikeMe=function(e){this.properties={id:"like_me",siteUrl:"",likeBlockId:"like_me-block",action_id:"play_global",main_id:"action-block",skip_button_id:"skip_button",like_button_id:"like_button",watch_button_id:"go-watch_again",search_button_id:"go-search",perfect_button_id:"go-perfect",congratulations_id:"congratulations",action_button_block_id:"action-button",keep_playing_button_id:"keep_playing",match_block_id:"match_block",like_me_btn_class:"like_me-btn",id_user:0,min_id:0,last_profile_id:0,get_users_url:"like_me/ajaxGetUsers",set_action_url:"like_me/ajaxPlayAction",congratulations_url:"like_me/ajaxCongratulations",contact_user_url:"like_me/ajaxContactUser",common_ancestor:"body",gotIt:'[data-action="go"]',goSearch:'[data-action="search"]',langs:{},isRegistr:0,isFlippingProfiles:0,class:{skip:".likemecontrols__item_skip"},data:{action:{closeBlock:'[data-action="close-block"]'}},windowObj:null};var t=this,o={};this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_controls(),t.properties.last_profile_id=lightGetCookie("exclude_user_id"),t.loadUsers(t.properties.action_id,0),t.properties.windowObj||(t.properties.windowObj=new loadingContent({loadBlockWidth:"400px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1})),t.changeHeader(t.properties.last_profile_id)},this.uninit=function(){return $(t.properties.common_ancestor).off("click","#"+t.properties.skip_button_id).off("click","#"+t.properties.like_button_id).off("click","#"+t.properties.watch_button_id).off("click","#"+t.properties.search_button_id).off("click","#"+t.properties.perfect_button_id).off("click","#"+t.properties.keep_playing_button_id).off("click","."+t.properties.like_me_btn_class).off("click","."+t.properties.gotIt).off("click","."+t.properties.goSearch),this},this.init_controls=function(){$(t.properties.common_ancestor).off("click","#"+t.properties.skip_button_id).on("click","#"+t.properties.skip_button_id,(function(){t.playAction("skip")})).off("click","#"+t.properties.like_button_id).on("click","#"+t.properties.like_button_id,(function(){t.playAction($(this).attr("data-action"))})).off("click","#"+t.properties.watch_button_id).on("click","#"+t.properties.watch_button_id,(function(){t.loadUsers(t.properties.action_id,1)})).off("click","#"+t.properties.search_button_id).on("click","#"+t.properties.search_button_id,(function(){t.exitLikeMe("users/search")})).off("click","#"+t.properties.perfect_button_id).on("click","#"+t.properties.perfect_button_id,(function(){t.exitLikeMe("perfect_match/index")})).off("click","#"+t.properties.keep_playing_button_id).on("click","#"+t.properties.keep_playing_button_id,(function(e){t.playAction($(this).data("action"))})).off("click","."+t.properties.like_me_btn_class).on("click","."+t.properties.like_me_btn_class,(function(){t.deleteMatchBlock(500)})).off("click",t.properties.gotIt).on("click",t.properties.gotIt,(function(){t.properties.windowObj.hide_load_block()})).off("click",t.properties.goSearch).on("click",t.properties.goSearch,(function(){t.exitLikeMe("users/search")})).off("click",t.properties.data.action.closeBlock).on("click",t.properties.data.action.closeBlock,(function(){$("#"+t.properties.like_button_id).remove()}))},this.loadUsers=function(e,o){"matches"==e&&$("body").addClass("mod-likeme-matches");var r={type:e,reload:o},i=t.isReloadCongratulationsNotice();!0===i&&(r.exclude_user_id=t.properties.last_profile_id),$.ajax({type:"POST",dataType:"JSON",url:t.properties.siteUrl+t.properties.get_users_url,data:r,success:function(e){void 0!==e.html&&(e.html=t.addJSParams(e.html),$("#"+t.properties.main_id).html(e.html),!0===i&&(t.congratulationsNotice(t.properties.last_profile_id),lightSetCookie("exclude_user_id",0)))},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.isReloadCongratulationsNotice=function(){var e=!1;return document.referrer.match(new RegExp("access_permissions"))&&t.properties.last_profile_id>0&&(e=!0),e},this.playAction=function(e){var o=$("[data-profile_id]").data("profile_id");$.ajax({type:"POST",dataType:"JSON",url:t.properties.siteUrl+t.properties.set_action_url,data:{type:t.properties.action_id,action:e,profile_id:o},success:function(r){if(void 0!==r.info.access_denied&&r.info.access_denied.length>0)return t.properties.windowObj.show_load_block(r.info.access_denied),!1;1===t.properties.isFlippingProfiles&&t.deleteMatchBlock(0),void 0===r.html?(lightSetCookie("exclude_user_id",o),t.congratulationsNotice(o)):1===t.properties.isFlippingProfiles?locationHref($(t.properties.class.skip).attr("href")):($("#"+t.properties.main_id).html(r.html),"skip"===e&&t.properties.windowObj.hide_load_block())},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.congratulationsNotice=function(e){$.ajax({type:"POST",dataType:"html",url:t.properties.siteUrl+t.properties.congratulations_url,data:{profile_id:e},success:function(e){t.rebuildStyleCss(e)},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.imgHeight=function(){return void 0===o.img_height&&(o.img_height=parseInt($(window).height()-$("header").height()-$(".pre-main-inner-content").height())),o.img_height},this.imgWidth=function(){return void 0===o.img_height&&(o.img_height=70*parseInt($(window).width())/100),o.img_height},this.exitLikeMe=function(e){locationHref(t.properties.siteUrl+e)},this.rebuildStyleCss=function(e){$("#"+t.properties.like_button_id).toggleClass("likemecontrols__item_like").toggleClass("likemecontrols__item_liked"),"like"==$("#"+t.properties.like_button_id).attr("data-action")?$("#"+t.properties.like_button_id).attr("data-action","unlike"):$("#"+t.properties.like_button_id).attr("data-action","like"),new Promise((function(e){t.properties.windowObj.changeTemplate("default"),t.properties.windowObj.update_css_styles({width:"400px"}),setTimeout((function(){e()}),1e3)})).then((function(){t.properties.windowObj.show_load_block(e),$("#"+t.properties.match_block_id).html(e)})),$("."+t.properties.like_me_btn_class).css("display","block"),$("."+t.properties.like_me_btn_class).find("button").eq(1).hide()},this.deleteMatchBlock=function(e){0===e?t.properties.windowObj.hide_load_block():setTimeout((function(){t.properties.windowObj.hide_load_block()}),e)},this.changeHeader=function(){var e=$(window).width(),o=e<768?"none":"block";if($("header").css("display",o),$(window).resize((function(){e=$(this).width(),o=e<768?"none":"block",$("header").css("display",o)})),1===t.properties.isRegistr){var r='<div class="register-header">'+t.properties.langs.header+'</div>\n                <div class="register-actions">\n                    <button class="btn btn-primary btn-lg" data-action="go">'+t.properties.langs.gotItBtn+'</button>\n                    <button class="btn btn-primary-inverted btn-lg" data-action="search">'+t.properties.langs.searchBtn+"</button>\n                </div>";t.properties.windowObj.show_load_block(r)}},this.escapeRegExp=function(e){return e.replace(/[]/g,"\\$&")},this.addJSParams=function(e){var o=new RegExp(t.escapeRegExp("siteUrl: site_url,").replace(/[]/g,"|"),"gi");return e.replace(o,"$& singleton: 0,")},t.Init(e)})},1166:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.MatchMe=function(e){this.properties={siteUrl:"",show_more_btn_id:"show_more",content_block_id:"matches",match_btn_class:"match-button-content",match_block_class:"b-likeme__mymatches",page:1,load_on_scroll:1,all_loaded:0,loading_status:0,post_data:{},show_more_lang:"Show more",url:{matches:"like_me/ajaxLoadMatches",like:"like_me/load_like_profiles",like_me:"like_me/load_like_me_profiles"},common_ancestor:"body"};var t=this,o=null;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_controls()},this.uninit=function(){return $(t.properties.common_ancestor).off("click","#"+t.properties.show_more_btn_id).off("mouseenter","."+t.properties.match_block_class+">div").off("mouseleave","."+t.properties.match_block_class+">div"),this},this.init_controls=function(){$(t.properties.common_ancestor).off("click","#"+t.properties.show_more_btn_id).on("click","#"+t.properties.show_more_btn_id,(function(){t.nextPage(this)})).off("mouseenter","."+t.properties.match_block_class+">div").on("mouseenter","."+t.properties.match_block_class+">div",(function(){$(this).find(".info").stop().slideDown(100)})).off("mouseleave","."+t.properties.match_block_class+">div").on("mouseleave","."+t.properties.match_block_class+">div",(function(){$(this).find(".info").stop(!0).delay(100).slideUp(100)}))},this.nextPage=function(e){t.properties.page++,t.loadContent(!1,e)},this.loadContent=function(e,r){if(e=e||!1)o&&o.abort(),t.properties.page=1;else if(1==t.properties.all_loaded||t.properties.loading_status)return!0;t.properties.loading_status=1,t.properties.content_block_id=$(r).data("type");var i=t.properties.url[t.properties.content_block_id];o=$.ajax({url:t.properties.siteUrl+i+"/"+t.properties.page,type:"GET",dataType:"JSON",cache:!1,success:function(e){t.createItemBlock(e.html)},complete:function(){t.properties.loading_status=0}})},this.createItemBlock=function(e){$(".b-likeme-page").css("position","relative"),e=t.addJSParams(e);var o="",r="";$("."+t.properties.match_btn_class).remove(),$(e).each((function(){r=$(this).find("."+t.properties.match_btn_class),$(this).find("."+t.properties.match_block_class+" i").addClass("w"),o=$(this).find("."+t.properties.match_block_class+">div>div").unwrap()})),$("."+t.properties.match_block_class+">div").append(o),r?$("#"+t.properties.content_block_id).append(r):(t.properties.load_on_scroll=0,t.properties.all_loaded=1)},this.escapeRegExp=function(e){return e.replace(/[]/g,"\\$&")},this.addJSParams=function(e){var o=new RegExp(t.escapeRegExp("siteUrl: site_url,").replace(/[]/g,"|"),"gi");return e.replace(o,"$& singleton: 0,")},t.Init(e)})},7771:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Likes=function(e){this.properties={siteUrl:"/",likeUrl:"likes/ajax_like",usersUrl:"likes/ajax_get_users",likeBlock:".like_block",likeBtn:".like_btn",likeMoreBtn:".like_more_btn",numberBlock:".like_num",usersBlock:".like_users",likeClass:"far fa-heart",unlikeClass:"fas fa-heart",likeTitle:"",unlikeTitle:"",actionAttr:"action",actionLike:"like",actionUnlike:"unlike",usersPositionMy:"left bottom",usersPositionAt:"left top",usersPositionWithin:".content",usersPositionCollision:"flip none",showUsersTimeout:300,hideUsersTimeout:300,canLike:!0},this.current_obj={};var t,o,r=this,i=[],n=!1;this.Init=function(e){r.properties=$.extend(r.properties,e),r.init_controls()},this.uninit=function(){return $(document).off("mouseenter",r.properties.likeBlock).off("mouseleave",r.properties.likeBlock).off("mouseenter",r.properties.usersBlock).off("mouseleave",r.properties.usersBlock).off("click",r.properties.likeBtn+", "+r.properties.numberBlock),this},this.init_controls=function(){$(document).off("mouseenter",r.properties.likeBlock).on("mouseenter",r.properties.likeBlock,(function(){var e=$(this);clearTimeout(o),t=setTimeout((function(){r.show_users(e)}),r.properties.showUsersTimeout)})).off("mouseleave",r.properties.likeBlock).on("mouseleave",r.properties.likeBlock,(function(){clearTimeout(t),o=setTimeout((function(){$(r.properties.usersBlock).fadeOut()}),r.properties.hideUsersTimeout)})).off("mouseenter",r.properties.usersBlock).on("mouseenter",r.properties.usersBlock,(function(){clearTimeout(o)})).off("mouseleave",r.properties.usersBlock).on("mouseleave",r.properties.usersBlock,(function(){o=setTimeout((function(){$(r.properties.usersBlock).fadeOut()}),r.properties.hideUsersTimeout)})).off("click",r.properties.likeBtn+", "+r.properties.numberBlock).on("click",r.properties.likeBtn+", "+r.properties.numberBlock,(function(){r.like($(this).closest(r.properties.likeBlock))})).off("click",r.properties.likeMoreBtn).on("click",r.properties.likeMoreBtn,(function(){r.show_all_users(r.current_obj)}))},this.like=function(e){var t=e.data("gid");if(!id_user)return error_object.errors_access(),!1;if(n||!t)return!1;var o=e.data(r.properties.actionAttr);n=!0,$.ajax({url:r.properties.siteUrl+r.properties.likeUrl,type:"POST",dataType:"json",cache:!1,data:{like_id:t,like_action:o},success:function(i){return n=!1,1===i.status?(r.save_like(t,o,i.count),"0"===i.count?$(r.properties.usersBlock).fadeOut():r.show_users(e,!0),o===r.properties.actionLike&&sendAnalytics("send_like_"+t.replace(/\d+$/,""),"communication","user"),!0):(error_object.show_error_block(i.error,"error"),!1)},error:function(){return n=!1,!1}})},this.show_all_users=function(e){return r.show_users(e,!0,!0),this},this.show_users=function(e,t,o){if("0"===e.find(r.properties.numberBlock).html())return!1;t|=!1,o|=!1;var n=e.data("gid");if(!n)return!1;r.current_obj=e,o||$(".like_users").stop(!0).hide();var s,a="like_"+n+"_users";if(s=$("."+a),-1!==$.inArray(n,i)&&!t)return s.is(":visible")||s.is(":empty")||s.fadeIn().position({my:r.properties.usersPositionMy,at:r.properties.usersPositionAt,of:e,within:e,collision:r.properties.usersPositionCollision}),!0;$.ajax({url:r.properties.siteUrl+r.properties.usersUrl,type:"POST",dataType:"html",cache:!1,data:{like_id:n,get_all:o?1:0},success:function(o){if(o=$.trim(o),s.length){if(0===o.length)return s.fadeOut((function(){s.html("")})),!0;s.html($(o).html())}else o.length&&(s=$(o).addClass(a).data("id-like",n),$("body").append(s));return t||i.push(n),s.fadeIn().position({my:r.properties.usersPositionMy,at:r.properties.usersPositionAt,of:e,within:e,collision:r.properties.usersPositionCollision}),!0},error:function(){console.log("error while getting users list")}})},this.save_like=function(e,t,o){var i=$('[data-gid="'+e+'"]'),n=i.find(r.properties.likeBtn);r.properties.actionLike===t?(i.data(r.properties.actionAttr,r.properties.actionUnlike),n.removeClass(r.properties.likeClass).addClass(r.properties.unlikeClass).attr("title",r.properties.unlikeTitle)):r.properties.actionUnlike===t?(i.data(r.properties.actionAttr,r.properties.actionLike),n.removeClass(r.properties.unlikeClass).addClass(r.properties.likeClass).attr("title",r.properties.likeTitle)):console.log("error while saving like: wrong action"),i.find(r.properties.numberBlock).html(o)},r.Init(e)})},9627:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.adminMailList=function(e){this.properties={siteUrl:"",imgsUrl:"",subscribe_lang:"",unsubscribe_lang:"",id:{groupingAll:"#grouping_all",btnSave:"#btn_save",searchForm:"#search_form"},errorObj:new Errors};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls()},this.initControls=function(){$(document).off("ifChanged",t.properties.id.groupingAll).on("ifChanged",t.properties.id.groupingAll,(function(){t.groupingAll(this)})).off("click",t.properties.id.btnSave).on("click",t.properties.id.btnSave,(function(){t.save_filter($(t.properties.id.searchForm).serializeArray())}))},this.groupingAll=function(e){$(e).prop("checked")?$("input[data='table_records']").iCheck("check"):$("input[data='table_records']").iCheck("uncheck")},this.bind_users_events=function(){$("#mail_list").off("click",".subscribe").on("click",".subscribe",(function(){t.subscribe_users($(this).attr("id"))})),$("#mail_list").off("click",".subscribe_one").on("click",".subscribe_one",(function(){var e=+$(this).parent().parent().attr("id").replace(/\D+/g,"");t.subscribe_one(e,$(this))})),$("#mail_list").off("click",".unsubscribe_one").on("click",".unsubscribe_one",(function(){var e=+$(this).parent().parent().attr("id").replace(/\D+/g,"");t.unsubscribe_one(e,$(this))}))},this.bind_filters_events=function(){$(".link_delete","#tbl_filters").unbind("click").on("click",(function(){var e=+$(this).attr("id").replace(/\D+/g,"");t.delete_filter(e,$(this).parent().parent())})),$(".link_search","#tbl_filters").unbind("click").on("click",(function(){var e=+$(this).attr("id").replace(/\D+/g,"");t.apply_filter(e)}))},this.subscribe_one=function(e,o){t.subscribe_users("subscribe_one",e),o.removeClass("subscribe_one btn-outline").addClass("unsubscribe_one"),o.html(t.properties.unsubscribe_lang)},this.unsubscribe_one=function(e,o){t.subscribe_users("unsubscribe_one",e),o.removeClass("unsubscribe_one").addClass("subscribe_one btn-outline"),o.html(t.properties.subscribe_lang),o.blur()},this.subscribe_users=function(e,o){var r={},i=0,n=!1;r.id_subscription=$("#id_subscription").val(),r.action=e,"subscribe_one"==e||"unsubscribe_one"==e?r.id_user=o:"subscribe_selected"!=e&&"unsubscribe_selected"!=e||(n=!0,r.id_users=[],$(".grouping:checked").each((function(){o=$(this).attr("value"),r.id_users.push(o),"subscribe_selected"==e?$("#user"+o).find(".subscribe_one i").removeClass("fa-square-o").addClass("fa-check-square-o").parent().removeClass("subscribe_one").addClass("unsubscribe_one"):$("#user"+o).find(".unsubscribe_one i").removeClass("fa-check-square-o").addClass("fa-square-o").parent().removeClass("unsubscribe_one").addClass("subscribe_one")}))),$.ajax({url:t.properties.siteUrl+"admin/mail_list/ajax_subscribe",type:"POST",cache:!1,data:r,success:function(o){switch(e){case"subscribe_one":i=1;break;case"unsubscribe_one":i=-1;break;case"subscribe_selected":i=r.id_users.length;break;case"unsubscribe_selected":i=-r.id_users.length;break;case"subscribe_all":i=parseInt($("#count_not_subscribed").html()),n=!0;break;case"unsubscribe_all":i=-parseInt($("#count_subscribed").html()),n=!0}t.updateCount(i),n&&location.reload()}})},this.updateCount=function(e){$("#count_subscribed").html(parseInt($("#count_subscribed").html())+e),$("#count_not_subscribed").html(parseInt($("#count_not_subscribed").html())-e)},this.save_filter=function(e){$.ajax({data:e,type:"POST",dataType:"JSON",cache:!1,url:t.properties.siteUrl+"admin/mail_list/ajax_save_filter",success:function(e){void 0!==e.success?t.properties.errorObj.show_error_block(e.success,"success"):t.properties.errorObj.show_error_block(e.error,"error")}})},this.delete_filter=function(e,o){$.ajax({url:t.properties.siteUrl+"admin/mail_list/ajax_delete_filter",type:"POST",cache:!1,data:{id_filter:e},success:function(t){return void 0!==t&&1==t?($("#filter_"+e).remove(),!0):(console.error("Error while removing filter"),!1)}})},this.apply_filter=function(e){$("#id_filter").val(e),$("#frm_apply_filter").submit()},t.Init(e)})},2035:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.mailbox=function(e){this.properties={siteUrl:"/",folder:"inbox",page:1,mainContent:"#mailbox_content",topMenu:"#mailbox_top_menu",selectAllElement:"#select_all_checkbox",checkboxMask:'input[data-role="msg-checkbox"]',deleteButton:"#mailbox_delete",deleteMessagesUrl:"mailbox/ajax_delete_messages",deleteMessageButton:"#message_delete",deleteMessageUrl:"mailbox/ajax_delete_message",deleteForeverButton:"#mailbox_delete_forever",deleteForeverUrl:"mailbox/ajax_delete_forever",markSpamButton:"#mark_spam",markSpamMessagesUrl:"mailbox/ajax_mark_spam_messages",markSpamMessageButton:"#message_mark_spam",markSpamMessageUrl:"mailbox/ajax_mark_spam_message",unmarkSpamMessagesButton:"#unmark_spam",unmarkSpamMessagesUrl:"mailbox/ajax_unmark_spam_messages",unmarkSpamMessageButton:"#message_unmark_spam",unmarkSpamMessageUrl:"mailbox/ajax_unmark_spam_message",untrashButton:"#mailbox_untrash",untrashUrl:"mailbox/ajax_untrash_messages",untrashMessageButton:"#message_untrash",untrashMessageUrl:"mailbox/ajax_untrash_message",threadUrl:"mailbox/ajax_thread",viewMessageUrl:"mailbox/view",editMessageUrl:"mailbox/edit",writeMessageButton:"#btn_write_message",savePeriod:10,saveFormId:"#write_form",saveMessageUrl:"mailbox/ajax_save_draft",messageId:0,sendMessageButton:"#btn_send_message",sendMessageUrl:"mailbox/ajax_send_message",formMessageUrl:"mailbox/ajax_show_form",fullWriteButton:"#write_message_full",fullWriteUrl:"mailbox/write",deleteAttachUrl:"mailbox/ajax_delete_attach",saveMessageButton:"#save_message",saveReplyUrl:"mailbox/ajax_save_reply",replyMessageUrl:"mailbox/ajax_reply_message",replyFormButton:"#reply_message",replyFormUrl:"mailbox/view",replyId:0,deleteThreadButton:"#delete_thread",deleteThreadUrl:"mailbox/ajax_delete_thread",searchMessagesButton:"#btn_search_messages",searchMessagesUrl:"mailbox/ajax_search_messages",editMessageButton:"#edit_message",statusTimeout:2,contactId:0,accessAvailableView:null,readAvailableView:null,sendAvailableView:null,windowObj:null,loadContent:!1,writeMessage:!1};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_objects(),t.init_controls()},this.uninit=function(){t.main_content_obj.off("click",t.properties.selectAllElement),t.main_content_obj.off("click",t.properties.deleteButton),t.main_content_obj.off("click",t.properties.markSpamButton),t.main_content_obj.off("click",t.properties.unmarkSpamMessagesButton),t.mark_spam_message_btn_obj.off("click"),t.unmark_spam_message_btn_obj.off("click"),t.main_content_obj.off("click",t.properties.deleteForeverButton),t.main_content_obj.off("click",t.properties.untrashButton),t.untrash_message_btn_obj.off("click"),t.main_content_obj.off("click",".btn-toggle-message"),t.main_content_obj.off("click",".btn_thread"),t.main_content_obj.off("click",".btn_read_message"),t.main_content_obj.off("click",".btn_edit_message"),t.main_content_obj.off("click",".pointer input[type=checkbox]"),t.write_message_btn_obj.off("click"),t.save_message_btn_obj.off("click"),t.send_message_btn_obj.off("click"),t.full_write_btn_obj.off("click"),t.reply_form_btn_obj.off("click"),t.delete_thread_btn_obj.off("click"),t.delete_message_btn_obj.off("click"),t.top_menu_obj.off("click",".a"),t.main_content_obj.off("click",".btn_delete_attach"),t.main_content_obj.off("click",".btn_search_messages"),t.edit_message_btn_obj.off("click"),delete t.properties.windowObj,t.properties.writeMessage&&clearInterval(t.save_interval_obj)},this.init_objects=function(){t.main_content_obj=$(t.properties.mainContent),t.mark_spam_message_btn_obj=$(t.properties.markSpamMessageButton),t.unmark_spam_message_btn_obj=$(t.properties.unmarkSpamMessageButton),t.untrash_message_btn_obj=$(t.properties.untrashMessageButton),t.write_message_btn_obj=$(t.properties.writeMessageButton),t.save_message_btn_obj=$(t.properties.saveMessageButton),t.send_message_btn_obj=$(t.properties.sendMessageButton),t.full_write_btn_obj=$(t.properties.fullWriteButton),t.reply_form_btn_obj=$(t.properties.replyFormButton),t.delete_thread_btn_obj=$(t.properties.deleteThreadButton),t.delete_message_btn_obj=$(t.properties.deleteMessageButton),t.top_menu_obj=$(t.properties.topMenu),t.edit_message_btn_obj=$(t.properties.editMessageButton),t.properties.windowObj=new loadingContent({loadBlockWidth:"520px",closeBtnClass:"w"}),t.properties.writeMessage&&(t.save_interval_obj=setInterval((function(){t.save_message.call(self)}),1e3*t.properties.savePeriod))},this.countChecked=function(){return $(".pointer input[type=checkbox]:checked").length},this.init_controls=function(){t.main_content_obj.off("change",t.properties.selectAllElement).on("change",t.properties.selectAllElement,(function(){t.main_content_obj.find(t.properties.checkboxMask).prop("checked",$(this).is(":checked")),$(this).is(":checked")?$(t.properties.topMenu+' div[role="btn"]').removeClass("disabled btn-disabled"):$(t.properties.topMenu+' div[role="btn"]').addClass("disabled btn-disabled")})),t.main_content_obj.off("click",t.properties.deleteButton).on("click",t.properties.deleteButton,(function(){t.delete_messages()})),t.main_content_obj.off("click",t.properties.markSpamButton).on("click",t.properties.markSpamButton,(function(){t.mark_spam_messages()})),t.main_content_obj.off("click",t.properties.unmarkSpamMessagesButton).on("click",t.properties.unmarkSpamMessagesButton,(function(){t.unmark_spam_messages()})),t.mark_spam_message_btn_obj.off("click").on("click",(function(){t.mark_spam_message()})),t.unmark_spam_message_btn_obj.off("click").on("click",(function(){t.unmark_spam_message()})),t.main_content_obj.off("click",t.properties.deleteForeverButton).on("click",t.properties.deleteForeverButton,(function(){t.delete_forever()})),t.main_content_obj.off("click",t.properties.untrashButton).on("click",t.properties.untrashButton,(function(){t.untrash_messages()})),t.untrash_message_btn_obj.off("click").on("click",(function(){t.untrash_message()})),t.main_content_obj.off("click",".btn-toggle-message").on("click",".btn-toggle-message",(function(){t.toggle_message($(this).attr("id"))})),t.main_content_obj.off("click",".btn_thread").on("click",".btn_thread",(function(){return t.thread_messages($(this)),!1})),t.main_content_obj.off("click",".btn_read_message").on("click",".btn_read_message",(function(){t.is_read_message($(this))})),t.main_content_obj.off("click",".btn_edit_message").on("click",".btn_edit_message",(function(){t.is_edit_message($(this))})),t.main_content_obj.off("click",".pointer input[type=checkbox]").on("click",".pointer input[type=checkbox]",(function(e){e.stopPropagation(),t.countChecked()>0?$(t.properties.topMenu+' div[role="btn"]').removeClass("disabled btn-disabled"):($(t.properties.topMenu+' div[role="btn"]').addClass("disabled btn-disabled"),$(t.properties.selectAllElement).prop("checked",!1))})),t.write_message_btn_obj.off("click").on("click",(function(){t.is_write_message()})),t.save_message_btn_obj.off("click").on("click",(function(){t.save_message(null,!0)})),t.send_message_btn_obj.off("click").on("click",(function(){t.is_send_message()})),t.reply_form_btn_obj.off("click").on("click",(function(){var e=t.properties.siteUrl+t.properties.replyFormUrl+"/"+t.properties.messageId;locationHref(e+"#reply_form")})),t.full_write_btn_obj.off("click").on("click",(function(){t.save_message((function(e){var o=t.properties.siteUrl+t.properties.fullWriteUrl;t.properties.messageId&&(o+="/"+t.properties.messageId),locationHref(o)})),$(t.properties.saveFormId).on("submit",(function(e){e.preventDefault()}))})),t.delete_thread_btn_obj.off("click").on("click",(function(){t.delete_thread()})),t.delete_message_btn_obj.off("click").on("click",(function(){t.delete_message()})),t.top_menu_obj.off("click",".a").on("click",".a",(function(){$(this).parent().parent().find("input[type=checkbox]").prop("checked",!1)})),t.main_content_obj.off("click",".btn_delete_attach").on("click",".btn_delete_upload",(function(){return t.delete_attach($(this).attr("data-id")),!1})),t.main_content_obj.off("click",".btn_search_messages").on("click",".btn_search_messages",(function(){var e=$(this).parents("ul").find("#mail_keywords").val();t.search_messages(e)})),t.edit_message_btn_obj.off("click").on("click",(function(){var e=t.properties.siteUrl+t.properties.editMessageUrl+"/"+t.properties.messageId;locationHref(e)}))},this.get_marked_ids=function(){var e=[];return t.main_content_obj.find(t.properties.checkboxMask+":checked").each((function(){e.push($(this).attr("value"))})),e},this.delete_messages=function(){ids=t.get_marked_ids(),0!==ids.length&&(t.properties.page=1,$.ajax({url:t.properties.siteUrl+t.properties.deleteMessagesUrl+"/"+t.properties.folder+"/"+t.properties.page,type:"POST",dataType:"json",cache:!1,data:{ids},success:function(e){1==e.status?(t.main_content_obj.html(e.content),error_object.show_error_block(e.message,"success")):error_object.show_error_block(e.message,"error")}}))},this.delete_message=function(){$.ajax({url:t.properties.siteUrl+t.properties.deleteMessageUrl+"/"+t.properties.messageId,type:"GET",dataType:"json",cache:!1,success:function(e){1==e.status?(error_object.show_error_block(e.message,"success"),locationHref(t.properties.siteUrl+t.properties.viewMessageUrl+"/"+t.properties.messageId)):error_object.show_error_block(e.message,"error")}})},this.mark_spam_messages=function(){ids=t.get_marked_ids(),0!==ids.length&&(t.properties.page=1,$.ajax({url:t.properties.siteUrl+t.properties.markSpamMessagesUrl+"/"+t.properties.folder+"/"+t.properties.page,type:"POST",dataType:"json",cache:!1,data:{ids},success:function(e){1==e.status?(t.main_content_obj.html(e.content),error_object.show_error_block(e.message,"success")):error_object.show_error_block(e.message,"error")}}))},this.mark_spam_message=function(){$.ajax({url:t.properties.siteUrl+t.properties.markSpamMessageUrl+"/"+t.properties.messageId,type:"GET",dataType:"json",cache:!1,success:function(e){1==e.status?(error_object.show_error_block(e.message,"success"),locationHref(t.properties.siteUrl+t.properties.viewMessageUrl+"/"+t.properties.messageId)):error_object.show_error_block(e.message,"error")}})},this.unmark_spam_messages=function(){ids=t.get_marked_ids(),0!==ids.length&&(t.properties.page=1,$.ajax({url:t.properties.siteUrl+t.properties.unmarkSpamMessagesUrl+"/"+t.properties.folder+"/"+t.properties.page,type:"POST",dataType:"json",cache:!1,data:{ids},success:function(e){1==e.status?(t.main_content_obj.html(e.content),error_object.show_error_block(e.message,"success")):error_object.show_error_block(e.message,"error")}}))},this.unmark_spam_message=function(){$.ajax({url:t.properties.siteUrl+t.properties.unmarkSpamMessageUrl+"/"+t.properties.messageId,type:"GET",dataType:"json",cache:!1,success:function(e){1==e.status?(error_object.show_error_block(e.message,"success"),locationHref(t.properties.siteUrl+t.properties.viewMessageUrl+"/"+t.properties.messageId)):error_object.show_error_block(e.message,"error")}})},this.delete_forever=function(){ids=t.get_marked_ids(),0!==ids.length&&(t.properties.page=1,$.ajax({url:t.properties.siteUrl+t.properties.deleteForeverUrl+"/"+t.properties.folder+"/"+t.properties.page,type:"POST",dataType:"json",cache:!1,data:{ids},success:function(e){1==e.status?(t.main_content_obj.html(e.content),error_object.show_error_block(e.message,"success")):error_object.show_error_block(e.message,"error")}}))},this.untrash_message=function(){$.ajax({url:t.properties.siteUrl+t.properties.untrashMessageUrl+"/"+t.properties.messageId,type:"GET",dataType:"json",cache:!1,success:function(e){1==e.status?(error_object.show_error_block(e.message,"success"),locationHref(t.properties.siteUrl+t.properties.viewMessageUrl+"/"+t.properties.messageId)):error_object.show_error_block(e.message,"error")}})},this.untrash_messages=function(){ids=t.get_marked_ids(),0!==ids.length&&(t.properties.page=1,$.ajax({url:t.properties.siteUrl+t.properties.untrashUrl+"/"+t.properties.folder+"/"+t.properties.page,type:"POST",dataType:"json",cache:!1,data:{ids},success:function(e){1==e.status?(t.main_content_obj.html(e.content),error_object.show_error_block(e.message,"success")):error_object.show_error_block(e.message,"error")}}))},this.toggle_message=function(e){$("#"+e).toggleClass("full")},this.thread_messages=function(e){var o=parseInt(e.attr("data-page")),r=e.attr("data-dir");$.ajax({url:t.properties.siteUrl+t.properties.threadUrl+"/"+e.attr("data-id")+"/"+r+"/"+o,type:"GET",dataType:"json",cache:!1,success:function(t){var i=e.parent();e.html(t.count),e.attr("data-page",o+1),t.count||e.parent().hide(),"next"===r?i.after(t.content):i.before(t.content)}})},this.is_read_message=function(e){t.properties.messageId=e.attr("data-id"),t.readAvailableView(t.properties.messageId)},this.readAvailableView=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.readAvailableView.properties.checkAvailableAjaxUrl+e,type:"POST",dataType:"json",cache:!1,success:function(e){if(e.content_buy_block)return t.properties.windowObj.show_load_block(e.content),!1;t.properties.readAvailableView.properties.success_request()}}),!1},this.read_message=function(){locationHref(t.properties.siteUrl+t.properties.viewMessageUrl+"/"+t.properties.messageId)},this.is_edit_message=function(e){t.properties.messageId=e.attr("data-id"),t.edit_message()},this.edit_message=function(){locationHref(t.properties.siteUrl+t.properties.editMessageUrl+"/"+t.properties.messageId)},this.is_write_message=function(){t.accessAvailableView()},this.accessAvailableView=function(){return $.ajax({url:t.properties.siteUrl+t.properties.accessAvailableView.properties.checkAvailableAjaxUrl,type:"POST",dataType:"json",cache:!1,success:function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return t.properties.windowObj.show_load_block(e.info.access_denied),!1;t.properties.accessAvailableView.properties.success_request()}}),!1},this.write_message=function(e,o){o=o||"full",$.ajax({url:t.properties.siteUrl+t.properties.formMessageUrl+"/"+e+"/"+o,type:"GET",cache:!1,success:function(e){if(t.isJson(e)){var o=JSON.parse(e);if(void 0!==o.info.access_denied&&o.info.access_denied.length>0)return t.properties.windowObj.show_load_block(o.info.access_denied),!1}else t.properties.windowObj.show_load_block(e)}})},this.is_save_message=function(e){for(var t in e)switch(e[t].name){case"id_to_user":if(e[t].value>0)return!0;break;case"name_to_user":break;default:if(e[t].value)return!0}return!1},this.save_message=function(e,o){var r=$(t.properties.saveFormId).serializeArray();if(!o&&!t.is_save_message(r))return!1;t.do_save_message(e,r)},this.do_save_message=function(e,o){var r=t.properties.siteUrl+t.properties.saveMessageUrl;if(t.properties.messageId)r+="/"+t.properties.messageId;else if(t.save_request_lock){if(t.save_request_data)return void t.save_request_data.push({callback:e,data:o})}else t.save_request_lock=!0;$.ajax({url:r,type:"POST",data:o,dataType:"json",cache:!1,success:function(o){o.message_id&&(t.properties.messageId=o.message_id),e?o.message_id&&e(o):($("#save_status").html(o.status).show(),setTimeout((function(){$("#save_status").hide()}),1e3*t.properties.statusTimeout)),t.save_request_lock&&(t.save_request_lock=!1,t.do_save_requests(!o.message_id))},error:function(e){console.error("mailbox error")}})},this.do_save_requests=function(e){for(var o in t.save_request_data)if(t.do_save_message(t.save_request_data[o].callback,t.save_request_data[o].data),delete t.save_request_data[o],e)break},this.save_reply=function(e,o){var r=$(t.properties.saveFormId).serializeArray();(o||t.is_save_message(r))&&t.do_save_reply(e,r)},this.do_save_reply=function(e,o){var r=t.properties.siteUrl+t.properties.saveReplyUrl+"/"+t.properties.messageId;if(t.properties.replyId)r+="/"+t.properties.replyId;else{if(t.save_reply_request_lock)return void t.save_reply_request_data.push({callback:e,data:o});t.save_reply_request_lock=!0}$.ajax({url:r,type:"POST",data:o,dataType:"json",cache:!1,success:function(o){o.reply_id&&(t.properties.replyId=o.reply_id),e?o.reply_id&&e(o):($("#save_status").html(o.status).show(),setTimeout((function(){$("#save_status").hide()}),1e3*t.properties.statusTimeout)),t.save_reply_request_lock&&(t.do_save_reply_requests(!o.reply_id),t.save_reply_request_lock=!1)}})},this.do_save_reply_requests=function(e){for(var o in t.save_reply_request_data)if(t.do_save_message(t.save_reply_request_data[o].callback,t.save_reply_request_data[o].data),delete t.save_reply_request_data[o],e)break},this.is_send_message=function(){return t.sendAvailableView()},this.sendAvailableView=function(){return $.ajax({url:t.properties.siteUrl+t.properties.sendAvailableView.properties.checkAvailableAjaxUrl,type:"POST",dataType:"json",cache:!1,success:function(e){if(e.content_buy_block)return t.properties.windowObj.show_load_block(e.content),!1;t.properties.sendAvailableView.properties.success_request()}}),!1},this.send_message=function(){$.ajax({url:t.properties.siteUrl+t.properties.sendMessageUrl+"/"+t.properties.messageId,type:"GET",dataType:"json",cache:!1,success:function(e){if(e.error.length>0)error_object.show_error_block(e.error,"error");else{error_object.show_error_block(e.success,"success"),sendAnalytics("mailbox_send_message","communication","user");var o=t.properties.siteUrl+t.properties.fullWriteUrl;document.location.href===o||document.location.href===o+"/"+t.properties.messageId?locationHref(t.properties.siteUrl+"mailbox/outbox"):(t.properties.messageId=0,$(".load_content_close").click())}},error:function(e){console.error("mailbox error")}})},this.reply_message=function(){$.ajax({url:t.properties.siteUrl+t.properties.replyMessageUrl+"/"+t.properties.replyId,type:"GET",dataType:"json",cache:!1,success:function(e){e.error?error_object.show_error_block(e.error,"error"):(error_object.show_error_block(e.success,"success"),locationHref(t.properties.siteUrl+"mailbox/outbox"))}})},this.delete_attach=function(e){$.ajax({url:t.properties.siteUrl+t.properties.deleteAttachUrl+"/"+e+"/"+t.properties.messageId,type:"GET",dataType:"json",cache:!1,success:function(t){if(t.errors.length>0)error_object.show_error_block(t.errors,"error");else{var o=$("#attaches");$("#delete_upload"+e).remove(),0===o.find("ul").children().length&&o.hide(),$('input[name="attach"]').val(""),error_object.show_error_block(t.success,"success")}}})},this.delete_thread=function(){$.ajax({url:t.properties.siteUrl+t.properties.deleteThreadUrl+"/"+t.properties.messageId,type:"GET",dataType:"json",cache:!1,success:function(e){e.error?error_object.show_error_block(e.error,"error"):(error_object.show_error_block(e.success,"success"),locationHref(t.properties.siteUrl+"mailbox/"+t.properties.folder))}})},this.search_messages=function(e){$.ajax({url:t.properties.siteUrl+t.properties.searchMessagesUrl+"/"+t.properties.folder+"/"+t.properties.page+"/"+encodeURIComponent(e),type:"GET",dataType:"json",cache:!1,success:function(e){t.main_content_obj.html(e.content)}})},this.isJson=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},t.Init(e)})},9171:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.albums=function(e){this.properties={siteUrl:"/",galleryContentDiv:"gallery_content",contentDiv:"#image_content",permissions:{},createAlbumButton:"#create_album_button",createAlbumContainer:"#create_album_container",albumNameInput:"#album_name",saveAlbumButton:"#save_album",saveAlbumUrl:"media/ajax_save_album/",saveAlbumMode:"small/",editAlbumUrl:"media/edit_album",editAlbumUrlReplace:"media/ajax_edit_album",editAlbumForm:"#album_form",noUserAlbums:"#no_user_albums",windowObj:new loadingContent({loadBlockWidth:"500px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0}),create_album_success_request:function(e){if(e.status){if(mediagallery&&(mediagallery.properties.galleryContentPage=1,mediagallery.properties.all_loaded=0,mediagallery.load_content(1),this.windowObj.hide_load_block(),e.data.albums_select&&mediagallery.properties.idUser===e.data.id_user)){var t=$(mediagallery.properties.albumSelector).val();$(mediagallery.properties.albumSelectorContainer).html(e.data.albums_select).val(t).prop("selected","selected")}}else error_object.show_error_block(e.errors,"error")},edit_album_success_request:function(){}};var t=this;this.Init=function(e){return t.properties=$.extend(t.properties,e),t.init_albums(),t.init_item_album_info(),this},this.uninit=function(){$(t.properties.contentDiv).off("click",t.properties.createAlbumButton).off("click",t.properties.saveAlbumButton),$("#"+t.properties.galleryContentDiv).off("click",".edit-album").off("mouseenter",".photo").off("mouseleave",".photo")},this.init_albums=function(){$(t.properties.contentDiv).off("click",t.properties.createAlbumButton).on("click",t.properties.createAlbumButton,(function(){$(t.properties.createAlbumContainer).toggleClass("hide").find('input[type="text"]').focus()})).off("click",t.properties.saveAlbumButton).on("click",t.properties.saveAlbumButton,(function(){t.create_album()}))},this.init_item_album_info=function(){$("#"+t.properties.galleryContentDiv).off("click",".edit-album").on("click",".edit-album",(function(e){e.preventDefault(),href=$(this).attr("href");var o=href.replace(t.properties.editAlbumUrl,t.properties.editAlbumUrlReplace);return t.display_album_form(o),!1})).off("mouseenter",".photo").on("mouseenter",".photo",(function(){$(this).find(".info").stop().slideDown(100)})).off("mouseleave",".photo").on("mouseleave",".photo",(function(){$(this).find(".info").stop(!0).delay(100).slideUp(100)}))},this.create_album=function(){name=$(t.properties.albumNameInput).val(),t.properties.saveAlbumMode="small",$.ajax({url:t.properties.siteUrl+t.properties.saveAlbumUrl+t.properties.saveAlbumMode,type:"POST",dataType:"json",data:{name},cache:!1,success:function(e){if(e.status){var o="";if(t.properties.permissions.option&&(o=t.properties.permissions.option[1]),$("#user_albums").append('<div class="clearfix album album-item" id="user_album_'+e.data.album_id+'"><input type="checkbox"> <span title="'+name+'">'+name+'</span><div class="fright" data-toggle="tooltip" title="'+o+'"><i class="fa fa-lock"></i></div></div> '),$("#user_album_"+e.data.album_id).fadeIn("slow"),$(t.properties.albumNameInput).val(""),$("#user_title_album").removeClass("hide"),$('.albums-list [data-toggle="tooltip"]').tooltip(),$(t.properties.noUserAlbums).addClass("hide"),mediagallery&&e.data.albums_select&&mediagallery.properties.idUser===e.data.id_user){var r=$(mediagallery.properties.albumSelector).val();$(mediagallery.properties.albumSelectorContainer).html(e.data.albums_select).val(r).prop("selected","selected")}}else e.errors.length&&error_object.show_error_block(e.errors,"error");t.properties.create_album_success_request(e)}})},this.display_album_form=function(e){$.ajax({url:e,type:"POST",dataType:"html",cache:!1,success:function(e){t.properties.windowObj.update_css_styles({width:"500px"}),t.properties.windowObj.show_load_block(e)}})},this.edit_album=function(e){t.properties.saveAlbumMode="full/",$.ajax({url:t.properties.siteUrl+t.properties.saveAlbumUrl+t.properties.saveAlbumMode+e,type:"POST",dataType:"json",data:$(t.properties.editAlbumForm).serialize(),cache:!1,success:function(e){e.status?t.properties.edit_album_success_request(e):error_object.show_error_block(e.errors,"error")}})},t.Init(e)})},2050:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.editMedia=function(e){this.properties={gallery_name:"mediagallery",siteUrl:"/",mediaId:"",getMediaContentUrl:"media/ajax_get_media_content/",getMediaSectionUrl:"media/ajax_get_section_content/",section:"view",contentDiv:"#image_content",menuContainer:"#media_menu",recropMenuContainer:"#recrop_menu",sectionsContainer:"#media_sections",mediaPreloaderContainer:"#media_preloader",photoMirrorHorId:"#photo_mirror_hor",saveAudioTitleUrl:"media/ajax_save_audio_title/",saveDescriptionUrl:"media/ajax_save_description/",savePermissionsUrl:"media/ajax_save_permissions/",addMediaInAlbumUrl:"media/ajax_add_media_in_album/",deleteMediaFromAlbumUrl:"media/ajax_delete_media_from_album/",error_in_adding_to_favorites:"error_in_adding_to_favorites",success_add_to_favorites:"success_add_to_favorites",recrop_container_id:"photo_source_recrop_box",recrop_img_id:"photo_source_recrop",photo_sizes_id:"photo_sizes",recrop_btn_id:"recrop_btn",recropUrl:"media/ajax_recrop/",selections:[],userType:"user",rotate_left_id:"photo_rotate_left",rotate_right_id:"photo_rotate_right",rotateUrl:"media/ajax_rotate/",nextMediaButton:"#next_media",previousMediaButton:"#prev_media",nextMedia:null,previousMedia:null,albumId:0,galleryContentParam:"all",mediaPosition:"#media_position",order:"date_add",direction:"desc",post_data:{},current_media_type:"",precache_images:!0,rand_param:null,rand_param_change:!1,saveAfterSelect:!1,success_request:function(e){},fail_request:function(e){},loaded_sections:{comments:!0,access:!0,albums:!1,recrop:!1},errorObj:new Errors,contentObj:new loadingContent({loadBlockWidth:"50%",closeBtnClass:"w",scroll:!0,closeBtnPadding:5,blockBody:!0})},this.imageareaselect=null,this.image_css_size={width:700,height:500},this.selections=[],this.index=0,this.img=new Image;var t=null,r=null,i=null,n=null,s={},a=this;this.Init=function(e){a.properties=$.extend(a.properties,e),a.add_selections(a.properties.selections),a.init_menu(),a.init_content(),a.init_buttons(),a.init_albums()},this.uninit=function(){$(a.properties.contentDiv).off(),$("#"+a.properties.photo_sizes_id).off(),$("#"+a.properties.recrop_container_id).off(),$("#"+a.properties.recrop_img_id).off("load"),a.imageareaselect=null,a.uninit_imageareaselect()},this.init_albums=function(){$(a.properties.contentDiv).off("click","#common_albums .album-item.active:not(.disabled)").on("click","#common_albums .album-item.active",(function(e){e.preventDefault();var t=$(this).attr("id");if(t){var o="#common_album_";t=t.substr(o.length-1),a.delete_photo_from_album(t,o+t)}})).off("click","#common_albums .album-item:not(.active)").on("click","#common_albums .album-item:not(.active):not(.disabled)",(function(e){e.preventDefault();var t=$(this).attr("id");if(t){var o="#common_album_";t=t.substr(o.length-1),a.add_photo_in_album(t,o+t)}})).off("click","#user_albums .album-item.active").on("click","#user_albums .album-item.active",(function(e){e.preventDefault();var t="#user_album_",o=$(this).attr("id").substr(t.length-1);a.delete_photo_from_album(o,t+o)})).off("click","#user_albums .album-item:not(.active)").on("click","#user_albums .album-item:not(.active)",(function(e){e.preventDefault();var t="#user_album_",o=$(this).attr("id").substr(t.length-1);a.add_photo_in_album(o,t+o)})).off("click",".to_favorites.active").on("click",".to_favorites.active",(function(e){e.preventDefault(),a.properties.errorObj.show_error_block(a.properties.error_in_adding_to_favorites,"error")})).off("click",".to_favorites:not(.active)").on("click",".to_favorites:not(.active)",(function(e){e.preventDefault();var t=$(this).data("id");a.add_photo_to_favorites(t,".to_favorites")}))},this.init_buttons=function(){$(a.properties.contentDiv).off("click","#save_permissions").on("click","#save_permissions",(function(){a.save_permissions()})).off("click",a.properties.nextMediaButton).on("click",a.properties.nextMediaButton,(function(){a.display_next_media()})).off("click",a.properties.previousMediaButton).on("click",a.properties.previousMediaButton,(function(){a.display_previous_media()})).off("focus","[contenteditable]").on("focus","[contenteditable]",(function(){$(this).parent().find("i").removeClass("active")})).off("click",".contenteditable i.active").on("click",".contenteditable i.active",(function(){$(this).parent().find("[contenteditable]").focus(),$(this).removeClass("active")})).off("blur","[contenteditable]").on("blur","[contenteditable]",(function(){var e=$(this).parent().find("i"),t=$(this).val().replace(/<br\s*\/?>/gm,"\n");$(this).hasClass("audio_content")?a.save_audio_title(t,e):a.save_description(t,e)})),window.addEventListener("keydown",(function(e){0!==a.properties.nextMedia&&("ArrowRight"!=e.key&&39!=e.keyCode||a.display_next_media()),0!==a.properties.previousMedia&&("ArrowLeft"!=e.key&&37!=e.keyCode||a.display_previous_media())}))},this.init_menu=function(){$(a.properties.contentDiv).off("click",a.properties.menuContainer+" [data-section]").on("click",a.properties.menuContainer+" [data-section]",(function(){var e=$(this).data("section");return $(this).parent().hasClass("active")||(a.properties.section=e,"recrop"===e&&a.selections.length?($(a.properties.contentDiv).find('[data-area="view"]').hide(),$(a.properties.contentDiv).find('[data-area="recrop"]').show(),a.index=1,a.init_imageareaselect(),$("#"+a.properties.rotate_left_id).on("click",(function(){return a.rotate(90),!1})),$("#"+a.properties.rotate_right_id).on("click",(function(){return a.rotate(-90),!1})),$(a.properties.photoMirrorHorId).on("click",(function(){return a.rotate("hor"),!1}))):($(a.properties.contentDiv).find(a.properties.menuContainer).find("li").removeClass("active"),$(this).parent().addClass("active"),$(a.properties.contentDiv).find('[data-area="recrop"]').hide(),$(a.properties.contentDiv).find('[data-area="view"]').show(),a.show_section(e))),!1})),$(a.properties.menuContainer).find('[data-section="'+a.properties.section+'"]').parent().addClass("active"),$(a.properties.contentDiv).off("click",a.properties.recropMenuContainer+" [data-section]").on("click",a.properties.recropMenuContainer+" [data-section]",(function(){"view"===$(this).data("section")&&($(a.properties.contentDiv).find('[data-area="recrop"]').hide(),$(a.properties.contentDiv).find('[data-area="view"]').show())}))},this.show_section=function(e){var t=$.Deferred();!1===a.properties.loaded_sections[e]?a.load_section(e).then(t.resolve(e)):t.resolve(e),t.done((function(e){var t=$.Deferred();$(a.properties.sectionsContainer).find("[data-section]").stop(!0).fadeOut(200,(function(){t.resolve()})).filter('[data-section="'+e+'"]').delay(150).fadeIn(200),t.done((function(){}))}))},this.add_photo_to_favorites=function(e,t){var o=window[a.properties.gallery_name].get_post_data();$.ajax({url:a.properties.siteUrl+a.properties.addMediaInAlbumUrl+a.properties.mediaId+"/"+e,type:"POST",data:o,dataType:"json",cache:!1,success:function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return a.properties.contentObj.show_load_block(e.info.access_denied),!1;e.status?($(t).addClass("active"),$(t).find(".status-icon").removeClass("fa-star-empty").addClass("fa-star").addClass("g"),$(t).find("input[type=checkbox]").prop("checked",!0),a.properties.errorObj.show_error_block(a.properties.success_add_to_favorites,"success")):a.properties.errorObj.show_error_block(e.errors,"error")}})};var c=!1;this.delete_photo_from_favorites=function(e,t){var o=window[a.properties.gallery_name].get_post_data();if(c)return!1;$.ajax({url:a.properties.siteUrl+a.properties.deleteMediaFromAlbumUrl+a.properties.mediaId+"/"+e,type:"POST",data:o,dataType:"json",cache:!1,beforeSend:function(){c=!0},success:function(e){c=!1,e.status?(console.log(t),$(t).removeClass("active"),$(t).find(".status-icon").removeClass("fa-star").addClass("fa-star-empty"),$(t).find("input[type=checkbox]").prop("checked",!1)):a.properties.errorObj.show_error_block(e.errors,"error")},error:function(){c=!0}})};var p=!1;this.add_photo_in_album=function(e,t){var o=window[a.properties.gallery_name].get_post_data();if(p)return!1;$.ajax({url:a.properties.siteUrl+a.properties.addMediaInAlbumUrl+a.properties.mediaId+"/"+e,type:"POST",data:o,dataType:"json",cache:!1,beforeSend:function(){p=!0},success:function(e){if(p=!1,void 0!==e.info.access_denied&&e.info.access_denied.length>0)return a.properties.contentObj.show_load_block(e.info.access_denied),!1;e.status?($(t).addClass("active"),$(t).find(".status-icon").removeClass("fa-check-empty").addClass("fa-check"),$(t).find("input[type=checkbox]").prop("checked",!0)):a.properties.errorObj.show_error_block(e.errors,"error")},error:function(){p=!0}})};var l=!1;this.delete_photo_from_album=function(e,t){var o=window[a.properties.gallery_name].get_post_data();if(l)return!1;$.ajax({url:a.properties.siteUrl+a.properties.deleteMediaFromAlbumUrl+a.properties.mediaId+"/"+e,type:"POST",data:o,dataType:"json",cache:!1,beforeSend:function(){l=!0},success:function(e){l=!1,e.status?($(t).removeClass("active"),$(t).find(".status-icon").removeClass("fa-check").addClass("fa-check-empty"),$(t).find("input[type=checkbox]").prop("checked",!1)):a.properties.errorObj.show_error_block(e.errors,"error")},error:function(){l=!0}})},this.save_description=function(e,o){t&&"pending"===t.state()?t.always(a.save_description(o)):t=$.ajax({url:a.properties.siteUrl+a.properties.saveDescriptionUrl+a.properties.mediaId,type:"POST",dataType:"json",data:{description:e,media_type:a.properties.current_media_type},cache:!1,success:function(e){e.status?(o.addClass("active"),a.properties.success_request(e.message)):a.properties.fail_request(e.errors)}})},this.save_audio_title=function(e,o){t&&"pending"===t.state()?t.always(a.save_description(o)):t=$.ajax({url:a.properties.siteUrl+a.properties.saveDescriptionUrl+a.properties.mediaId,type:"POST",dataType:"json",data:{fname:e,media_type:a.properties.current_media_type},cache:!1,success:function(t){t.status?(o.addClass("active"),$(".audioname_"+t.media.id).text(e),a.properties.success_request(t.message)):a.properties.fail_request(t.errors)}})},this.save_permissions=function(){var e=$("#permissions:checked,select#permissions").val();$.ajax({url:a.properties.siteUrl+a.properties.savePermissionsUrl+a.properties.mediaId,type:"POST",dataType:"json",data:{permissions:e},cache:!1,success:function(e){e.status?a.properties.success_request():a.properties.fail_request(e.errors)}})},this.load_section=function(e){if(r&&"pending"===r.state())return r;var t=window[a.properties.gallery_name].get_post_data();return t.id=a.properties.mediaId,t.album_id=a.properties.albumId,t.section=e,r=$.ajax({url:a.properties.siteUrl+a.properties.getMediaSectionUrl,type:"POST",data:t,dataType:"json",cache:!1,success:function(t){a.properties.loaded_sections[e]=!0,$(a.properties.sectionsContainer).find('[data-section="'+e+'"]').html(t.content)}}),r},this.init_content=function(e){if(i&&"pending"===i.state())return i;a.properties.loaded_sections={comments:!0,access:!0,albums:!1,recrop:!1},e=e||!1;var t=window[a.properties.gallery_name].get_post_data();return t.rand_param=null!==a.properties.rand_param?a.properties.rand_param:0,e&&$(a.properties.contentDiv).stop().animate({opacity:.3},200),i=$.ajax({url:a.properties.siteUrl+a.properties.getMediaContentUrl+a.properties.mediaId+"/"+a.properties.galleryContentParam+"/"+a.properties.albumId,type:"POST",data:t,dataType:"json",cache:!1,success:function(t){var o=$(a.properties.contentDiv).height(),r=$((t.content||"").trim()),i=$.Deferred();e?i=s.animate_load(o,r):($(a.properties.contentDiv).html(t.content).stop(!0).css({opacity:1}),i.resolve()),t.position_info&&($(a.properties.mediaPosition).html(t.position_info.position+" / "+t.position_info.count),a.properties.nextMedia=t.position_info.next,a.properties.previousMedia=t.position_info.previous,a.properties.precache_images)&&(t.position_info.next_image.image&&((new Image).src=t.position_info.next_image.image+"?"+a.properties.rand_param,t.position_info.next_image.thumb&&((new Image).src=t.position_info.next_image.thumb+"?"+a.properties.rand_param)),t.position_info.previous_image.image&&((new Image).src=t.position_info.previous_image.image+"?"+a.properties.rand_param,t.position_info.previous_image.thumb&&((new Image).src=t.position_info.previous_image.thumb+"?"+a.properties.rand_param))),t.media_type&&(a.properties.current_media_type=t.media_type),t.views_num&&$('span[data-gid^="media'+a.properties.mediaId+'"] .view_num').html(t.views_num),i.always((function(){0==a.properties.nextMedia&&$(a.properties.nextMediaButton).hide(),0==a.properties.previousMedia&&$(a.properties.previousMediaButton).hide()})),"admin"==a.properties.userType&&$('[data-section="recrop"]').trigger("click")}})},s.animate_load=function(e,t){var r,i=$.Deferred(),n=t.find("[data-image-src]").data("image-src");if(n){var s=new Image;s.src=n,s.height?(r=$(a.properties.contentDiv).css({visibility:"hidden"}).html(t).height(),$(a.properties.contentDiv).css({height:e+"px"}),i.resolve(r)):($(a.properties.contentDiv).html(t).stop(!0).css({opacity:1}),i.resolve())}else $(a.properties.contentDiv).html(t).stop(!0).css({opacity:1}),i.reject();return i.done((function(e){$(a.properties.contentDiv).css({visibility:"visible"}).stop(!0).animate({height:e+"px",opacity:1},200,(function(){$(this).css("height","auto")})),"object"===o(window[a.properties.gallery_name])&&$("#"+window[a.properties.gallery_name].properties.windowObj.properties.loadBlockBgID).animate({scrollTop:0},100)})),i},this.display_next_media=function(){a.properties.mediaId=a.properties.nextMedia,!1===a.properties.rand_param_change?a.init_content(!0):(a.init_content(!1),a.properties.rand_param_change=!1)},this.display_previous_media=function(){a.properties.mediaId=a.properties.previousMedia,!1===a.properties.rand_param_change?a.init_content(!0):(a.init_content(!1),a.properties.rand_param_change=!1)},this.add_selection=function(e,t,o,r,i){return a.selections.push({prefix:e,x1:t,y1:o,width:r,height:i,orig_width:r,orig_height:i}),this},this.add_selections=function(e){for(var t in e)e.hasOwnProperty(t)&&a.add_selection(t,0,0,parseInt(e[t].width),parseInt(e[t].height))},this.recalc_selection=function(){var e=a.img.height/a.image_css_size.height,t=a.img.width/a.image_css_size.width;for(var o in a.selections)if(a.selections.hasOwnProperty(o))if(a.img.width<a.selections[o].width||a.img.height<a.selections[o].height){var r;a.img.width<a.selections[o].width&&(r=a.img.width/a.selections[o].width,a.selections[o].width*=r,a.selections[o].height*=r),a.img.height<a.selections[o].height&&(r=a.img.height/a.selections[o].height,a.selections[o].width*=r,a.selections[o].height*=r)}else{var i=a.selections[o].width*t,n=a.selections[o].height*e;i>=a.selections[o].width&&i<a.img.width&&n>=a.selections[o].height&&n<a.img.height&&(a.selections[o].width=i,a.selections[o].height=n);var s=Math.round(a.img.width/2-a.selections[o].width/2);s<0&&(s=0);var c=Math.round(a.img.height/2-a.selections[o].height/2);c<0&&(c=0),a.selections[o].x1=s,a.selections[o].y1=c}return this},this.change_selection=function(){var e=a.selections[a.index];return a.imageareaselect.setOptions({aspectRatio:e.width+":"+e.height,minWidth:e.width,minHeight:e.height,x1:e.x1,y1:e.y1,x2:e.x1+e.width,y2:e.y1+e.height}),a.imageareaselect.update(!1),this},this.init_imageareaselect=function(){if(s.img_obj=$("#"+a.properties.recrop_img_id),s.photo_sizes_obj=$("#"+a.properties.photo_sizes_id),s.recrop_btn_obj=$("#"+a.properties.recrop_btn_id),s.photo_sizes_obj.html(""),s.photo_sizes_obj.find("li").removeClass("active").eq(a.index).addClass("active"),s.photo_sizes_obj.off("click","li span").on("click","li span",(function(){var e=$(this).data("index");return e>=a.selections.length||e==a.index||(a.index=e,a.change_selection(),s.photo_sizes_obj.find("li").removeClass("active"),$(this).parent().addClass("active")),!1})),$("#"+a.properties.recrop_container_id).off("recrop:do").on("recrop:do",(function(){a.recrop()})),!$.isEmptyObject(a.selections)){a.img.src=s.img_obj.attr("src");var e=$(a.properties.contentDiv+" #"+a.properties.recrop_container_id+" img"),t=$(a.properties.contentDiv+" .inner-image img"),o=e.attr("src"),r=t.attr("src");return e.attr("src",o+"?"+(new Date).getTime()),t.attr("src",r+"?"+(new Date).getTime()),a.img.onload=function(){a.img.width?s.image_ready():s.img_obj.off("load").on("load",(function(){s.image_ready()}))},this}},s.image_ready=function(e){for(e=e||0;(!s.img_obj.width()||!s.img_obj.height())&&e<60;)return setTimeout((function(){s.image_ready(++e)}),50),this;return a.image_css_size={width:s.img_obj.width(),height:s.img_obj.height()},a.selections=[],a.add_selections(a.properties.selections),a.recalc_selection(),a.imageareaselect=s.img_obj.imgAreaSelect({handles:!0,persistent:!0,aspectRatio:a.selections[a.index].width+":"+a.selections[a.index].height,minWidth:a.selections[a.index].width,minHeight:a.selections[a.index].height,imageWidth:a.img.width,imageHeight:a.img.height,instance:!0,parent:"#"+a.properties.recrop_container_id,x1:a.selections[a.index].x1,y1:a.selections[a.index].y1,x2:a.selections[a.index].x1+a.selections[a.index].width,y2:a.selections[a.index].y1+a.selections[a.index].height,zIndex:2,onSelectStart:function(e,t){s.hide_recrop_btn(this)},onSelectEnd:function(e,t){t.width&&t.height&&(a.properties.saveAfterSelect?a.recrop():s.show_recrop_btn(this),a.selections[a.index].x1=Math.min(t.x1,t.x2),a.selections[a.index].y1=Math.min(t.y1,t.y2),a.selections[a.index].width=t.width,a.selections[a.index].height=t.height)},onSelectChange:function(e,t){t.width&&t.height&&(s.hide_recrop_btn(this),a.selections[a.index].x1=Math.min(t.x1,t.x2),a.selections[a.index].y1=Math.min(t.y1,t.y2),a.selections[a.index].width=t.width,a.selections[a.index].height=t.height)},onInit:function(e,t){s.show_recrop_btn(this)}}),this},s.show_recrop_btn=function(e){var t=$(e.parent).find("."+e.classPrefix+"-selection"),o=$('<div class="selection-recrop-btn" onmouseup="$(\'#'+a.properties.recrop_container_id+"').trigger('recrop:do');\"></div>");t.html(o)},s.hide_recrop_btn=function(e){$(e.parent).find("."+e.classPrefix+"-selection").html("")},this.recrop=function(){return n&&"pending"===n.state()?n:n=$.ajax({url:a.properties.siteUrl+a.properties.recropUrl+a.properties.mediaId,type:"POST",data:a.selections[a.index],dataType:"json",cache:!1,success:function(e){if(e.status){if(e.data.img_url)for(var t in e.data.img_url)$('img[src^="'+e.data.img_url[t]+'"]').attr("src",e.data.img_url[t]+"?"+(new Date).getTime())}else e.errors.length&&a.properties.errorObj.show_error_block(e.errors,"error");e.msg.length&&a.properties.errorObj.show_error_block(e.msg,"success")}})},this.uninit_imageareaselect=function(){return a.imageareaselect=null,a.selections=[],a.index=0,this},this.rotate=function(e){return n&&"pending"===n.state()?n:n=$.ajax({url:a.properties.siteUrl+a.properties.rotateUrl+a.properties.mediaId+"/"+e,type:"POST",data:{},dataType:"json",cache:!1,success:function(e){if(e.status){if(e.data.img_url){for(var t in $('a[href^="'+e.data.img_url+'"]').attr("href",e.data.img_url+"?"+(new Date).getTime()),$('img[data-image-src^="'+e.data.img_url+'"]').attr("src",e.data.img_url+"?"+(new Date).getTime()),e.data.thumbs)$('img[src^="'+e.data.thumbs[t]+'"]').attr("src",e.data.thumbs[t]+"?"+(new Date).getTime());$(a.properties.contentDiv).find('[data-area="recrop"]').hide(),$(a.properties.contentDiv).find('[data-area="view"]').show(),$('[data-section="recrop"]').click(),setTimeout((function(){$('[data-section="recrop"]').click()}),1e3)}a.properties.rand_param=Math.floor(999999*Math.random()+1),a.properties.rand_param_change=!0}else e.errors.length&&a.properties.errorObj.show_error_block(e.errors,"error");e.msg.length&&setTimeout((function(){a.properties.errorObj.show_error_block(e.msg,"success")}),1e3)}})},a.Init(e)})},8218:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.gallery=function(e){this.properties={singleton:1,site_url:"",get_list_url:"media/ajax_get_gallery_list/",id:"gallery",id_filters:"gallery_filters",id_albums:"gallery_albums",id_albums_select:"album_id",id_sorter:"gallery_media_sorter",column_width:95,row_height:305,columns_per_line:9,lines_per_req:6,margins:5,button_title:"More...",onInit:function(){},load_on_scroll:!1,id_album:0,album_page:1,param:"all",random_float:!1,post_data:{filter_duplicate:1},line_data:[],errorObj:new Errors,blocks:{block8:{columns:2,rnd_weight:3,images:["big"]}},windowObj:new loadingContent({loadBlockWidth:"500px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0}),scrollPage:{},page:{count:1,previous:0,current:1,next:2}};var t={blocks_count:0,all_loaded:!1,loading_status:!1,img_n:0,loaded_count:0,load_lines_xhr:null,load_albums_xhr:null},o=this;$.extend(o.properties,e),this.init=function(){for(var e in t.blocks_count=0,t.all_loaded=!1,o.properties.blocks)o.properties.blocks.hasOwnProperty(e)&&t.blocks_count++;return $("#"+o.properties.id).html(""),o.clear_gallery(),o.init_objects(),o.init_filters(),o.init_sorter(),o.properties.load_on_scroll&&setTimeout((function(){o.setLoadOnScroll(1,1)}),500),o.properties.onInit(),this},this.uninit=function(){t.all_loaded=!1,t.loading_status=!1,t.img_n=0,t.loaded_count=0,t.load_lines_xhr=null,$(window).unbind("scroll.gallery"),$("#"+o.properties.id).off("click",'.button-cont input[type="button"]').off("mouseenter",".block-item").off("mouseleave",".block-item").off("click",".block-item img, .zoom-icon"),o.albums_obj.off("change","#"+o.properties.id_albums_select),o.sorter_obj.off()},this.init_objects=function(){o.filters_obj=$("#"+o.properties.id_filters),o.albums_obj=$("#"+o.properties.id_albums),o.albums_select_obj=$("#"+o.properties.id_albums_select),o.sorter_obj=$("#"+o.properties.id_sorter),o.properties.columns_per_line,o.properties.column_width,o.properties.margins,$("#"+o.properties.id).append('<div class="wrapper"></div>').append('<div class="mt20 button-cont hide"><input class="btn btn-cancel form-control" type="button" value="'+o.properties.button_title+'" /></div>').off("click",'.button-cont input[type="button"]').on("click",'.button-cont input[type="button"]',(function(){o.load()})).off("mouseenter",".block-item").on("mouseenter",".block-item",(function(){$(this).find(".block-item-info").slideDown(100)})).off("mouseleave",".block-item").on("mouseleave",".block-item",(function(){$(this).find(".block-item-info").stop(!0).delay(100).slideUp(100)})).on("mouseenter",".block-item",(function(){$(this).find(".block-item-top-info").slideDown(100)})).on("mouseleave",".block-item",(function(){$(this).find(".block-item-top-info").stop(!0).delay(100).slideUp(100)})).off("click",".block-item img, .zoom-icon").on("click",".block-item img, .zoom-icon",(function(){var e="IMG"===$(this).get(0).tagName?$(this):$(this).parents(".block-item").find("img"),t=$(e).attr("src");t=t.replace("gal_big_thumb_","").replace("big_thumb_","").replace("thumb_","")}))},this.init_filters=function(){o.albums_obj.off("change","#"+o.properties.id_albums_select).on("change","#"+o.properties.id_albums_select,(function(){o.properties.id_album=$(this).val(),o.properties.id_album>0?o.sorter_obj.stop(!0).fadeIn():o.sorter_obj.hide(),o.reload()}))},this.init_sorter=function(){return o.sorter_obj.off("change","select").on("change","select",(function(){o.reload()})),o.sorter_obj.off("click",'[data-role="sorter-dir"]').on("click",'[data-role="sorter-dir"]',(function(){$(this).hasClass("fa-arrow-up")?$(this).removeClass("fa-arrow-up").addClass("fa-arrow-down"):$(this).removeClass("fa-arrow-down").addClass("fa-arrow-up"),o.reload()})),this},this.clear_gallery=function(){return o.properties.album_page=1,t.all_loaded=!1,t.loading_status=!1,t.loaded_count=0,t.load_lines_xhr&&t.load_lines_xhr.abort(),t.load_albums_xhr&&t.load_albums_xhr.abort(),this},this.reload=function(){return o.clear_gallery(),o.load({},!0,!0),this},this.get_post_data=function(){var e=$.extend(o.properties.post_data,{order:"date_add",direction:"desc"});return e.order=o.sorter_obj.find("select").val(),e.direction=o.sorter_obj.find('[data-role="sorter-dir"]').hasClass("fa-arrow-up")?"asc":"desc",e},this.setLoadOnScroll=function(e,t){return t=t||0,!e||o.properties.load_on_scroll&&!t?(o.properties.load_on_scroll=!1,$(window).unbind("scroll.gallery")):(o.properties.load_on_scroll=!0,$(window).scrollTop(0),$(window).on("scroll.gallery",(function(){var e=$("#"+o.properties.id).find(".button-cont").offset(),t=window.innerHeight?window.innerHeight:$(window).height();e&&$(window).scrollTop()>=e.top-t+100&&o.load()}))),this},this.load=function(e,t,r){return e=e||{},t=t||!1,r=r||!1,e=$.extend(e,o.get_post_data()),o.properties.param=o.filters_obj.find(".active").attr("data-param"),$(window).trigger("changeParam.gallery",o.properties.param),"albums"===o.properties.param&&0==o.properties.id_album?o.loadAlbums(e,t,r):o.loadLines(e,t,r),this},this.loadAlbums=function(e,r,i){return e=e||{},i=i||!1,(r=r||!1)&&(t.load_albums_xhr&&t.load_albums_xhr.abort(),t.loading_status=!1),t.all_loaded||t.loading_status||(t.loading_status=!0,i&&$("#"+o.properties.id).animate({opacity:.2},200),e=$.extend({page:o.properties.album_page},e),t.load_albums_xhr=$.ajax({type:"POST",url:site_url+o.properties.get_list_url+o.properties.param+"/"+o.properties.id_album,data:e,success:function(e){e.errors?o.properties.errorObj.show_error_block(e.errors,"error"):(i&&($("#"+o.properties.id).find(".wrapper").html(""),$("#"+o.properties.id).find(".button-cont").hide()),o.properties.album_page++,t.all_loaded=!e.gallery.have_more,o.albums_select_obj.val(o.properties.id_album).prop("selected","selected"),$("#"+o.properties.id).find(".wrapper").append(e.gallery.content),t.all_loaded&&(o.properties.load_on_scroll=!1))},error:function(e,t,o){"undefined"!=typeof console&&console.log(o)},complete:function(){t.loading_status=!1,t.all_loaded?$("#"+o.properties.id).find(".button-cont").hide():$("#"+o.properties.id).find(".button-cont").show(),$("#"+o.properties.id).stop(!0).animate({opacity:1},50)},dataType:"json",backend:0})),this},this.loadLines=function(e,r,i){if(e=e||{},i=i||!1,(r=r||!1)&&(t.load_lines_xhr&&t.load_lines_xhr.abort(),t.loading_status=!1),t.all_loaded||t.loading_status)return this;t.loading_status=!0;var n,s,a="",c=[];t.img_n=0,o.properties.line_data=[];for(var p=0;p<o.properties.lines_per_req;p++){a+=(s=o.generateLine(1,0)).data;for(var l=0;l<s.images.length;l++)c.push(s.images[l])}n=$("<div>"+a+"</div>"),i&&$("#"+o.properties.id).animate({opacity:.2},200);var d=$.extend({icons:c,loaded_count:t.loaded_count,line_data:o.properties.line_data,current_page:o.properties.page.current},e);return t.load_lines_xhr=$.ajax({type:"POST",url:site_url+o.properties.get_list_url+o.properties.param+"/"+o.properties.id_album,data:d,success:function(e){if(e.errors)o.properties.errorObj.show_error_block(e.errors,"error"),t.all_loaded=!0,t.loading_status=!0;else if(i&&($("#"+o.properties.id).find(".wrapper").html(""),$("#"+o.properties.id).find(".button-cont").hide()),t.all_loaded=!e.gallery.have_more,e.gallery.media_count&&e.gallery.media){if(t.loaded_count+=e.gallery.media_count,t.all_loaded){for(var r=e.gallery.media_count;r<e.gallery.requested_count;r++)$(n).find('img[data-num="'+r+'"]').parent(".block-item").remove();$(n).find(".block:empty").remove(),$(n).find(".gallery-line:empty").remove(),$(n).find(".gallery-line:last").find(".block").addClass("fleft")}$("#"+o.properties.id).find(".wrapper").append(e.content),$(".block-item").css("margin",o.properties.margins+"px"),void 0!==$('[data-page="'+o.properties.page.current+'"]').offset()&&(o.properties.scrollPage[o.properties.page.current]=$('[data-page="'+o.properties.page.current+'"]').offset().top),$("html, body").animate({scrollTop:o.properties.scrollPage[o.properties.page.current]-150},"slow"),o.properties.page.current=o.properties.page.current+1}else e.gallery.msg&&$("#"+o.properties.id).find(".wrapper").append("<div>"+e.gallery.msg+"</div>")},error:function(e,t,o){"undefined"!=typeof console&&console.log(o)},complete:function(){t.loading_status=!1,t.all_loaded?$("#"+o.properties.id).find(".button-cont").hide():$("#"+o.properties.id).find(".button-cont").show(),$("#"+o.properties.id).stop(!0).animate({opacity:1},50)},dataType:"json",backend:0}),this},this.generateLine=function(e,t){e=e||0,t=t||0;for(var r=o.properties.columns_per_line,i=[],n=[];r>0;){var s=[],a=[];for(var c in o.properties.blocks)if(o.properties.blocks.hasOwnProperty(c)&&o.properties.blocks[c].columns<=r){a.push(o.properties.blocks[c]);for(var p=0;p<o.properties.blocks[c].rnd_weight;p++)s.push(a.length-1)}if(s.length){var l=Math.floor(Math.random()*s.length);for(i.push(a[s[l]]),c=0;c<a[s[l]].images.length;c++)n.push(a[s[l]].images[c]);r-=a[s[l]].columns}else r=0}return e?{data:o.getLineHtml(i,t),images:n}:{data:i,images:n}},this.getLineHtml=function(e,r){var i,n;r=r||0;for(var s="",a=0;a<e.length;a++){n="",i=e[a].columns*o.properties.column_width+e[a].columns*o.properties.margins*2;for(var c=0;c<e[a].images.length;c++)n+='<div class="block-item fleft '+e[a].images[c]+'" style="margin: '+o.properties.margins+'px"><img data-num="'+t.img_n+'" class="'+e[a].images[c]+'" /><div class="block-item-info info"></div><div class="block-item-top-info info"></div></div>',t.img_n++;o.properties.random_float?s+='<div class="block" style="width: '+i+"px; float: "+(Math.random()>.5?"left":"right")+';">'+n+"</div>":s+='<div class="block fleft" style="width: '+i+'px;">'+n+"</div>",o.properties.line_data.push({count:e[a].images.length,width:i})}o.properties.line_data.push({end_block:1});var p='<div class="gallery-line oh">'+s+"</div>";return r?$(p):p}})},2011:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.media=function(e){this.properties={gallery_name:"mediagallery",siteUrl:"/",idUser:0,is_guest:!1,addPhotoID:"add_photo",btnOk:"Ok",btnCancel:"Cancel",addPhotoUrl:"media/ajax_add_images",deleteMediaUrl:"media/delete_",deleteMediaUrlReplace:"media/ajax_delete_",viewMediaUrl:"media/ajax_view_media",galleryContentDiv:"gallery_content",galleryContentUrl:"media/ajax_get_list",recentMediaUrl:"media/ajax_get_recent_media",galleryContentParam:"all",galleryContentPage:1,galleryPageContent:".media-button-content",galleryPageButton:"#media_button",filterObj:"#filters",menuAlbumItem:"albums",albumSelectorContainer:"#album_id_container",albumSelector:"#album_id",albumId:0,addVideoID:"add_video",addVideoUrl:"media/ajax_add_video",uploadVideoForm:"#upload_video",addAudioID:"add_audio",addAudioUrl:"media/ajax_add_audio",uploadVAudioForm:"#upload_audio",sorterId:"media_sorter",refreshRecentPhotosButton:"#refresh_recent_photos",refreshRecentPhotosDiv:"#recent_photo",load_on_scroll:0,all_loaded:0,loading_status:0,lang_delete_confirm:"Are you sure you want to delete this file?",lang_delete_confirm_album:"Do you really want to delete the album?",order:"date_add",direction:"desc",recentPhotos:16,post_data:{},place:"user_gallery",windowObj:null,errorObj:new Errors};var t=null,o={},r=this;this.Init=function(e){r.properties=$.extend(r.properties,e),r.properties.windowObj||(r.properties.windowObj=new loadingContent({loadBlockWidth:"500px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1})),r.init_links(),r.properties.idUser>0&&r.init_filters(),r.init_sorter(),r.init_global_events(),r.properties.load_on_scroll&&setTimeout((function(){r.setLoadOnScroll()}),500),r.init_item_block_info()},this.uninit=function(){$(window).unbind("scroll.media").off("changeParam.gallery"),$("#"+r.properties.galleryContentDiv).off(),$("[data-media="+r.properties.addPhotoID+"]").unbind(),$("[data-media="+r.properties.addVideoID+"]").unbind(),$("[data-media="+r.properties.addAudioID+"]").unbind(),$(r.properties.galleryPageButton).unbind(),$(r.properties.filterObj).find("li").unbind(),$(r.properties.albumSelectorContainer).off(),$("#"+r.properties.sorterId).off()},this.init_item_block_info=function(){$("#"+r.properties.galleryContentDiv).off("click",'[data-click="album"]').on("click",'[data-click="album"]',(function(e){e.preventDefault();var t=$(this).parents("[data-album-id]").attr("data-album-id");return r.properties.idUser=$(this).data("user-id")||r.properties.idUser,t&&(r.properties.albumId=t,r.load_content(!0),$(r.properties.albumSelector).val(t).prop("selected","selected").change()),!1})).off("click",'[data-click="view-media"]').on("click",'[data-click="view-media"]',(function(e){e.preventDefault(),r.properties.idUser=$(this).data("user-id")||r.properties.idUser,$(this).data("id-album")&&(r.properties.albumId=$(this).data("id-album")),$(this).data("place")&&(r.properties.place=$(this).data("place"));var t=$(this).data("id-media");return r.display_edit_view_form(t),!1})).off("click",".delete-media").on("click",".delete-media",(function(e){e.preventDefault(),e.stopPropagation();var t=$(this).attr("href"),o=$(this).attr("data-album-id");if(r.properties.idUser=$(this).data("user-id")||r.properties.idUser,o)i=r.properties.lang_delete_confirm_album;else var i=r.properties.lang_delete_confirm;var n=t.replace(r.properties.deleteMediaUrl,r.properties.deleteMediaUrlReplace),s=new loadingContent({loadBlockWidth:"50%",closeBtnClass:"w",scroll:!0,otherClass:"alert_load",closeBtnPadding:5,blockBody:!0}).show_load_block('<div class="center"><div class="alert_text">'+i+'</div><button data-href="'+n+'" class="alert_ok alert_ok_delete btn btn-primary mt20 mlr20">'+r.properties.btnOk+'</button> <button class="alert_cancel alert_cancel_delete btn btn-cancel mt20 mlr20">'+r.properties.btnCancel+"</button></div>");$(".alert_ok.alert_ok_delete").unbind("click").on("click",(function(){var e=$(this).data("href");r.delete_media(e),$(".load_content_close").click(),$("#"+s).parent().hide()})),$(".alert_cancel.alert_cancel_delete").unbind("click").on("click",(function(){$(".load_content_close").click(),$("#"+s).parent().hide()}))})).off("mouseenter",".photo").on("mouseenter",".photo",(function(){$(this).find(".info").stop().slideDown(100)})).off("mouseleave",".photo").on("mouseleave",".photo",(function(){$(this).find(".info").stop(!0).delay(100).slideUp(100)})),$("#remove_wide").off("click").on("click",(function(e){e.preventDefault();var t=$(this).attr("href");if($(this).attr("data-album-id"))o=r.properties.lang_delete_confirm_album;else var o=r.properties.lang_delete_confirm;var i=t.replace(r.properties.deleteMediaUrl,r.properties.deleteMediaUrlReplace);return alerts.show({text:o,type:"confirm",ok_callback:function(){r.delete_media(i)}}),!1}))},this.init_links=function(){$("[data-media="+r.properties.addPhotoID+"]").unbind("click").on("click",(function(){r.display_upload_photos_form()})),$("[data-media="+r.properties.addVideoID+"]").unbind("click").on("click",(function(){r.display_upload_video_form()})),$("[data-media="+r.properties.addAudioID+"]").unbind("click").on("click",(function(){r.display_upload_audio_form()})),$(r.properties.galleryPageButton).unbind("click").on("click",(function(){r.next_page()})),$(r.properties.refreshRecentPhotosButton).unbind("click").on("click",(function(){r.refresh_recent_photos()}))},this.init_filters=function(){$(r.properties.filterObj).find("li").each((function(){$(this).attr("data-param"),$(this).unbind("click").on("click",(function(){$(r.properties.filterObj).find("li").removeClass("active"),$(this).addClass("active");var e=$(this).attr("data-param");e==r.properties.menuAlbumItem?($(r.properties.albumSelectorContainer).stop(!0).fadeIn(),$("#"+r.properties.sorterId).hide()):($(r.properties.albumSelectorContainer).hide(),$("#"+r.properties.sorterId).stop(!0).fadeIn()),r.properties.galleryContentParam=e,r.properties.albumId=0,r.reload()}))})),$(r.properties.albumSelectorContainer).off("change",r.properties.albumSelector).on("change",r.properties.albumSelector,(function(){r.properties.albumId=$(this).val(),r.properties.albumId>0?$("#"+r.properties.sorterId).stop(!0).fadeIn():$("#"+r.properties.sorterId).hide(),r.reload()}))},this.init_sorter=function(){$("#"+r.properties.sorterId).off("change","select").on("change","select",(function(){r.load_content(1,!0)})),$("#"+r.properties.sorterId).off("click",'[data-role="sorter-dir"]').on("click",'[data-role="sorter-dir"]',(function(){$(this).hasClass("fa-arrow-up")?$(this).removeClass("fa-arrow-up").addClass("fa-arrow-down"):$(this).removeClass("fa-arrow-down").addClass("fa-arrow-up"),r.load_content(1,!0)}))},this.init_global_events=function(){$(window).off("changeParam.gallery").on("changeParam.gallery",(function(e,t){r.properties.galleryContentParam=t}))},this.get_post_data=function(){var e=$.extend(r.properties.post_data,{order:r.properties.order,direction:r.properties.direction,gallery_name:r.properties.gallery_name,place:r.properties.place});return $("#"+r.properties.sorterId).length&&(e.order=$("#"+r.properties.sorterId).find("select").val(),e.direction=$("#"+r.properties.sorterId).find('[data-role="sorter-dir"]').hasClass("fa-arrow-up")?"asc":"desc"),e},this.next_page=function(){r.properties.galleryContentPage++,r.load_content()},this.isJson=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},this.display_edit_view_form=function(e){var t=r.get_post_data();$.ajax({url:r.properties.siteUrl+r.properties.viewMediaUrl+"/"+e+"/"+r.properties.idUser+"/"+r.properties.galleryContentParam+"/"+r.properties.albumId,type:"POST",data:t,dataType:"JSON",cache:!1,success:function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return r.properties.errorObj.show_error_block(e.info.access_denied,"info"),!1;r.properties.windowObj.changeTemplate("gallery"),r.properties.windowObj.update_css_styles({width:"962px"}),r.properties.windowObj.show_load_block(e.content)}})},this.delete_media=function(e){var t=r.get_post_data();$.ajax({url:e,type:"POST",data:t,dataType:"json",cache:!1,success:function(e){1==e.status?(r.reload(),error_object.show_error_block(e.message,"success"),e.data&&e.data.albums_select&&$(r.properties.albumSelectorContainer).html(e.data.albums_select)):e.message&&error_object.show_error_block(e.message,"error")}})},this.reload=function(){r.properties.galleryContentPage=1,r.properties.all_loaded=0,r.load_content(1)},this.display_upload_photos_form=function(){o.display_upload_form("image")},this.display_upload_video_form=function(){o.display_upload_form("video")},this.display_upload_audio_form=function(){o.display_upload_form("audio")},o.display_upload_form=function(e){if(r.properties.is_guest)error_object.errors_access();else{var t,o=r.get_post_data();switch(o.id_album=r.properties.albumId,e){case"image":t=r.properties.addPhotoUrl;break;case"video":t=r.properties.addVideoUrl;break;case"audio":t=r.properties.addAudioUrl}$.ajax({url:r.properties.siteUrl+t,type:"POST",data:o,dataType:"html",cache:!1,success:function(e){r.properties.windowObj.changeTemplate("default"),r.properties.windowObj.update_css_styles({width:"500px"}),r.properties.windowObj.show_load_block(e)}})}},this.load_content=function(e,o){if(o=o||!1)t&&t.abort(),r.properties.galleryContentPage=1;else if(1==r.properties.all_loaded||r.properties.loading_status)return!0;r.properties.loading_status=1;var i=r.get_post_data();t=$.ajax({url:r.properties.siteUrl+r.properties.galleryContentUrl+"/"+r.properties.idUser+"/"+r.properties.galleryContentParam+"/"+r.properties.galleryContentPage+"/"+r.properties.albumId,type:"POST",data:i,dataType:"json",cache:!1,success:function(t){$(r.properties.albumSelector).val(r.properties.albumId).prop("selected","selected"),e?$("#"+r.properties.galleryContentDiv).html(t.content):$("#"+r.properties.galleryContentDiv).append(t.content),t.albums_select&&$(r.properties.albumSelectorContainer).html(t.albums_select),t.have_more?$(r.properties.galleryPageContent).show():(r.properties.load_on_scroll=0,r.properties.all_loaded=1,$(r.properties.galleryPageContent).hide())},complete:function(){r.properties.loading_status=0}})},this.set_properties=function(e){r.properties=$.extend(r.properties,e)},this.setLoadOnScroll=function(){r.properties.load_on_scroll?($(window).scrollTop(0),$(window).on("scroll.media",(function(){var e=$(r.properties.galleryPageContent).offset(),t=window.innerHeight?window.innerHeight:$(window).height();e&&$(window).scrollTop()>=e.top-t+100&&r.next_page()}))):$(window).unbind("scroll.media")},this.refresh_recent_photos=function(){$.ajax({url:r.properties.siteUrl+r.properties.recentMediaUrl,type:"POST",data:{count:r.properties.recentPhotos,upload_gid:"photo",id_user:r.properties.idUser,template:r.properties.recentTemplate},dataType:"JSON",cache:!1,success:function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return r.properties.windowObj.show_load_block(e.info.access_denied),!1;e.errors?r.properties.errorObj.show_error_block(e.errors,"error"):$(r.properties.refreshRecentPhotosDiv).html(e.html)}})},r.Init(e)})},3616:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.mainMenu=function(e){this.properties={siteUrl:"",slidemenu:"#slidemenu",slidemenuId:"#slidemenu-outer",closeBtnId:"#slidemenu-close",pjaxcontainer:"#pjaxcontainer",buttonDropdownMenu:"button.dropdown-toggle",dropdownMenu:".dropdown-menu",dataSlidemenu:'[data-slidemenu="#slidemenu"]'};var t=this;return this.Init=function(e){t.properties=$.extend(t.properties,e),"open"===lightGetCookie("statusMainMenu")&&($(t.properties.slidemenu).show(),$(t.properties.slidemenuId).show()),$(document).off("click",t.properties.pjaxcontainer).on("click",t.properties.pjaxcontainer,(function(e){0===$(e.target).closest(t.properties.slidemenu).length&&0===$(e.target).closest(t.properties.slidemenuId).length&&0===$(e.target).closest(t.properties.dataSlidemenu).length&&t.hideMainMenu()})).off("click",t.properties.buttonDropdownMenu).on("click",t.properties.buttonDropdownMenu,(function(){t.dropdownPosition($(this))})).off("click",t.properties.dataSlidemenu).on("click",t.properties.dataSlidemenu,(function(){t.showMainMenu()})).off("click",t.properties.closeBtnId).on("click",t.properties.closeBtnId,(function(){t.hideMainMenu()}))},this.uninit=function(){return $(document).off("click",t.properties.buttonDropdownMenu).off("click",t.properties.dataSlidemenu).off("click",t.properties.closeBtnId),this},this.showMainMenu=function(){return $(t.properties.slidemenu).show(),$(t.properties.slidemenuId).show(),t.delMenuCookie(),this},this.hideMainMenu=function(){return $(t.properties.slidemenuId).hide(),t.delMenuCookie(),this},this.dropdownPosition=function(e){var o=parseInt($(window).height()-($(e).offset().top-$(window).scrollTop())),r=parseInt($(e).siblings(t.properties.dropdownMenu).height());if(o<r){var i=r+50;$(e).siblings(t.properties.dropdownMenu).css("margin-top","-"+i+"px")}else $(e).siblings(t.properties.dropdownMenu).css("margin-top","2px");return this},this.delMenuCookie=function(){var e=new Date;e.setTime(e.getTime()-1),document.cookie="statusMainMenu=;expires="+e.toGMTString()},t.Init(e),t})},7469:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.menuBookmark=function(e){this.properties={bmID:"bookmark",bmElement:"li",bmActiveClass:"active",bmExeptClass:"no-tab",tCounter:0,tWidth:0,padding:5,float:"right"};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.tWidth||(t.properties.tWidth=parseInt($("#"+t.properties.bmID).width()));var o=0;for(maxWidth=0,temp=0,$("#"+t.properties.bmID+" "+t.properties.bmElement).each((function(){var e=$(this);e.css({"min-width":0}),e.hasClass(t.properties.bmExeptClass)||(t.properties.tCounter++,temp=parseInt(e.outerWidth(!0)),(0==maxWidth||maxWidth<temp)&&(maxWidth=temp),o+=temp)})),iter=0;o>t.properties.tWidth&&iter<100;){o=maxWidth;var r="";$("#"+t.properties.bmID+" "+t.properties.bmElement).each((function(){$(this).hasClass(t.properties.bmExeptClass)||($(this).attr("initial")||$(this).attr("initial",$(this).text()),(r=$(this).find("a").text()).length>4&&(r=r.slice(0,-4)+"..."),$(this).attr("changed",r),$(this).find("a").text(r),$(this).hasClass(t.properties.bmActiveClass)||(o+=parseInt($(this).outerWidth(!0))))})),iter++}if(iter>0){var i=$("#"+t.properties.bmID+" "+t.properties.bmElement+"."+t.properties.bmActiveClass);i.find("a").text(i.attr("initial")),$("#"+t.properties.bmID+" "+t.properties.bmElement).on("click",(function(){$(this).hasClass(t.properties.bmExeptClass)||t.active_item($(this))})),$("#"+t.properties.bmID+" "+t.properties.bmElement).on("mouseenter",(function(){$(this).hasClass(t.properties.bmExeptClass)||t.active_item($(this))}))}},this.active_item=function(e){e.hasClass(t.properties.bmExeptClass)||($("#"+t.properties.bmID+" "+t.properties.bmElement).each((function(){$(this).hasClass(t.properties.bmExeptClass)||$(this).find("a").text($(this).attr("changed"))})),e.find("a").text(e.attr("initial")))},t.Init(e)})},8217:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.mobileTopMenu=function(e){this.properties={siteUrl:"",offScroll:"",mMenu:".mobile-top-menu",mobileMenu:".mobile-menu-wrapper",mobileMenuItem:".mobile-menu-item",scrollToTop:".scroll-to-top",siteheader:"header",mainMenu:"#main-menu-container",demoPromoBlock:".demo-promo-block-js",tempScrollTop:0,fixedMenuScroll:10};var t=this,o=["h1",".title-block",".footer-menu-title-block","#activities_chatbox_item_xs"];this.scroll_top_fast=!1,this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_controls(),t.buildMenu();var o=0;$(window).resize((function(){var e=$(document).scrollTop();$(".mobile-menu-wrapper").is(":visible")?$(".magazine-profile__media").css("top","0px"):e||$(".magazine-profile__media").css("top","47px")})),$(window).scroll((function(){void 0!==$.fn.slick&&$(".mobile-menu-wrapper").slick("slickGoTo",0,!0);var e=$(document).scrollTop();$(t.properties.demoPromoBlock).is(":visible")?t.properties.fixedMenuScroll=150:t.properties.fixedMenuScroll=10,t.properties.offScroll||(e<o?($("nav").css({display:"block"}),$(t.properties.mMenu).css({top:"46px",position:"fixed",display:"block"}),$(".magazine-profile__media").length>0&&($(".mobile-menu-wrapper").is(":visible")?$(".magazine-profile__media").css("top","0px"):$(".magazine-profile__media").css("top","47px")),$(t.properties.mainMenu).css({position:"relative"})):e>t.properties.fixedMenuScroll+100?($("nav").css({display:"none"}),$(".magazine-profile__media").length>0&&$(".magazine-profile__media").css("top","0px"),$(t.properties.mMenu).css({display:"none"})):($(t.properties.mMenu).css({display:"none"}),$(t.properties.mainMenu).css({position:"fixed"})),0==e&&$(t.properties.mMenu).css({top:"0",position:"relative",display:"block"})),o=e})),t.scrollToTop()},this.uninit=function(){return $(document).off("click",t.properties.mobileMenuItem).off("focus keypress keyup change blur","textarea, input[type=text]"),this},this.init_controls=function(){$(document).off("click",t.properties.mobileMenuItem).on("click",t.properties.mobileMenuItem,(function(){t.scrollToBlock($(this))})).off("focus keypress keyup change blur","textarea, input[type=text]").on("focus keypress keyup change blur","textarea, input[type=text]",(function(){t.textBoxFocus()}))},this.buildMenu=function(){$("div").find(o.join()).each((function(){if(!location.href.includes("chatbox")||!$(this).prop("id").includes("chatbox")){var e=$(this).data("title"),o=$(this).data("id"),r=$(this).prop("href");void 0!==r&&(void 0===o&&(o=$(this).prop("id")),void 0===e&&(e=$(this).html())),void 0!==e&&void 0!==o&&t.createMenu(e,o,r)}})),$(t.properties.mobileMenu).slick({accessibility:!1,dots:!1,infinite:!0,speed:0,slidesToShow:3,slidesToScroll:1,prevArrow:!1,nextArrow:!1,rtl:"rtl"===site_rtl_settings})},this.createMenu=function(e,o,r){r&&(e='<a href="'+r+'">'+e+"</a>"),$(t.properties.mobileMenu).append('<div class="mobile-menu-item" data-id="'+o+'">'+e+'<s data-mblock-id="'+o+'"></s></div>')},this.scrollToBlock=function(e){t.scroll_top_fast=!0;var o,r=$(e).data("id");o="pjaxcontainer"!=r?parseInt($(e).index())-4:parseInt($(e).index())-3,$(".mobile-menu-wrapper").slick("slickGoTo",o,!0),$("html, body").animate({scrollTop:$("#"+r).offset().top-$(".main-inner-content").offset().top},800)},this.scrollToTop=function(){$(window).scroll((function(){0==$(this).scrollTop()&&(t.scroll_top_fast=!1),$(this).scrollTop()>150&&$(this).width()<768&&t.properties.tempScrollTop>$(this).scrollTop()?(t.scroll_top_fast?$(t.properties.scrollToTop).fadeOut():$(t.properties.scrollToTop).is(":visible")||$(t.properties.scrollToTop).fadeIn(),$("#cookie_policy_block").is(":visible")&&$(t.properties.scrollToTop).css("bottom","0px")):$(t.properties.scrollToTop).fadeOut(),t.properties.tempScrollTop=$(this).scrollTop()}))},this.textBoxFocus=function(){$(t.properties.scrollToTop).fadeOut()},t.Init(e)})},8907:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.App=function(e){this.properties={siteUrl:"/",statusAppBanner:"mobile_app_banner",class:{appTopBanner:".app-top-banner-js"},os_tags:["ios","android"],data:{action:{closeBanner:'[data-action="close-app_banner"]',installApp:'[data-action="install-app"]'}}};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),t.getStatusBanner(),t.initActions()},this.initActions=function(){if("undefined"!=typeof analyticsEvents){var e={"Personal Demo":{}};$.each(t.properties.os_tags,(function(t,o){e["Personal Demo"]["banner-"+o]="banner-install",$.extend(!0,analyticsEvents,e)}))}},this.initControls=function(){$(document).off("click",t.properties.data.action.closeBanner).on("click",t.properties.data.action.closeBanner,(function(){t.closeBanner()})).off("click",t.properties.data.action.installApp).on("click",t.properties.data.action.installApp,(function(){t.installApp(this)}))},this.getStatusBanner=function(){"closed"!==lightGetCookie(t.properties.statusAppBanner)&&$(t.properties.class.appTopBanner).removeClass("hide"),$(".app-top-banner-js").prependTo("#pjaxcontainer")},this.installApp=function(e){var t=$(e).data("tag");"undefined"!=typeof analyticsEvents&&sendAnalytics("banner-install","Personal Demo","banner-"+t)},this.closeBanner=function(){$(t.properties.class.appTopBanner).addClass("hide"),"undefined"!=typeof isFramed&&(isFramed||$(".app-top-banner-js").is(":visible")||$("#frame-wrapper").css("height",""))},this.query=function(e,o,r,i){return/^(f|ht)tps?:\/\//i.test(e)||(e=t.properties.siteUrl+e),$.ajax({url:e,type:"POST",cache:!1,data:o,dataType:r,success:function(e){void 0!==e.error&&e.error.length>0&&t.properties.errorObj.show_error_block(e.error,"error"),void 0!==e.info&&e.info.length>0&&t.properties.errorObj.show_error_block(e.info,"info"),void 0!==e.success&&e.success.length>0&&t.properties.errorObj.show_error_block(e.success,"success"),void 0!==i&&i(e)}}),!1},t.Init(e)})},8666:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.NearestUsers=function(e){this.properties={siteUrl:"",hide_map:0,map_height:400,id_map_form:"nearest_users_map_form",id_show_map_link:"show_map_link",id_hide_map_link:"hide_map_link",ajax_save_map_view_url:"nearest_users/ajaxSaveMapView/"};var t=this;this.Init=function(e){t.prop=$.extend(t.properties,e),1==t.prop.hide_map&&$("#"+t.prop.id_map_form).hide(),t.init_controls()},this.init_controls=function(){$("#"+t.prop.id_show_map_link).on("click",(function(){t.showMap()})),$("#"+t.prop.id_hide_map_link).on("click",(function(){t.hideMap()}))},this.showMap=function(){$("#"+t.prop.id_map_form).show(),$("#"+t.prop.id_show_map_link).addClass("hide"),$("#"+t.prop.id_hide_map_link).removeClass("hide"),t.prop.hide_map=0,$.ajax({type:"POST",url:site_url+t.prop.ajax_save_map_view_url+t.prop.hide_map,success:function(e){}})},this.hideMap=function(){$("#"+t.prop.id_map_form).hide(),$("#"+t.prop.id_hide_map_link).addClass("hide"),$("#"+t.prop.id_show_map_link).removeClass("hide"),t.prop.hide_map=1,$.ajax({type:"POST",url:site_url+t.prop.ajax_save_map_view_url+t.prop.hide_map,success:function(e){}})},t.Init(e)})},7780:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.adminNetwork=function(e){var t=this;this.properties={btnGetAccess:{},btnHideHelp:{},btnShowHelp:{},fast:{},frmNetwork:{},hasAccess:!1,helpBlock:{},domainField:{},keyField:{},interval:1e3,isRegistered:!0,meetsReqs:!1,parent:{},prevFast:"",prevSlow:"",showHelp:!0,showHelpBlock:{},showHelpInput:{},showLog:!0,siteUrl:"",slow:{},status:!1,statusUrl:"admin/network/ajax_get_status",accessUrl:"admin/network/get_access"};var r=function(e){for(var t in e)$("#"+e[t]).show()},i=function(e){for(var t in e)$("#"+e[t]).hide()},n=function(e){return $.ajax({dataType:"json",url:t.properties.siteUrl+e,context:document.body})};this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.parent=$(".network-content"),t.properties.fast=$("#fast",t.properties.parent),t.properties.slow=$("#slow",t.properties.parent),t.properties.helpBlock=$("#help-block"),t.properties.btnHideHelp=$("#btn-hide-help",t.properties.helpBlock),t.properties.showHelpBlock=$("#show-help-block"),t.properties.btnShowHelp=$("#btn-show-help",t.properties.showHelpBlock),t.properties.btnGetAccess=$("#btn-get-access"),t.properties.frmNetwork=$("#network-form"),t.properties.domainField=$("#network-domain"),t.properties.keyField=$("#network-key"),t.properties.showHelpInput=$('[name="show_help"]',t.properties.frmNetwork),t.properties.btnStartConnect=$('[data-action="start_connect"]'),t.properties.btnStopConnect=$('[data-action="stop_connect"]'),t.properties.btnStopConnect=$('[data-action="stop_connect"]'),t.properties.blockActionStop=$(".net_client_started"),t.properties.blockActionStart=$(".net_client_stopped"),t.uninit(),t.bindEvents(),t.properties.showLog&&setInterval((function(){n(t.properties.statusUrl).done((function(e){var o;o=e,t.properties.prevSlow!==o.slow.log&&(t.properties.prevSlow=o.slow.log,t.properties.slow.html(o.slow.log)),t.properties.prevFast!==o.fast.log&&(t.properties.prevFast=o.fast.log,t.properties.fast.text(o.fast.log))}))}),t.properties.interval),t.properties.showHelp?a():c(),t.initStep[p()]()},this.uninit=function(){t.properties.frmNetwork.off("submit")},this.formIsValid=function(){return!0},this.bindEvents=function(){t.uninit(),t.properties.frmNetwork.on("submit",(function(){return t.formIsValid()})),t.properties.btnHideHelp.on("click",(function(){c()})),t.properties.btnShowHelp.on("click",(function(){a()})),t.properties.btnGetAccess.on("click",(function(){n(t.properties.accessUrl).done((function(e){if("object"!==o(e.access)||"string"!=typeof e.access.domain||"string"!=typeof e.access.key)return console.error("wrong_access"),!1;e.access.error.length&&error_object.show_error_block(e.access.error,"error"),t.properties.domainField.val(e.access.domain),t.properties.keyField.val(e.access.key),t.properties.hasAccess=e.access.is_correct,t.initStep[p()]()}))})),t.properties.btnStartConnect.on("click",(function(){s("start")})),t.properties.btnStopConnect.on("click",(function(){s("stop")}))};var s=function(e){n("admin/network/"+e).done((function(e){void 0!==e.error&&e.error.length>0&&error_object.show_error_block(e.error,"error"),void 0!==e.success&&e.success.length>0&&(t.properties.blockActionStart.toggle(),t.properties.blockActionStop.toggle(),error_object.show_error_block(e.success,"success"))}))},a=function(){t.properties.showHelpInput.val(1),t.properties.showHelpBlock.hide(),t.properties.helpBlock.show()},c=function(){t.properties.showHelpInput.val(0),t.properties.showHelpBlock.show(),t.properties.helpBlock.hide()},p=function(){return t.properties.isRegistered?4:t.properties.meetsReqs?t.properties.hasAccess?t.properties.isRegistered?4:3:2:1};this.initStep={1:function(){r(["help-section","requirements-section"]),i(["settings-header","access-section","settings-section","save-section","connection-status-section"])},2:function(){r(["network-form","access-section","btn-access-section"]),i(["access-fields-section","settings-header","settings-section","save-section","connection-status-section"])},3:function(){r(["network-form","settings-section","save-section"]),i(["upload-photos-section","access-section","settings-header","connection-status-section","requirements-section"])},4:function(){r(["help-section","requirements-section","network-form","settings-header","settings-section","save-section","log-section","connection-status-section","requirements-section","upload-photos-section"]),i(["btn-access-section"])}},t.Init(e)})},7018:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.PaymentsCardForm=function(e){this.properties={siteUrl:"/"};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls()},this.initControls=function(){},t.Init(e)})},1900:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.AdminPaymentsSettings=function(e){this.properties={siteUrl:"",useAutoUpdateId:"use_rates_update",driverAutoUpdateId:"rates_update_driver",driverSelectId:"driver_select",manualUpdateId:"rates_update_manual",manualSelectId:"manual_select",urlUseAutoUpdate:"admin/payments/ajax_use_rates_update/",urlDriverAutoUpdate:"admin/payments/ajax_rates_driver_update/",urlManualUpdate:"admin/payments/ajax_currency_rates_update/",errorObj:new Errors({position:site_error_position})};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$("#"+t.properties.useAutoUpdateId).on("change",(function(){var e=this.checked?1:0;return t.use_auto_update(e),!1})),$("#"+t.properties.driverAutoUpdateId).on("click",(function(){var e=$("#"+t.properties.driverSelectId).val();return t.driver_auto_update(e),!1})),$("#"+t.properties.manualUpdateId).on("click",(function(){var e=$("#"+t.properties.manualSelectId).val();return t.manual_update(e),!1}))},this.use_auto_update=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.urlUseAutoUpdate+e,type:"GET",data:{},dataType:"json",cache:!1,success:function(e){void 0!==e.error&&""!=e.error?t.properties.errorObj.show_error_block(e.error,"error"):t.properties.errorObj.show_error_block(e.success,"success")}}),!1},this.driver_auto_update=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.urlDriverAutoUpdate+e,type:"GET",data:{},dataType:"json",cache:!1,success:function(e){void 0!==e.error&&""!=e.error?t.properties.errorObj.show_error_block(e.error,"error"):t.properties.errorObj.show_error_block(e.success,"success")}}),!1},this.manual_update=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.urlManualUpdate+e,type:"GET",data:{},dataType:"json",cache:!1,success:function(e){void 0!==e.error&&""!=e.error?t.properties.errorObj.show_error_block(e.error,"error"):t.properties.errorObj.show_error_block(e.success,"success")}}),!1},t.Init(e)})},1618:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}Number.prototype.formatMoney=function(e,t,o){var r=this,i="-"==e||"–"==e,n=(e=i?0:isNaN(e=Math.abs(e))?2:e,t=null==t?",":t,o=null==o?".":o,r<0?"-":""),s=parseInt(r=Math.abs(+r||0).toFixed(e))+"",a=(a=s.length)>3?a%3:0;return n+(a?s.substr(0,a)+o:"")+s.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+o)+(e?t+Math.abs(r-s).toFixed(e).slice(2):"")+(i?t+"–":"")},"object"===o(t)&&(t.__esModule=!0,t.adminPayments=function(e){this.properties={};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),$("div.row:odd").addClass("zebra"),t.bind_events(),t.set_format()},this.bind_events=function(){$("#gid, #abbr, input[name=dec_sep], input[name=gr_sep], input[name=dec_part]").on("change keyup click",(function(){t.set_format()}))},this.set_format=function(){var e=1234.56,t=$("#gid").val(),o=$("#abbr").val(),r=$("input[name=dec_sep]:checked").val(),i=$("input[name=gr_sep]:checked").val(),n=$("input[name=dec_part]:checked").val();e=e.formatMoney(n,r,i),$("#templates label").each((function(){var r=$("#"+$(this).attr("for")).val().split("[abbr]").join(o).split("[gid]").join(t).split("[value]").join(e);$(this).html(r)}))},t.Init(e)})},8743:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.PaymentSystemTarifs=function(e){this.properties={siteUrl:"",systemGid:"",useOperators:!1,blockId:"system_tarifs_block",formId:"operator_edit_block",sortId:"operators_sorting",sortUrl:"admin/payments/ajax_save_system_operators_sorter/",deleteUrl:"admin/payments/ajax_delete_system_operator/",formUrl:"admin/payments/ajax_get_system_operator_form/",saveUrl:"admin/payments/ajax_save_system_operator_data/",activateUrl:"admin/payments/ajax_set_system_operator_status/",blockUrl:"admin/payments/ajax_get_system_operators/",cancelBtnId:"btn_cancel",saveBtnId:"btn_save",addBtnId:"add_operator_link",onActionUpdate:!0,errorObj:new Errors,contentObj:null};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.contentObj||(t.properties.contentObj=new loadingContent),t.set_sortable(),$("#"+t.properties.addBtnId).on("click",(function(){return t.get_operator_form(),!1}))},this.set_sortable=function(){$("#"+t.properties.sortId).sortable({items:"li",scroll:!0,forcePlaceholderSize:!0,placeholder:"limiter",revert:!0,update:function(e,o){t.properties.onActionUpdate&&t.update_sorting()}}),$("#"+t.properties.sortId+" > li").each((function(){var e=$(this).attr("id").substring(9);$(this).find(".add_link").on("click",(function(){return t.add_operator_tarif(e),!1})),$(this).find(".remove_link").on("click",(function(){return t.delete_operator_tarif($(this)),!1})),$(this).find(".edit_link").on("click",(function(){return t.get_operator_form(e),!1})),$(this).find(".delete_link").on("click",(function(){return t.delete_operator(e),!1})),$(this).find(".activate_link").on("click",(function(){return t.activate_operator(e),!1})),$(this).find(".deactivate_link").on("click",(function(){return t.deactivate_operator(e),!1}))}))},this.reload_block=function(){var e=t.properties.siteUrl+t.properties.blockUrl;$.ajax({url:e+t.properties.systemGid,type:"GET",cache:!1,success:function(e){$("#"+t.properties.blockId).html(e),t.set_sortable()}})},this.update_sorting=function(){var e=t.properties.siteUrl+t.properties.sortUrl,o=new Object;$("#"+t.properties.sortId+" > li").each((function(e){o[$(this).attr("id")]=e+1})),$.ajax({url:e+t.properties.systemGid,type:"POST",dataType:"json",data:{sorter:o},cache:!1,success:function(e){t.properties.errorObj.show_error_block(e.success,"success")}})},this.get_operator_form=function(e){e=e||"";var o=t.properties.siteUrl+t.properties.formUrl;$.ajax({url:o+t.properties.systemGid+"/"+e,cache:!1,success:function(o){t.properties.contentObj.show_load_block(o),$("#"+t.properties.cancelBtnId).on("click",(function(){return t.properties.contentObj.hide_load_block(),!1})),$("#"+t.properties.saveBtnId).off().on("click",(function(){t.save_operator_form_data(e)}))}})},this.save_operator_form_data=function(e){var o=new Object;$("#"+t.properties.formId+" input").each((function(e){o[$(this).attr("name")]=$(this).val()}));var r=t.properties.siteUrl+t.properties.saveUrl;$.ajax({url:r+t.properties.systemGid+"/"+e,type:"POST",data:{data:o},dataType:"json",cache:!1,success:function(e){void 0!==e.errors&&""!=e.errors?t.properties.errorObj.show_error_block(e.errors,"error"):(t.properties.contentObj.hide_load_block(),t.reload_block())}})},this.add_operator_tarif=function(e){var t=$("#"+e+"_tarif_block>div").clone(!0);$("#"+e+"_tarifs_block").append(t)},this.delete_operator_tarif=function(e){e.parent().remove()},this.delete_operator=function(e){var o=t.properties.siteUrl+t.properties.deleteUrl;$.ajax({url:o+t.properties.systemGid+"/"+e,cache:!1,success:function(e){t.reload_block()}})},this.activate_operator=function(e){var o=t.properties.siteUrl+t.properties.activateUrl;$.ajax({url:o+t.properties.systemGid+"/"+e+"/1",cache:!1,success:function(e){t.reload_block()}})},this.deactivate_operator=function(e){var o=t.properties.siteUrl+t.properties.activateUrl;$.ajax({url:o+t.properties.systemGid+"/"+e+"/0",cache:!1,success:function(e){t.reload_block()}})},t.Init(e)})},4864:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.PollsList=function(e){this.properties={siteUrl:"",ajaxPollUrl:"polls/ajax_poll/"};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.bind_events()},this.bind_events=function(){$(".poll_question_link").on("click",(function(){$(this).next(".poll_results_content").is(":hidden")?t.show_poll($(this)):t.hide_poll($(this))}))},this.show_poll=function(e){var o=e.attr("id").replace(/\D+/g,""),r=t.properties.siteUrl+t.properties.ajaxPollUrl+o+"/1";e.find('[data-role="expander"]').removeClass("down").addClass("up"),""==e.next(".poll_results_content").html()?e.next(".poll_results_content").load(r,(function(){e.next(".poll_results_content").show()})):e.next(".poll_results_content").show()},this.hide_poll=function(e){e.find('[data-role="expander"]').removeClass("up").addClass("down"),e.next(".poll_results_content").hide()},t.Init(e)})},1717:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.adminPolls=function(e){this.properties={siteUrl:""};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),$("div.row:odd").addClass("zebra"),$(".datepicker").datepicker({dateFormat:"dd-mm-yy"})},this.bind_events=function(){$("#use_expiration").on("click",(function(){this.checked?$("#date_end").removeAttr("disabled"):$("#date_end").attr("disabled","disabled")})),$("#poll_language").change((function(){$(this).val()>0?($(".question").hide(),$("#question_"+$(this).val()).show()):$(".question").show()}))},t.Init(e)})},9391:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.adminPollsAnswers=function(e){this.properties={siteUrl:"",counter:0,show_results:!1};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),$(".lef div.row:odd, .ref div.row:odd").addClass("zebra"),$(".datepicker").datepicker({dateFormat:"dd-mm-yy"}),$(".color-pick").each((function(){$(this).val()||$(this).val(t.get_rand_color())})),t.update_preview()},this.bind_events=function(){$("input.default_answer").off().on("keyup change click mouseup",(function(){t.update_preview()})),$("input.color-pick").off().on("change",(function(){t.update_preview()})),$("a.delete_answer").off().on("click",(function(){var e=+$(this).attr("id").replace(/\D+/g,"");t.delete_answer(e)})),$("#add_answer").off().on("click",(function(){t.add_answer()}))},this.add_answer=function(){var e=++polls.properties.counter,o=$("#answer_tpl").html().replace(/-id-/g,e);$("#answers_list").append(o);var r=$("#preview_tpl").html().replace(/-id-/g,e);$("#preview_tpl").before(r),$("#color_answer_"+e).attr("value",polls.get_rand_color()),t.update_preview(),t.bind_events(),jscolor.init(),$(".lef div.row, .ref div.row").removeClass("zebra"),$(".lef div.row:odd, .ref div.row:odd").addClass("zebra")},this.update_preview=function(){for($("#results_answers").html(""),i=1;i<=t.properties.counter;i++){var e="answer_"+i,o=$("."+e).attr("id");null!=$("#"+e).val()&&null!=$("input#color_"+e).val()&&($("label[for="+o+"]").html($("#"+e).val()),t.properties.show_results&&$("#results_answers").append('<div class="result" id="result_answer_'+i+'">'+$("#"+e).val()+'<div class="progress" style="background-color: #'+$("input#color_"+e).val()+"; width: "+1.5*i+'%;"></div></div>'))}},this.get_rand_color=function(){var e=Math.floor(0+16777215*Math.random()).toString(16);return 6!=e.length&&(e=t.get_rand_color()),e},this.delete_answer=function(e){$("#row_answer_"+e).remove(),$("#preview_answer_"+e).remove(),t.properties.show_results&&$("#result_answer_"+e).remove(),$(".lef div.row, .ref div.row").removeClass("zebra"),$(".lef div.row:odd, .ref div.row:odd").addClass("zebra"),t.update_preview()},t.Init(e)})},9896:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Polls=function(e){this.properties={siteUrl:"",poll_id:"",ajaxPollUrl:"polls/ajax_poll/"};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.bind_events()},this.bind_events=function(){$("#poll_block_"+t.properties.poll_id+" .respond").on("click",(function(){return t.save_result($("#poll_block_"+t.properties.poll_id)),!1})),$("#poll_block_"+t.properties.poll_id+" .next_poll").on("click",(function(){return t.update_poll($("#poll_block_"+t.properties.poll_id)),!1}))},this.update_poll=function(e,o){o=o||0,$.get(t.properties.siteUrl+t.properties.ajaxPollUrl+o,(function(t){e.addClass("old_block").hide(),e.before(t),$(".old_block").remove()}))},this.save_result=function(e){var o=e.find("form");if(o.find("input[name^=answer]:checked").val()>0){e.addClass("old_block").hide();var r=o.serialize(),i=t.properties.siteUrl+"polls/ajax_save_result/";$.post(i,r,(function(o){"error"!=o?(e.before(o),$(".old_block").remove()):location.href=t.properties.siteUrl+"polls"}))}},t.Init(e)})},3091:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Postbacks=function(e){this.properties={siteUrl:"/",errorObj:new Errors};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls()},this.initControls=function(){},t.Init(e)})},7731:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Questions=function(e){this.properties={siteUrl:"",use_form:!0,btnForm:"btn-questions",btnRefresh:"btn-refresh",cFormId:"questions_form",urlGetForm:"",urlSendForm:"",urlGetData:"",error_sent:"Question already sent",id_close:"btn_send_questions",errorObj:new Errors,dataType:"html",contentObj:new loadingContent({loadBlockWidth:"50%",closeBtnClass:"w",scroll:!0,closeBtnPadding:5,blockBody:!1})};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$(document).off("click","#"+t.properties.btnForm).on("click","#"+t.properties.btnForm,(function(){1===$(this).data("compared")?t.properties.errorObj.show_error_block(t.properties.error_sent,"error"):t.properties.use_form&&t.get_form()}))},this.isJson=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},this.get_form=function(){return $.ajax({url:t.properties.siteUrl+t.properties.urlGetForm,type:"POST",cache:!1,dataType:"json",success:function(e){return e.errors?(t.properties.errorObj.show_error_block(e.errors,"error"),!1):void 0!==e.info.access_denied&&e.info.access_denied.length>0?(t.properties.contentObj.properties.onClose=function(){$("body").removeClass("blur-page fixed-top").find(".pjaxcontainer-inner").removeClass("blur-it")},t.properties.contentObj.show_load_block(e.info.access_denied),!1):(t.properties.contentObj.show_load_block(e.content),$("#"+t.properties.id_close).unbind().on("click",(function(){return t.clearBox(),!1})),void $("#"+t.properties.btnRefresh).unbind().on("click",(function(){t.refresh()})))}}),!1},this.refresh=function(){$.ajax({url:t.properties.siteUrl+t.properties.urlGetData,type:"POST",cache:!1,dataType:"json",success:function(e){if(e.items)for(var t in $("#list").empty(),e.items)$("#list").append('<li><label><input type="radio" class="" value="'+e.items[t].id+'" id="question-'+e.items[t].id+'" name="question" /> '+e.items[t].name+"</label></li>")}})},this.send_form=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.urlSendForm,type:"POST",data:e,dataType:"json",cache:!1,success:function(e){void 0!==e.error&&""!=e.error?t.properties.errorObj.show_error_block(e.error,"error"):($("#"+t.properties.btnForm).attr("data-compared","1").addClass("link-disabled"),t.properties.errorObj.show_error_block(e.success,"success"),t.properties.contentObj.hide_load_block(),sendAnalytics("questions_send_question","communication","user"))}}),!1},this.clearBox=function(){var e=$("#"+t.properties.cFormId).serialize();t.send_form(e)},t.Init(e)})},5264:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Ratings=function(e){this.properties={siteUrl:"",ratingId:"",readOnly:!1,width:39,height:39,type:"previous",showLabel:!1,useMinAsDefault:!1,errorObj:new Errors,isRTL:!1};var t=this;t.blocks=[],t.types=["one","previous","next"],this.Init=function(e){t.properties=$.extend(t.properties,e),$("#"+t.properties.ratingId+", #extended-"+t.properties.ratingId+" .rating").each((function(e,o){var r=[];r=$.extend(t.properties,r),o={el:o=$(o),values:{},score:o.find("input[name^=rating_data]").val(),label:o.find("label"),options:r},t.properties.showLabel&&o.label.css({display:"inline-block"}),o.el.on("mouseleave",(function(){t.properties.readOnly||t.render(o)})),o.el.find("li").each((function(e,r){(r=$(r)).on("mouseover",(function(){o.options.readOnly||t.render(o,r.attr("data-id"))})).on("click",(function(){if(!o.options.readOnly){var e=r.attr("data-id");o.score!=e?o.score=e:o.score=0,o.el.find("input[name^=rating_data]").val(o.score),t.render(o)}})),o.values[e]={el:r,value:r.attr("data-id"),label:r.attr("data-label")}})),t.blocks[e]=o,t.render(o)}))},this.render=function(e,o){o=o||e.score,e.label.html(""),e.el.find(".custom").remove();var r=0,i=null,n=null;for(var s in e.values){var a=e.values[s];a.el.attr("class",a.el.hasClass("hide")?"hide":"far"),null==n&&o>0&&a.value>=o&&(r=o/a.value,i={el:a.el,value:a.value,label:a.label}),n&&n.value<o&&a.value>=o&&(i=(r=(o-n.value)/(a.value-n.value))>=.5?{el:a.el,value:a.value,label:a.label}:{el:a.el,value:n.value,label:n.label}),!i&&t.properties.useMinAsDefault&&(i={el:a.el,value:a.value,label:a.label}),n=a}if(i){switch(e.options.type){case"previous":i.el.prevAll().addClass("fas rating-"+i.value);break;case"next":i.el.nextAll().addClass("fas rating-"+i.value)}r>0&&r<1&&(i.el.before(i.el.clone(!0)),i.el.addClass("custom").css("marginLeft","-"+i.el.width()+"px").width(i.el.width()*r)),e.label.html(i.label),i.el.addClass("fas rating-"+i.value)}},t.Init(e)})},1744:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.RatingsForm=function(e){this.properties={siteUrl:"",sendRatingBtn:"rating_btn",cFormId:"ratings_form",urlGetForm:"ratings/ajax_get_form/",urlSendForm:"ratings/ajax_send_rating/",id_close:"close_btn",viewRatingBlockClass:".view-rating-block",emptyRating:".empty-rating",rand:null,isPopup:!0,isOwner:!1,success:null,contentObj:null,errorObj:new Errors,common_ancestor:"body",lang:{you:"You"},data:{myMark:'[data-rating="my_mark"]',allMark:'[data-rating="all_mark"]'}};var t=this;return this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.contentObj||(t.properties.contentObj=new loadingContent({loadBlockWidth:"544px",closeBtnClass:"load_content_close",closeBtnPadding:5})),t.properties.isPopup?$("#"+t.properties.sendRatingBtn+"_"+t.properties.rand).on("click",(function(){var e={object_id:$(this).attr("data-id"),type_gid:$(this).attr("data-type"),responder_id:$(this).attr("data-responder"),is_owner:void 0!==$(this).attr("data-owner")?1:0,rand:t.properties.rand};return t.get_form(e),!1})).show():$(t.properties.common_ancestor).off("click","#"+t.properties.cFormId+"_"+t.properties.rand+" ins").on("click","#"+t.properties.cFormId+"_"+t.properties.rand+" ins",(function(){if(!t.properties.readOnly)return t.send_form($(this).closest("form").serialize()),!1})).off("mouseenter",+t.properties.viewRatingBlockClass).on("mouseenter",t.properties.viewRatingBlockClass,(function(){t.viewRatingBlock(this)})).off("mouseleave",+t.properties.viewRatingBlockClass).on("mouseleave",t.properties.viewRatingBlockClass,(function(){t.closeRatingBlock(this)}))},this.uninit=function(){return $(t.properties.common_ancestor).off("click","#"+t.properties.cFormId+"_"+t.properties.rand),this},this.viewRatingBlock=function(e){return $(e).find(t.properties.emptyRating).hide(),$(e).find(".form-rating").show(),this},this.closeRatingBlock=function(e){$(e).find(".form-rating").hide(),$(e).find(t.properties.emptyRating).show()},this.get_form=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.urlGetForm,type:"post",data:e,cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),$("#"+t.properties.id_close).unbind().on("click",(function(){return t.clearBox(),!1}))}}),!1},this.send_form=function(e){return e=void 0!==e?e:$("#"+t.properties.cFormId+"_"+t.properties.rand).serialize(),$.ajax({url:t.properties.siteUrl+t.properties.urlSendForm,type:"post",data:e,dataType:"json",cache:!1,success:function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return!0===loadingContent.prototype.isActive&&"gallery"===loadingContent.prototype.template&&(t.properties.contentObj.destroy(),t.properties.contentObj.changeTemplate("default")),t.properties.contentObj.show_load_block(e.info.access_denied),!1;if(void 0!==e.errors&&""!==e.errors)t.properties.errorObj.show_error_block(e.errors,"error");else{if(t.properties.isPopup){var o=$("#"+t.properties.sendRatingBtn+"_"+t.properties.rand);o.removeAttr("href").unbind("click").on("click",(function(){return!1})),o.find("ins").addClass("g"),t.properties.contentObj.hide_load_block()}else $("#"+t.properties.cFormId).find("textarea").val("");t.properties.errorObj.show_error_block(e.success,"success"),$("#rating_avg-"+t.properties.rand).html(e.rating.rating_value),$("#rating_count-"+t.properties.rand).html('(<i class="fa fa-user g"></i> '+e.rating.rating_count+")"),$(t.properties.viewRatingBlockClass).find(".get-rating>.bottom").html("("+e.rating.rating_count+")"),$(t.properties.data.allMark).html(e.rating.rating_value),$(t.properties.data.myMark).html(e.my_mark),$(t.properties.data.myMark).siblings(".bottom").html(t.properties.langs.you),$(t.properties.data.myMark).siblings("i").attr("class","fa fa-star"),$(t.properties.data.myMark).closest(t.properties.emptyRating).addClass("set"),t.properties.success&&t.properties.success(e.id)}},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}}),!1},this.clearBox=function(){var e=$("#"+t.properties.cFormId+"_"+t.properties.rand).serialize();t.send_form(e)},t.Init(e),this})},4174:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.RatingsList=function(e){this.properties={siteUrl:"",listAjaxUrl:"ratings/ajax_get_ratings",listBlockId:"ratings_list",replyAjaxUrl:"ratings/ajax_reply/",order:"date_add",orderDirection:"DESC",page:1,replySuccessCallback:null,replyFormClass:"ratings-reply-form",errorObj:null,tIds:[]};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.errorObj||(t.properties.errorObj=new Errors),$(document).off("submit","."+t.properties.replyFormClass).on("submit","."+t.properties.replyFormClass,(function(){return t.reply_form($(this)),!1})),t.init_links()},this.init_links=function(){if(t.properties.tIds.length)for(var e in t.properties.tIds){var o=t.properties.tIds[e];$(document).on("change","#"+o+" select",(function(){return t.properties.order=$(this).val(),t.loading_block(),!1})),$(document).on("click","#"+o+" [name=sorter_btn]",(function(){return"ASC"==t.properties.orderDirection?t.properties.orderDirection="DESC":t.properties.orderDirection="ASC",t.loading_block(),!1})),$(document).on("click","#"+o+">.pages a[data-page]",(function(){return t.properties.page=$(this).attr("data-page"),t.loading_block(),!1}))}},this.loading_block=function(e){e||(e=t.properties.siteUrl+t.properties.listAjaxUrl+"/"+t.properties.order+"/"+t.properties.orderDirection+"/"+t.properties.page),$.ajax({url:e,type:"GET",cache:!1,success:function(e){$("#"+t.properties.listBlockId).html(e)}})},this.reply_form=function(e){var o=e.data("id"),r=e.serialize();$.ajax({url:t.properties.siteUrl+t.properties.replyAjaxUrl+o,type:"POST",cache:!1,data:r,dataType:"json",success:function(o){return o.success?(t.properties.replySuccessCallback&&t.properties.replySuccessCallback(e,o),t.properties.errorObj.show_error_block(o.success,"success")):t.properties.errorObj.show_error_block(o.error,"error"),!1}})},t.Init(e)})},5780:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Ratings=function(e){this.properties={siteUrl:"",ratingId:"",readOnly:!1,showLabel:!1,useMinAsDefault:!1,errorObj:new Errors,isRTL:!1,cbSendForm:null,mouseX:0,mouseY:0,rand:0};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$(window).mousemove((function(e){t.properties.mouseX=e.clientX,t.properties.mouseY=e.clientY,$("#rating_current-"+t.properties.rand).css("position","fixed"),$("#rating_current-"+t.properties.rand).css("padding","10px"),$("#rating_current-"+t.properties.rand).css("top",t.properties.mouseY+8+"px"),$("#rating_current-"+t.properties.rand).css("left",t.properties.mouseX+8+"px")})),$("#"+t.properties.ratingId+", #extended-"+t.properties.ratingId+" .rating").each((function(e,o){var r=[];r=$.extend(t.properties,r),(o={el:o=$(o),values:{},score:o.find("input[name^=rating_data]").data("my-set-mark"),label:o.find("#rating_current-"+t.properties.rand),l:"",options:r,min:1,max:1}).el.on("mouseleave",(function(){t.properties.readOnly||t.render(o)})),o.el.find("ins").each((function(e,r){(r=$(r)).on("mouseover",(function(){o.options.readOnly||(t.render(o,r.data("id"),r.data("label")),navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/)||o.label.show())})).on("mouseout",(function(){navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/)||o.label.hide()})).on("click",(function(){if(!o.options.readOnly)if(""==$("input[name^=id_poster]").val())$("html, body").animate({scrollTop:$("#ajax_login_link_menu").length?$("#ajax_login_link_menu").offset().top:0},1e3),$("#ajax_login_link").click();else{var e=r.data("id");o.score=e,o.l=r.data("label"),o.l||(o.l=""),o.el.find("input[name^=rating_data]").val(o.score),"function"==typeof t.properties.cbSendForm&&t.properties.cbSendForm(),t.render(o)}})),o.min=Math.min(o.min,r.data("id")),o.max=Math.max(o.max,r.data("id")),o.values[e]={el:r,value:r.data("id"),label:r.data("label")}})),t.render(o)}))},this.render=function(e,t,o){t=t||e.score,o=o||e.l,e.label.html(""),e.el.find(".rating-vals").css({width:Math.round(t/e.max*100)+"%"}).show(),e.label.html(o)},t.Init(e)})},9365:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Referral_links=function(e){this.properties={siteUrl:"",use_form:!0,btnForm:"btn-referral_links",cFormId:"referral_links_form",urlGetForm:"",urlSendForm:"",id_close:"btn_send_link",errorObj:new Errors,dataType:"html",contentObj:new loadingContent({loadBlockWidth:"640px",closeBtnClass:"w",scroll:!0,closeBtnPadding:5,blockBody:!0})};var t=this;return this.Init=function(e){t.properties=$.extend(t.properties,e),$("#"+t.properties.btnForm).on("click",(function(e){e.preventDefault(),t.get_form()})).show()},this.get_form=function(){return $.ajax({url:t.properties.siteUrl+t.properties.urlGetForm,type:"POST",cache:!1,dataType:t.properties.dataType,success:function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return t.properties.contentObj.show_load_block(e.info.access_denied),!1;void 0!==e.errors&&""!==e.errors?error_object.show_error_block(e.errors,"error"):(t.properties.contentObj.show_load_block(e.html),$("#"+t.properties.id_close).unbind().on("click",(function(){return t.clearBox(),!1})))}}),!1},this.send_form=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.urlSendForm,type:"POST",data:e,dataType:"json",cache:!1,success:function(e){void 0!==e.error&&""!=e.error?t.properties.errorObj.show_error_block(e.error,"error"):(t.properties.errorObj.show_error_block(e.success,"success"),t.properties.contentObj.hide_load_block())}}),!1},this.clearBox=function(){var e=$("#"+t.properties.cFormId).serialize();t.send_form(e)},t.Init(e),this})},5217:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.SendMoney=function(e){this.properties={siteUrl:"",reloadTimeout:600,idTransaction:0,rand:0,user_id:0,urlDecline:"send_money/ajaxDecline/",urlApprove:"send_money/ajaxApprove/",urlValidateTransaction:"send_money/ajaxValidateTransaction/",urlGetSendMoneyBlock:"send_money/ajaxGetSendMoneyBlock/",contentObj:new loadingContent({loadBlockWidth:"400px",loadBlockLeftType:"right",loadBlockTopType:"bottom",closeBtnClass:"w"})};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$(document).off("click","#donate_link_send_money").on("click","#donate_link_send_money",(function(){t.getSendMoneyBlock()}))},this.getSendMoneyBlock=function(){$.ajax({url:t.properties.siteUrl+t.properties.urlGetSendMoneyBlock+t.properties.user_id,cache:!1,dataType:"JSON",success:function(e){void 0!==e.errors&&e.errors.length>0?error_object.show_error_block(e.errors,"error"):t.properties.contentObj.show_load_block(e.html)}})},this.declineMoneyTransaction=function(e,o){$.ajax({type:"POST",url:t.properties.siteUrl+t.properties.urlDecline+e,data:{id_transaction:e},success:function(e){e?(error_object.show_error_block(e,"success"),$("#status_"+o).html('<font class="donate decline">'+e+"</font>")):console.log("return error")}})},this.approveMoneyTransaction=function(e,o){$.ajax({type:"POST",url:t.properties.siteUrl+t.properties.urlApprove+e,data:{id_transaction:e},success:function(e){e?(error_object.show_error_block(e,"success"),$("#status_"+o).html('<font class="donate approve">'+e+"</font>"),sendAnalytics("send_money_approved","communication","user")):console.log("return error")}})},this.validateTransaction=function(){$("#send_money").unbind("click").on("click",(function(e){e.preventDefault(),$.ajax({type:"POST",url:t.properties.siteUrl+t.properties.urlValidateTransaction,data:$("#send_form").serialize(),dataType:"json",success:function(e){void 0!==e.errors&&""!=e.errors?error_object.show_error_block(e.errors,"error"):$("#send_form").submit()}})}))},t.Init(e)})},2378:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.SendVip=function(e){this.properties={siteUrl:"",reloadTimeout:600,idTransaction:0,rand:0,user_id:0,urlDecline:"send_vip/ajaxDecline/",urlApprove:"send_vip/ajaxApprove/",urlValidateTransaction:"send_vip/ajaxValidateTransaction/",urlGetSendVipBlock:"send_vip/ajaxGetSendVipBlock/",contentObj:new loadingContent({loadBlockWidth:"400px",loadBlockLeftType:"right",loadBlockTopType:"bottom",closeBtnClass:"w"})};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$(document).off("click","#donate_link_send_vip").on("click","#donate_link_send_vip",(function(){t.getSendVipBlock()}))},this.getSendVipBlock=function(){$.ajax({url:t.properties.siteUrl+t.properties.urlGetSendVipBlock+t.properties.user_id,cache:!1,dataType:"JSON",success:function(e){void 0!==e.errors&&e.errors.length>0?error_object.show_error_block(e.errors,"error"):t.properties.contentObj.show_load_block(e.html)}})},this.declineVipTransaction=function(e,o){$.ajax({type:"POST",url:t.properties.siteUrl+t.properties.urlDecline+e,data:{id_transaction:e},success:function(e){e?(error_object.show_error_block(e,"success"),$("#status_"+o).html('<font class="donate decline">'+e+"</font>")):console.log("return error")}})},this.approveVipTransaction=function(e,o){$.ajax({type:"POST",url:t.properties.siteUrl+t.properties.urlApprove+e,data:{id_transaction:e},success:function(e){e?(error_object.show_error_block(e,"success"),$("#status_"+o).html('<font class="donate approve">'+e+"</font>"),sendAnalytics("send_membership_approved","communication","user")):console.log("return error")}})},this.validateTransaction=function(){$("#send_vip").on("click",(function(e){e.preventDefault(),$.ajax({type:"POST",url:t.properties.siteUrl+t.properties.urlValidateTransaction,data:$("#send_form").serialize(),dataType:"json",success:function(e){void 0!==e.errors&&e.errors.length>0?error_object.show_error_block(e.errors,"error"):$("#send_form").submit()}})}))},t.Init(e)})},6935:()=>{},9638:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Services=function(e){this.properties={selectMethodClass:"select-payment-method",billingBlockClass:"billing-systems-block",billingMethodClass:"billing-method",systemGidId:"system_gid"};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls()},this.uninit=function(){return $(document).off("click","."+t.properties.selectMethodClass).off("click","."+t.properties.billingMethodClass),this},this.initControls=function(){$(document).off("click","."+t.properties.selectMethodClass).on("click","."+t.properties.selectMethodClass,(function(){t.toggleMethodBlock()})).off("click","."+t.properties.billingMethodClass).on("click","."+t.properties.billingMethodClass,(function(){t.setMethod($(this))}))},this.toggleMethodBlock=function(){$("."+t.properties.billingBlockClass).toggle()},this.setMethod=function(e){$("."+t.properties.billingMethodClass).removeClass("selected"),$(e).addClass("selected"),$("#"+t.properties.systemGidId).val($(e).data("gid"))},t.Init(e)})},9802:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Shoutbox=function(e){this.properties={id:"shoutbox",site_url:"",active_ajax_timeout:3,inactive_ajax_timeout:6,id_user:0,max_id:0,min_id:0,count_newm:0,msg_max_length:150,user_name:"",position:"right",get_messages_url:"shoutbox/ajax_get_messages",post_message_url:"shoutbox/ajax_post_message",new_msgs:{messages:{},count_new:0},shoutboxPanel:"#shoutbox-panel",shoutboxBlock:"#shoutbox_block",shoutboxBtn:"#shoutbox_btn",shoutboxClose:"#shoutbox-close",shoutboxPanelBottom:"#shoutbox_panel-bottom",shoutbox_msg_btns_id:"shoutbox_msg_btns",shoutboxMobileBlock:".shoutbox-mobile-block",bottomBtns:"#bottom-btns",toggleBlock:".js-toggle-block",is_dom_init:!1,load_old:!1,is_opened:!1,isFirstOpening:!1};var t={shoutboxPanelObj:{},shoutboxBlockObj:{},shoutboxBtnObj:{},shoutboxCloseObj:{},shoutbox_obj:{},msg_textarea_obj:{},msg_chat_obj:{},msg_btns_obj:{},counter_new_messages_obj:{},btn_in_top_obj:{},counter_to:{},xhr_send_message:null};this.init_vars=function(){t.xhr_send_message=null,this.shoutbox_messages={max_id:0,min_id:0,msg:[]}};var o=this;return o.init_vars(),this.init=function(e){return e=e||{},$.extend(!0,o.properties,e),o.properties.id_user?(t.initDomObjects(),$("body").append('<div id="'+o.properties.id+'_full_text" class="shoutbox_full_text" style="display:none;"><div>').on("mouseleave","#"+o.properties.id+"_full_text",(function(){$("#"+o.properties.id+"_full_text").fadeOut(0)})),o.initScroll(),this):this},this.initScroll=function(){try{t.msg_chat_obj.slimScroll({railVisible:!0,height:"250px",size:"5px",position:o.properties.position,endScrollY:function(){t.loadOldMessage()}})}catch(e){}},t.loadOldMessage=function(){if(o.properties.isInitialized&&!o.properties.load_old){o.properties.load_old=!0;var e=t.getMinId();if(!(e<2))return $.ajax({type:"POST",url:o.properties.site_url+o.properties.get_messages_url,data:{min_id:e},success:function(e,r,i){t.setShoutboxMessages(e),o.properties.new_msgs.messages&&delete o.properties.new_msgs.messages,t.renderMessages(o.shoutbox_messages.msg,"replace_old"),o.shoutbox_messages.loaded=1,setTimeout((function(){o.properties.load_old=!1}),1e3),o.initScroll()},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)},dataType:"json",backend:1}),this}},this.uninit=function(){return o.properties.is_dom_init&&(t.msg_btns_obj.off("click",'input[name="sendbtn"]'),t.msg_textarea_obj.off("keydown")),o.properties.new_msgs={messages:{},count_new:0},o.init_vars(),this},this.die=function(){return MultiRequest.disableAction("shoutbox_new_msgs"),o.uninit(),$(o.properties.shoutboxBlock).remove(),this},this.firstOpeningShoutBox=function(){$.ajax({url:o.properties.site_url+o.properties.get_messages_url,dataType:"json",success:function(e){o.properties.new_msgs=e.msg,o.properties.max_id=e.max_id,o.properties.min_id=e.min_id,o.shoutbox_messages={max_id:o.properties.max_id,min_id:o.properties.min_id,msg:[]},t.renderMessages(o.properties.new_msgs,"init"),t.initMultiRequest(),o.isInitialized=!0,o.properties.isFirstOpening=!0}})},this.showShoutbox=function(){return t.panel_obj.fadeIn(),t.message_window_state?t.msg_window_obj.fadeIn():t.msg_window_obj.hide(),$(document).trigger("im:show"),this},this.sendMessage=function(){if(t.xhr_send_message&&4!=t.xhr_send_message.readyState)return this;var e=t.trimStr(t.msg_textarea_obj.val());if(!e)return this;t.xhr_send_message=$.ajax({type:"POST",url:o.properties.site_url+o.properties.post_message_url,data:{text:e,max_id:t.getMaxId(),id_user:o.properties.id_user},success:function(e,r,i){e.errors.length?error_object.show_error_block(e.errors,"error"):(t.msg_textarea_obj.val(""),$("#"+o.properties.id+"_msg_count").text(o.properties.msg_max_length),e.messages.msg.length&&(t.setShoutboxMessages(e.messages),t.renderMessages(e.messages.msg,"replace_my"))),e.notices&&e.notices.length&&error_object.show_error_block(e.notices,"info")},error:function(e,t,o){},dataType:"json",async:!0,backend:0})},this.updateNewMessages=function(e){o.properties.new_msgs={count_new:e.count_new,messages:{}};var r={max_id:e.max_id,min_id:e.min_id,msg:e.messages};return t.setShoutboxMessages(r),o.properties.new_msgs.messages&&delete o.properties.new_msgs.messages,t.renderMessages(o.shoutbox_messages.msg,"replace"),o.setCounterNewMessages(),this},this.setCounterNewMessages=function(){return t.counter_to&&clearTimeout(t.counter_to),t.msg_chat_obj.scrollTop()<55?(t.counter_new_messages_obj.text(""),o.properties.count_newm=0,void t.btn_in_top_obj.hide()):(t.counter_to=setTimeout((function(){o.setCounterNewMessages()}),500),this)},t.setShoutboxMessages=function(e){o.shoutbox_messages?(o.shoutbox_messages.max_id<e.max_id&&(o.shoutbox_messages.max_id=e.max_id),o.shoutbox_messages.min_id>e.min_id&&(o.shoutbox_messages.min_id=e.min_id)):o.shoutbox_messages={min_id:e.min_id,max_id:e.max_id,msg:[]};for(var t=0;t<e.msg.length;t++){var r=parseInt(e.msg[t].id);o.shoutbox_messages.msg[r]=e.msg[t]}},t.renderMessages=function(e,r){for(var i in"replace_old"==r&&e.reverse(),e)if(e.hasOwnProperty(i)&&void 0!==e[i].user_info&&!$("#shoutbox_msg_"+e[i].id).length){var n;n=e[i].user_info.nickname?e[i].user_info.nickname:e[i].user_info.output_name;var s=$('<div id="shoutbox_msg_'+e[i].id+'" data-msg-id="'+e[i].id+'" class="shoutbox-contact box-sizing"><div class="shoutbox-contact__image"><a data-action="set_user_ids" data-gid="shoutbox" data-href="'+e[i].user_info.link+'" href="#"><img src="'+e[i].user_info.media.user_logo.thumbs.small+'"></a></div><div class="shoutbox-contact__info"><div class="shoutbox_msg_header"><span class="shoutbox_user_name">'+n+'</span><span class="date">, '+e[i].date_str+'</span></div><div class="shoutbox_msg_body">'+e[i].message+"</div></div></div>");"replace_old"==r?$(s).appendTo(t.msg_chat_obj):$(s).prependTo(t.msg_chat_obj),"replace_old"!=r&&"init"!=r&&"replace_my"!=r&&($(s).addClass("new-msg").animate({backgroundColor:"#FFFFFF"},{duration:2e3,complete:function(){$(s).removeClass("new-msg").removeAttr("style")}}),t.msg_chat_obj.scrollTop(t.msg_chat_obj.scrollTop()+$(s).height()+5),o.properties.count_newm=o.properties.count_newm+1,0!=o.properties.count_newm&&t.counter_new_messages_obj.text("("+o.properties.count_newm+")"),o.initScroll())}return"replace_old"!=r&&"init"!=r&&"replace_my"!=r?t.msg_chat_obj.scrollTop()>55?(t.btn_in_top_obj.show(),setTimeout((function(){t.btn_in_top_obj.hide()}),6e3)):(t.msg_chat_obj.scrollTop(0),t.counter_new_messages_obj.text(""),o.properties.count_newm=0):"replace_my"==r&&(t.msg_chat_obj.scrollTop(0),t.counter_new_messages_obj.text(""),o.properties.count_newm=0,o.initScroll()),o.updateCountMessages(o.properties.count_newm),this},t.initDomObjects=function(){return t.shoutboxPanelObj=$(o.properties.shoutboxPanel),t.shoutboxBlockObj=$(o.properties.shoutboxBlock),t.shoutboxBtnObj=$(o.properties.shoutboxBtn),t.shoutboxCloseObj=$(o.properties.shoutboxClose),t.shoutbox_obj=$("#"+o.properties.id),t.msg_textarea_obj=t.shoutbox_obj.find(".shoutbox-bottom textarea"),t.msg_chat_obj=t.shoutbox_obj.find(".shoutbox-content .shoutbox-scroller"),t.msg_btns_obj=$("#"+o.properties.shoutbox_msg_btns_id),t.counter_new_messages_obj=$("#shoutbox_counter_nm"),t.btn_in_top_obj=t.shoutbox_obj.find(".shoutbox-in-top"),t.shoutboxPanelObj.off("click",o.properties.shoutboxClose).on("click",o.properties.shoutboxClose,(function(){o.hideShoutbox()})),t.shoutboxPanelObj.off("click",o.properties.shoutboxBtn).on("click",o.properties.shoutboxBtn,(function(){o.showShoutbox()})),t.btn_in_top_obj.off("click").on("click",(function(){t.msg_chat_obj.scrollTop(0),t.counter_new_messages_obj.text(""),o.properties.count_newm=0,t.btn_in_top_obj.hide(),$(".slimScrollBar").css("top",0)})),t.msg_chat_obj.off("click",".shoutbox_user_name").on("click",".shoutbox_user_name",(function(){t.msg_textarea_obj.val(t.msg_textarea_obj.val()+$(this).text()+", "),t.msg_textarea_obj.trigger("keyup")})),t.msg_textarea_obj.off("keydown").on("keydown",(function(e){e.ctrlKey&&13===e.keyCode&&o.sendMessage()})).off("keyup blur").on("keyup blur",(function(){var e=$(this).val().length;e>o.properties.msg_max_length&&$(this).val($(this).val().substring(0,o.properties.msg_max_length)).scrollTop(1e3),e=$(this).val().length,$("#"+o.properties.id+"_msg_count").text(o.properties.msg_max_length-e)})),$(document).off("click","[data-id=shoutbox_panel-bottom]").on("click","[data-id=shoutbox_panel-bottom]",(function(){o.createMobileBlock()})).off("click",'input[name="sendbtn"]').on("click",'input[name="sendbtn"]',(function(){o.sendMessage(),t.msg_textarea_obj.focus()})),t.shoutbox_obj.show(),o.properties.is_dom_init=!0,this},t.initMultiRequest=function(){var e=[{gid:"shoutbox_new_msgs",params:{module:"shoutbox",model:"ShoutboxModel",method:"backendCheckNewMessages",max_id:t.getMaxId},paramsFunc:function(){return{}},callback:function(e){e&&o.updateNewMessages(e)},period:3,status:1}];return MultiRequest.initActions(e),this},t.getMaxId=function(){var e=0;return o.shoutbox_messages&&(e=o.shoutbox_messages.max_id),e},t.getMinId=function(){var e=0;return o.shoutbox_messages&&(e=o.shoutbox_messages.min_id),e},t.trimStr=function(e){return(e=e.replace(/^\s+/g,"")).replace(/\s+$/g,"")},this.showShoutbox=function(){return t.shoutboxBtnObj.hide(),t.shoutboxBlockObj.removeClass("hide").fadeIn(),o.properties.is_opened=!0,!1===o.properties.isFirstOpening&&o.firstOpeningShoutBox(),$(".shoutbox-msg-window__textarea").focus(),this},this.hideShoutbox=function(){return t.shoutboxBlockObj.hide(),t.shoutboxBtnObj.fadeIn(),o.properties.is_opened=!1,this},this.createMobileBlock=function(){return width=$(window).width(),width<768?(t.shoutboxPanelObj.appendTo(o.properties.shoutboxPanelBottom),$(o.properties.shoutboxMobileBlock).parent("div").show(),o.showShoutbox()):$(o.properties.shoutboxPanelBottom).find("div").length&&(t.shoutboxPanelObj.prependTo(o.properties.bottomBtns),o.hideShoutbox()),this},this.updateCountMessages=function(e){return e>0?$(".mobile-top-menu").find("[data-mblock-id=shoutbox_panel-bottom]").html('<span class="badge">'+e+"</span>"):$(".mobile-top-menu").find("[data-mblock-id=shoutbox_panel-bottom]").html(""),this},this.scrollToShoutbox=function(){return $(window).width()<768&&$("html, body").animate({scrollTop:$(o.properties.shoutboxMobileBlock).offset().top},800),this},o.init(e),this})},314:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Spam=function(e){this.properties={siteUrl:"",mark_as_spam_btn:"mark_as_spam",mark_as_spam_link:"mark_as_spam",use_form:!1,is_send:!1,error_is_send:"spam_form",cFormId:"spam_form",urlGetForm:"spam/ajax_get_form/",urlSendForm:"spam/ajax_mark_as_spam/",id_close:"close_btn",isOwner:!1,markAsSpamId:"",contentObj:new loadingContent({loadBlockWidth:"544px",closeBtnClass:"load_content_close w",closeBtnPadding:5}),errorObj:new Errors};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$("#"+t.properties.mark_as_spam_btn).unbind("click").on("click",(function(e){e.preventDefault();var o=$(this).attr("data-type"),r=$(this).attr("data-id"),i={object_id:r,type_gid:o,is_owner:t.properties.isOwner?1:0};t.properties.use_form?t.properties.is_send?t.properties.errorObj.show_error_block(t.properties.error_is_send,"error"):t.get_form(i,o,r):t.send_form(i,o,r)})).show()},this.get_form=function(e,o,r){return o=o||"",r=r||"",t.properties.is_send?t.properties.errorObj.show_error_block(t.properties.error_is_send,"error"):$.ajax({url:t.properties.siteUrl+t.properties.urlGetForm,type:"POST",data:e,cache:!1,success:function(e){e?"is_send"==e?t.properties.errorObj.show_error_block(t.properties.error_is_send,"error"):(t.properties.contentObj.unsetLoadedBlock(),t.properties.contentObj.show_load_block(e),$("#"+t.properties.id_close).unbind().on("click",(function(e){e.preventDefault(),t.clearBox(o,r)}))):(t.properties.use_form=!1,t.send_form(e,o,r))}}),!1},this.send_form=function(e,o,r){return o=o||"",r=r||"",$.ajax({url:t.properties.siteUrl+t.properties.urlSendForm,type:"POST",data:e,dataType:"json",cache:!1,success:function(e){if(void 0!==e.error&&""!=e.error)t.properties.errorObj.show_error_block(e.error,"error");else{t.properties.is_send=!0,t.properties.errorObj.show_error_block(e.success,"success"),t.properties.contentObj.hide_load_block();var i=$("#"+t.properties.mark_as_spam_btn),n=i.find("ins"),s=i.find("a");n.length?(n.addClass("g"),"media_object"==o&&$("#"+o+"_"+r).addClass("g")):s.length?s.addClass("link-inactive"):($(t.properties.markAsSpamId).hide(),t.properties.mark_as_spam_link&&$("#"+t.properties.mark_as_spam_link).remove())}}}),!1},this.clearBox=function(e,o){var r=$("#"+t.properties.cFormId).serialize();t.send_form(r,e,o)},t.Init(e)})},9653:()=>{},6854:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.storeBanners=function(e){this.properties={banner_path:"https://www.datingpro.com/banners_dating_free_package/",banner_block_class:"homepage-banners",lang_code:"en",langs:{},common_ancestor:"body"};var t=this,o=["custom","design","modules","packages"],r={custom:{all:"https://www.pilotgroup.net/"},design:{all:"https://www.pilotgroup.net/"},modules:{all:"https://marketplace.datingpro.com/",ru:"https://marketplace.datingsoftware.ru/"},packages:{all:"https://marketplace.datingpro.com/information/pricing/"}};this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_controls(),t.loadBanner()},this.uninit=function(){return $(t.properties.common_ancestor).off("click","."+t.properties.banner_block_class),this},this.init_controls=function(){$(t.properties.common_ancestor).off("click","."+t.properties.banner_block_class).on("click","."+t.properties.banner_block_class,(function(){t.goToUrl($(this).data("url"))}))},this.loadBanner=function(){var e=Math.floor(Math.random()*o.length),r=t.bannersObject(o[e]);$(".homepage_block").siblings("h1").before(r)},this.bannersObject=function(e){var o="",r=t.bannerReturnUrl(e);return o+='<div class="'+t.properties.banner_block_class+'" data-url="'+r+'">',o+='<img src="'+t.properties.banner_path+e+'.jpg" >',o+='<div class="text-block '+e+'">',o+='<div class="header oh">'+t.properties.langs[e].header+"</div>",o+='<div class="description">'+t.properties.langs[e].description+"</div>",o+='<div class="button">'+t.properties.langs[e].button+"</div>",(o+="</div>")+"</div>"},this.bannerReturnUrl=function(e){var o=r[e].all;return void 0!==r[e][t.properties.lang_code]&&(o=r[e][t.properties.lang_code]),o},this.goToUrl=function(e){window.open(e)},t.Init(e)})},5818:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.langInlineEditor=function(e){this.properties={siteUrl:"",formUrl:"admin/start/lang_inline_editor/",contentObj:new loadingContent,idCloseBtn:"lie_close",idSaveBtn:"lie_save",multiple:0};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.reload_buttons()},this.reload_buttons=function(){$("[lang-editor=button]").each((function(){$(this).unbind().on("click",(function(){return t.load_editor($(this).attr("lang-editor-type"),$(this).attr("lang-field-type"),$(this)),!1}))}))},this.load_editor=function(e,o,r){var i={};1==t.properties.multiple?r.parent().find('input[lang-editor-type="'+e+'"][lang-editor="value"], textarea[lang-editor-type="'+e+'"][lang-editor="value"]').each((function(){i[$(this).attr("lang-editor-lid")]=$(this).val()})):$('input[lang-editor-type="'+e+'"][lang-editor="value"], textarea[lang-editor-type="'+e+'"][lang-editor="value"]').each((function(){i[$(this).attr("lang-editor-lid")]=$(this).val()})),$.ajax({url:t.properties.siteUrl+t.properties.formUrl+(t.properties.textarea||"textarea"===o?1:0),type:"GET",success:function(o){var n=$("<div></div>").append(o);n.find('input[lang-editor="redactor"], textarea[lang-editor="redactor"]').each((function(){$(this).val(i[$(this).attr("lang-id")])})),t.properties.contentObj.show_load_block(n),$("#"+t.properties.idCloseBtn).unbind().on("click",(function(){return t.properties.contentObj.hide_load_block(),!1})),$("#"+t.properties.idSaveBtn).unbind().on("click",(function(){return t.save_editor(e,r),!1}))}})},this.save_editor=function(e,o){var r={};$('input[lang-editor="redactor"], textarea[lang-editor="redactor"]').each((function(){r[$(this).attr("lang-id")]=$(this).val()})),1==t.properties.multiple?o.parent().find('input[lang-editor-type="'+e+'"][lang-editor="value"], textarea[lang-editor-type="'+e+'"][lang-editor="value"]').each((function(){$(this).val(r[$(this).attr("lang-editor-lid")])})):$('input[lang-editor-type="'+e+'"][lang-editor="value"], textarea[lang-editor-type="'+e+'"][lang-editor="value"]').each((function(){$(this).val(r[$(this).attr("lang-editor-lid")])})),t.properties.contentObj.hide_load_block()},t.Init(e)})},2853:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.checkBox=function(e){this.properties={labelClass:"label",boxClass:"box",checkedClass:"checked",hoveredClass:"hovered",elementsIDs:[]};var t=this;this.Init=function(e){for(var o in t.properties=$.extend(t.properties,e),t.properties.elementsIDs)t.initBox(t.properties.elementsIDs[o])},this.initBox=function(e){$("#"+e+"_cbox").length<1||($("#"+e+"_cbox ."+t.properties.labelClass+", #"+e+"_cbox ."+t.properties.boxClass).unbind("click").on("click",(function(){var o=$(this).attr("gid");$("#"+e+"_cbox ."+t.properties.boxClass+"[gid="+o+"]."+t.properties.checkedClass).length>0?t.uncheckBox(e,o):t.checkBox(e,o)})),$("#"+e+"_cbox_check_all").unbind("click").on("click",(function(){t.checkBoxAll(e)})),$("#"+e+"_cbox_uncheck_all").unbind("click").on("click",(function(){t.uncheckBoxAll(e)})))},this.checkBox=function(e,o){$("#"+e+"_cbox ."+t.properties.boxClass+"[gid="+o+"]").addClass(t.properties.checkedClass),$("#"+e+"_cbox input[value="+o+"]").remove();var r=$("#"+e+"_cbox").attr("iname");r||(r=e);var i="";$("#"+e+"_cbox ."+t.properties.boxClass).length>1&&(i="[]"),$("#"+e+"_cbox").append('<input type="hidden" name="'+r+i+'" value="'+o+'">'),$("#"+e+"_cbox input[value="+o+"]:first").change()},this.uncheckBox=function(e,o){$("#"+e+"_cbox ."+t.properties.boxClass+"[gid="+o+"]").removeClass(t.properties.checkedClass),$("#"+e+"_cbox input[value="+o+"]:first").remove()},this.checkBoxAll=function(e){$("#"+e+"_cbox ."+t.properties.boxClass).each((function(){var o=$(this).attr("gid");t.checkBox(e,o)}))},this.uncheckBoxAll=function(e){$("#"+e+"_cbox ."+t.properties.boxClass).each((function(){var o=$(this).attr("gid");t.uncheckBox(e,o)}))},t.Init(e)})},8040:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.date_formats=function(e){var t=this;this.properties={siteUrl:""},this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.bind_events(),t.update_formats($(this))},this.bind_events=function(){$(".format").on("change",(function(){t.update_formats()})),$("#tpl").on("keyup",(function(){t.check_radio(),t.update_formats()})),$(".sample").on("click",(function(){$("#tpl").val($("#tpl").val()+$(this).html()),t.check_radio(),t.update_formats()}))},this.check_radio=function(){var e,t;$(".sample").each((function(){e=$(this).html().replace(/[\[\]]/g,""),"radio"===(t=$('[name="'+e+'"]')).attr("type")&&!t.is(":checked")&&$("#tpl").val().indexOf("["+e+"]")>0&&$('[name="'+e+'"]:first').attr("checked",!0)}))},this.update_formats=function(){var e=$("#date_format").serialize();$.ajax({type:"GET",url:t.properties.siteUrl+"/admin/start/ajax_get_example",data:e,success:function(e){$("#example").html(e)},error:function(){$("#example").html("error")}})},t.Init(e)})},735:(__unused_webpack_module,exports)=>{function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function guide(optionArr){var windowObj;this.properties={autoshow:!1,step:1,guide:{},labelOf:"of",labelSkip:"Skip",labelNext:"Next",labelBuy:"Buy",windowObjTitle:"",callbackShow:function(){}};var total=0,_self=this;this.Init=function(options){_self.properties=$.extend(_self.properties,options),_self.total=Object.keys(_self.properties.guide).length,_self.properties.autoshow&&_self.show(),$("#guide-btn").on("click",(function(e){e.preventDefault();var guide_item=_self.properties.guide[_self.properties.step];guide_item.selector&&$(guide_item.selector).removeAttr("style"),guide_item.reset&&eval(guide_item.reset),_self.properties.step==_self.total&&(_self.properties.step=1),_self.show()})),$(document).off("click","#guide-next").on("click","#guide-next",(function(e){e.preventDefault();var guide_item=_self.properties.guide[_self.properties.step];guide_item.selector&&$(guide_item.selector).removeAttr("style"),guide_item.reset&&eval(guide_item.reset),_self.properties.step++,_self.properties.step==_self.total&&sendAnalytics("dp_user_end_tutorial","tutorial","user"),_self.properties.step<=_self.total?_self.show():_self.windowObj&&($.get(site_url+"start/skip_guide"),_self.windowObj.hide_load_block())})),$(document).off("click","#guide-skip").on("click","#guide-skip",(function(e){e.preventDefault();var guide_item=_self.properties.guide[_self.properties.step];guide_item.selector&&$(guide_item.selector).removeAttr("style"),guide_item.reset&&eval(guide_item.reset),$.get(site_url+"start/skip_guide"),_self.windowObj&&(_self.windowObj.destroy(),_self.windowObj=null)}))},this.uninit=function(){_self.windowObj&&_self.windowObj.destroy()},this.show=function(){_self.windowObj&&_self.windowObj.destroy();var guide_item=_self.properties.guide[_self.properties.step];if(guide_item.page){if($.post(site_url+"start/save_guide",{step:_self.properties.step,page:guide_item.page},(function(e){site_url+guide_item.page!=location.href&&(!0===e.status?location.href=site_url+guide_item.page:location.href=site_url+_self.properties.guide[_self.properties.step+1].page)}),"json"),site_url+guide_item.page!=location.href)return}else $.post(site_url+"start/save_guide",{step:_self.properties.step,page:""},(function(){}));var options={otherClass:"guide_content col-sm-10 col-sm-offset-1 col-md-6 col-md-offset-3 col-lg-8 col-lg-offset-2",draggable:!0,blockBody:!1,closeBtnUse:!1,closeBtnID:"guide-skip",onClose:function onClose(){var guide_item=_self.properties.guide[_self.properties.step];guide_item.selector&&$(guide_item.selector).removeAttr("style"),guide_item.reset&&eval(guide_item.reset),$.get(site_url+"start/skip_guide")}},footerButtons='<button type="button" id="guide-skip" class="btn btn-default">'+_self.properties.labelSkip+"</button>";_self.properties.step<_self.total?footerButtons+='<button class="btn btn-success pull-right" type="button" id="guide-next" name="btn_next">'+_self.properties.labelNext+"</button>":footerButtons+='<a class="btn btn-success pull-right" href="https://marketplace.datingpro.com/information/pricing/" target="_blank">'+_self.properties.labelBuy+"</a>",_self.windowObj=new loadingContent(options);var block=_self.windowObj.show_load_block('<div id="guide-content" class="content-block load_content" style="display:table;width:100%;height:100%;table-layout:fixed;">  <div style="display:table-row;">    <h1 style="display:table-cell;">'+_self.properties.step+" "+_self.properties.labelOf+" "+_self.total+": "+guide_item.title+'</h1>  </div>  <div style="display:table-row;">    <div class="inside" style="display:table-cell;height:100%;">      <div style="position:relative;height:100%;">        <div style="top:0;left:0;bottom:0;right:0;overflow:auto;">'+guide_item.content+'</div>      </div>    </div>  </div>  <div style="display:table-row;">    <div class="inside" style="display:table-cell;padding-top:20px;">'+footerButtons+"</div>  </div></div>");$("#guide-content").parents(".load_content_bg").first().css("background","none"),$("#"+block).attr("style","position: absolute;padding: 0;left: 0; right: 0;margin: auto;max-width: 600px; top: 10%"),$("#"+block).removeClass("load_content_inner");var bg_block=block.replace("user_load_content","user_load_content_bg");$("#"+bg_block).addClass("guide_modal"),_self.callbackShow(),guide_item.selector&&$(guide_item.selector).attr("style",guide_item.attr),guide_item.function&&eval(guide_item.function)},this.callbackShow=function(){_self.properties.callbackShow()},_self.Init(optionArr)}"object"===_typeof(exports)&&(exports.__esModule=!0,exports.guide=guide)},7139:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.hlBox=function(e){this.properties={dataClass:"data",elementsIDs:[],force:!1};var t=this;this.Init=function(e){for(var o in t.properties=$.extend(t.properties,e),t.properties.elementsIDs)t.initBox(t.properties.elementsIDs[o]);return $(document).one("pjax:start",(function(e){t.uninit()})),this},this.uninit=function(){return t.clear(),$("body").unbind("click.hlBox"),this},this.clear=function(){for(var e in t.properties.elementsIDs)t.unsetBox(t.properties.elementsIDs[e]);return this},this.initBox=function(e){if($("#"+e+"_box").length&&!$("#"+e+"_box").data("init"))return $("#"+e+"_box").data("init","1"),t.setDefault(e),$("#"+e+"_box").find("li").off("click").on("click",(function(){t.toggleBox(e,$(this))})),this},this.unsetBox=function(e){return $("#"+e+"_box").removeAttr("hlb_init").off().find("li").off(),this},this.toggleBox=function(e,o){var r=$("#"+e+"_box").data("multiselect");return o.hasClass("active")?r&&t.unsetActiveBox(e,o):t.setActiveBox(e,o),this},this.setActiveBox=function(e,o){var r=$("#"+e+"_box").data("multiselect"),i=$("#"+e+"_box").data("input");r?i+="[]":$("#"+e+"_box").find("li.active").each((function(){t.unsetActiveBox(e,$(this))}));var n=o.data("value");return o.addClass("active"),$("#"+e+"_inputs").find('input[value="'+n+'"]').length||$("#"+e+"_inputs").append('<input type="hidden" name="'+i+'" value="'+n+'" />').find("input").change(),this},this.unsetActiveBox=function(e,t){$("#"+e+"_box").data("input");var o=t.data("value");return t.removeClass("active"),$("#"+e+"_inputs").find('input[value="'+o+'"]').remove(),this},this.setDefault=function(e){$("#"+e+"_box").data("multiselect");var r=$("#"+e+"_box").data("defaults");if($("#"+e+"_inputs").find("input").remove(),$("#"+e+"_box").find("li").removeClass("active"),"object"===o(r))for(var i in r)r.hasOwnProperty(i)&&t.setActiveBox(e,$("#"+e+'_box li[data-value="'+r[i]+'"]'));else t.setActiveBox(e,$("#"+e+'_box li[data-value="'+r+'"]'));return this},t.Init(e)})},5177:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.langInlineEditor=function(e){this.properties={siteUrl:"",formUrl:"start/lang_inline_editor/",contentObj:new loadingContent,idCloseBtn:"lie_close",idSaveBtn:"lie_save",textarea:!1};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.reload_buttons()},this.reload_buttons=function(){$("[lang-editor=button]").each((function(){$(this).unbind().on("click",(function(){return t.load_editor($(this).attr("lang-editor-type")),!1}))}))},this.load_editor=function(e){var o={};$('input[lang-editor-type="'+e+'"][lang-editor="value"], textarea[lang-editor-type="'+e+'"][lang-editor="value"]').each((function(){o[$(this).attr("lang-editor-lid")]=$(this).val()})),$.ajax({url:t.properties.siteUrl+t.properties.formUrl+(t.properties.textarea?1:0),type:"GET",success:function(r){var i=$("<div></div>").append(r);i.find('input[lang-editor="redactor"], textarea[lang-editor="redactor"]').each((function(){$(this).val(o[$(this).attr("lang-id")])})),t.properties.contentObj.show_load_block(i),$("#"+t.properties.idCloseBtn).unbind().on("click",(function(){return t.properties.contentObj.hide_load_block(),!1})),$("#"+t.properties.idSaveBtn).unbind().on("click",(function(){return t.save_editor(e),!1}))}})},this.save_editor=function(e){var o={};$('input[lang-editor="redactor"], textarea[lang-editor="redactor"]').each((function(){o[$(this).attr("lang-id")]=$(this).val()})),$('input[lang-editor-type="'+e+'"][lang-editor="value"], textarea[lang-editor-type="'+e+'"][lang-editor="value"]').each((function(){$(this).val(o[$(this).attr("lang-editor-lid")])})),t.properties.contentObj.hide_load_block()},t.Init(e)})},6075:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.options=function(e){this.properties={alertPleaseSelect:"Please select at least one option",allSelected:{},allText:"All",allValue:"all",bgBlock:{},bgBlockClass:"multiselect_bg",bgBlockId:"multiselect_bg",btnApply:{},btnApplySelector:".btn_apply",btnClose:{},btnCloseSelector:".close",btnOpen:{},btnOpenSelector:".options_open",btnSelectAll:{},btnSelectAllSelector:".btn_select_all",classSelected:"selected",clearTabOnChange:!0,fields:{},itemsList:{},itemsListSelector:".items .item",limitBlock:{},limitBlockSelector:".limit",limits:{},multiselectBlock:{},optionsBlock:{},optionsBlockSelector:".options",optionsBlockId:"",optionsSelectedItems:{},optionsSelectedItemsBlock:{},optionsSelectedItemsBlockSelector:".options-selected .options-selected-items",rand:"",selectedField:"",selectedItems:{},selectedItemsBlock:{},selectedItemsBlockSelector:".selected .selected-items",selectedLeft:0,selectedNum:0,siteUrl:"",tabsList:{},tabsListSelector:".tab"},this.errors={};var t=this,r=function(){return!0===t.properties.allSelected[t.properties.selectedField]},i=function(){t.closeForm(t.properties.selectedField)},n=function(){t.properties.limitBlock.hide()},s=function(){t.properties.limitBlock.show()},a=function(e){var o,r=$("<li>").attr({class:"remove-selected item "+t.properties.selectedField+"-selected-"+e,"data-value":e});return o=t.properties.allValue!==e?t.properties.fields[t.properties.selectedField].option[e]:t.properties.allText,r.html(o+'<i class="fa fa-times"></i>'),r},c=function(e){return $("<input>").attr({type:"hidden",value:e,name:t.properties.selectedField+"[]"})},p=function(e){if(d(e),!0===t.properties.allSelected[t.properties.selectedField]||e&&0===t.properties.selectedNum)l(t.properties.allValue,e);else for(var o in t.properties.selectedItems[t.properties.selectedField])l(o,e)},l=function(e,o){if(o=o||!1,t.properties.allValue===e){if(a(e).appendTo(t.properties.optionsSelectedItemsBlock),!0===o){for(var r in t.properties.fields[t.properties.selectedField].option)a(r).appendTo(t.properties.selectedItemsBlock);c(e).prependTo(t.properties.selectedItemsBlock)}}else a(e).appendTo(t.properties.optionsSelectedItemsBlock),!0===o&&(a(e).appendTo(t.properties.selectedItemsBlock),c(e).prependTo(t.properties.selectedItemsBlock))},d=function(e){e=e||!1,t.properties.optionsSelectedItemsBlock.html(""),!0===e&&t.properties.selectedItemsBlock.html("")},u=function(e,o){if(t.properties.selectedLeft<=0)return!1;t.properties.allSelected[t.properties.selectedField]&&_(),$("."+t.properties.selectedField+"-option-"+e).addClass(t.properties.classSelected),void 0===t.properties.selectedItems[t.properties.selectedField]&&(t.properties.selectedItems[t.properties.selectedField]={}),t.properties.selectedItems[t.properties.selectedField][e]=t.properties.fields[t.properties.selectedField].option[e],g(),l(e,o)},_=function(){d(!1),t.properties.allSelected[t.properties.selectedField]=!1,delete t.properties.selectedItems[t.properties.selectedField][t.properties.allValue]},f=function(){t.properties.selectedItems=[],d(!1),t.properties.itemsList.removeClass(t.properties.classSelected),g(),t.properties.allSelected[t.properties.selectedField]=!1},h=function(e){t.properties.itemsList.removeClass(t.properties.classSelected),d(!1),t.properties.allSelected[t.properties.selectedField]=!1,delete t.properties.selectedItems[t.properties.selectedField][t.properties.allValue],t.properties.allValue!==e&&u(e,!1),g(),s()},m=function(e,o){if(!0===t.properties.allSelected[t.properties.selectedField])return h(e),!1;delete t.properties.selectedItems[t.properties.selectedField][e],$("."+t.properties.selectedField+"-option-"+e).removeClass(t.properties.classSelected),g(),function(e,o){o=o||!1,t.properties.optionsSelectedItemsBlock.find("."+t.properties.selectedField+"-selected-"+e).remove(),!0===o&&t.properties.selectedItemsBlock.find("."+t.properties.selectedField+"-selected-"+e).remove()}(e,o)},g=function(){"object"===o(t.properties.selectedItems[t.properties.selectedField])?t.properties.selectedNum=Object.keys(t.properties.selectedItems[t.properties.selectedField]).length:t.properties.selectedNum=0;var e=t.properties.limits[t.properties.selectedField];return t.properties.selectedLeft=e-t.properties.selectedNum,t.properties.limitBlock.find(".selected_num").html(t.properties.selectedNum),t.properties.limitBlock.find(".max_num").html(e),t.properties.selectedLeft};this.Init=function(e){t.properties=$.extend(t.properties,e),function(){var e=t.properties.bgBlockId+"_"+t.properties.rand,o=$("<div>").attr({id:e,class:t.properties.bgBlockClass});$("body").append(o)}(),t.properties.multiselectBlock=$("#multiselect_"+t.properties.rand),t.properties.bgBlock=$("#"+t.properties.bgBlockId+"_"+t.properties.rand),t.properties.btnOpen=t.properties.multiselectBlock.find(t.properties.btnOpenSelector),t.properties.selectedItemsBlock=t.properties.multiselectBlock.find(t.properties.selectedItemsBlockSelector),t.properties.optionsBlock=t.properties.multiselectBlock.find(t.properties.optionsBlockSelector),t.properties.btnClose=t.properties.optionsBlock.find(t.properties.btnCloseSelector),t.properties.btnApply=t.properties.multiselectBlock.find(t.properties.btnApplySelector),t.properties.btnSelectAll=t.properties.multiselectBlock.find(t.properties.btnSelectAllSelector),t.properties.tabsList=t.properties.optionsBlock.find(t.properties.tabsListSelector),t.properties.itemsList=t.properties.optionsBlock.find(t.properties.itemsListSelector),t.properties.optionsSelectedItemsBlock=t.properties.optionsBlock.find(t.properties.optionsSelectedItemsBlockSelector),t.properties.limitBlock=t.properties.optionsBlock.find(t.properties.limitBlockSelector),t.properties.btnOpen.on("click",(function(){t.openForm(t.properties.selectedField)})),t.properties.bgBlock.on("click",(function(){i()})),t.properties.btnClose.on("click",(function(){i()})),t.properties.tabsList.on("click",(function(){!function(e){var o=t.properties.optionsBlock.find(".tab_"+e);if(o.hasClass("active"))return!1;t.properties.clearTabOnChange&&f(),t.properties.selectedField=e,t.properties.tabsList.removeClass("active"),o.addClass("active"),t.properties.optionsBlock.find(".tab-content").hide(),t.properties.optionsBlock.find(".options_"+e).show(),g(),p(!1),!0===t.properties.allSelected[t.properties.selectedField]?n():s()}($(this).data("tab"))})),t.properties.btnApply.on("click",(function(){if(!(Object.keys(t.properties.selectedItems[t.properties.selectedField]).length||r()?(p(!0),1):(alert(t.properties.alertCantSaveEmpty),0)))return!1;t.closeForm()})),t.properties.btnSelectAll.on("click",(function(){r()?h(t.properties.allValue):(t.properties.selectedItems=[],d(!1),t.properties.itemsList.addClass(t.properties.classSelected),g(),n(),u(t.properties.allValue),t.properties.allSelected[t.properties.selectedField]=!0)})),t.properties.multiselectBlock.on("click",".remove-selected",(function(){m($(this).data("value"),!1)})),t.properties.itemsList.on("selectstart mousedown",(function(){return!1})),t.properties.itemsList.on("click",(function(){$(this).hasClass(t.properties.classSelected)?m($(this).data("value"),!1):u($(this).data("value"),!1)})),t.properties.selectedItemsBlock.on("click",(function(){"nowrap"===$(this).css("white-space")?$(this).css("white-space","inherit"):$(this).css("white-space","nowrap")})),g(),function(){for(var e in t.properties.fields)void 0===t.properties.allSelected[e]&&(t.properties.allSelected[e]=!1),void 0===t.properties.selectedItems[e]&&(t.properties.selectedItems[e]=[])}()},this.openForm=function(){$("body").addClass("modal-open"),t.properties.bgBlock.show(),t.properties.optionsBlock.show(),g()},this.closeForm=function(){$("body").removeClass("modal-open"),t.properties.multiselectBlock.find(".header").html(t.properties.fields[t.properties.selectedField].header),t.properties.optionsBlock.hide(),t.properties.bgBlock.hide()},t.Init(e)})},3156:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.radio=function(e){this.properties={labelClass:"label",boxClass:"box",checkedClass:"checked",hoveredClass:"hovered",elementsIDs:[]};var t=this;this.Init=function(e){for(var o in t.properties=$.extend(t.properties,e),t.properties.elementsIDs)t.initBox(t.properties.elementsIDs[o])},this.initBox=function(e){$("#"+e).length<1||($("#"+e+" ."+t.properties.labelClass+", #"+e+" ."+t.properties.boxClass).unbind("mouseenter").on("mouseenter",(function(){var o=$(this).attr("gid");$("#"+e+" ."+t.properties.boxClass+"[gid="+o+"]").addClass(t.properties.hoveredClass)})).unbind("mouseleave").on("mouseleave",(function(){var o=$(this).attr("gid");$("#"+e+" ."+t.properties.boxClass+"[gid="+o+"]").removeClass(t.properties.hoveredClass)})),$("#"+e+" ."+t.properties.labelClass+", #"+e+" ."+t.properties.boxClass).unbind("click").on("click",(function(){var o=$(this).attr("gid");t.checkBox(e,o)})))},this.checkBox=function(e,o){t.uncheckBoxAll(e),$("#"+e+" ."+t.properties.boxClass+"[gid="+o+"]").addClass(t.properties.checkedClass),$("#"+e+" input[value="+o+"]").remove();var r=$("#"+e).attr("iname");r||(r=e),$("#"+e).append('<input type="hidden" name="'+r+'" value="'+o+'">'),$("#"+e+" input[value="+o+"]:first").change()},this.uncheckBox=function(e,o){$("#"+e+" ."+t.properties.boxClass+"[gid="+o+"]").removeClass(t.properties.checkedClass),$("#"+e+" input[value="+o+"]:first").remove()},this.uncheckBoxAll=function(e){$("#"+e+" ."+t.properties.boxClass).each((function(){var o=$(this).attr("gid");t.uncheckBox(e,o)}))},t.Init(e)})},3694:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.search=function(e){this.properties={siteUrl:"",currentForm:"user",slideSteps:2,slideCurrentStep:1,currentFormType:"line",selects:[],multiselects:[],checkboxes:[],radios:[],hlboxes:[],selectObject:{},checkboxObject:{},hlboxObject:{},multiselectObject:{},radioObject:{},userFormUrl:"users/ajax_search_form",userSearchUrl:"users/ajax_search",userCountUrl:"users/ajax_search_counts/advanced",check_counts:!0,resultsBlockId:{user:"main_users_results"},preloadInterval:1e3,preloadUTS:0,preloadTID:!1,errorObj:new Errors,resultPopupTO:5e3,resultPopupObjTO:null,preloadResultsObjTO:null,preloader:null,popup_autoposition:!1,hide_popup:!1,view_type:null};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.formId=t.properties.currentForm+"_"+t.properties.currentFormType,t.init_tabs(),t.properties.view_type,t.init_form(t.properties.currentForm),t.init_result_popup()},this.init_tabs=function(){$("#resume-form-tab").on("click",(function(){return t.properties.currentForm="resume",t.load_form(t.properties.currentForm),!1})),$("#vacancy-form-tab").on("click",(function(){return t.properties.currentForm="vacancy",t.load_form(t.properties.currentForm),!1}))},this.load_form=function(e){var o=t.properties.siteUrl+t.properties.userFormUrl;$.ajax({url:o,type:"GET",cache:!1,success:function(o){t.properties.selectObject.clear(),$("#search-form-block_"+t.properties.formId).html(o),t.init_form(e)}})},this.init_result_popup=function(e){$("#result_popup_"+t.properties.formId).length||($("#search-form-block_"+t.properties.formId).append('<div id="result_popup_'+t.properties.formId+'" class="result-popup"></div>'),$(document).on("mouseover","#result_popup_"+t.properties.formId,(function(){t.properties.resultPopupObjTO&&clearTimeout(t.properties.resultPopupObjTO)})).on("mouseout","#result_popup_"+t.properties.formId,(function(){t.properties.resultPopupObjTO=setTimeout((function(){$("#result_popup_"+t.properties.formId).hide()}),t.properties.resultPopupTO)})))},this.init_form=function(e){$("#vacancy-form-tab, #resume-form-tab").removeClass("active"),$("#"+e+"-form-tab").addClass("active"),t.properties.selectObject=new selectBox({elementsIDs:selects,force:!0}),"undefined"!=typeof multiselects&&(t.properties.multiselectObject=new selectBox({elementsIDs:multiselects,force:!0})),t.properties.checkboxObject=new checkBox({elementsIDs:checkboxes,force:!0}),t.properties.hlboxObject=new hlBox({elementsIDs:hlboxes,force:!0}),"undefined"!=typeof radios&&(t.properties.radioObject=new radio({elementsIDs:radios,force:!0})),t.properties.slideSteps=1,t.properties.slideCurrentStep=1,$("#line-search-form_"+t.properties.formId).length>0&&(t.properties.currentFormType="line"),$("#short-search-form_"+t.properties.formId).length>0&&(t.properties.currentFormType="short"),$("#full-search-form_"+t.properties.formId).length>0&&(t.properties.slideSteps=2,$("#full-search-form_"+t.properties.formId).is(":visible")&&(t.properties.currentFormType="full",t.properties.slideCurrentStep=2)),"line"!==t.properties.currentFormType&&t.properties.check_counts&&$("#search-form-block_"+t.properties.formId).on("change","input[type=text], input[type=hidden], input[type=checkbox]",(function(){var e="hidden"===$(this).attr("type")?$(this).next().hasClass("selectBox")?$(this).next().position().top:$(this).parent().position().top:$(this).position().top,o="hidden"===$(this).attr("type")?$(this).next().hasClass("selectBox")?$(this).next().position().top+$(this).next().outerHeight():$(this).parent().position().top+$(this).parent().outerHeight():$(this).position().top+$(this).outerHeight(),r=$(this).parent().position().left,i=$(this).parent().width()+$(this).parent().position().left+parseInt($(this).parent().css("margin-left"));clearTimeout(t.properties.preloadResultsObjTO),t.properties.preloadResultsObjTO=setTimeout((function(){t.preload_results(e,r,i,o)}),250)})).on("remove","input[type=hidden]",(function(){var e=$(this).parent().position().top,o=$(this).parent().position().top+$(this).parent().outerHeight(),r=$(this).parent().position().left,i=$(this).parent().width()+$(this).parent().position().left+parseInt($(this).parent().css("margin-left"));$(this).removeAttr("name"),clearTimeout(t.properties.preloadResultsObjTO),t.properties.preloadResultsObjTO=setTimeout((function(){t.preload_results(e,r,i,o)}),250)})),"line"===t.properties.currentFormType?$("#more-options-link_"+t.properties.formId).on("click",(function(){return t.load_form(t.properties.currentForm),!1})):($("#more-options-link_"+t.properties.formId+", #less-options-link_"+t.properties.formId).hide(),$("#more-options-link_"+t.properties.formId+", #less-options-link_"+t.properties.formId).on("click",(function(){return t.slide_form(),!1})),t.properties.slideSteps>1&&t.properties.slideCurrentStep===t.properties.slideSteps?$("#less-options-link_"+t.properties.formId).show():t.properties.slideSteps>1&&$("#more-options-link_"+t.properties.formId).show()),"line"!==t.properties.currentFormType&&$("#main_search_button_"+t.properties.formId).unbind().on("click",(function(){var o=t.properties.resultsBlockId[e];if($("#"+o).length>0)return t.load_results(),!1}))},this.slide_form=function(){$(".button-search_block>div"),t.properties.slideSteps>1&&t.properties.slideCurrentStep===t.properties.slideSteps?($("#less-options-link_"+t.properties.formId).hide(),$("#more-options-link_"+t.properties.formId).show(),$("#advanced-search-form_"+t.properties.formId+", #full-search-form_"+t.properties.formId).stop(!0).removeClass("hide").slideUp(150),$("#result_popup_"+t.properties.formId).hide(),$(".button-search_block").html($(".bottom-serch-btn-js>")),t.properties.slideCurrentStep=1):t.properties.slideSteps>1&&(1===t.properties.slideCurrentStep?$("#full-search-form_"+t.properties.formId).stop(!0).removeClass("hide").slideDown(150):2===t.properties.slideCurrentStep&&$("#advanced-search-form_"+t.properties.formId).stop(!0).removeClass("hide").slideDown(150),t.properties.slideCurrentStep++,t.properties.slideCurrentStep===t.properties.slideSteps&&($("#more-options-link_"+t.properties.formId).hide(),$("#less-options-link_"+t.properties.formId).show()),$(".bottom-serch-btn-js").html($(".button-search_block>div")))},this.load_results=function(){var e=t.properties.siteUrl+t.properties.userSearchUrl;$.ajax({url:e,type:"POST",data:$("#main_search_form_"+t.properties.formId).serialize(),cache:!1,success:function(e){var r=t.properties.resultsBlockId[t.properties.currentForm];$("#"+r).html(e),"object"===("undefined"==typeof users_list?"undefined":o(users_list))&&"function"==typeof users_list.init_links&&(users_list.init_links(),users_list.properties.formCallback())}})},this.preload_results=function(e,o,r,i){if(!t.properties.hide_popup){var n=new Date;if(0!==t.properties.preloadUTS&&n.getTime()-t.properties.preloadUTS<t.properties.preloadInterval)!1===t.properties.preloadTID&&(t.properties.preloadTID=setTimeout((function(){t.preload_results(e,o,r)}),t.properties.preloadInterval));else{t.properties.preloadTID=!1,t.properties.preloadUTS=n.getTime();var s=t.properties.siteUrl+t.properties.userCountUrl;$.ajax({url:s,type:"POST",data:$("#main_search_form_"+t.properties.formId).serialize(),cache:!1,dataType:"json",success:function(i){t.properties.resultPopupObjTO&&clearTimeout(t.properties.resultPopupObjTO);var n='<a href="javascript:;" onclick="$(\'#main_search_button_'+t.properties.formId+"').click(); $(this).parent().hide();\">"+i.string+"</a>",s=e-$("#result_popup_"+t.properties.formId).outerHeight()-6,a=e+$("#result_popup_"+t.properties.formId).outerHeight(),c=s;if(t.properties.popup_autoposition&&(s<0?($("#result_popup_"+t.properties.formId).addClass("on-bottom"),c=a):$("#result_popup_"+t.properties.formId).removeClass("on-bottom")),$("#result_popup_"+t.properties.formId).hide().html(n).css({top:c+"px"}).show(),"rtl"===window.site_rtl_settings){var p=$("#result_popup_"+t.properties.formId).parent().width();$("#result_popup_"+t.properties.formId).css("right",p-r+"px")}else $("#result_popup_"+t.properties.formId).css("left",o+"px");t.properties.resultPopupObjTO=setTimeout((function(){$("#result_popup_"+t.properties.formId).hide()}),t.properties.resultPopupTO),$("#search-preresult_"+t.properties.formId).html(i.string)},complete:function(){}})}}},t.Init(e)})},697:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.selectBox=function(e){this.properties={labelClass:"label",arrowClass:"arrow",dropdownClass:"dropdown",dropdownAutosize:!1,dropdownRight:!1,dataClass:"data",elementsIDs:[],force:!1};var t=this;this.Init=function(e){for(var o in t.properties=$.extend(t.properties,e),t.properties.force&&t.clear(),t.properties.elementsIDs)t.initBox(t.properties.elementsIDs[o]);$(document).one("pjax:start",(function(e){t.uninit()}))},this.uninit=function(){t.clear(),$("body").find("#select_box_bg").remove(),$(window).off("resize.selectBox"),$("body").unbind("click.selectBox")},this.initBg=function(){$("body").find("#select_box_bg").length||($("body").append('<div id="select_box_bg"></div>'),$("#select_box_bg").css({display:"none",position:"fixed","z-index":"98999",left:"0",top:"0",width:"100%",height:"100%"}))},this.clear=function(){for(var e in t.properties.elementsIDs)t.unsetBox(t.properties.elementsIDs[e])},this.expandBg=function(e){$("#select_box_bg").show().unbind("click").on("click",(function(){t.closeBox(e)}))},this.collapseBg=function(){$("#select_box_bg").hide().unbind()},this.initBox=function(e){$("#"+e+"_box").length<1||$("#"+e+'_box[sb_init="1"]').length||($("#"+e+"_box").attr("sb_init","1"),t.createDropDown(e),$("#"+e+"_box, #"+e+"_dropdown").unbind("click").on("click",(function(o){$("#"+e+"_dropdown").is(":visible")?t.closeBox(e):(o.cancelBubble=!0,o.stopPropagation&&o.stopPropagation(),t.openBox(e))})),t.setDefault(e),$("#"+e+"_dropdown").on("click","li",(function(){t.setActiveBox(e,$(this))})),$(window).on("resize.selectBox",(function(){$("#"+e+"_dropdown").is(":visible")&&t.resetDropDown(e)})))},this.unsetBox=function(e){$("#"+e+"_box").removeAttr("sb_init").unbind("click").off("click"),$("#"+e+"_dropdown").unbind("click").off("click").off("click","li").remove()},this.openBox=function(e){for(var o in t.expandBg(e),t.properties.elementsIDs)$("#"+t.properties.elementsIDs[o]+"_dropdown").is(":visible")&&t.closeBox(t.properties.elementsIDs[o]);t.resetDropDown(e),$("#"+e+"_dropdown").slideDown(100,(function(){var e=$(this).find("li.active").position().top-$(this).find("ul").position().top-($(this).height()/2-$(this).find("li.active").outerHeight()/2);$(this).scrollTop(e)})),$("body").unbind("click.selectBox").on("click.selectBox",(function(o){t.closeBox(e)}))},this.createDropDown=function(e){var o=$("#"+e+"_box ."+t.properties.dataClass).html();$("body").append('<div class="'+t.properties.dropdownClass+'" id="'+e+'_dropdown">'+o+"</div>"),t.resetDropDown(e)},this.resetDropDown=function(e){var o=$("#"+e+"_box").offset().top+$("#"+e+"_box .label").outerHeight(),r=$("#"+e+"_box").width();if(t.properties.dropdownAutosize){$("#"+e+"_dropdown").css({display:"block",visibility:"hidden"});var i=0,n=$("#"+e+"_dropdown").find("li:first"),s=n.outerWidth()-n.width();$("#"+e+"_dropdown").find("li span").each((function(){$(this).width()+s>i&&(i=$(this).width()+s)})),i>r&&(r=i)}var a=$("#"+e+"_box").offset().left+"px";t.properties.dropdownRight&&(a=$("#"+e+"_box").offset().left+$("#"+e+"_box").width()-r+"px"),$("#"+e+"_dropdown").css({width:r+"px",left:a,top:o+"px",display:"none",visibility:"visible"})},this.closeBox=function(e){$("body").unbind("click.selectBox"),t.collapseBg(),$("#"+e+"_dropdown").stop(!0).slideUp(100)},this.setActiveBox=function(e,o){$("#"+e+"_dropdown li").removeClass("active"),o.addClass("active"),$("#"+e+"_box ."+t.properties.labelClass).html(o.text()),$("#"+e).val(o.attr("gid")).change()},this.resetValues=function(e,o,r){r||(r=$("#"+e).val());var i=!1;if($("#"+e+'_dropdown > ul > li[gid!=""]').remove(),o)for(var n in o)$("#"+e+"_dropdown ul").append('<li gid="'+n+'">'+o[n]+"</li>"),o[n].id==r&&(t.setActiveBox(e,$("#"+e+'_dropdown li[gid="'+n+'"]')),i=!0);0!=r&&i||t.setDefault(e)},this.setDefault=function(e){var o=$("#"+e).val();o||(o=$("#"+e+"_dropdown > ul > li:first").attr("gid")),t.setActiveBox(e,$("#"+e+'_dropdown li[gid="'+o+'"]'))},t.Init(e)})},7536:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.StatisticsAdmin=function(e){this.properties={siteUrl:"/"};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e)},t.Init(options)})},2229:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Statistics=function(e){this.properties={siteUrl:"/"};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e)},t.Init(e)})},3403:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.AdminStore=function(e){this.properties={siteUrl:"",inputPrice:'input[name^="price"]'},this.Init=function(e){},this.formatPrice=function(e){e.value.match(/[^0-9]/g)&&(e.value=e.value.replace(/[^0-9.]/g,""),e.value=Math.ceil(e.value))},this.Init(e)})},6564:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.storeCart=function(e){this.properties={siteUrl:"/",langs:{add_cart_lang:"1",confirm_lang:"2",error_select:"3"},addProductButton:".add_product",quickViewButton:".quick_view_wrapper",selectOptions:".select-options",preorderButton:"#preorder",hoverBlock:".product_item",cartBlock:"#cart_block",loadCartBlock:"#load_cart_block",cartCount:"#cart_count",productCount:"#product_count",cartItem:"#cart_item_",cartItemCount:"#count_",cartItemStatus:"#status_",cartItemPrice:"#price_",cartTotal:"#cart_total",countUp:"#count_up",countDown:"#count_down",loadCart:"#load_cart",viewProduct:"#view_product",createPreorder:"#create_preorder",delItemCart:"#del_item_cart",actionBlock:"#action_block",option:"#option_",itemId:"#item_",cartItems:"#cart_items",goShoppingCart:".go_shopping_cart",commonAncestor:"body",addProductUrl:"store/ajax_add_to_cart/",loadCartUrl:"store/ajax_load_cart/",removeUrl:"store/ajax_remove_from_cart/",quickView:"store/ajax_quick_view/",createPreopderUrl:"store/preorder/",animate:!0,contentObj:new loadingContent({loadBlockWidth:"700px",loadBlockLeftType:"center",loadBlockTopType:"center",loadBlockTopPoint:100,closeBtnClass:"w"}),currency_output:!1};var t=this,o=!0;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_controls()},this.uninit=function(){return $(t.properties.commonAncestor).off("click",t.properties.loadCartBlock).off("click",t.properties.addProductButton).off("click",t.properties.quickViewButton).off("mouseenter",t.properties.hoverBlock).off("mouseleave",t.properties.hoverBlock).off("click",t.properties.countUp).off("click",t.properties.countDown).off("click",t.properties.delItemCart).off("click",t.properties.createPreorder).off("click",t.properties.preorderButton).off("click",t.properties.goShoppingCart).off("click",t.properties.selectOptions+" li"),this},this.init_controls=function(){$(t.properties.commonAncestor).off("click",t.properties.loadCartBlock).on("click",t.properties.loadCartBlock,(function(){t.loadCart()})).off("click",t.properties.addProductButton).on("click",t.properties.addProductButton,(function(){t.addToCart($(this))})).off("click",t.properties.quickViewButton).on("click",t.properties.quickViewButton,(function(){var e=$(this).data("idproduct");t.ajaxQuickView(e)})).off("mouseenter",t.properties.hoverBlock).on("mouseenter",t.properties.hoverBlock,(function(){$(this).addClass("product_item_hover")})).off("mouseleave",t.properties.hoverBlock).on("mouseleave",t.properties.hoverBlock,(function(){$(this).removeClass("product_item_hover")})).off("click",t.properties.countUp).on("click",t.properties.countUp,(function(){t.changeCount($(this).data("cartitem"),1)})).off("click",t.properties.countDown).on("click",t.properties.countDown,(function(){t.changeCount($(this).data("cartitem"),-1)})).off("click",t.properties.delItemCart).on("click",t.properties.delItemCart,(function(){t.removeItems()})).off("click",t.properties.createPreorder).on("click",t.properties.createPreorder,(function(){t.preorder()})).off("click",t.properties.preorderButton).on("click",t.properties.preorderButton,(function(){t.savePreorder()})).off("click",t.properties.goShoppingCart).on("click",t.properties.goShoppingCart,(function(){t.shoppingCart()})).off("click",t.properties.selectOptions+" li").on("click",t.properties.selectOptions+" li",(function(e){t.checkOption($(this),e)}))},this.addToCart=function(e){var o=e.data("idproduct"),i=e.data("idrecipient");if(e.data("quick_view"))t.ajaxQuickView(o);else{var n=$(t.properties.viewProduct).serialize();r(t.properties.addProductUrl,o+"/"+i,n,"json",(function(r){var i=r;if(t.properties.animate){var n=e.closest("#product_"+o).find("img");$(".ui-effects-transfer:last").css({"background-image":"url("+n.attr("src")+")","z-index":1001,"background-size":"100%"})}error_object.show_error_block(i.success,"success"),$(t.properties.productCount).html(i.products_count),e.val(t.properties.langs.add_cart_lang)}))}},this.loadCart=function(){0!=parseInt($(t.properties.productCount).html())&&(o?r(t.properties.loadCartUrl,"","","html",(function(e){o=!1,$(t.properties.loadCart).html(e).show(),$(t.properties.loadCart).height()>250&&$(".cart-scroller").slimScroll({railVisible:!0,size:"5px",position:"right"})})):(o=!0,$(t.properties.loadCart).toggle()))},this.ajaxQuickView=function(e){r(t.properties.quickView,e,"","json",(function(e){var o=e;t.properties.contentObj.show_load_block(o.html)}))},this.changeCount=function(e,o){$(t.properties.cartItemCount+e).val((function(r,i){var n=1,s=t.getTotalSum(),a=t.getItemSum(e);return o>0?(n=parseInt(i)+1,$(t.properties.itemId+e).text(n),s+=a,t.setTotalSum(s),t.changeAllCount(o),n<1?1:n):i<=1?1:(n=parseInt(i)-1,$(t.properties.itemId+e).text(n),s-=a,t.setTotalSum(s),t.changeAllCount(o),n<1?1:n)}))},this.changeAllCount=function(e){$(t.properties.cartCount).html((function(t,o){return parseInt(o)+e}))},this.removeItems=function(){var e=t.getItems(),o=0,i=0;e.length>0&&r(t.properties.removeUrl,"",e,"json",(function(e){e.products_count<1&&$(t.properties.actionBlock).hide(),$(t.properties.cartBlock+" input[type=checkbox]").each((function(){var e=$(this).data("cartitem");if($(this).prop("checked"))$(t.properties.cartItem+e).hide();else{var r=t.getItemCount(e);i+=r;var n=r*t.getItemSum(e);o+=n||0}})),t.setTotalSum(o),$(t.properties.cartCount).html(i),0==i&&$(t.properties.cartItems).next().addClass("table-div").show()}))},this.preorder=function(){var e=0,o=0;t.getItems()?($(t.properties.cartBlock+" input[type=checkbox]").each((function(){if($(this).prop("checked")){var r=t.getItemCount($(this).data("cartitem"));o+=r=r<1?1:r;var i=r*t.getItemSum($(this).data("cartitem"));e+=i||0}else $(t.properties.cartItem+$(this).data("cartitem")).remove()})),t.setTotalSum(e),$(t.properties.cartCount).html(o),t.savePreorder()):error_object.show_error_block(t.properties.langs.error_select,"error")},this.savePreorder=function(){$("input:checked").length<1||($(t.properties.cartBlock+" input[type=checkbox]").each((function(){$(this).prop("checked")||$(t.properties.cartItem+$(this).data("cartitem")).hide()})),$(t.properties.cartBlock).submit())},this.getItems=function(){var e="";return $("input:checked").each((function(){e+="&"+$("#cart_item_"+$(this).data("cartitem")).find("input").serialize()})),e},this.getItemCount=function(e){return parseInt($(t.properties.cartItemCount+e).val())},this.getItemSum=function(e){return parseInt($(t.properties.cartItemPrice+e).data("price"))},this.getTotalSum=function(){var e=parseInt($(t.properties.cartTotal).data("total"));return e<0&&(e=t.recalculateTotalSum()),e},this.recalculateTotalSum=function(){var e=0;return $("input:checked").each((function(){var o=t.getItemCount($(this).data("cartitem"))*t.getItemSum($(this).data("cartitem"));e+=o||0})),e},this.setTotalSum=function(e){$(t.properties.cartTotal).data("total",e),$(t.properties.cartTotal).html(t.currencyOutput(e))},this.shoppingCart=function(){locationHref(t.properties.siteUrl+"store/cart/")},this.checkOption=function(e){e.parents("ul").find("li").removeClass("selected-block"),e.parents("ul").find("input").prop("disabled",!0),e.addClass("selected-block");var o=e.data("value"),r=e.data("option");$(t.properties.option+r+"_"+o).prop("disabled",!1)};var r=function(e,o,r,i,n){$.ajax({url:t.properties.siteUrl+e+o,type:"POST",cache:!1,data:r,dataType:i,success:function(e){e.errors?error_object.show_error_block(e.errors,"error"):n(e)}})};this.currencyOutput=function(e){if("function"==typeof t.properties.currency_output)try{return t.properties.currency_output(e)}catch(e){console.log(e)}return e+" "+t.properties.currency},t.Init(e)})},3434:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.storeList=function(e){this.properties={siteUrl:"/",categoriesId:"categories",sortId:"sort_product",categoriesBlockId:"cat-load-block",searchProductId:"search_product",catBlockClass:"cat-block",categoriesListClass:"categories-list",categoriesLink:"store/ajax_load_categories/",categoryLink:"",sortLink:"store/",commonAncestor:"body"};var t=this,o=!0,r=0;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_controls()},this.uninit=function(){return $(document).off("click","#"+t.properties.categoriesId).off("change","#"+t.properties.sortId).off("click","#"+t.properties.searchProductId),this},this.init_controls=function(){$(document).off("click",t.properties.commonAncestor).on("click",t.properties.commonAncestor,(function(e){t.categoriesClose(e)})).off("click","#"+t.properties.categoriesId).on("click","#"+t.properties.categoriesId,(function(){t.categoriesLoad()})).off("change","#"+t.properties.sortId).on("change","#"+t.properties.sortId,(function(){t.sortProducts($(this))})).off("click","#"+t.properties.searchProductId).on("click","#"+t.properties.searchProductId,(function(){t.searchProduct()}))},this.categoriesClose=function(e){$(e.target).closest("#"+t.properties.categoriesId).length||$(e.target).closest("#"+t.properties.categoriesBlockId).length||($("#"+t.properties.categoriesBlockId).hide(),e.stopPropagation())},this.categoriesLoad=function(){o?i(t.properties.categoriesLink,"","","json",(function(e){var i=e;$("#"+t.properties.categoriesBlockId).html(i.html).show((function(){r=$("."+t.properties.categoriesListClass).height()})),o=!1,r>250&&($(".cat-scroller").slimScroll({railVisible:!0,size:"5px",position:"right"}),$("."+t.properties.categoriesListClass).hover((function(){$(".cat-scroller").slimScroll({railVisible:!0,size:"5px",position:"right"}),$(".slimScrollBar").show(),$(".slimScrollRail").show()}),(function(){$(".slimScrollBar").hide(),$(".slimScrollRail").hide()})))})):($("#"+t.properties.categoriesBlockId).toggle(),r>250&&$(".cat-scroller").slimScroll({railVisible:!0,size:"5px",position:"right"}))},this.sortProducts=function(e){var o=e.val();"undefined"!==o&&(document.location.href=t.properties.siteUrl+t.properties.category_id+"/"+o)},this.searchProduct=function(){$("."+t.properties.catBlockClass).hide("drop",{direction:"left"},500)};var i=function(e,o,r,i,n){$.ajax({url:t.properties.siteUrl+e+o,type:"POST",cache:!1,data:r,dataType:i,success:function(e){e.errors?error_object.show_error_block(e.errors,"error"):n(e)}})};t.Init(e)})},6888:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.store_media=function(e){this.properties={gallery_name:"storegallery",siteUrl:"/",idProduct:0,mediaId:"",count_photo:0,photoSize:"smalle",deleteMediaUrl:"admin/store/product_media_delete_",deleteMediaUrlReplace:"admin/store/ajax_product_media_delete_",viewMediaUrl:"admin/store/ajax_view_product_media",galleryContentDiv:"store_photos",galleryContentUrl:"admin/store/ajax_get_product_photos",galleryContentParam:"all",refreshRecentPhotosButton:"#refresh_recent_photos",refreshRecentPhotosDiv:"#recent_photo",nextMediaButton:"#next_media",previousMediaButton:"#prev_media",contentDiv:"#image_content",mediaBlock:"#media_",photoRemove:".photo-remove",nextMedia:null,previousMedia:null,all_loaded:0,loading_status:0,lang_delete_confirm:"Are you sure you want to delete this file?",post_data:{},windowObj:null};var t=null,o=this;this.Init=function(e){o.properties=$.extend(o.properties,e),o.properties.windowObj||(o.properties.windowObj=new loadingContent({loadBlockSize:"big"})),o.init_links(),o.init_global_events(),o.init_item_block_info()},this.uninit=function(){$(window).unbind("scroll.media").off("changeParam.gallery"),$("#"+o.properties.galleryContentDiv).off(),$(o.properties.galleryPageButton).unbind(),$(o.properties.filterObj).find("li").unbind(),$(o.properties.albumSelectorContainer).off(),$("#"+o.properties.sorterId).off(),$(o.properties.contentDiv).off("click",o.properties.nextMediaButton).off("click",o.properties.previousMediaButton)},this.init_item_block_info=function(){$("#"+o.properties.galleryContentDiv).off("click",'[data-click="view-media-photo"]').on("click",'[data-click="view-media-photo"]',(function(e){e.preventDefault();var t=$(this).data("id-product")?$(this).data("id-product"):o.properties.idProduct,r=$(this).data("id-media");return o.display_edit_view_form(t,r,"photo"),!1})).off("click",'[data-click="view-media-video"]').on("click",'[data-click="view-media-video"]',(function(e){e.preventDefault();var t=$(this).data("id-product")?$(this).data("id-product"):o.properties.idProduct;return o.display_edit_view_form(t,0,"video"),!1})).off("click",".delete-media").on("click",".delete-media",(function(e){e.preventDefault();var t=$(this).attr("href").replace(o.properties.deleteMediaUrl,o.properties.deleteMediaUrlReplace);return alerts.show({text:o.properties.lang_delete_confirm,type:"confirm",ok_callback:function(){o.delete_media(t)}}),!1})).off("mouseenter",".photo").on("mouseenter",".photo",(function(){$(this).find(".info").stop().slideDown(100)})).off("mouseleave",".photo").on("mouseleave",".photo",(function(){$(this).find(".info").stop(!0).delay(100).slideUp(100)}))},this.init_links=function(){$(o.properties.galleryPageButton).unbind("click").on("click",(function(){o.next_page()})),$(o.properties.refreshRecentPhotosButton).unbind("click").on("click",(function(){o.refresh_recent_photos()})),$(o.properties.contentDiv).off("click",o.properties.nextMediaButton).on("click",o.properties.nextMediaButton,(function(){o.display_next_media()})).off("click",o.properties.previousMediaButton).on("click",o.properties.previousMediaButton,(function(){o.display_previous_media()}))},this.init_sorter=function(){$("#"+o.properties.sorterId).off("change","select").on("change","select",(function(){o.load_content(1,!0)})),$("#"+o.properties.sorterId).off("click",'[data-role="sorter-dir"]').on("click",'[data-role="sorter-dir"]',(function(){$(this).hasClass("up")?$(this).removeClass("up").addClass("down"):$(this).removeClass("down").addClass("up"),o.load_content(1,!0)}))},this.init_global_events=function(){$(window).off("changeParam.gallery").on("changeParam.gallery",(function(e,t){o.properties.galleryContentParam=t}))},this.get_post_data=function(){var e=$.extend(o.properties.post_data,{order:o.properties.order,direction:o.properties.direction,gallery_name:o.properties.gallery_name,place:o.properties.place});return $("#"+o.properties.sorterId).length&&(e.order=$("#"+o.properties.sorterId).find("select").val(),e.direction=$("#"+o.properties.sorterId).find('[data-role="sorter-dir"]').hasClass("up")?"asc":"desc"),e},this.next_page=function(){o.properties.galleryContentPage++,o.load_content()},this.display_edit_view_form=function(e,t,r){var i=o.get_post_data();$.ajax({url:o.properties.siteUrl+o.properties.viewMediaUrl+"/"+r+"/"+e+"/"+t,type:"POST",data:i,dataType:"html",cache:!1,success:function(e){o.properties.windowObj.changeTemplate("gallery"),o.properties.windowObj.update_css_styles({width:"962px"}),o.properties.windowObj.show_load_block(e),0==t&&$(o.properties.previousMediaButton).hide(),parseInt(o.properties.count_photo)<1&&$(o.properties.nextMediaButton).hide();var r=$("#view_media_close");r.length>0&&r.on("click",(function(){o.properties.windowObj.hide_load_block()}))}})},this.delete_media=function(e){var t=o.get_post_data();$.ajax({url:e,type:"POST",data:t,dataType:"json",cache:!1,success:function(e){1==e.status?(o.reload(),error_object.show_error_block(e.message,"success"),e.data&&e.data.albums_select&&$(o.properties.albumSelectorContainer).html(e.data.albums_select)):error_object.show_error_block(e.message,"error")}})},this.show_content=function(e){o.properties.windowObj.changeTemplate("gallery"),o.properties.windowObj.update_css_styles({width:"962px"}),o.properties.windowObj.show_load_block(e)},this.reload=function(){o.properties.galleryContentPage=1,o.properties.all_loaded=0,o.load_content(1)},this.load_content=function(e,r){if(r=r||!1)t&&t.abort(),o.properties.galleryContentPage=1;else if(1==o.properties.all_loaded||o.properties.loading_status)return!0;o.properties.loading_status=1;var i=o.get_post_data();t=$.ajax({url:o.properties.siteUrl+o.properties.galleryContentUrl+"/"+o.properties.idProduct+"/"+o.properties.galleryContentParam+"/"+o.properties.photoSize,type:"POST",data:i,dataType:"json",cache:!1,success:function(t){e?($("#"+o.properties.galleryContentDiv).html(t.content),$("textarea").val("")):$("#"+o.properties.galleryContentDiv).append(t.content),t.have_more?$(o.properties.galleryPageContent).show():(o.properties.all_loaded=1,$(o.properties.galleryPageContent).hide())},complete:function(){o.properties.loading_status=0,0==o.properties.nextMedia&&$(o.properties.nextMediaButton).hide(),0==o.properties.previousMedia&&$(o.properties.previousMediaButton).hide(),$(o.properties.photoRemove).show()}})},this.set_properties=function(e){o.properties=$.extend(o.properties,e)},this.refresh_recent_photos=function(){$.ajax({url:o.properties.siteUrl+o.properties.recentMediaUrl,type:"POST",data:{count:16,upload_gid:"photo"},dataType:"html",cache:!1,success:function(e){$(o.properties.refreshRecentPhotosDiv).html(e)}})},this.display_next_media=function(){$(o.properties.nextMediaButton).show(),o.properties.mediaId<parseInt(o.properties.count_photo)-1?(o.properties.mediaId=parseInt(o.properties.mediaId)+1,$(o.properties.mediaBlock+o.properties.mediaId).click()):$(o.properties.nextMediaButton).hide()},this.display_previous_media=function(){$(o.properties.previousMediaButton).show(),o.properties.mediaId>0?(o.properties.mediaId=parseInt(o.properties.mediaId)-1,$(o.properties.mediaBlock+o.properties.mediaId).click()):$(o.properties.previousMediaButton).hide()},o.Init(e)})},9443:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.storeOrders=function(e){this.properties={siteUrl:"/",order:{id_order:0,shipping_id:0,price:0,is_formed:0,status:"",comment:""},data_order:[],form:"#order_block",id_country:"#country_name",id_region:"#region_name",id_city:"#city_name",id_hidden_country:"#id_hidden_country",id_hidden_region:"#id_hidden_region",id_hidden_city:"#id_hidden_city",forFriendBlock:"#for_friend",forMyselfBlock:"#for_myself",receiversBlock:"#receivers",friendListBlock:"#friendlist",addressBlock:"#address",sentListBlock:"#sent_gift",countryBlock:"#country_box",regionBlock:"#region_box",cityBlock:"#city_box",orderLogBlock:"#order_log_block_",addressId:"#last_address_",searchButton:"#search_friend",saveAddressButton:"#save_address",changeUser:"#change_user",friendsLoad:"#friends_load",userSearchForm:"#user_search",addressEdit:".address_edit",countryButton:"#country_load",idAddressForm:"#shipping_address",streetAddress:"#street_address",shippingSelect:"#shipping_select",shippingShow:"#shipping_methods",shippingMethods:"#shipping-methods",shippingName:"#shipping_name",orderTotal:"#order_total",termsDelivery:"#terms_delivery",createOrder:"#create_order",phone:"#phone",zip:"#zip",comment:"#comment",regionLang:"#region_lang",cityLang:"#city_lang",addressRecipient:"#address_recipient",paymentBlock:"#payment-block",canceledSender:".canceled_sender",canceledSenderSubmit:"#canceled_sender",servicesHelper:"#services_helper",shippingPrice:".shipping_price",shippingTotal:".shipping_total",orderCount:".order_count",orderPrice:".order_price",linkOrderLog:".link-order_log",viewOrderHistory:".view_order_history",deleteOrderHistory:".delete_order_history",addUser:".add-user",countrySelect:".country-select",regionSelect:".region-select",citySelect:".city-select",lastAddress:".last_address",removeAddress:".address_remove",cancel:".cancel",editShippingMethod:".edit-shipping-method",changeUserLink:"store/ajax_order_users/",searchUserLink:"store/ajax_search_users/",selectUsersLink:"store/ajax_select_users/",allFriendsLink:"store/ajax_friends/",friendListLink:"store/ajax_friend_list/",sentListsLink:"store/ajax_sent_list/",addressFormLink:"store/ajax_address_form/",userAddressLink:"store/ajax_user_address/",countryLoadLink:"store/ajax_load_countries/",regionCityLoadLink:"store/ajax_load_region_city/",saveAddressLink:"store/ajax_save_address/",removeAddressLink:"store/ajax_delete_address/",termsDeliveryLink:"store/ajax_terms_delivery/",saveOrderLink:"store/save_order/",orderLogLink:"store/ajax_show_order_log/",closePreorderLink:"store/ajax_close_preorder/",deleteHistoryLink:"store/ajax_delete_history/",confirmAddressLink:"store/ajax_confirm_address/",shippingMethodsLink:"store/ajax_load_shipping_methods/",timeout_obj:null,timeout:500,commonAncestor:"body",contentObj:new loadingContent({loadBlockWidth:"700px",loadBlockLeftType:"center",loadBlockTopType:"top",loadBlockTopPoint:100,closeBtnClass:"w",draggable:!0})};var t=this,o=!0,r=!0,i=!0,n="",s={for_friend:0,for_myself:0,user_id:0,address_id:0,shipping_id:0,agree_terms_delivery:0};this.Init=function(e){if(t.properties=$.extend(t.properties,e),t.init_controls(),1==t.properties.order.is_formed&&t.loadPaymentData(),"status_confirmed_recipient"==t.properties.order.status){$(t.properties.shippingMethods).length&&$("html, body").animate({scrollTop:$(t.properties.shippingMethods).offset().top},1e3);var o=$(t.properties.forFriendBlock+" input").val();t.shippingMethodsLoad(0,o,(function(){t.isOneshippingMethods()}))}(t.properties.data_order.for_friend||t.properties.data_order.for_myself)&&t.loadOrderDaeta(),s.comment=t.properties.order.comment},this.uninit=function(){return $(t.properties.commonAncestor).off("click",t.properties.forFriendBlock).off("click",t.properties.forMyselfBlock).off("click",t.properties.changeUser).off("click",t.properties.addUser).off("click",t.properties.friendsLoad).off("click",t.properties.searchButton).off("click",t.properties.addressBlock).off("click",t.properties.addressEdit).off("click",t.properties.countryButton).off("click",t.properties.countryBlock).off("click",t.properties.regionBlock).off("click",t.properties.cityBlock).off("keyup",t.properties.id_city).off("click",t.properties.saveAddressButton).off("keyup",t.properties.phone).off("click",t.properties.lastAddress).off("click",t.properties.removeAddress).off("click",t.properties.shippingSelect).off("click",t.properties.shippingShow).off("click",t.properties.termsDelivery).off("click",t.properties.createOrder).off("click",t.properties.linkOrderLog).off("click",t.properties.canceledSender).off("click",t.properties.viewOrderHistory).off("click",t.properties.deleteOrderHistory).off("click",t.properties.addressRecipient).off("click",t.properties.canceledSenderSubmit).off("click",t.properties.cancel),this},this.init_controls=function(){$(t.properties.commonAncestor).off("click",t.properties.forFriendBlock).on("click",t.properties.forFriendBlock,(function(){t.chooseFor(t.properties.forFriendBlock)})).off("click",t.properties.forMyselfBlock).on("click",t.properties.forMyselfBlock,(function(){t.chooseFor(t.properties.forMyselfBlock)})).off("click",t.properties.changeUser).on("click",t.properties.changeUser,(function(){t.loadUsers()})).off("click",t.properties.addUser).on("click",t.properties.addUser,(function(){var e=$(this).data("userid");t.selectUsers(e)})).off("click",t.properties.friendsLoad).on("click",t.properties.friendsLoad,(function(){t.allFriends()})).off("click",t.properties.searchButton).on("click",t.properties.searchButton,(function(){t.searchResult()})).off("click",t.properties.addressEdit).on("click",t.properties.addressEdit,(function(){t.addressForm($(this).data("addressid"))})).off("click",t.properties.countryButton).on("click",t.properties.countryButton,(function(){t.changeCountry()})).off("click",t.properties.countryBlock).on("click","li.country",t.properties.countryBlock,(function(){t.set_country($(this).attr("country"),$(this).text())})).off("click",t.properties.regionBlock).on("click","li.region",t.properties.regionBlock,(function(){t.set_region($(this).attr("region"),$(this).text())})).off("click",t.properties.cityBlock).on("click",".city",t.properties.cityBlock,(function(){t.set_city($(this).attr("city"),$(this).text())})).off("keyup",t.properties.id_region).on("keyup",t.properties.id_region,(function(){t.changeRegion($(this).val())})).off("keyup",t.properties.id_city).on("keyup",t.properties.id_city,(function(){t.changeCity($(this).val())})).off("click",t.properties.saveAddressButton).on("click",t.properties.saveAddressButton,(function(){t.saveAddress($(this).data("addressid"))})).off("keyup",t.properties.phone).on("keyup",t.properties.phone,(function(){t.formatPhone(this)})).off("click",t.properties.lastAddress).on("click",t.properties.lastAddress,(function(){t.addressChoose($(this).data("addressid"),(function(){t.isOneshippingMethods()}))})).off("click",t.properties.removeAddress).on("click",t.properties.removeAddress,(function(){t.addressDelete($(this))})).off("click",t.properties.shippingSelect).on("click",t.properties.shippingSelect,(function(){t.shippingMethods()})).off("click",t.properties.shippingShow).on("click","div.shipping_methods",t.properties.shippingShow,(function(){t.changeShipping($(this))})).off("click",t.properties.termsDelivery).on("click",t.properties.termsDelivery,(function(e){t.loadTermsDelivery($(this),e)})).off("click",t.properties.createOrder).on("click",t.properties.createOrder,(function(){t.saveOrder()})).off("click",t.properties.linkOrderLog).on("click",t.properties.linkOrderLog,(function(){t.loadOrderLog()})).off("click",t.properties.canceledSender).on("click",t.properties.canceledSender,(function(){t.cancelOrder($(this))})).off("click",t.properties.viewOrderHistory).on("click",t.properties.viewOrderHistory,(function(){t.viewHistory($(this))})).off("click",t.properties.deleteOrderHistory).on("click",t.properties.deleteOrderHistory,(function(){t.deleteHistory($(this))})).off("click",t.properties.addressRecipient).on("click",t.properties.addressRecipient,(function(){t.saveAddressRecipient()})).off("click",t.properties.canceledSenderSubmit).on("click",t.properties.canceledSenderSubmit,(function(){t.canceledOrder()})).off("click",t.properties.cancel).on("click",t.properties.cancel,(function(){t.properties.contentObj.hide_load_block()})).off("submit",t.properties.userSearchForm).on("submit",t.properties.userSearchForm,(function(){return t.searchResult(),!1}))},this.chooseFor=function(e){switch($(e+" .block").removeClass("select-for"),$(e+" i").removeClass("check"),e){case t.properties.forFriendBlock:$(t.properties.forFriendBlock+" input").prop("disabled",!1),$(t.properties.forMyselfBlock+" .block").addClass("select-for"),$(t.properties.forMyselfBlock+" i").addClass("check");var o=$(t.properties.forFriendBlock+" input").val();s.for_friend=1,s.user_id=o,s.for_myself=0,t.addressLoad(!1),$(t.properties.lastAddress+" .block").addClass("select-for");break;case t.properties.forMyselfBlock:$(t.properties.forFriendBlock+" input").prop("disabled",!0),$(t.properties.forFriendBlock+" .block").addClass("select-for"),$(t.properties.forFriendBlock+" i").addClass("check"),s.user_id=s.for_friend=0,s.for_myself=1,t.addressLoad(!0)}},this.addressChoose=function(e,o){$(t.properties.lastAddress+" .block").addClass("select-for"),$(t.properties.lastAddress+" i").addClass("check"),$(t.properties.lastAddress+" input").prop("disabled",!0),$(t.properties.addressId+e+" .block").removeClass("select-for"),$(t.properties.addressId+e+" i").removeClass("check"),$(t.properties.addressId+e+" input").prop("disabled",!1),s.address_id=e,$(t.properties.shippingTotal).html(0);var r=$(t.properties.orderPrice).data("price");t.totalPrise(0,r),t.shippingMethodsLoad(e,0,o)},this.shippingMethodsLoad=function(e,o,r){var i={id:e=void 0===e?0:e,user_id:o};a(t.properties.shippingMethodsLink,"",i,"json",(function(e){var o=e;$(t.properties.shippingMethods).html(o.html),r&&r()}))},this.addressLoad=function(e){e?($(t.properties.addressBlock).show(),1===$(t.properties.lastAddress).length&&t.addressChoose($(t.properties.lastAddress).data("addressid"),(function(){t.isOneshippingMethods()}))):($(t.properties.addressBlock).hide(),"status_confirmed_recipient"!==t.properties.order.status&&$(t.properties.shippingMethods).html(""))},this.loadUsers=function(){a(t.properties.changeUserLink,"","","JSON",(function(e){t.showLoadBlock(e.data),t.friendsList(),t.mySentGifts()}))},this.friendsList=function(){a(t.properties.friendListLink,"","","html",(function(e){$(t.properties.friendListBlock).html(e)}))},this.mySentGifts=function(){a(t.properties.sentListsLink,"","","html",(function(e){$(t.properties.sentListBlock).html(e)}))},this.selectUsers=function(e){s.user_id=e,a(t.properties.selectUsersLink,e,"","html",(function(e){t.properties.contentObj.hide_load_block(),$(t.properties.receiversBlock).html(e),t.chooseFor(t.properties.forFriendBlock),o=!0}))},this.allFriends=function(){o?a(t.properties.allFriendsLink,"","","html",(function(e){o=!1,n=e,$(t.properties.friendListBlock).html(e),$(t.properties.friendsLoad).hide()})):$(t.properties.friendListBlock).html(n),$(t.properties.friendsLoad).hide()},this.searchResult=function(){var e=$(t.properties.userSearchForm).serialize();a(t.properties.searchUserLink,"",e,"html",(function(e){$(t.properties.friendListBlock).html(e)}))},this.addressForm=function(e){a(t.properties.addressFormLink,e,"","html",(function(e){t.showLoadBlock(e),s.comment&&$(t.properties.comment).val(s.comment)}))},this.saveAddress=function(e){$(".error").html("");var o={country:$(t.properties.id_hidden_country).val(),region:$(t.properties.id_hidden_region).val(),city:$(t.properties.id_hidden_city).val(),street_address:$(t.properties.streetAddress).val(),phone:$(t.properties.phone).val(),zip:$(t.properties.zip).val()};s.comment=$(t.properties.comment).val(),a(t.properties.saveAddressLink,t.properties.order.id_order+"/"+e,o,"json",(function(e){var o=e;if(o.address_id)t.properties.contentObj.hide_load_block(),$(t.properties.addressBlock).html(o.html),t.addressChoose(o.address_id,(function(){t.isOneshippingMethods()})),$(t.properties.addressRecipient).show();else if(o.errors)for(var r in o.errors)$("#error-"+r).show().html(o.errors[r])}))},this.changeCountry=function(){i?(i=!1,$(t.properties.countryBlock+" ul").empty(),a(t.properties.countryLoadLink,"","","json",(function(e){var o=e.countries;if(o){for(var r in o)$(t.properties.countryBlock+" ul").append('<li class="country" gid="rs_'+o[r].id+'" country="'+o[r].code+'">'+o[r].name+"</li>");$(t.properties.countryBlock).slideDown()}}))):($(t.properties.countryBlock).slideUp(),i=!0)},this.set_country=function(e,o){$(t.properties.id_country).val(o),$(t.properties.id_country).html(o),$(t.properties.id_hidden_country).val(e),t.destroyLocations(),t.closeBox(t.properties.countryBlock)},this.set_region=function(e,o){$(t.properties.id_region).val(o),$(t.properties.id_hidden_region).val(e),t.closeBox(t.properties.regionBlock)},this.set_city=function(e,o){$(t.properties.id_city).val(o),$(t.properties.id_hidden_city).val(e),t.closeBox(t.properties.cityBlock)},this.destroyLocations=function(){t.set_region("",""),t.set_city("","")},this.changeRegion=function(e){return t.properties.timeout_obj&&clearTimeout(t.properties.timeout_obj),t.properties.timeout_obj=setTimeout((function(){$(t.properties.regionBlock+" ul").empty();var o=$(t.properties.id_hidden_country).val();if(o){var r={country:o,data:e,type:"region"};a(t.properties.regionCityLoadLink,"",r,"json",(function(e){var o=e;if(void 0!==o.msg)$(t.properties.regionBlock+" ul").append("<li>"+o.msg+"</li>");else for(var r in o.regions)$(t.properties.regionBlock+" ul").append('<li class="region" gid="rs_'+r+'" region="'+o.regions[r].id+'">'+o.regions[r].name+"</li>");$(t.properties.regionBlock).slideDown()}))}else t.changeCountry()}),t.properties.timeout),!0},this.changeCity=function(e){return t.properties.timeout_obj&&clearTimeout(t.properties.timeout_obj),t.properties.timeout_obj=setTimeout((function(){$(t.properties.cityBlock+" ul").empty();var o={country:$(t.properties.id_hidden_country).val(),region:$(t.properties.id_hidden_region).val(),data:e,type:"city"};a(t.properties.regionCityLoadLink,"",o,"json",(function(e){var o=e;if(void 0!==o.msg)$(t.properties.cityBlock+" ul").append("<li>"+o.msg+"</li>");else for(var r in o.cities)$(t.properties.cityBlock+" ul").append('<li class="city" gid="rs_'+r+'" city="'+o.cities[r].id+'">'+o.cities[r].name+"</li>");$(t.properties.cityBlock).slideDown()}))}),t.properties.timeout),!0},this.addressDelete=function(e){var o=e.closest(".last_address").data("addressid");a(t.properties.removeAddressLink,o,"","html",(function(e){$(t.properties.addressId+e).hide((function(){$(this).remove()})),$(t.properties.lastAddress).length<2&&$(t.properties.addressRecipient).hide()}))},this.formatPhone=function(e){e.value.match(/[^0-9]/g)&&(e.value=e.value.replace(/[^0-9]/g,""))},this.closeBox=function(e){$(e).slideUp(),$(e+" ul").empty()},this.isOneshippingMethods=function(){return 1===$(".shipping-methods").length&&($("#shipping_method_"+$(".shipping-methods").data("shippingid")).addClass("select-shipping"),$("div.shipping_methods>input").click()),!1},this.shippingMethods=function(){var e=[];e.title=$(t.properties.shippingMethods+" h1").html(),e.content=$(t.properties.shippingShow).html(),t.showLoadBlock(e,!0),$(".load_content").css("background","#FFFFFF"),$(".load_content").find(t.properties.editShippingMethod).hide()},this.changeShipping=function(e){if(e.data("shippingid"))return $(".shipping_methods").removeClass("select-shipping"),void e.addClass("select-shipping");$(t.properties.shippingName).html($(".select-shipping").html()),$(t.properties.editShippingMethod).show();var o=$(".select-shipping").find(t.properties.shippingPrice);$(t.properties.shippingTotal).html(o.html());var r=$(".select-shipping").data("price"),i=$(".select-shipping").data("shippingid"),n=$(t.properties.orderPrice).data("price");t.totalPrise(r,n),s.shipping_id=i,t.properties.contentObj.hide_load_block()},this.totalPrise=function(e,o){var r=(parseFloat(e)+parseFloat(o)).toFixed(2);$(t.properties.orderTotal).html(currency_output(r))},this.loadTermsDelivery=function(e,o){var r=e.find("input").prop("checked");s.agree_terms_delivery=r?1:0,"SPAN"==o.target.tagName&&a(t.properties.termsDeliveryLink,"","","json",(function(e){var o=e;t.showLoadBlock(o,!0)}))},this.showLoadBlock=function(e,o){o&&(e="<div class='content-block load_content'><h1>"+e.title+"</h1><div class='m10'>"+e.content+"</div></div>"),t.properties.contentObj.show_load_block(e)},this.saveOrder=function(){s.shipping_id||(s.shipping_id=t.properties.order.shipping_id);var e=s,o="";for(var r in e)o+="<input type='hidden' name='"+r+"' value='"+e[r]+"'>";$(t.properties.form).prepend(o).submit()},this.canceledOrder=function(){$(t.properties.form).prepend("<input type='hidden' name='canceled_sender' value='1'>").submit()},this.loadOrderLog=function(){r?a(t.properties.orderLogLink,t.properties.order.id_order,"","json",(function(e){var o=e;$(t.properties.orderLogBlock+t.properties.order.id_order).html(o.html),r=!1})):$(t.properties.orderLogBlock+t.properties.order.id_order).toggle()},this.cancelOrder=function(e){var o=e.data("orderid");a(t.properties.closePreorderLink,o,{canceled_sender:1},"json",(function(o){var r=o;r.errors?error_object.show_error_block(o.errors,"error"):r&&e.closest("div.js-order-product").hide((function(){var e=$(this).prev();$(this).remove(),0==$(t.properties.canceledSender).length&&(e.prev().hide(),e.show())}))}))},this.viewHistory=function(e){var o=e.data("id");e.hasClass("fa-folder-o")?a(t.properties.orderLogLink,o,"","json",(function(r){var i=r;e.removeClass("fa-folder-o").addClass("fa-folder-open-o"),$(t.properties.orderLogBlock+o).html(i.html).show()})):(e.removeClass("fa-folder-open-o").addClass("fa-folder-o"),$(t.properties.orderLogBlock+o).hide((function(){$(this).html("")})))},this.deleteHistory=function(e){var o=e.data("id");a(t.properties.deleteHistoryLink,o,"","html",(function(r){e.closest("div.js-order-product").hide((function(){var e=$(this).prev();$(this).remove(),0==$(t.properties.deleteOrderHistory).length&&(e.prev().hide(),e.show())})),$(t.properties.orderLogBlock+o).hide((function(){$(this).remove()}))}))},this.saveAddressRecipient=function(){var e={address_id:s.address_id,comment:s.comment,order_id:t.properties.order.id_order};a(t.properties.confirmAddressLink,"",e,"json",(function(e){var t=e;t.success?error_object.show_error_block(t.success,"success"):t.errors&&error_object.show_error_block(t.errors,"error")}))},this.loadPaymentData=function(){$(t.properties.servicesHelper).length&&($("#service_id_order_payment").val((function(e,o){return o||t.properties.order.id_order})),$("#service_id_shipping").val((function(e,o){return o||t.properties.order.shipping_id})),$("#service_price").val((function(e,o){return o||t.properties.order.price})),$("input[name=price]").val((function(e,o){return o||t.properties.order.price})))},this.loadOrderDaeta=function(){if(0!=t.properties.data_order.for_myself)return t.chooseFor(t.properties.forMyselfBlock),t.properties.data_order.address_id?void t.addressChoose(t.properties.data_order.address_id,(function(){if(t.properties.data_order.shipping_id)return $("#shipping_method_"+t.properties.data_order.shipping_id).addClass("select-shipping"),void $("div.shipping_methods>input").click()})):void 0;0!=t.properties.data_order.for_friend&&t.chooseFor(t.properties.forFriendBlock)};var a=function(e,o,r,i,n){$.ajax({url:t.properties.siteUrl+e+o,type:"POST",cache:!1,data:r,dataType:i,success:function(e){e.errors?error_object.show_error_block(e.errors,"error"):n(e)}})};t.Init(e)})},4519:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.tickets=function(e){this.properties={siteUrl:"/",idUser:0,messagesContentDiv:"#tickets_content",messagesInput:"#messages_admin",messagesContentUrl:"tickets/ajax_get_messages",messagesSendUrl:"tickets/ajax_send_messages",messagesLoadLimit:10,messagesCountPage:0,messagesButtonMore:"",messagesButtonSend:"#send_message",messagesTruncate:30};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_objects(),t.init_controls(),t.load_message()},this.uninit=function(){t.send_message_btn_obj.off("click"),t.messages_content_obj.off("click","#next-page")},this.init_objects=function(){t.messages_content_obj=$(t.properties.messagesContentDiv),t.send_message_btn_obj=$(t.properties.messagesButtonSend),t.send_message_input_obj=$(t.properties.messagesInput)},this.init_controls=function(){t.send_message_btn_obj.off("click").on("click",(function(){t.send_message()})),t.messages_content_obj.off("click","#next-page").on("click","#next-page",(function(){$(this).remove(),t.list_message()}))},this.load_message=function(){t.list_message()},this.list_message=function(){$.ajax({url:t.properties.siteUrl+t.properties.messagesContentUrl,type:"POST",dataType:"json",data:{count_messages:t.properties.messagesCountPage},cache:!1,success:function(e){e.content&&(t.messages_content_obj.append(e.content).fadeIn(),t.properties.messagesCountPage=$(".addressbar:visible").length,t.properties.messagesCountPage>=t.properties.messagesLoadLimit&&t.messages_content_obj.append('<input class="btn btn-primary-inverted" type="button" id="next-page" value="'+t.properties.messagesButtonMore+'">'))}})},this.send_message=function(){message=t.send_message_input_obj.val(),id_user=t.properties.idUser,$.ajax({url:t.properties.siteUrl+t.properties.messagesSendUrl,type:"POST",data:{message,id_user},dataType:"json",cache:!1,success:function(e){e.content&&(t.send_message_input_obj.val(""),message=e.content.message,content='<dl class="pointer bold"><dt class="w650"><div class="addressbar"><font>'+e.content.date_created+"</font><font> "+e.content.output_name+'</font></div><div class="view">'+message+"</div></dt></dl>",t.messages_content_obj.prepend(content).fadeIn(),t.properties.messagesCountPage=$(".addressbar:visible").length,error_object.show_error_block(e.success,"success")),e.errors&&error_object.show_error_block(e.errors,"error")}})},t.Init(e)})},290:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.TwilioChat=function(e){this.properties={siteUrl:"/",idUser:0,messagesContentDiv:"#tickets_content",messagesInput:"#messages_admin",messagesContentUrl:"tickets/ajax_get_messages",messagesSendUrl:"tickets/ajax_send_messages",messagesLoadLimit:10,messagesCountPage:0,messagesButtonMore:"",messagesButtonSend:"#send_message",messagesTruncate:30};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_objects(),t.init_controls(),t.load_message()},this.uninit=function(){t.send_message_btn_obj.off("click"),t.messages_content_obj.off("click","#next-page")},this.init_objects=function(){t.messages_content_obj=$(t.properties.messagesContentDiv),t.send_message_btn_obj=$(t.properties.messagesButtonSend),t.send_message_input_obj=$(t.properties.messagesInput)},this.init_controls=function(){t.send_message_btn_obj.off("click").on("click",(function(){t.send_message()})),t.messages_content_obj.off("click","#next-page").on("click","#next-page",(function(){$(this).remove(),t.list_message()}))},this.load_message=function(){t.list_message()},this.list_message=function(){$.ajax({url:t.properties.siteUrl+t.properties.messagesContentUrl,type:"POST",dataType:"json",data:{count_messages:t.properties.messagesCountPage},cache:!1,success:function(e){e.content&&(t.messages_content_obj.append(e.content).fadeIn(),t.properties.messagesCountPage=$(".addressbar:visible").length,t.properties.messagesCountPage>=t.properties.messagesLoadLimit&&t.messages_content_obj.append('<input class="btn btn-primary-inverted" type="button" id="next-page" value="'+t.properties.messagesButtonMore+'">'))}})},this.send_message=function(){message=t.send_message_input_obj.val(),id_user=t.properties.idUser,$.ajax({url:t.properties.siteUrl+t.properties.messagesSendUrl,type:"POST",data:{message,id_user},dataType:"json",cache:!1,success:function(e){e.content&&(t.send_message_input_obj.val(""),message=e.content.message,content='<dl class="pointer bold"><dt class="w650"><div class="addressbar"><font>'+e.content.date_created+"</font><font> "+e.content.output_name+'</font></div><div class="view">'+message+"</div></dt></dl>",t.messages_content_obj.prepend(content).fadeIn(),t.properties.messagesCountPage=$(".addressbar:visible").length,error_object.show_error_block(e.success,"success")),e.errors&&error_object.show_error_block(e.errors,"error")}})},t.Init(e)})},2815:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.TwilioChatVideo=function(){this.room_name=null,this.tw_token=null,this.video_popup=null,this.tw_room=null,this.TW_Video=null,this.track_id=null,this.local_video=null,this.local_video_track=null,this.check_room_status_invite=null,this.check_room_status=null,this.tplPopup="",this.user_id=null,this.participant=null,this.isOpenCaller=!1,this.cameraDevice=[],this.camerasCounter=0,this.timeCounter=0,this.timeConnectCounter=0,this.timeConnectCounterId=null,this.contentObj=null;var e=this;this.get_status_room=function(t,o){$.ajax({url:site_url+"twilio_chat/get_status_room/",type:"POST",data:{track_id:t,partner_id:e.participant.id,type:o,user_id:e.user_id},dataType:"json",cache:!1,success:function(t){void 0!==t.track&&("caller"===o?(e.timeConnectCounter>=30&&0===e.timeCounter?t.track.status="disconnected":e.timeConnectCounter>=30&&e.timeCounter>0&&(clearInterval(e.timeConnectCounterId),e.timeConnectCounter=0),"in-progress"===t.track.status&&"decline"!==t.track.status&&e.video_popup||(clearInterval(e.timeConnectCounterId),e.timeConnectCounter=0,e.video_popup&&e.video_popup.destroy(),clearInterval(e.check_room_status),e.check_room_status=null,"decline"===t.track.status&&error_object.show_error_block(t.track.status_decline,"warning"),e.closeBlock())):"in-progress"===t.track.status&&"decline"!==t.track.status||(e.video_popup&&e.video_popup.destroy(),clearInterval(e.check_room_status_invite),e.check_room_status_invite=null,e.closeBlock(),$(".menu-video-item").addClass("no-notifications"),$(".menu-video-item .sum").text("")),"disconnected"===t.track.status&&error_object.show_error_block("disconnected","warning"))}})},this.closeBlock=function(){e.room_name&&(e.room_name=null),e.tw_room&&(e.tw_room.disconnect(),e.tw_room=null,e.tw_token=null),e.local_video_track&&(e.local_video_track.stop(),e.local_video_track=null),e.video_popup=null,e.timeOfCall._counerId&&e.timeOfCall.stop(),e.isOpenCaller=!1},this.sendStatusRoom=function(e,t){$.ajax({url:site_url+"twilio_chat/set_status_room/",type:"POST",data:{track_id:e,status:t},dataType:"json",cache:!1,success:function(e){console.log("room status - "+t)}})},this.generatePopup=function(){this.video_popup=new loadingContent({loadBlockTopType:"center",otherClass:"twilio_chat",closeBtnPadding:12,linkerObjID:null,blockBody:!1,showAfterImagesLoad:!0,onClose:e.closeBlock}),this.video_popup.active_bg=function(){$("#"+e.video_popup.properties.loadBlockBgID).hasClass("gallery-type")?$("#"+e.video_popup.properties.loadBlockBgID).show():$("#"+e.video_popup.properties.loadBlockBgID).css("display","flex")},e.tplPopup=$(document.querySelector("#twilioRoomContainer").innerHTML),e.tplPopup.removeAttr("style"),e.tplPopup.find(".local-media-tw").html(""),e.tplPopup.find(".connect-tw").attr("id",e.room_name),e.participant&&(e.tplPopup.find(".twilio_user_info_top").css("background-image","url("+e.participant.media.user_logo.thumbs.grand+")"),e.tplPopup.find(".modal-body").attr("id","room-track-"+e.track_id),e.tplPopup.find(".twilio-room_user_info").html(e.participant.output_name+"</span>")),e.video_popup.show_load_block(e.tplPopup.html()),$(".twilio-camera-off").off("click").click((function(){$(this).toggleClass("svg-active "),e.turnOffOnVideoStream()})),$(".twilio-mute-switcher").off("click").click((function(){$(this).toggleClass("svg-active"),e.turnOffOnMuteStream()})),e.closeBtn(),e.switchCamera()},this.initCall=function(t,o,r){e.tw_token||e.room_name||(e.tw_token=t,e.room_name=o,e.track_id=r,e.createVideo())},this.openCaller=function(){var t=$(document.querySelector("#callingToPartner").innerHTML),o=e.participant.link;t.find("#partnerthumbs").attr("src",e.participant.media.user_logo.thumbs.great),t.find("#messageImage").attr("href",o),t.find(".partner_name").html("<a href='"+o+"'> "+e.participant.name+"</a>"),t.find(".partner_year_numb").html("<a href='"+o+"'> "+e.participant.age+"</a>"),$(".menu-video-more.dropdown-menu").find(".menu-alerts-more-items").css("text-align","center").html(t.html()),$(".menu-video-item").removeClass("no-notifications"),$(".menu-video-item .sum").text(1),$(".menu-video-item").addClass("open")},this.closeCaller=function(){$(".menu-video-more.dropdown-menu").find(".menu-alerts-more-items").html(""),$(".menu-video-item").addClass("no-notifications"),$(".menu-video-item .sum").text(""),$(".menu-video-item").removeClass("open")},this.getInviteTwilio=function(t,o,r,i,n,s){e.video_popup||e.isOpenCaller||(e.participant=i,e.user_id=n,e.isOpenCaller=!0,e.openCaller(),e.check_room_status_invite||(e.check_room_status_invite=setInterval((function(){e.get_status_room(r,"partner")}),5e3)),$(".accept-chat").off("click").click((function(){e.closeCaller(),e.initCall(t,o,r)})),$(".decline-chat").off("click").click((function(){e.sendStatusRoom(r,"decline",s,e.user_id),e.closeCaller(),e.isOpenCaller=!1})),$("html, body").animate({scrollTop:0},"slow"))},this.sendInviteTwilio=function(t){$.ajax({url:site_url+"twilio_chat/get_room/"+t,type:"POST",dataType:"json",cache:!1,success:function(t){if(void 0!==t.info.access_denied&&t.info.access_denied.length>0)return e.contentObj.show_load_block(t.info.access_denied),!1;void 0!==t.errors?error_object.show_error_block(t.errors,"error"):t.data&&t.data.my_token&&(e.tw_token=t.data.my_token,e.room_name=t.data.room_name,e.track_id=t.data.track_id,e.participant=t.data.participant,e.user_id=t.data.user_id,e.createVideo(),e.check_room_status=setInterval((function(){e.track_id&&e.get_status_room(e.track_id,"caller")}),5e3),e.timeConnectCounterId=setInterval((function(){e.timeConnectCounter++}),1e3))},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.createVideo=function(){var t={name:e.room_name,audio:!0,maxAudioBitrate:16e3,video:{frameRate:24}};function o(t){e.timeOfCall.start();var o=document.createElement("div");o.id=t.sid,o.classList="caller",t.on("trackSubscribed",(function(e){return i(o,e)})),t.on("trackUnsubscribed",n),t.tracks.forEach((function(e){e.isSubscribed&&i(o,e.track)})),$("#"+e.room_name).append(o)}function r(t){void 0!==t.localParticipant&&t.localParticipant.tracks.forEach((function(e){return e.track.stop()})),e.timeOfCall.stop(),e.sendStatusRoom(e.track_id,t.state,e.tw_room.sid,e.user_id)}function i(e,t){e.appendChild(t.attach())}function n(e){e.detach().forEach((function(e){return e.remove()}))}e.TW_Video=Twilio.Video,e.TW_Video.isSupported?(e.generatePopup(),e.TW_Video.connect(e.tw_token,t).then((function(t){e.tw_room=t,e.updateVideoDevice(),t.participants.forEach(o),t.on("participantConnected",o),t.on("trackDisabled",(function(e){"video"==e.kind&&$(".twilio-room").removeClass("partner_in")})),t.on("trackEnabled",(function(e){"video"==e.kind&&$(".twilio-room").addClass("partner_in")})),t.on("trackStarted",(function(){$(".twilio-room").addClass("partner_in")})),t.once("disconnected",r)})).catch((function(e){console.log(e.message)}))):error_object.show_error_block("Video stream unavailable, please connect webcam","error")},this.addIndicator=function(){if(!$(".menu-video-item").length&&document.querySelector("#callingIndicator")){var e=document.querySelector("#callingIndicator").innerHTML;$(".navbar-right #users-alerts-menu #menu_admin_alerts").before(e),$(".navbar-ava-xs").after(e),$(".navbar-header .menu-video-item").addClass("navbar-ava-xs"),$(".menu-video-item").tooltip(),$(".menu-video-item").off("click").click((function(){$(".menu-video-item").tooltip("hide")}))}},this.gotDevices=function(t){t.forEach((function(t){"videoinput"===t.kind&&e.cameraDevice.push(t.deviceId)}))},this.updateVideoDevice=function(){e.TW_Video.createLocalVideoTrack({deviceId:{exact:e.cameraDevice[e.camerasCounter]}}).then((function(t){var o=Array.from(e.tw_room.localParticipant.videoTracks.values()).map((function(e){return e.track}));e.local_video_track=t,e.tw_room.localParticipant.unpublishTracks(o),e.tw_room.localParticipant.publishTrack(e.local_video_track),e.tw_room.localParticipant.audioTracks.forEach((function(e){e.track.enable()})),e.local_video=$(".local-media-tw"),e.local_video.html(e.local_video_track.attach())})).catch((function(t){e.sendStatusRoom(e.track_id,"disconnected"),console.error(t)})),e.cameraDevice.length-1>e.camerasCounter?e.camerasCounter++:e.camerasCounter=0,$(".twilio-mute-switcher").removeClass("svg-active"),$(".twilio-camera-off").removeClass("svg-active")},this.switchCamera=function(){e.cameraDevice.length>1&&$(".twilio-camera-switcher").css("display","inline-flex"),$(document).off("click").on("click",".twilio-camera-switcher",e.updateVideoDevice)},this.turnOffOnVideoStream=function(){var t=e.local_video_track;"object"===o(t)&&null!==t?(t.mediaStreamTrack.enabled=!!t.mediaStreamTrack.enabled,e.tw_room.localParticipant.videoTracks.forEach((function(e){e.track.isEnabled?e.track.disable():e.track.enable()}))):$(".twilio-camera-off").removeClass("svg-active")},this.turnOffOnMuteStream=function(){"object"===o(e.tw_room)&&null!==e.tw_room?e.tw_room.localParticipant.audioTracks.forEach((function(e){e.track.isEnabled?e.track.disable():e.track.enable()})):$(".twilio-mute-switcher").removeClass("svg-active")},this.closeBtn=function(){$(".twilio_close").off("click").click((function(e){e.preventDefault(),$(".load_content_close").trigger("click")}))},this.init=function(){e.addIndicator(),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices().then(e.gotDevices),$(document).on("pjax:complete",(function(t){e.video_popup=null,e.isOpenCaller=!1,e.addIndicator(),clearInterval(e.check_room_status_invite)})),e.contentObj=new loadingContent({loadBlockWidth:"400px",loadBlockLeftType:"center",loadBlockTopType:"top"})},this.timeOfCall={_counerId:null,_sec:0,_min:0,_h:0,start:function(){var t=this,o=$(".twilio-room_user_time");this._counerId=setInterval((function(){t._step(),t._sec=e.timeCounter++,o.show(),o.find(".twilio-room_user_time-counter").html(t._format())}),1e3)},stop:function(){$(".twilio-room_user_time").hide(),clearInterval(this._counerId),e.timeCounter=0},_step:function(){59==this._sec&&(this._min++,e.timeCounter=0),59==this._min&&59==this.sec&&(this._h++,this._min=0,this._sec=0),23==this._h&&59==this._min&&59==this.sec&&(this._h=0,this._min=0,this._sec=0)},_format:function(){var e="";return this._h&&(e=this._h+":"+this._min+":"+this._sec),this._min<10?e+=0+this._min:e+=this._min,this._sec<10?e+=":0"+this._sec:e+=":"+this._sec,e}},e.init()})},7591:()=>{jQuery.extend({createUploadIframe:function(e,t){var o="jUploadFrame"+e,r='<iframe id="'+o+'" name="'+o+'" style="position:absolute; top:-9999px; left:-9999px"';return window.ActiveXObject&&("boolean"==typeof t?r+=' src="javascript:false"':"string"==typeof t&&(r+=' src="'+t+'"')),r+=" />",jQuery(r).appendTo(document.body),jQuery("#"+o).get(0)},createUploadForm:function(e,t,o){var r="jUploadForm"+e,i="jUploadFile"+e,n=jQuery('<form  action="" method="POST" name="'+r+'" id="'+r+'" enctype="multipart/form-data"></form>');if(o)for(var s in o)jQuery('<input type="hidden" name="'+s+'" value="'+o[s]+'" />').appendTo(n);var a=jQuery("#"+t),c=jQuery(a).clone();return jQuery(a).attr("id",i),jQuery(a).before(c),jQuery(a).appendTo(n),jQuery(n).css("position","absolute"),jQuery(n).css("top","-1200px"),jQuery(n).css("left","-1200px"),jQuery(n).appendTo("body"),n},ajaxFileUpload:function(e){e=jQuery.extend({},jQuery.ajaxSettings,e);var t=(new Date).getTime(),o=jQuery.createUploadForm(t,e.fileElementId,void 0!==e.data&&e.data),r=(jQuery.createUploadIframe(t,e.secureuri),"jUploadFrame"+t),i="jUploadForm"+t;e.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var n=!1,s={};e.global&&jQuery.event.trigger("ajaxSend",[s,e]);var a=function(t){var i=document.getElementById(r);try{i.contentWindow?(s.responseText=i.contentWindow.document.body?i.contentWindow.document.body.innerHTML:null,s.responseXML=i.contentWindow.document.XMLDocument?i.contentWindow.document.XMLDocument:i.contentWindow.document):i.contentDocument&&(s.responseText=i.contentDocument.document.body?i.contentDocument.document.body.innerHTML:null,s.responseXML=i.contentDocument.document.XMLDocument?i.contentDocument.document.XMLDocument:i.contentDocument.document)}catch(t){jQuery.handleError(e,s,null,t)}if(s||"timeout"==t){var a;n=!0;try{if("error"!=(a="timeout"!=t?"success":"error")){var c=jQuery.uploadHttpData(s,e.dataType);e.success&&e.success(c,a),e.global&&jQuery.event.trigger("ajaxSuccess",[s,e])}else jQuery.handleError(e,s,a)}catch(t){a="error",jQuery.handleError(e,s,a,t)}e.global&&jQuery.event.trigger("ajaxComplete",[s,e]),e.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop"),e.complete&&e.complete(s,a),jQuery(i).unbind(),setTimeout((function(){try{jQuery(i).remove(),jQuery(o).remove()}catch(t){jQuery.handleError(e,s,null,t)}}),100),s=null}};e.timeout>0&&setTimeout((function(){n||a("timeout")}),e.timeout);try{o=jQuery("#"+i),jQuery(o).attr("action",e.url),jQuery(o).attr("method","POST"),jQuery(o).attr("target",r),o.encoding?jQuery(o).attr("encoding","multipart/form-data"):jQuery(o).attr("enctype","multipart/form-data"),jQuery(o).submit()}catch(t){jQuery.handleError(e,s,null,t)}return jQuery("#"+r).load(a),{abort:function(){}}},uploadHttpData:function uploadHttpData(r,type){var data=!type;return data="xml"==type||data?r.responseXML:r.responseText,"script"==type&&jQuery.globalEval(data),"json"==type&&eval("data = "+data),"html"==type&&jQuery("<div>").html(data).evalScripts(),data}})},4237:()=>{!function(e){var t,o,r,i,n,s,a,c,p,l,d,u,_,f,h,m,g,b,v,y,k,w,$,x,S,j,C,T,P,I,M,B,O,A,U,D,E,R=(t=65,o={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!1},r=function(t,o){var r=U(t);e(o).data("colorpicker").fields.eq(1).val(r.r).end().eq(2).val(r.g).end().eq(3).val(r.b).end()},i=function(t,o){e(o).data("colorpicker").fields.eq(4).val(t.h).end().eq(5).val(t.s).end().eq(6).val(t.b).end()},n=function(t,o){e(o).data("colorpicker").fields.eq(0).val(D(t)).end()},s=function(t,o){e(o).data("colorpicker").selector.css("backgroundColor","#"+D({h:t.h,s:100,b:100})),e(o).data("colorpicker").selectorIndic.css({left:parseInt(150*t.s/100,10),top:parseInt(150*(100-t.b)/100,10)})},a=function(t,o){e(o).data("colorpicker").hue.css("top",parseInt(150-150*t.h/360,10))},c=function(t,o){e(o).data("colorpicker").currentColor.css("backgroundColor","#"+D(t))},p=function(t,o){e(o).data("colorpicker").newColor.css("backgroundColor","#"+D(t))},l=function(o){var r=o.charCode||o.keyCode||-1;if(r>t&&r<=90||32==r)return!1;!0===e(this).parent().parent().data("colorpicker").livePreview&&d.apply(this)},d=function(t){var o,c=e(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?c.data("colorpicker").color=o=O(B(this.value)):this.parentNode.className.indexOf("_hsb")>0?c.data("colorpicker").color=o=I({h:parseInt(c.data("colorpicker").fields.eq(4).val(),10),s:parseInt(c.data("colorpicker").fields.eq(5).val(),10),b:parseInt(c.data("colorpicker").fields.eq(6).val(),10)}):c.data("colorpicker").color=o=A(M({r:parseInt(c.data("colorpicker").fields.eq(1).val(),10),g:parseInt(c.data("colorpicker").fields.eq(2).val(),10),b:parseInt(c.data("colorpicker").fields.eq(3).val(),10)})),t&&(r(o,c.get(0)),n(o,c.get(0)),i(o,c.get(0))),s(o,c.get(0)),a(o,c.get(0)),p(o,c.get(0)),c.data("colorpicker").onChange.apply(c,[o,D(o),U(o)])},u=function(t){e(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus")},_=function(){t=this.parentNode.className.indexOf("_hex")>0?70:65,e(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),e(this).parent().addClass("colorpicker_focus")},f=function(t){var o=e(this).parent().find("input").focus(),r={el:e(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:t.pageY,field:o,val:parseInt(o.val(),10),preview:e(this).parent().parent().data("colorpicker").livePreview};e(document).on("mouseup",r,m),e(document).on("mousemove",r,h)},h=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val+e.pageY-e.data.y,10)))),e.data.preview&&d.apply(e.data.field.get(0),[!0]),!1},m=function t(o){return d.apply(o.data.field.get(0),[!0]),o.data.el.removeClass("colorpicker_slider").find("input").focus(),e(document).unbind("mouseup",t),e(document).unbind("mousemove",h),!1},g=function(t){var o={cal:e(this).parent(),y:e(this).offset().top};o.preview=o.cal.data("colorpicker").livePreview,e(document).on("mouseup",o,v),e(document).on("mousemove",o,b)},b=function(e){return d.apply(e.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,e.pageY-e.data.y)))/150,10)).get(0),[e.data.preview]),!1},v=function t(o){return r(o.data.cal.data("colorpicker").color,o.data.cal.get(0)),n(o.data.cal.data("colorpicker").color,o.data.cal.get(0)),e(document).unbind("mouseup",t),e(document).unbind("mousemove",b),!1},y=function(t){var o={cal:e(this).parent(),pos:e(this).offset()};o.preview=o.cal.data("colorpicker").livePreview,e(document).on("mouseup",o,w),e(document).on("mousemove",o,k)},k=function(e){return d.apply(e.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,e.pageY-e.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,e.pageX-e.data.pos.left))/150,10)).get(0),[e.data.preview]),!1},w=function t(o){return r(o.data.cal.data("colorpicker").color,o.data.cal.get(0)),n(o.data.cal.data("colorpicker").color,o.data.cal.get(0)),e(document).unbind("mouseup",t),e(document).unbind("mousemove",k),!1},$=function(t){e(this).addClass("colorpicker_focus")},x=function(t){e(this).removeClass("colorpicker_focus")},S=function(t){var o=e(this).parent(),r=o.data("colorpicker").color;o.data("colorpicker").origColor=r,c(r,o.get(0)),o.data("colorpicker").onSubmit(r,D(r),U(r),o.data("colorpicker").el)},j=function(t){var o=e("#"+e(this).data("colorpickerId"));o.data("colorpicker").onBeforeShow.apply(this,[o.get(0)]);var r=e(this).offset(),i=P(),n=r.top+this.offsetHeight,s=r.left;return n+176>i.t+i.h&&(n-=this.offsetHeight+176),s+356>i.l+i.w&&(s-=356),o.css({left:s+"px",top:n+"px"}),0!=o.data("colorpicker").onShow.apply(this,[o.get(0)])&&o.show(),e(document).on("mousedown",{cal:o},C),!1},C=function t(o){T(o.data.cal.get(0),o.target,o.data.cal.get(0))||(0!=o.data.cal.data("colorpicker").onHide.apply(this,[o.data.cal.get(0)])&&o.data.cal.hide(),e(document).unbind("mousedown",t))},T=function(e,t,o){if(e==t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));for(var r=t.parentNode;r&&r!=o;){if(r==e)return!0;r=r.parentNode}return!1},P=function(){var e="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(e?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(e?document.documentElement.clientHeight:document.body.clientHeight)}},I=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},M=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},B=function(e){var t=6-e.length;if(t>0){for(var o=[],r=0;r<t;r++)o.push("0");o.push(e),e=o.join("")}return e},O=function(e){return A(function(e){return{r:(e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16))>>16,g:(65280&e)>>8,b:255&e}}(e))},A=function(e){var t={h:0,s:0,b:0},o=Math.min(e.r,e.g,e.b),r=Math.max(e.r,e.g,e.b),i=r-o;return t.b=r,t.s=0!=r?255*i/r:0,0!=t.s?e.r==r?t.h=(e.g-e.b)/i:e.g==r?t.h=2+(e.b-e.r)/i:t.h=4+(e.r-e.g)/i:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},U=function(e){var t={},o=Math.round(e.h),r=Math.round(255*e.s/100),i=Math.round(255*e.b/100);if(0==r)t.r=t.g=t.b=i;else{var n=i,s=(255-r)*i/255,a=o%60*(n-s)/60;360==o&&(o=0),o<60?(t.r=n,t.b=s,t.g=s+a):o<120?(t.g=n,t.b=s,t.r=n-a):o<180?(t.g=n,t.r=s,t.b=s+a):o<240?(t.b=n,t.r=s,t.g=n-a):o<300?(t.b=n,t.g=s,t.r=s+a):o<360?(t.r=n,t.g=s,t.b=n-a):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},D=function(t){return o=U(t),r=[o.r.toString(16),o.g.toString(16),o.b.toString(16)],e.each(r,(function(e,t){1==t.length&&(r[e]="0"+t)})),r.join("");var o,r},E=function(){var t=e(this).parent(),o=t.data("colorpicker").origColor;t.data("colorpicker").color=o,r(o,t.get(0)),n(o,t.get(0)),i(o,t.get(0)),s(o,t.get(0)),a(o,t.get(0)),p(o,t.get(0))},{init:function(t){if("string"==typeof(t=e.extend({},o,t||{})).color)t.color=O(t.color);else if(null!=t.color.r&&null!=t.color.g&&null!=t.color.b)t.color=A(t.color);else{if(null==t.color.h||null==t.color.s||null==t.color.b)return this;t.color=I(t.color)}return this.each((function(){if(!e(this).data("colorpickerId")){var o=e.extend({},t);o.origColor=t.color;var h="collorpicker_"+parseInt(1e3*Math.random());e(this).data("colorpickerId",h);var m=e('<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>').attr("id",h);o.flat?m.appendTo(this).show():m.appendTo(document.body),o.fields=m.find("input").on("keyup",l).on("change",d).on("blur",u).on("focus",_),m.find("span").on("mousedown",f).end().find(">div.colorpicker_current_color").on("click",E),o.selector=m.find("div.colorpicker_color").on("mousedown",y),o.selectorIndic=o.selector.find("div div"),o.el=this,o.hue=m.find("div.colorpicker_hue div"),m.find("div.colorpicker_hue").on("mousedown",g),o.newColor=m.find("div.colorpicker_new_color"),o.currentColor=m.find("div.colorpicker_current_color"),m.data("colorpicker",o),m.find("div.colorpicker_submit").on("mouseenter",$).on("mouseleave",x).on("click",S),r(o.color,m.get(0)),i(o.color,m.get(0)),n(o.color,m.get(0)),a(o.color,m.get(0)),s(o.color,m.get(0)),c(o.color,m.get(0)),p(o.color,m.get(0)),o.flat?m.css({position:"relative",display:"block"}):e(this).on(o.eventName,j)}}))},showPicker:function(){return this.each((function(){e(this).data("colorpickerId")&&j.apply(this)}))},hidePicker:function(){return this.each((function(){e(this).data("colorpickerId")&&e("#"+e(this).data("colorpickerId")).hide()}))},setColor:function(t){if("string"==typeof t)t=O(t);else if(null!=t.r&&null!=t.g&&null!=t.b)t=A(t);else{if(null==t.h||null==t.s||null==t.b)return this;t=I(t)}return this.each((function(){if(e(this).data("colorpickerId")){var o=e("#"+e(this).data("colorpickerId"));o.data("colorpicker").color=t,o.data("colorpicker").origColor=t,r(t,o.get(0)),i(t,o.get(0)),n(t,o.get(0)),a(t,o.get(0)),s(t,o.get(0)),c(t,o.get(0)),p(t,o.get(0))}}))}});e.fn.extend({ColorPicker:R.init,ColorPickerHide:R.hidePicker,ColorPickerShow:R.showPicker,ColorPickerSetColor:R.setColor})}(jQuery)},1202:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.UserInformation=function(e){this.properties={siteUrl:"/",id:{descriptionBlock:"#ui-description_block"},class:{UIModulesList:".ui-modules_list",contentPage:".content-page"},data:{action:{createArchive:'[data-action="create-archive"]',duringArchive:'[data-action="during-archive"]',readyArchive:'[data-action="ready-archive"]',deleteArchive:'[data-action="delete-archive"]',UIChange:'[data-action="ui_change"]'}},url:{create:"user_information/create/",delete:"user_information/delete/",download:"user_information/download/",page:"users/settings/download_my_data"},lang:{systemError:"System error!"},errorObj:new Errors};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls()},this.initControls=function(){$(document).off("click",t.properties.data.action.createArchive).on("click",t.properties.data.action.createArchive,(function(){t.createArchive($(this))})).off("click",t.properties.data.action.readyArchive).on("click",t.properties.data.action.readyArchive,(function(){t.readyArchive()})).off("click",t.properties.data.action.deleteArchive).on("click",t.properties.data.action.deleteArchive,(function(){t.deleteArchive()})).off("change",t.properties.data.action.UIChange).on("change",t.properties.data.action.UIChange,(function(){t.selectModules()}))},this.selectModules=function(){0===$(t.properties.data.action.UIChange+":checked").length?$(t.properties.data.action.createArchive).prop("disabled",!0):$(t.properties.data.action.createArchive).prop("disabled",!1)},this.createArchive=function(e){if(0!==$(t.properties.data.action.UIChange+":checked").length){var o=[];$(t.properties.data.action.UIChange+":checked").each((function(){o.push($(this).data("module"))})),t.query(t.properties.url.create,{create:1,modules:o},"json",(function(o){void 0!==o.error&&0!==o.error.length||(e.attr({"data-action":"during-archive","data-status":"during"}).removeClass("btn-primary").addClass("btn-default").html('<i class="fa fa-spinner" aria-hidden="true"></i> '+t.properties.lang.btnDuring),$(t.properties.id.descriptionBlock).html('<div class="well">'+t.properties.lang.descriptionPrepared+"</div>"))}))}},this.readyArchive=function(){location.href=t.properties.siteUrl+t.properties.url.download},this.deleteArchive=function(){t.query(t.properties.url.delete,{delete:1},"json",(function(e){void 0!==e.error&&0!==e.error.length||locationHref(t.properties.siteUrl+t.properties.url.page)}))},this.query=function(e,o,r,i){return/^(f|ht)tps?:\/\//i.test(e)||(e=t.properties.siteUrl+e),$.ajax({url:e,type:"POST",cache:!1,data:o,dataType:r,success:function(e){void 0!==e.error&&e.error.length>0&&t.properties.errorObj.show_error_block(e.error,"error"),void 0!==e.info&&e.info.length>0&&t.properties.errorObj.show_error_block(e.info,"info"),void 0!==e.success&&e.success.length>0&&t.properties.errorObj.show_error_block(e.success,"success"),void 0!==i&&i(e)}}),!1},t.Init(e)})},6999:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.UsersFieldsValidation=function(e){this.properties={siteUrl:"/",objBtnDisabled:!1,url:{validation:"users/fieldValidation/"},ages:{},langs:{},rules:{},fields:{},data:{actionValidationChange:'[data-action="validation"]:checkbox',actionValidationFocus:'[data-action="validation"]:not(checkbox)',actionValidationClick:'li[data-action="validation"]',actionValidationKeyUp:'[data-action="validation-keyup"]'},class:{status:{success:"has-success",warning:"has-warning",error:"has-error"}},errorObj:new Errors,method:{email:function(e){t.emailValidation(e)},password:function(e){t.passwordValidation(e)},nickname:function(){t.nicknameValidation()},birth_date:function(){t.birthDateValidation()},confirmation:function(e){t.confirmationValidation(e)}}};var t=this;return this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),t.setData()},this.initControls=function(){$(document).off("focusout",t.properties.data.actionValidationFocus).on("focusout",t.properties.data.actionValidationFocus,(function(){t.fieldValidation(this)})).off("change",t.properties.data.actionValidationChange).on("change",t.properties.data.actionValidationChange,(function(){t.fieldValidation(this)})).off("click",t.properties.data.actionValidationClick).on("click",t.properties.data.actionValidationClick,(function(){t.fieldValidation(this)})).off("keyup",t.properties.data.actionValidationKeyUp).on("keyup",t.properties.data.actionValidationKeyUp,(function(){t.fieldValidation(this)}))},this.setData=function(){for(var e in t.properties.fields)t.properties.data[e+"Field"]='[data-field="'+e+'"]'},this.fieldValidation=function(e,o){if(void 0!==t.properties.method[$(e).data("field")])return t.properties.method[$(e).data("field")](o)},this.emailValidation=function(e){var o=$(t.properties.data.emailField).val();t.properties.rules.email.test(o)?t.query(t.properties.url.validation,{data:{field:"email",value:o}},"json",(function(e){t.isValidate("email",e.error.email)})):t.isValidate("email",t.properties.langs.errors.email,e)},this.confirmationValidation=function(){var e=!0===$(t.properties.data.confirmationField).prop("checked")?1:0;return t.properties.rules.confirmation.test(e)?t.isValidate("confirmation"):t.isValidate("confirmation",t.properties.langs.errors.confirmation),this},this.nicknameValidation=function(){var e=$(t.properties.data.nicknameField).val();t.properties.rules.nickname.test(e)?t.query(t.properties.url.validation,{data:{field:"nickname",value:e}},"json",(function(e){t.isValidate("nickname",e.error.nickname)})):t.isValidate("nickname",t.properties.langs.errors.nickname)},this.passwordValidation=function(e){var o=$(t.properties.data.passwordField).val();t.properties.rules.password.test(o)?t.query(t.properties.url.validation,{data:{field:"password",value:o}},"json",(function(e){t.isValidate("password",e.error.password)})):t.isValidate("password",t.properties.langs.errors.password,e)},this.birthDateValidation=function(){var e=$("#birth_date").val(),o=t.birthDateToAge(e);if(o>=t.properties.ages.age_min||o<=t.properties.ages.age_max)t.query(t.properties.url.validation,{data:{field:"birth_date",value:e}},"json",(function(e){t.isValidate("birth_date",e.error.birth_date)}));else{var r=t.properties.langs.errors.birth_date.replace("[min_age]",t.properties.ages.age_min);r=r.replace("[max_age]",t.properties.ages.age_max),t.isValidate("birth_date",r)}},this.birthDateToAge=function(e){var t=new Date,o=new Date(e),r=t.getFullYear()-o.getFullYear();return t.setFullYear(1972)<o.setFullYear(1972)?r-1:r},this.isValidate=function(e,o,r){t.properties.fields[e]=!1,$(t.properties.data[e+"Field"]).next(".tooltip").remove(),void 0!==o&&0!==o?$(t.properties.data[e+"Field"]).after((function(){return'<div class="tooltip">'+o+"</div>"})).closest("div").removeClass(t.properties.class.status.success).addClass((function(){if(void 0===r)return t.properties.class.status.error})):(t.properties.fields[e]=!0,$(t.properties.data[e+"Field"]).closest("div").removeClass(t.properties.class.status.error).addClass(t.properties.class.status.success))},this.query=function(e,o,r,i){return/^(f|ht)tps?:\/\//i.test(e)||(e=t.properties.siteUrl+e),$.ajax({url:e,type:"POST",cache:!1,data:o,dataType:r,success:function(e){void 0!==i&&i(e)}}),!1},t.Init(e),this})},8337:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.UsersRegistration=function(e){"use strict";this.properties={siteUrl:"/",id:{firstRegistrationPage:"#first-registration-page",secondRegistrationPage:"#second-registration-page",thirdRegistrationPage:"#third-registration-page",fourthRegistrationPage:"#fourth-registration-page",email:"#email",password:"#password",nickname:"#nickname",birthDate:"#birth_date",gRecaptchaResponse:"#g-recaptcha-response",mainMenuContainer:"#main-menu-container",bottomBtns:"#bottom-btns",pjaxContainer:"#pjaxcontainer",datepicker:"#datepicker",staticAlertBlock:"#static-alert-block",termsAndConditions:"#terms_and_conditions",privacyAndSecurity:"#privacy_and_security"},name:{idCountry:'input[name="id_country"]',idRegion:'input[name="id_region"]',idCity:'input[name="id_city"]',lat:'input[name="lat"]',lon:'input[name="lon"]',confirmation:'input[name="confirmation"]'},class:{registrationBlock:".registration-block",mainBlockPages:".main-block-pages",preMainInnerContent:".pre-main-inner-content",header:".b-header__topline",afterheader:".b-afterheader",features:".b-features",mobile:".b-mobile",footer:".b-footer",pageWraper:".pages-wraper",dropdownLocation:".dropdown_location"},data:{buttonTypeI:'[data-button_type="i"]',buttonTypeLook:'[data-button_type="look"]',blockPages:'[data-block="pages"]',UserTypeI:'[data-user_type="i"]',UserTypeLook:'[data-user_type="look"]',selectDay:'[data-handler="selectDay"]',selectMonth:'[data-handler="selectMonth"]',selectYear:'[data-handler="selectYear"]'},dataAction:{nextPage:'[data-action="next-page"]',prevPage:'[data-action="prev-page"]',setPage:'[data-action="set-page"]',userType:'[data-action="user-type"] li',updateProfile:'[data-action="update-profile"]',rebuildView:'[data-action="rebuild-view"]',showRegistrationBlock:'[data-action="show-registration-block"]'},url:{registration:"users/registration/",photoUpload:"users/photoUpload/",quickPage:"content/quickPage"},langs:{},user:{},errors:{},dateFormat:"yy-mm-dd",pages:4,pageBlock:1,isAuth:0,isLink:0,timeout_obj:null,timeout:500,errorObj:new Errors,isCouple:!1,simpleRegPage:!1,isRegistration:0,usersFieldsValidation:null,contentObj:new loadingContent({loadBlockWidth:"800px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0})};var t=this,o={},r={1:["user_type","looking_user_type"],2:["email","password","confirmation"],3:["nickname","birth_date","captcha_confirmation","nickname_couple","birth_date_couple"]};return this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),t.getPage(),1!==t.properties.isLink&&1!==t.properties.isRegistration&&(t.setPage(t.properties.pageBlock),t.render()),1===t.properties.isRegistration&&t.showRegistrationBlock()},this.initControls=function(){$(document).off("click",t.properties.dataAction.userType).on("click",t.properties.dataAction.userType,(function(){t.setUserType(this,!0)})).off("click",t.properties.dataAction.nextPage).on("click",t.properties.dataAction.nextPage,(function(){t.navigatingPages(this)})).off("click",t.properties.dataAction.prevPage).on("click",t.properties.dataAction.prevPage,(function(){t.navigatingPages(this)})).off("click",t.properties.dataAction.setPage).on("click",t.properties.dataAction.setPage,(function(){t.navigatingPages(this)})).off("click",t.properties.dataAction.updateProfile).on("click",t.properties.dataAction.updateProfile,(function(e){t.sendData(e)})).off("click",t.properties.id.termsAndConditions).on("click",t.properties.id.termsAndConditions,(function(){t.quickPage(this)})).off("click",t.properties.id.privacyAndSecurity).on("click",t.properties.id.privacyAndSecurity,(function(){t.quickPage(this)})).off("click",t.properties.dataAction.showRegistrationBlock).on("click",t.properties.dataAction.showRegistrationBlock,(function(){t.showRegistrationBlock()})).off("click",t.properties.class.pageWraper).on("click",t.properties.class.pageWraper,(function(e){"pages"===$(e.target).data("block")&&"close"===$(e.target).data("act")&&1!==t.properties.isRegistration&&t.hideRegistrationBlock()}))},this.render=function(){$(t.properties.class.registrationBlock).find('input:not([type="checkbox"])').addClass("input-lg")},this.navigatingPages=function(e){var o=parseInt($(e).data("page"));for(var i in r[o])if(t.properties.usersFieldsValidation&&!1===t.properties.usersFieldsValidation.properties.fields[r[o][i]]&&(2==o&&"next-page"==$(e).data("action")&&($("#"+r[o][i]).focusout(),$("#"+r[o][i]).focus()),2!=o||"set-page"!=$(e).data("action")))return!1;"next-page"===$(e).data("action")&&0<o<t.properties.pages?o++:"prev-page"===$(e).data("action")&&1<o<=t.properties.pages&&o--,$(t.properties.data.blockPages).addClass("hide"),t.setPage(o)},this.getPage=function(){if(null!==t.properties.errors&&t.properties.usersFieldsValidation){var e=t.properties.usersFieldsValidation.properties.method;for(var o in e)e[o]();var i=Object.keys(t.properties.errors).length,n=1;for(var s in t.properties.errors)for(var a in r)-1!=$.inArray(s,r[a])&&(n==a&&(t.properties.pageBlock=n),n>a&&(t.properties.pageBlock=a),n<a&&(t.properties.pageBlock=n),1==i&&(t.properties.pageBlock=a),n=a)}},this.setPage=function(e){var o=parseInt(e);switch(t.properties.pageBlock=o,o){case 1:t.firstPage();break;case 2:t.secondPage();break;case 3:t.thirdPage();break;case 4:t.fourthPage()}},this.changePaginator=function(e){if("0"===t.properties.user.isAuth){for(var o='<div class="paginator">',r=1;r<=t.properties.pages;r++)r===e?o+='<i class="fa fa-circle active" data-action="set-page" data-page="'+r+'"></i>':r<e?o+='<i class="fa fa-circle" data-action="set-page" data-page="'+r+'"></i>':0!==t.properties.isAuth?o+='<i class="far fa-circle" data-page="'+r+'" data-action="set-page"></i>':o+='<i class="far fa-circle" data-page="'+r+'"></i>';return o+"</div>"}},this.firstPage=function(){if($(window).width()<768&&$("body").css("position","inherit"),$("body").css("overflow-y","auto"),$(t.properties.id.firstRegistrationPage).removeClass("hide"),1===t.properties.isLink||1===t.properties.isRegistration?($(t.properties.class.mainBlockPages).removeClass("hide"),$("body").css("overflow-y","hidden")):$(t.properties.class.mainBlockPages).addClass("hide"),void 0===o.user_type&&t.setUserType($(t.properties.data.UserTypeI+" li:eq(0)"),!1),void 0===o.looking_user_type){var e=$(t.properties.data.UserTypeLook+" li").length;e>1?t.setUserType($(t.properties.data.UserTypeLook+" li:eq(1)"),!1):1===e&&t.setUserType($(t.properties.data.UserTypeLook+" li:eq(0)"),!1)}1!==t.properties.isLink&&1!==t.properties.isRegistration||!1!==$(t.properties.id.firstRegistrationPage).find("div").is(".paginator")||(t.keyUpNextPage(t.properties.dataAction.nextPage),$(window).width()<768&&$("body").css("position","fixed"),$("body").css("overflow-y","hidden"),$(t.properties.class.mainBlockPages).removeClass("hide"),$(t.properties.id.firstRegistrationPage+">div").prepend(t.changePaginator(1)))},this.secondPage=function(){$(window).width()<768&&$("body").css("position","fixed"),$("body").css("overflow-y","hidden"),$(t.properties.id.secondRegistrationPage).removeClass("hide"),$(t.properties.class.mainBlockPages).removeClass("hide"),t.properties.timeout_obj&&clearTimeout(t.properties.timeout_obj),t.properties.timeout_obj=setTimeout((function(){document.getElementById("email").addEventListener("input",(function(){return t.properties.usersFieldsValidation.fieldValidation(this,"info"),!0})),document.getElementById("password").addEventListener("input",(function(){return t.properties.usersFieldsValidation.fieldValidation(this,"info"),!0})),document.getElementById("confirmation").addEventListener("input",(function(){return t.properties.usersFieldsValidation.fieldValidation(this,"info"),!0}))}),t.properties.timeout),!1===$(t.properties.id.secondRegistrationPage).find("div").is(".paginator")&&(1===t.properties.isLink||t.properties.isRegistration,$(t.properties.id.secondRegistrationPage+">div").prepend(t.changePaginator(2))),t.keyUpNextPage(t.properties.dataAction.nextPage)},this.thirdPage=function(){t.properties.simpleRegPage?t.formatDPickerField(""):($(window).width()<768&&$("body").css("position","fixed"),$("body").css("overflow-y","hidden"),$(t.properties.id.thirdRegistrationPage).removeClass("hide"),$(t.properties.class.mainBlockPages).removeClass("hide"),!1===$(t.properties.id.thirdRegistrationPage).find("div").is(".paginator")&&(t.properties.isLink,$(t.properties.id.thirdRegistrationPage+">div").prepend(t.changePaginator(3)),t.formatDPickerField(""),t.properties.usersFieldsValidation.birthDateValidation(),t.geoData(),t.scaleCaptcha(),$(t.properties.class.pageWraper).scroll((function(){var e=$('input[name="region_name"]').offset().top+45;$(t.properties.class.dropdownLocation).css("top",e)})),$(window).resize((function(){var e=$('input[name="region_name"]').offset().top+45,o=$('input[name="region_name"]').offset().left,r=$('input[name="region_name"]').closest(".input-autocomplete").width();$(t.properties.class.dropdownLocation).css({top:e,left:o,width:r}),t.scaleCaptcha()})))),t.keyUpNextPage(t.properties.dataAction.updateProfile)},this.fourthPage=function(){1===t.properties.isAuth?($(t.properties.id.pjaxcontainer).hide("overflow-y","hidden"),$(t.properties.id.fourthRegistrationPage).removeClass("hide"),$(t.properties.class.mainBlockPages).removeClass("hide"),!1===$(t.properties.id.fourthRegistrationPage).find("div").is(".paginator")&&$(t.properties.id.fourthRegistrationPage+">div").prepend(t.changePaginator(4)),$("#bottom-btns").addClass("hide"),$("#pjaxcontainer").addClass("blur-page").find(".pjaxcontainer-inner").addClass("blur-it")):t.thirdPage()},this.sendData=function(e){e.preventDefault();var o=!0;for(var r in t.properties.usersFieldsValidation.properties.fields)!1===t.properties.usersFieldsValidation.properties.fields[r]&&(t.properties.usersFieldsValidation.fieldValidation(document.getElementById(r),"info"),o=!1);!0===o&&t.query(t.properties.url.registration,$(t.properties.class.registrationBlock).find("form").serialize(),"json",(function(e){void 0!==e.errors&&e.errors.length>0?void 0!==e.error.name&&t.properties.usersFieldsValidation.fieldValidation(document.getElementById(e.error.name),"info"):void 0!==e.redirect&&locationHref(e.redirect,!0)}))},this.setUserType=function(e,r){"i"===$(e).closest("ul").data("user_type")?""!==$('input[name="data[user_type]"]').val()&&!0!==r||($(t.properties.data.buttonTypeI+">span:first").text($(e).text()),o.user_type=$(e).data("type"),$('input[name="data[user_type]"]').val($(e).data("type"))):""!==$('input[name="data[looking_user_type]"]').val()&&!0!==r||($(t.properties.data.buttonTypeLook+">span:first").text($(e).text()),o.looking_user_type=$(e).data("type"),$('input[name="data[looking_user_type]"]').val($(e).data("type")))},this.geoData=function(){navigator.geolocation&&"undefined"!=typeof autoloc_obj&&navigator.geolocation.getCurrentPosition((function(e){var t=e.coords.latitude,o=e.coords.longitude;if("undefined"!=typeof Storage){var r=t+";"+o;localStorage.getItem("userLocation")!==r&&localStorage.setItem("userLocation",r)}autoloc_obj.identifyLocation()}))},this.formatDPickerField=function(e){var o=new Date,r=new Date(o.getFullYear()-t.properties.user.age_max,0,1).getFullYear()+":"+new Date(o.getFullYear()-t.properties.user.age_min,0,1).getFullYear();$(t.properties.id.datepicker+e).datepicker({dateFormat:t.properties.dateFormat,changeYear:!0,changeMonth:!0,yearRange:r}),new DatepickerDropdownTemplate({setDate:t.properties.user.setDate,dateFormat:t.properties.user.dateFormat,inputName:"data[birth_date"+e+"]",postfix:e,langs:{defaultDay:t.properties.langs.defaultDay,defaultMonth:t.properties.langs.defaultMonth,defaultYear:t.properties.langs.defaultYear}}),$(t.properties.data.selectDay).attr({"data-field":"birth_date"+e,"data-action":"validation"}),$(t.properties.data.selectMonth).attr({"data-field":"birth_date"+e,"data-action":"validation"}),$(t.properties.data.selectYear).attr({"data-field":"birth_date"+e,"data-action":"validation"})},this.quickPage=function(e){t.query(t.properties.url.quickPage,{gid:$(e).data("gid")},"json",(function(e){t.properties.contentObj.show_load_block(e.data),$(".load_content_bg").css("overflow-y","auto")}))},this.scaleCaptcha=function(){var e=$(".captcha-block>div").width()/304;$(".g-recaptcha").css({transform:"scale("+e+", 1)"})},this.showRegistrationBlock=function(){1==$(t.properties.dataAction.showRegistrationBlock).data("gotoform")&&$("html, body").animate({scrollTop:$(t.properties.id.firstRegistrationPage).offset().top+"px"},"fast"),t.setPage(t.properties.pageBlock)},this.getFormData=function(e){return o[e]},this.hideRegistrationBlock=function(){$("body").css("overflow-y","auto"),1===t.properties.isLink||1===t.properties.isRegistration||$(t.properties.id.firstRegistrationPage).removeClass("hide"),$(t.properties.class.mainBlockPages).addClass("hide")},this.query=function(e,o,r,i){return/^(f|ht)tps?:\/\//i.test(e)||(e=t.properties.siteUrl+e),$.ajax({url:e,type:"POST",cache:!1,data:o,dataType:r,success:function(e){void 0!==e.error&&0!==e.error.length&&t.properties.errorObj.show_error_block(e.error,"error"),void 0!==e.info&&0!==e.info.length&&t.properties.errorObj.show_error_block(e.info,"info"),void 0!==e.success&&0!==e.success.length&&t.properties.errorObj.show_error_block(e.success,"success"),void 0!==i&&i(e)}}),!1},this.keyUpNextPage=function(e){$(document).keydown((function(t){if(13===t.keyCode)return t.preventDefault(),t.stopPropagation(),$(e).each((function(){if($(this).is(":visible"))return $(this).click(),!1})),!1}))},t.Init(e),this})},43:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.UsersSearch=function(e){"use strict";this.properties={siteUrl:"/",loadOnScroll:!0,sort:"date_created",users:{countAll:null,countPage:null},page:{count:1,previous:0,current:1,next:2},scrollPage:{},id:{mainUsersResults:"#main_users_results",formButton:"#main_search_button",formId:"#main_search_form"},dataAction:{showMore:'[data-action="show-more"]',showPrevious:'[data-action="show-previous"]',sortBy:'[data-action="sort-by"]',sendSearchForm:'[data-action="send_search_form"]',setPage:'[data-action="set-page"]',scrollToTop:'[data-action="scroll-to-top"]'},url:{search:"users/search/",ajaxSearch:"users/ajax_search/search/",ajaxLoadUsers:"users/ajaxLoadUsers/"},langs:{},tempScrollTop:0};var t=this,o={lastUrl:null};return this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),t.scrollPage()},this.uninit=function(){return $(document).off("click",t.properties.dataAction.showMore).off("click",t.properties.dataAction.showPrevious).off("click",t.properties.dataAction.sortBy).off("click",t.properties.dataAction.scrollToTop),this},this.initControls=function(){$(document).off("click",t.properties.dataAction.showMore).on("click",t.properties.dataAction.showMore,(function(){t.getUsers($(this),"next")})).off("click",t.properties.dataAction.showPrevious).on("click",t.properties.dataAction.showPrevious,(function(){t.getUsers($(this),"previous")})).off("click",t.properties.dataAction.sortBy).on("click",t.properties.dataAction.sortBy,(function(){t.sortUsers($(this))})).off("click",t.properties.dataAction.scrollToTop).on("click",t.properties.dataAction.scrollToTop,(function(){$("html, body").animate({scrollTop:0},"slow")}))},this.getUsers=function(e,o){e.closest(".tac").remove();var r="next";"next"===o?(r="previous",t.properties.page[o]=t.properties.page.next):t.properties.page[o]=t.properties.page.previous,t.query(t.properties.url.ajaxLoadUsers+t.properties.sort,{page:t.properties.page[o],hide_dir:r},"json",(function(e){e.content?("next"===o?($(t.properties.id.mainUsersResults).append(e.content),t.properties.page.current=t.properties.page.next,t.properties.page.next=t.properties.page.next+1):(window.history.pushState(null,null,t.properties.siteUrl+t.properties.url.search+t.properties.sort+"/desc/"+t.properties.page[o]),t.properties.page.current=t.properties.page.previous,t.properties.page.previous=t.properties.page.previous-1,$(t.properties.id.mainUsersResults).prepend(e.content),t.scrollPage()),t.properties.scrollPage[t.properties.page.current]=$('[data-page="'+t.properties.page.current+'"]').offset().top,$("html, body").animate({scrollTop:t.properties.scrollPage[t.properties.page.current]-150},"slow")):$(t.properties.id.mainUsersResults).append(t.properties.langs.usersNotFound)}))},this.sortUsers=function(e){$(t.properties.dataAction.sortBy).removeClass("active"),e.addClass("active"),t.resetPage(),t.properties.sort=e.data("sort"),window.history.pushState(null,null,t.properties.siteUrl+t.properties.url.search+t.properties.sort+"/desc/"+t.properties.page.current),t.query(t.properties.url.ajaxSearch+"search/"+t.properties.sort+"/desc/"+t.properties.page.current,{},"html",(function(e){$(t.properties.id.mainUsersResults).html(e)}))},this.resetPage=function(){t.properties.page.previous=0,t.properties.page.current=1,t.properties.page.next=2},this.reset=function(){t.resetPage(),window.history.pushState(null,null,t.properties.siteUrl+t.properties.url.search)},this.scrollPage=function(){var e=0;t.properties.scrollPage={},$(t.properties.dataAction.setPage).each((function(e,o){t.properties.scrollPage[$(o).data("page")]=$(o).offset().top})),window.addEventListener("popstate",(function(e){-1!==window.location.href.indexOf(t.properties.siteUrl+"users/search")&&locationHref(window.location.href)})),-1!==window.location.href.indexOf(t.properties.siteUrl+"users/search")&&$(window).scroll((function(){var r=$(this).scrollTop();e<r?t.properties.scrollPage[t.properties.page.current]<r&&t.properties.scrollPage[t.properties.page.current+1]>r&&(t.properties.page.current=t.properties.page.current+1):e>r&&t.properties.scrollPage[t.properties.page.current]>r&&t.properties.scrollPage[t.properties.page.current-1]<r&&(t.properties.page.current=t.properties.page.current-1),window.location.href.indexOf(t.properties.siteUrl+"users/search")>-1&&o.lastUrl!==t.properties.siteUrl+"users/search/"+t.properties.sort+"/desc/"+t.properties.page.current&&(o.lastUrl=t.properties.siteUrl+"users/search/"+t.properties.sort+"/desc/"+t.properties.page.current,window.history.pushState(null,null,o.lastUrl)),e=r,t.scrollToTop(r)}))},this.scrollToTop=function(e){e>150?$(t.properties.dataAction.scrollToTop).fadeIn("fast"):$(t.properties.dataAction.scrollToTop).fadeOut("fast")},this.query=function(e,o,r,i){return/^(f|ht)tps?:\/\//i.test(e)||(e=t.properties.siteUrl+e),$.ajax({url:e,type:"POST",cache:!1,data:o,dataType:r,success:function(e){void 0!==e.error&&0!==e.error.length&&t.properties.errorObj.show_error_block(e.error,"error"),void 0!==e.info&&0!==e.info.length&&t.properties.errorObj.show_error_block(e.info,"info"),void 0!==e.success&&0!==e.success.length&&t.properties.errorObj.show_error_block(e.success,"success"),void 0!==i&&i(e)}}),!1},t.Init(e),this})},1654:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.usersSelected=function(e){this.properties={siteUrl:"",rand:"",load_user_link:"admin/users/ajax_get_users_data",load_form:"admin/users/ajax_get_users_form",load_selected_data_link:"admin/users/ajax_get_selected_users",id_main:"",id_span:"",id_manage_link:"",id_items:"user_select_items",id_selected_items:"user_selected_items",id_search:"user_search",id_user_page:"user_page",id_close:"user_close_link",isUserDeleted:"",id:{blockUser:"#block_user",deleteUser:"#delete_user",fullDelete:"#full_delete"},user_type:0,var_name:"",max:"",selected_items:[],contentObj:new loadingContent({loadBlockWidth:"680px",closeBtnPadding:15})};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),t.properties.id_main="user_select_"+t.properties.rand,t.properties.id_span="user_text_"+t.properties.rand,t.properties.id_manage_link="user_link_"+t.properties.rand,t.properties.max=parseInt(t.properties.max),$("#"+t.properties.id_manage_link).on("click",(function(){return t.open_form(),!1}))},this.initControls=function(){$(document).off("ifChanged",t.properties.id.blockUser).on("ifChanged",t.properties.id.blockUser,(function(){t.blockUser()})).off("ifChanged",t.properties.id.deleteUser).on("ifChanged",t.properties.id.deleteUser,(function(){t.deleteUser(!1)})).off("ifChanged","input[name^=module]").on("ifChanged","input[name^=module]",(function(){t.deleteUser(!0)}))},this.blockUser=function(){t.properties.isUserDeleted?($("input[name^=module]").each((function(e,t){$(t).iCheck("disable")})),$(t.properties.id.fullDelete).prop("disabled",!0)):$(t.properties.id.fullDelete).prop("disabled",!1)},this.deleteUser=function(e){0===t.properties.isUserDeleted?($("input[name^=module]").each((function(t,o){void 0!==e&&!1!==e||$(o).iCheck("enable")})),$("input[value=users_delete]").iCheck("check"),$("input[name^=module]:checked").val()?$(t.properties.id.fullDelete).prop("disabled",!1):$(t.properties.id.fullDelete).prop("disabled",!0)):($(t.properties.id.deleteUser).iCheck("check"),$("input[name^=module]:checked").val()?$(t.properties.id.fullDelete).prop("disabled",!1):$(t.properties.id.fullDelete).prop("disabled",!0))},this.open_form=function(){var e=t.properties.siteUrl+t.properties.load_form+"/"+t.properties.max;$.ajax({url:e,type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),t.load_users("",1),$("#"+t.properties.id_search).unbind().on("keyup",(function(){t.load_users($(this).val(),1)})),1!=t.properties.max&&$("#"+t.properties.id_selected_items+" input:checkbox").on("click",(function(){t.unset_user($(this).val())})),$("#"+t.properties.id_close).on("click",(function(){return t.properties.contentObj.hide_load_block(),!1}))}})},this.load_users=function(e,o){var r={selected:t.properties.selected_items,user_type:t.properties.user_type};""!=e&&(r.search=e),$.ajax({url:t.properties.siteUrl+t.properties.load_user_link+"/"+o,dataType:"json",type:"POST",data:r,cache:!1,success:function(o){for(var r in $("#"+t.properties.id_items+" option").unbind(),$("#"+t.properties.id_items).empty(),o.items){var i='<li index="'+o.items[r].id+'"';in_array(o.items[r].id,t.properties.selected_items)&&(i+='class="hide"'),i+=">"+o.items[r].nickname+"("+o.items[r].output_name+")</li>",$("#"+t.properties.id_items).append(i)}t.generate_user_pages(o.pages,o.current_page,e),$("#"+t.properties.id_items+" li").on("click",(function(){t.set_user($(this).attr("index"))}))}})},this.generate_user_pages=function(e,o,r){if($("#"+t.properties.id_user_page+" a").unbind(),$("#"+t.properties.id_user_page).empty(),e>1){var i=e-12,n=o>6?o-6:1;n>i&&(n=i),o>7&&($("#"+t.properties.id_user_page).append('<ins class="fleft"><a href="#">1</a></ins>'),$("#"+t.properties.id_user_page).append('<ins class="fleft">...</ins>')),function(e,o,r){r=parseInt(r);for(var i=e;i<=o;i++)i===r?$("#"+t.properties.id_user_page).append('<ins class="fleft current"><mark>'+i+"</mark></ins>"):$("#"+t.properties.id_user_page).append('<ins class="fleft"><a href="#">'+i+"</a></ins>")}(n,n+12,o),o<e-6&&($("#"+t.properties.id_user_page).append('<ins class="fleft">...</ins>'),$("#"+t.properties.id_user_page).append('<ins class="fleft"><a href="#">'+e+"</a></ins>")),$("#"+t.properties.id_user_page+" a").on("click",(function(){return t.load_users(r,$(this).text()),!1}))}},this.set_user=function(e){var o=!1,r=0;for(r in t.properties.selected_items)t.properties.selected_items[r]==e&&(o=!0);if(t.properties.max>1&&t.properties.selected_items.length>=t.properties.max)return t.properties.selected_items=t.properties.selected_items.splice(0,t.properties.max),void t.load_selected();1==t.properties.max&&t.properties.selected_items.length>0&&(t.properties.selected_items=[]),o||(r=parseInt(r)+1,t.properties.selected_items.length||(r=0),t.properties.selected_items[r]=e,1==t.properties.max?t.properties.contentObj.hide_load_block():t.hide_option(e),t.load_selected())},this.load_selected=function(){$.ajax({url:t.properties.siteUrl+t.properties.load_selected_data_link,dataType:"json",type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(e){t.reload_span(e),1!=t.properties.max&&t.reload_selected(e)}})},this.unset_user=function(e){var o=!1;for(var r in t.properties.selected_items)t.properties.selected_items[r]==e&&(o=!0,t.properties.selected_items.splice(r,1));o&&$.ajax({url:t.properties.siteUrl+t.properties.load_selected_data_link,dataType:"json",type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(o){t.reload_span(o),1!=t.properties.max&&t.reload_selected(o),t.show_option(e)}})},this.hide_option=function(e){$("#"+t.properties.id_items+" li[index="+e+"]").addClass("hide")},this.show_option=function(e){$("#"+t.properties.id_items+" li[index="+e+"]").removeClass("hide")},this.reload_span=function(e){for(var o in $("#"+t.properties.id_span).empty(),e)isNaN(parseInt(o))||(1!=t.properties.max?$("#"+t.properties.id_span).append(e[o].nickname+"("+e[o].output_name+')<br><input type="hidden" name="'+t.properties.var_name+'[]" value="'+e[o].id+'">'):$("#"+t.properties.id_span).append(e[o].nickname+"("+e[o].output_name+')<input type="hidden" name="'+t.properties.var_name+'" value="'+e[o].id+'">'))},this.reload_selected=function(e){for(var o in $("#"+t.properties.id_selected_items).empty(),e)$("#"+t.properties.id_selected_items).append('<li><div class="user-block"><input type="checkbox" name="remove_users[]" value="'+e[o].id+'" checked>'+e[o].nickname+"</div></li>");$("#"+t.properties.id_selected_items+" input:checkbox").unbind("click").on("click",(function(){t.unset_user($(this).val())}))},t.Init(e)})},1758:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.topMenu=function(e){this.properties={siteUrl:"/",parent:"#users-top-menu",summands:".summand",sum:".sum",noNotifications:"no-notifications",hide:"hide-always",summandsParent:"li:first",blockMore:".menu-alerts-more",sidebarParent:"#slidemenu",sidebarSum:".sidebar-sum",sidebarSumVal:0,data:{action:{eventMenu:'[data-action="event_menu"]'}}};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),$(t.properties.parent).each((function(){t.init_objects(this),t.update_num(this),function(){if("undefined"==typeof MultiRequest)return!1;MultiRequest.initAction({gid:"notifications-sum",params:{},paramsFunc:function(){return{}},callback:function(){t.properties.sidebarSumVal=0,$(t.properties.parent).each((function(){t.init_objects(this),t.update_num(this)})),t.update_sidebar_sum()},period:3,status:0}),id_user&&MultiRequest.enableAction("notifications-sum"),$(document).on("users:login",(function(){MultiRequest.enableAction("notifications-sum")})).on("users:logout, session:guest",(function(){MultiRequest.disableAction("notifications-sum")}))}()})),t.update_sidebar_sum()},this.initControls=function(){},this.init_objects=function(e){t.summands=$(t.properties.summands,e),t.sum=$(t.properties.sum,e),t.sidebarSummands=$(t.properties.summands,t.properties.sidebarParent)},this.update_num=function(e){var r=o();t.sum.html(r||""),r?$(e).removeClass(t.properties.noNotifications):$(e).addClass(t.properties.noNotifications)},this.update_sidebar_sum=function(){if(void 0!==t.sidebarSummands){var e=0;t.sidebarSummands.each((function(){e=parseInt($(this).html()),t.properties.sidebarSumVal+=e}))}};var o=function(){var e=0,o=0;return t.summands.each((function(){o=parseInt($(this).html()),$(this).parents(t.properties.summandsParent),o&&(e+=o)})),e};t.Init(e)})},4758:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.UsersAuth=function(e){"use strict";this.properties={siteUrl:"/",loginBtnId:"ajax_login_link",content:null};var t=this;return this.Init=function(e){t.properties=$.extend(t.properties,e),$(document).off("click","#"+t.properties.loginBtnId).on("click","#"+t.properties.loginBtnId,(function(){t.login()}))},this.uninit=function(){return this},this.login=function(){$.ajax({url:t.properties.siteUrl+"users/ajax_login_form",cache:!1,dataType:"html",success:function(e){null==t.properties.content&&(t.properties.content=new loadingContent({loadBlockWidth:"500px",closeBtnClass:"w",loadBlockTopType:"bottom",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1})),t.properties.content.unsetLoadedBlock(),t.properties.content.show_load_block(e)}})},t.Init(e),this})},7276:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.UsersAvatar=function(e){this.properties={site_url:"",load_avatar_url:"users/ajax_load_avatar/",photo_id:"user_photo",id_user:0,recrop_url:"users/ajax_recrop_avatar/",recrop_container_id:"photo_source_recrop_box",recrop_img_id:"photo_source_recrop",photo_sizes_id:"photo_sizes",image_content_id:"image_content_avatar",menu_container_id:"media_menu",recropMenuContainer:"#recrop_menu",rotateMenuId:"#rotate-menu",photoMirrorHorId:"#photo_mirror_hor",rotate_left_id:"photo_rotate_left",rotate_right_id:"photo_rotate_right",photo_crop_id:"photo_crop",rotateUrl:"users/photoRotate/",image_css_size:{width:700,height:500},selections:[],section:"",userType:"user",saveAfterSelect:!1,changePhotoClass:".change-photo-button",viewPhotoClass:".view-photo-button",photoAction:".photo-action-js",haveAvatar:!1,mobileWidth:767,errorObj:new Errors,window_obj:new loadingContent({loadBlockWidth:"800px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1}),callback:function(){}};var t={},o=null;this.imageareaselect=null,this.selections=[],this.index=0,this.img=new Image,this.image_css_size={width:0,height:0};var r=this;return this.Init=function(e){return r.properties=$.extend(r.properties,e),r.init_window_obj(),t.avatar_obj=$("#"+r.properties.photo_id),$(r.properties.photoAction).width(t.avatar_obj.width()),$(window).resize((function(){t.avatar_obj=$("#"+r.properties.photo_id),$(r.properties.photoAction).width(t.avatar_obj.width())})),t.avatar_obj.off("click").on("click",(function(){r.properties.mobileWidth<$(window).width()&&r.load_avatar()})),$(r.properties.viewPhotoClass).off("click").on("click",(function(){r.load_avatar()})),$(r.properties.changePhotoClass).off("click").on("click",(function(){r.load_avatar(1)})),r.init_imageareaselect(),this},this.init_window_obj=function(){r.properties.window_obj=new loadingContent({loadBlockWidth:"800px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1})},this.destroy_window=function(){r.properties.window_obj.hide_load_block(),r.properties.window_obj.destroy()},this.uninit=function(){return r.uninit_imageareaselect(),t.avatar_obj.off(),this},this.load_avatar=function(e){var t=e||"";$.ajax({url:r.properties.site_url+r.properties.load_avatar_url+t,type:"POST",data:{id_user:r.properties.id_user},dataType:"json",cache:!1,success:function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return r.properties.window_obj.show_load_block(e.info.access_denied),!1;e.status?(r.properties.window_obj.changeTemplate("gallery"),r.properties.window_obj.update_css_styles({width:"962px"}),r.properties.window_obj.show_load_block(e.data.html),r.selections=[],r.properties.selections=e.data.selections,r.add_selections(r.properties.selections)):e.errors.length&&error_object.show_error_block(e.errors,"error")}})},this.add_selection=function(e,t,o,i,n){return r.selections.push({prefix:e,x1:t,y1:o,width:i,height:n,orig_width:i,orig_height:n}),this},this.add_selections=function(e){for(var t in e)e.hasOwnProperty(t)&&r.add_selection(t,0,0,parseInt(e[t].width),parseInt(e[t].height))},this.recrop=function(){return o&&"pending"==o.state()?o:o=$.ajax({url:r.properties.site_url+r.properties.recrop_url+r.properties.id_user,type:"POST",data:r.selections[r.index],dataType:"json",cache:!1,success:function(e){if(e.status){if(e.data.img_url){for(var t in e.data.img_url)$('img[src^="'+e.data.img_url[t]+'"]').attr("src",e.data.img_url[t]+"?"+(new Date).getTime());$("#photo_source_recrop").attr("src",e.data.img_url.grand),$("#user_photo img, .inner-image img").attr("src",e.data.img_url.grand),$("#user_photo_bg").css("background","transparent url('"+e.data.img_url.grand+"') no-repeat center/cover"),setTimeout((function(){$('ul.media-gallery-editor__photo-view [data-section="view"]').trigger("click")}),0)}}else e.errors.length&&error_object.show_error_block(e.errors,"error");e.msg.length&&error_object.show_error_block(e.msg,"success")}})},this.init_imageareaselect=function(){t.img_obj=$("#"+r.properties.recrop_img_id),t.photo_sizes_obj=$("#"+r.properties.photo_sizes_id),t.image_content_obj=$("#"+r.properties.image_content_id),t.photo_sizes_obj.html("");var e=$("#"+r.properties.image_content_id+" #"+r.properties.recrop_container_id+" img"),o=$("#"+r.properties.image_content_id+" .inner-image #"+r.properties.recrop_img_id),i=e.attr("src"),n=o.attr("src");return e.attr("src",i+"?"+(new Date).getTime()),o.attr("src",n+"?"+(new Date).getTime()),t.image_content_obj.off("click","#"+r.properties.menu_container_id+" [data-section]").on("click","#"+r.properties.menu_container_id+" [data-section]",(function(){if("recrop"===$(this).data("section")&&r.selections.length){if(t.image_content_obj.find('[data-area="view"]').hide(),t.image_content_obj.find('[data-area="recrop"]').show(),r.index=1,t.photo_sizes_obj.html(""),t.photo_sizes_obj.find("li").removeClass("active").eq(r.index).addClass("active"),t.photo_sizes_obj.off("click","li span").on("click","li span",(function(){var e=$(this).data("index");return e>=r.selections.length||e==r.index||(r.index=e,r.change_selection(),t.photo_sizes_obj.find("li").removeClass("active"),$(this).parent().addClass("active")),!1})),$("#"+r.properties.recrop_container_id).off("recrop:do").on("recrop:do",(function(){r.recrop()})),$.isEmptyObject(r.selections))return;r.img.src=t.img_obj.attr("src"),r.img.onload=function(){r.img.width?t.image_ready():t.img_obj.off("load").on("load",(function(){t.image_ready()}))},$("#"+r.properties.rotate_left_id).on("click",(function(){return r.rotate(90),!1})),$("#"+r.properties.rotate_right_id).on("click",(function(){return r.rotate(-90),!1})),$(r.properties.photoMirrorHorId).on("click",(function(){return r.rotate("hor"),!1})),$("#"+r.properties.photo_crop_id).on("click",(function(){return r.recrop(),!1}))}else t.image_content_obj.find('[data-area="view"]').show(),r.imageareaselect&&r.imageareaselect.setOptions({hide:!0});$(this).parents("ul").find("li").removeClass("active"),$(this).parent().addClass("active")})),$("#"+r.properties.menu_container_id).find('[data-section="'+r.properties.section+'"]').parent().addClass("active"),$("#"+r.properties.menu_container_id+" .active span").click(),t.image_content_obj.off("click",".media-gallery-editor__photo-view").on("click",".media-gallery-editor__photo-view",(function(e){var o=$("#photo_source_recrop_box"),i=$(r.properties.rotateMenuId);0===o.has(e.target).length&&0===i.has(e.target).length&&(t.image_content_obj.find('[data-area="recrop"]').hide(),t.image_content_obj.find('[data-area="view"]').show())})),"admin"==r.properties.userType&&t.image_content_obj.find('[data-section="recrop"]').trigger("click"),this},t.image_ready=function(e){for(e=e||0;(!t.img_obj.width()||!t.img_obj.height())&&e<60;)return setTimeout((function(){t.image_ready(++e)}),50),this;r.image_css_size={width:t.img_obj.width(),height:t.img_obj.height()},r.selections=[],r.add_selections(r.properties.selections),r.recalc_selection(),r.imageareaselect=t.img_obj.imgAreaSelect({handles:!0,persistent:!0,aspectRatio:r.selections[r.index].width+":"+r.selections[r.index].height,minWidth:r.selections[r.index].width,minHeight:r.selections[r.index].height,imageWidth:r.img.width,imageHeight:r.img.height,instance:!0,parent:"#"+r.properties.recrop_container_id,x1:r.selections[r.index].x1,y1:r.selections[r.index].y1,x2:r.selections[r.index].x1+r.selections[r.index].width,y2:r.selections[r.index].y1+r.selections[r.index].height,zIndex:2,onSelectStart:function(e,o){t.hide_recrop_btn(this)},onSelectEnd:function(e,o){o.width&&o.height&&(r.properties.saveAfterSelect?r.recrop():t.show_recrop_btn(this),r.selections[r.index].x1=Math.min(o.x1,o.x2),r.selections[r.index].y1=Math.min(o.y1,o.y2),r.selections[r.index].width=o.width,r.selections[r.index].height=o.height)},onSelectChange:function(e,o){o.width&&o.height&&(t.hide_recrop_btn(this),r.selections[r.index].x1=Math.min(o.x1,o.x2),r.selections[r.index].y1=Math.min(o.y1,o.y2),r.selections[r.index].width=o.width,r.selections[r.index].height=o.height)},onInit:function(e,o){t.show_recrop_btn(this)}})},t.show_recrop_btn=function(e){var t=$(e.parent).find("."+e.classPrefix+"-selection"),o=$('<div class="selection-recrop-btn"></div>');t.html(o)},t.hide_recrop_btn=function(e){$(e.parent).find("."+e.classPrefix+"-selection").html("")},this.uninit_imageareaselect=function(){return t.img_obj&&t.img_obj.off(),t.photo_sizes_obj&&t.photo_sizes_obj.off(),t.image_content_obj&&t.image_content_obj.off(),$("#"+r.properties.recrop_container_id).off(),r.imageareaselect=null,r.selections=[],r.index=0,this},this.change_selection=function(){var e=r.selections[r.index];return r.imageareaselect.setOptions({aspectRatio:e.width+":"+e.height,minWidth:e.width,minHeight:e.height,x1:e.x1,y1:e.y1,x2:e.x1+e.width,y2:e.y1+e.height}),r.imageareaselect.update(!1),this},this.recalc_selection=function(){var e=r.img.height/r.image_css_size.height,t=r.img.width/r.image_css_size.width;for(var o in r.selections)if(r.selections.hasOwnProperty(o))if(r.img.width<r.selections[o].width||r.img.height<r.selections[o].height){var i;r.img.width<r.selections[o].width&&(i=r.img.width/r.selections[o].width,r.selections[o].width*=i,r.selections[o].height*=i),r.img.height<r.selections[o].height&&(i=r.img.height/r.selections[o].height,r.selections[o].width*=i,r.selections[o].height*=i)}else{var n=r.selections[o].width*t,s=r.selections[o].height*e;n>=r.selections[o].width&&n<r.img.width&&s>=r.selections[o].height&&s<r.img.height&&(r.selections[o].width=n,r.selections[o].height=s);var a=Math.round(r.img.width/2-r.selections[o].width/2);a<0&&(a=0);var c=Math.round(r.img.height/2-r.selections[o].height/2);c<0&&(c=0),r.selections[o].x1=a,r.selections[o].y1=c}return this},this.rotate=function(e){return o&&"pending"===o.state()?o:($("#"+r.properties.recrop_img_id).attr("src"),o=$.ajax({url:r.properties.site_url+r.properties.rotateUrl+e+"/"+r.properties.id_user,type:"POST",dataType:"json",cache:!1,success:function(e){if(e.status){if(e.data.img_url){for(var o in $("#"+r.properties.recrop_img_id).attr("src",e.data.img_url+"?"+(new Date).getTime()),r.index=1,r.init_imageareaselect(),e.data.thumbs)$('img[src^="'+e.data.thumbs[o]+'"]').attr("src",e.data.thumbs[o]+"?"+(new Date).getTime());t.image_content_obj.find('[data-area="recrop"]').hide(),t.image_content_obj.find('[data-area="view"]').show(),$('[data-section="recrop"]').click(),setTimeout((function(){$('[data-section="recrop"]').click()}),1e3)}r.properties.rand_param=Math.floor(999999*Math.random()+1),r.properties.rand_param_change=!0}else e.errors.length&&r.properties.errorObj.show_error_block(e.errors,"error");e.msg.length&&setTimeout((function(){r.properties.errorObj.show_error_block(e.msg,"success")}),1e3)}}))},this.postUploadAvatar=function(){setTimeout((function(){r.load_avatar(),setTimeout((function(){$('[data-section="recrop"]').click()}),400)}),400)},r.Init(e),this})},5255:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.usersInput=function(e){this.properties={siteUrl:"",rand:"",id_user:"",load_user_link:"users/ajax_get_users_data/",load_form:"users/ajax_get_users_form/",load_data:"users/ajax_get_selected_users/",id_main:"",id_text:"",id_open:"",id_hidden_user:"",id_bg:"",id_select:"",id_items:"user_select_items",id_clear:"user_select_clear",id_close:"user_select_close",id_search:"user_search",id_page:"user_page",timeout_obj:null,timeout:500,dropdownClass:"dropdown",contentObj:new loadingContent({loadBlockWidth:"680px",closeBtnPadding:15})};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.id_main="user_select_"+t.properties.rand,t.properties.id_text="user_text_"+t.properties.rand,t.properties.id_open="user_open_"+t.properties.rand,t.properties.id_hidden_user="user_hidden_"+t.properties.rand,$("#"+t.properties.id_open).on("click",(function(){return t.open_form(),!1}))},this.open_form=function(){$.ajax({url:t.properties.siteUrl+t.properties.load_form,cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),$("#"+t.properties.id_clear).unbind().on("click",(function(){t.clearBox()})),t.load_users(),$("#"+t.properties.id_search).unbind().on("keyup",(function(){t.load_users($(this).val(),1)})),$("#"+t.properties.id_close).on("click",(function(){t.properties.contentObj.hide_load_block()}))}})},this.load_users=function(e,o,r){e=e||"",o=o||1,r=r||t.display_select;var i={page:o};e&&(i.search=e),$.ajax({url:t.properties.siteUrl+t.properties.load_user_link,dataType:"json",type:"POST",data:i,cache:!1,success:function(e){r(e)}})},this.display_select=function(e){for(var o in $("#"+t.properties.id_items).unbind(),$("#"+t.properties.id_items).empty(),e.items)$("#"+t.properties.id_items).append('<li index="'+e.items[o].id+'">'+e.items[o].nickname+" ("+e.items[o].output_name+")</li>");t.generate_pages(e.pages,e.current_page,name),$("#"+t.properties.id_items+" li").on("click",(function(){t.set_values($(this).attr("index"),$(this).text(),e),t.properties.contentObj.hide_load_block()}))},this.display_input=function(e){if(e.all>0){for(var o in $("#"+t.properties.id_select+" ul").empty(),e.items)$("#"+t.properties.id_select+" ul").append('<li gid="rs_'+o+'" data-id="'+e.items[o].id+'">'+e.items[o].nickname+" ("+e.items[o].output_name+")</li>");t.openBox()}else t.closeBox()},this.set_values=function(e,o,r){var i="";$("#"+t.properties.id_hidden_user).val(e.toString()).change(),t.properties.id_user=e.toString(),""==(i=o)&&(i="..."),$("#"+t.properties.id_text).val(i)},this.set_values_text=function(e,o){$("#"+t.properties.id_text).val(o),t.properties.id_user=e,$("#"+t.properties.id_hidden_user).val(t.properties.id_user).change(),t.closeBox()},this.emptyValues=function(){t.properties.id_user="",$("#"+t.properties.id_hidden_user).val(t.properties.id_user).change()},this.generate_pages=function(e,o,r){if($("#"+t.properties.id_page+" a").unbind(),$("#"+t.properties.id_page).empty(),e>1){for(var i=Math.max(o-2,1),n=Math.min(e,5),s=i;s<=n;s++)s==o?$("#"+t.properties.id_page).append('<ins class="current">'+s+"</ins>"):$("#"+t.properties.id_page).append('<ins><a href="#">'+s+"</a></ins>");$("#"+t.properties.id_page+" a").on("click",(function(){return t.load_users(r,$(this).text()),!1}))}},this.initBg=function(){$("body").append('<div id="'+t.properties.id_bg+'"></div>'),$("#"+t.properties.id_bg).css({display:"none",position:"fixed","z-index":"98999",width:"1px",height:"1px",left:"1px",top:"1px"})},this.expandBg=function(){$("#"+t.properties.id_bg).css({width:$(window).width()+"px",height:$(window).height()+"px",display:"block"}).on("click",(function(){t.closeBox()}))},this.collapseBg=function(){$("#"+t.properties.id_bg).css({width:"1px",height:"1px",display:"none"}).unbind()},this.initBox=function(){t.createDropDown(),$("#"+t.properties.id_select).on("click","li",(function(){t.set_values_text($(this).attr("data-id"),$(this).text())}))},this.unsetBox=function(){$("#"+t.properties.id_select).unbind().remove()},this.openBox=function(){t.expandBg(),t.resetDropDown(),$("#"+t.properties.id_select).slideDown()},this.createDropDown=function(){$("body").append('<div class="'+t.properties.dropdownClass+'" id="'+t.properties.id_select+'"><ul></ul></div>'),t.resetDropDown()},this.resetDropDown=function(){var e=$("#"+t.properties.id_text).offset().top+$("#"+t.properties.id_text).outerHeight();$("#"+t.properties.id_select).css({width:$("#"+t.properties.id_text).width()+"px",left:$("#"+t.properties.id_text).offset().left+"px",top:e+"px"})},this.closeBox=function(){t.collapseBg(),$("#"+t.properties.id_select).slideUp()},this.clearBox=function(){t.set_values_text("",""),t.properties.contentObj.hide_load_block()},t.Init(e)})},367:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.usersList=function(e){this.properties={siteUrl:"",viewUrl:"users/index",viewAjaxUrl:"users/ajax_index",listBlockId:"users_block",savedListView:!1,saveSearchUrl:"users/ajax_save_search",errorObj:new Errors,tIds:[],formCallback:function(){}};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_links(),t.init_form()},this.uninit=function(){if(t.properties.tIds.length)for(var e in t.properties.tIds){var o=t.properties.tIds[e];$("#"+o+" a").unbind("click")}$("#save_search_link").off("click"),$("#user_search").off("keyup"),$("#user_reset").off("click")},this.init_links=function(){if(t.properties.tIds.length)for(var e in t.properties.tIds){var o=t.properties.tIds[e];$("#"+o+" a").unbind("click").on("click",(function(e){var o=$(this).attr("href").replace(t.properties.viewUrl,t.properties.viewAjaxUrl);if(o!=$(this).attr("href"))return t.loading_block(o),!1}))}$("#save_search_link").on("click",(function(){return t.save_search(),!1}))},this.init_form=function(){$("#user_search").on("keyup",(function(){return t.search(),!1})),$("#user_reset").on("click",(function(){return $("form#user_search_form")[0].reset(),t.search(),!1}))},this.search=function(){var e=$("#user_search_form").serialize();$.ajax({url:t.properties.siteUrl+t.properties.viewAjaxUrl,type:"POST",cache:!1,data:e,success:function(e){$("#"+t.properties.listBlockId).html(e),t.init_links()}})},this.loading_block=function(e){$.ajax({url:e,type:"GET",cache:!1,success:function(e){$("#"+t.properties.listBlockId).html(e),t.init_links()}})},this.loading_post_block=function(e,o){o||(o=t.properties.siteUrl+t.properties.viewAjaxUrl),$.ajax({url:o,type:"POST",data:e,cache:!1,success:function(e){$("#"+t.properties.listBlockId).html(e),t.init_links()}})},this.save_search=function(){$.ajax({url:t.properties.siteUrl+t.properties.saveSearchUrl,type:"GET",cache:!1,dataType:"json",success:function(e){return e.success?t.properties.errorObj.show_error_block(e.success,"success"):t.properties.errorObj.show_error_block(e.error,"error"),!1}})},t.Init(e)})},1143:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.usersMap=function(e){this.properties={siteUrl:"",user_id:0,view_ajax_url:"users/ajax_view_map_user_location",link_view_map_id:"view_map_link",error_object:new Errors,window_object:new loadingContent({loadBlockWidth:"642px",loadBlockTopType:"top",loadBlockTopPoint:100,closeBtnClass:"w"})};var t=this;this.Init=function(e){t.prop=$.extend(t.properties,e),t.bindEvents()},this.bindEvents=function(){var e=1;$("#"+t.prop.link_view_map_id).on("click",(function(){$.ajax({url:t.prop.siteUrl+t.prop.view_ajax_url,type:"POST",dataType:"json",data:{id:t.prop.user_id,load_map_scripts:e},cache:!1,success:function(o){""!=o.errors?t.prop.error_object.show_error_block(o.errors,"error"):""!=o.html&&($.pjax.disable(),e=0,t.prop.window_object.show_load_block(o.html))}})})),$("input[name=id_country]").on("change",(function(){t.checkAddressUpdated()}))},this.checkAddressUpdated=function(){var e=$("input[name=id_country]").val();if($("input[name=id_region]").val(),$("input[name=id_city]").val(),""!=e){var o="",r="",i="",n=$("input[name=region_name]").val().split(",");void 0!==n[0]&&(o=n[0]),void 0!==n[1]&&(r=n[1]),void 0!==n[2]&&(i=n[2]),t.updateCoordinates(o,r,i)}else t.setCoordinates(0,0)},this.updateCoordinates=function(e,o,r){if("undefined"!=typeof geocoder){var i=geocoder.getLocationFromAddress(e,o,r);geocoder.geocodeLocation(i,(function(e,o){t.setCoordinates(e,o)}))}},this.setCoordinates=function(e,t){$("#lat").val(e),$("#lon").val(t)},t.Init(e)})},4520:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.usersSelect=function(e){this.properties={siteUrl:"",rand:"",load_user_link:"users/ajax_get_users_data/",load_form:"users/ajax_get_users_form/",load_selected_data_link:"users/ajax_get_selected_users",id_main:"",id_span:"",id_manage_link:"",id_items:"user_select_items",id_selected_items:"user_selected_items",id_search:"user_search",id_user_page:"user_page",id_close:"user_close_link",user_type:0,var_name:"",max:"",selected_items:[],checkboxClass:"",reloadSelectedCallback:function(){},contentObj:null};var t=this;this.errors={},this.Init=function(e){t.properties=$.extend(t.properties,e),t.properties.id_main="user_select_"+t.properties.rand,t.properties.id_span="user_text_"+t.properties.rand,t.properties.id_manage_link="user_link_"+t.properties.rand,t.properties.max=parseInt(t.properties.max),t.properties.contentObj||(t.properties.contentObj=new loadingContent({loadBlockWidth:"680px",closeBtnPadding:15})),$("#"+t.properties.id_manage_link).on("click",(function(){return t.open_form(),!1}))},this.open_form=function(){var e=t.properties.siteUrl+t.properties.load_form+t.properties.max;$.ajax({url:e,type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(e){t.properties.contentObj.show_load_block(e),t.load_users("",1),$("#"+t.properties.id_search).unbind().on("keyup",(function(){t.load_users($(this).val(),1)})),1!=t.properties.max&&$("#"+t.properties.id_selected_items+" input:checkbox").on("click",(function(){t.unset_user($(this).val())})),$("#"+t.properties.id_close).on("click",(function(){return t.properties.contentObj.hide_load_block(),!1}))}})},this.load_users=function(e,o){var r={selected:t.properties.selected_items,user_type:t.properties.user_type};""!=e&&(r.search=e),$.ajax({url:t.properties.siteUrl+t.properties.load_user_link+o,dataType:"json",type:"POST",data:r,cache:!1,success:function(o){for(var r in $("#"+t.properties.id_items+" option").unbind(),$("#"+t.properties.id_items).empty(),o.items){var i='<li index="'+o.items[r].id+'"';in_array(o.items[r].id,t.properties.selected_items)&&(i+='class="hide"'),i+=">"+o.items[r].nickname+"("+o.items[r].output_name+")</li>",$("#"+t.properties.id_items).append(i)}t.generate_user_pages(o.pages,o.current_page,e),$("#"+t.properties.id_items+" li").on("click",(function(){t.set_user($(this).attr("index"))}))}})},this.generate_user_pages=function(e,o,r){if($("#"+t.properties.id_user_page+" a").unbind(),$("#"+t.properties.id_user_page).empty(),e>1){var i=e-12,n=o>6?o-6:1;n>i&&(n=i),o>7&&($("#"+t.properties.id_user_page).append('<ins class="fleft"><a href="#">1</a></ins>'),$("#"+t.properties.id_user_page).append('<ins class="fleft">...</ins>')),function(e,o,r){r=parseInt(r);for(var i=1;i<=o;i++)i===r?$("#"+t.properties.id_user_page).append('<ins class="fleft current"><mark>'+i+"</mark></ins>"):$("#"+t.properties.id_user_page).append('<ins class="fleft"><a href="#">'+i+"</a></ins>")}(0,e,o),o<e-6&&($("#"+t.properties.id_user_page).append('<ins class="fleft">...</ins>'),$("#"+t.properties.id_user_page).append('<ins class="fleft"><a href="#">'+e+"</a></ins>")),$("#"+t.properties.id_user_page+" a").on("click",(function(){return t.load_users(r,$(this).text()),!1}))}},this.set_user=function(e){var o=!1,r=0;for(r in t.properties.selected_items)t.properties.selected_items[r]==e&&(o=!0);if(t.properties.max>1&&t.properties.selected_items.length>=t.properties.max)return t.properties.selected_items=t.properties.selected_items.splice(0,t.properties.max),void t.load_selected();1==t.properties.max&&t.properties.selected_items.length>0&&(t.properties.selected_items=[]),o||(r=parseInt(r)+1,t.properties.selected_items.length||(r=0),t.properties.selected_items[r]=e,1==t.properties.max?t.properties.contentObj.hide_load_block():t.hide_option(e),t.load_selected())},this.load_selected=function(){$.ajax({url:t.properties.siteUrl+t.properties.load_selected_data_link,dataType:"json",type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(e){t.reload_span(e.selected),1!=t.properties.max&&t.reload_selected(e.selected)}})},this.unset_user=function(e){var o=!1;for(var r in t.properties.selected_items)t.properties.selected_items[r]==e&&(o=!0,t.properties.selected_items.splice(r,1));o&&$.ajax({url:t.properties.siteUrl+t.properties.load_selected_data_link,dataType:"json",type:"POST",data:{selected:t.properties.selected_items},cache:!1,success:function(o){t.reload_span(o.selected),1!=t.properties.max&&t.reload_selected(o.selected),t.show_option(e)}})},this.hide_option=function(e){$("#"+t.properties.id_items+" li[index="+e+"]").addClass("hide")},this.show_option=function(e){$("#"+t.properties.id_items+" li[index="+e+"]").removeClass("hide")},this.reload_span=function(e){for(var o in $("#"+t.properties.id_span).empty(),e)1!=t.properties.max?$("#"+t.properties.id_span).append(e[o].nickname+"("+e[o].output_name+')<br><input type="hidden" name="'+t.properties.var_name+'[]" value="'+e[o].id+'">'):$("#"+t.properties.id_span).append(e[o].nickname+"("+e[o].output_name+')<input type="hidden" name="'+t.properties.var_name+'" value="'+e[o].id+'">')},this.reload_selected=function(e){for(var o in $("#"+t.properties.id_selected_items).empty(),e)$("#"+t.properties.id_selected_items).append('<li><div class="user-block"><input type="checkbox" name="remove_users[]" value="'+e[o].id+'" class="'+t.properties.checkboxClass+'" checked> '+e[o].nickname+"</div></li>");$("#"+t.properties.id_selected_items+" input:checkbox").on("click",(function(){t.unset_user($(this).val())})),t.properties.reloadSelectedCallback()},t.Init(e)})},1639:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.usersSettings=function(e){"use strict";this.properties={siteUrl:"",guest_view_profile_allow_id:"#guest_view_profile_allow",guest_view_profile_allow:{},guest_view_profile_limit_id:"#guest_view_profile_limit",guest_view_profile_limit:{},guest_view_profile_num_id:"#guest_view_profile_num",guest_view_profile_num:{},servicesMenuTemplate:"#services-menu_template",availableData:"",getChangeLocationForm:"users/getChangeLocationForm",setChangeLocationForm:"users/setChangeLocationForm",getAvailableActivation:"users/getAvailableActivation/",setUserIds:"users/set_user_ids",dataChangeProfile:"[data-change=profile]",dataChangeLocation:"[data-change=location]",dataChangeAvatar:"[data-change=user-avatar]",changeUserPhotoBlock:"#user_photo_block",changeLocationBlock:"#change-location-block",saveLocationBlock:"#save-location-block",fieldInfo:".owner-actions .field-block",iAgreeTerms:"#i_agree_terms",servicesMenu:"#services-menu",customSelect:".custom-select",errorObj:new Errors,avatarObj:"",class:{dropdown:".dropdown",popover:".popover",loadContentBg:".load_content_bg",staticAlertBlock:".static-alert-block",availableBlock:".available-block",wrapBlock:".wrap-block",fixOverflow:".fix-overflow-js",scrollToTop:".scroll-to-top"},user:{},url:{getUserField:"users/getUserField",setUserField:"users/setUserField",isActiveService:"users/isActiveService",profileEdit:"users/profile/personal",iAgreeTerms:"users/i_agree_terms",removeAvatar:"users/upload_avatar"},langs:{},data:{fieldActionChange:'[data-fieldaction="change"]',fieldActionClick:'[data-fieldaction="click"]',fieldLocation:'[data-field="location"]',fieldIdCountry:'[data-change="id_country"]',fieldIdRegion:'[data-change="id_region"]',changeField:'[data-action="change-field"]',profileAvailable:'[data-action="profile_available"]',activateProfile:'[data-block="activate-profile"]',actions:{setUserIds:'[data-action="set_user_ids"]',setUserMenuActions:'[data-action="set-user_menu_actions"]',removeAvatar:'[data-action="remove-avatar"]'}},availableActivationData:{birth_date:'data-change="profile"',location:'data-change="location"',id_country:'data-change="id_country"',id_region:'data-change="id_region"',nickname:'data-change="profile"',user_logo:"data-change=user-avatar",user_type:'data-change="profile"',looking_user_type:'data-change="profile"'},contentObj:new loadingContent({loadBlockWidth:"400px",loadBlockLeftType:"center",loadBlockTopType:"top",loadBlockTopPoint:100,closeBtnClass:"w"})};var t=this,o=["col-xs-12 col-sm-12 col-md-12 col-lg-12","col-xs-12 col-sm-6 col-md-6 col-lg-6","col-xs-12 col-sm-6 col-md-4 col-lg-4","col-xs-12 col-sm-6 col-md-4 col-lg-3","col-xs-12 col-sm-6 col-md-4 col-lg-3"],r={},i=function(){t.properties.guest_view_profile_allow.is(":checked")?t.properties.guest_view_profile_limit.attr("disabled",null):t.properties.guest_view_profile_limit.attr("disabled","disabled").attr("checked",null),t.properties.guest_view_profile_limit.is(":checked")?t.properties.guest_view_profile_num.attr("disabled",null):t.properties.guest_view_profile_num.attr("disabled","disabled").val(0)};this.customSelectEvent=function(){setTimeout((function(){$(t.properties.customSelect+" input").off().on("click",(function(){var e=$(this).closest("label");this.checked?e.addClass("label-active"):e.removeClass("label-active")}))}),0)},this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_controls(),"undefined"!=typeof available_view&&(t.properties.usersProfileAvailableView=new available_view({siteUrl:site_url})),t.properties.guest_view_profile_allow=$(t.properties.guest_view_profile_allow_id),t.properties.guest_view_profile_limit=$(t.properties.guest_view_profile_limit_id),t.properties.guest_view_profile_num=$(t.properties.guest_view_profile_num_id),t.properties.guest_view_profile_allow.on("change",(function(){i()})),t.properties.guest_view_profile_limit.on("change",(function(){i()})),t.properties.servicesMenu.length>0&&($.fn.popover,$(t.properties.servicesMenu).popover({placement:"bottom",html:!0,content:function(){return void 0===r.servicesMenuClone&&(r.servicesMenuClone=$($("#services-menu_template .menu-actions")).clone(!0)),r.servicesMenuClone}}),$(t.properties.servicesMenu).on("show.bs.popover",(function(){$(t.properties.class.fixOverflow).removeClass("media"),$(".photo-action-js").width(""),$(t.properties.class.scrollToTop).hide().css("bottom","25px")})),$(t.properties.servicesMenu).on("hide.bs.popover",(function(){$(t.properties.class.fixOverflow).addClass("media"),$(t.properties.class.scrollToTop).css("bottom","0px")}))),i()},this.uninit=function(){return $(document).off("click","."+t.properties.dataChangeLocation).off("click","."+t.properties.saveLocationBlock).off("click",t.properties.fieldInfo).off("click",t.properties.data.fieldActionChange).off("click",t.properties.data.fieldActionClick).off("click",t.properties.servicesMenu),this},this.init_controls=function(){$(document).off("mouseup","body").on("mouseup","body",(function(e){t.closeFields(e)})).off("click",t.properties.dataChangeLocation).on("click",t.properties.dataChangeLocation,(function(){t.changeLocation()})).off("click",t.properties.saveLocationBlock).on("click",t.properties.saveLocationBlock,(function(){t.saveLocation()})).off("click",t.properties.data.changeField).on("click",t.properties.data.changeField,(function(){t.changeFieldInfo(this)})).off("change",t.properties.data.fieldActionChange).on("change",t.properties.data.fieldActionChange,(function(){t.saveFieldInfo(this,!0)})).off("click",t.properties.data.fieldActionClick).on("click",t.properties.data.fieldActionClick,(function(){t.saveFieldInfo(this,!0)})).off("click",t.properties.data.fieldLocation+" i").on("click",t.properties.data.fieldLocation+" i",(function(){t.saveFieldInfo(this,!0)})).off("click",t.properties.servicesMenu).on("click",t.properties.servicesMenu,(function(){t.servicesMenuToogle(this)})).off("click",t.properties.data.profileAvailable).on("click",t.properties.data.profileAvailable,(function(){t.changeProfileAvailable(this)})).off("click",t.properties.dataChangeProfile).on("click",t.properties.dataChangeProfile,(function(){locationHref(t.properties.siteUrl+t.properties.url.profileEdit)})).off("click",t.properties.dataChangeAvatar).on("click",t.properties.dataChangeAvatar,(function(){t.loadAvatar()})).off("click",t.properties.data.fieldIdCountry).on("click",t.properties.data.fieldIdCountry,(function(){t.changeLocation()})).off("click",t.properties.data.fieldIdRegion).on("click",t.properties.data.fieldIdRegion,(function(){t.changeLocation()})).off("click",t.properties.iAgreeTerms).on("click",t.properties.iAgreeTerms,(function(){t.iAgreeTerms()})).off("mouseenter",t.properties.changeUserPhotoBlock).on("mouseenter",t.properties.changeUserPhotoBlock,(function(){$(t.properties.dataChangeAvatar).removeClass("hide"),$(t.properties.data.actions.removeAvatar).removeClass("hide")})).off("mouseleave",t.properties.changeUserPhotoBlock).on("mouseleave",t.properties.changeUserPhotoBlock,(function(){$(t.properties.dataChangeAvatar).addClass("hide"),$(t.properties.data.actions.removeAvatar).addClass("hide")})).off("click",t.properties.data.actions.setUserIds).on("click",t.properties.data.actions.setUserIds,(function(e){t.setUserIds(this,e)})).off("click",t.properties.data.actions.setUserMenuActions).on("click",t.properties.data.actions.setUserMenuActions,(function(){t.setUserMenuActions()})).off("click",t.properties.data.actions.removeAvatar).on("click",t.properties.data.actions.removeAvatar,(function(){t.removeAvatar()}))},this.removeAvatar=function(){$.ajax({url:t.properties.siteUrl+t.properties.url.removeAvatar,type:"POST",data:{user_icon_delete:1},dataType:"json",cache:!1,success:function(e){void 0!==e.errors&&e.errors.length?t.properties.errorObj.show_error_block(e.errors,"error"):($(t.properties.data.actions.removeAvatar).remove(),$("#user_photo").html('<img src="'+e.logo.file_url+'">'))}})},this.setUserMenuActions=function(){$(t.properties.servicesMenu).click()},this.setUserIds=function(e,o){o.preventDefault();var r=$(e).data("gid");$.ajax({url:t.properties.siteUrl+t.properties.setUserIds,type:"POST",cache:!1,data:{gid:r},dataType:"json",success:function(){locationHref($(e).data("href"))}})},this.closeFields=function(e){0===$(e.target).closest(t.properties.data.changeField).length&&0===$(e.target).closest(t.properties.class.dropdown).length&&0===$(e.target).closest(t.properties.class.loadContentBg).length&&$(".edit-field-js").each((function(){t.saveFieldInfo($(this).find(".field-info"),!1)}))},this.servicesMenuToogle=function(e){var t=$("div.popover").css("left");"rtl"===site_rtl_settings&&$("div.popover").css({right:t,left:"0"})},this.saveFieldInfo=function(e,o){if(void 0!==$(e).closest(".edit-field-js").data("field")){var r=$(e).closest(".edit-field-js").find("input[name],select[name],textarea[name]").serialize(),i=$(e).closest(".edit-field-js").data("field");r+=!0===o?"&save=1":"&save=0",r+="&field_name="+i,$.ajax({url:t.properties.siteUrl+t.properties.url.setUserField,type:"post",cache:!1,data:r,dataType:"json",success:function(o){if(void 0!==o.errors&&0!==o.errors.length)return t.properties.errorObj.show_error_block(o.errors,"error"),!1;void 0!==o.data?(sendAnalytics("dp_user_profile_btn_edit_field","my_profile","user"),$(e).closest(".edit-field-js").removeClass("edit-field-js"),$(e).closest(".field-info").html((function(){return null===o.data&&(o.data=""),""===o.data&&(o.data='<p class="example-fields">'+o.example+"</p>"),void 0!==o.couple?o.data+"&nbsp;|&nbsp;"+o.couple+'<i class="fas fa-pencil-alt"></i>':("location"===i&&$(t.properties.dataChangeLocation).html((function(){return'<i class="fas fa-map-marker-alt"></i>&nbsp;'+(0!==o.data.length?o.data:t.properties.langs.link_select_region)})),o.data+'<i class="fas fa-pencil-alt"></i>')}))):void 0!==o.couple&&0!==o.couple.length&&($(e).closest(".edit-field-js").removeClass("edit-field-js"),$(e).closest(".field-info").html((function(){if(void 0!==o.couple)return o.couple+'<i class="fas fa-pencil-alt"></i>'}))),void 0!==o.status&&t.properties.errorObj.show_error_block(o.msg,o.status)}})}},this.changeFieldInfo=function(e){!1===$(e).hasClass("edit-field-js")&&t.queryField(e)},this.createElement=function(e,o){$(e).find(".field-info").html((function(r,i){$(e).addClass("edit-field-js");var n='<div class="hide">'+i+"</div>";if("text"===o.type)void 0!==o.data.couple?(n+='<div class="col-xs-6">'+t.inputText($(e).data("field"),o.data.value)+"</div>",n+='<div class="col-xs-6">'+t.inputText($(e).data("field")+"_couple",o.data.couple.value)+"</div>"):n+='<div class="col-xs-12">'+t.inputText($(e).data("field"),o.data.value)+"</div>";else if("text|text"===o.type)if(1==Object.keys(o.data).length)for(var s in o.data)void 0!==o.data[s].couple?(n+='<div class="col-xs-6">\n                                                <label>'+o.data[s].name+":</label>"+t.inputText(o.data[s].field,o.data[s].value)+"</div>",n+='<div class="col-xs-6">\n                                                <label>'+o.data[s].couple.name+":</label>"+t.inputText(o.data[s].couple.field,o.data[s].couple.value)+"</div>"):n+='<div class="col-xs-12">\n                                                <label>'+o.data[s].name+":</label>"+t.inputText(o.data[s].field,o.data[s].value)+"</div>";else{for(var s in n+='<div class="input__input-group">',o.data)void 0!==o.data[s].couple?(n+='<div class="col-xs-6">\n                                                <label>'+o.data[s].name+":</label>"+t.inputText(o.data[s].field,o.data[s].value,0)+"</div>",n+='<div class="col-xs-6">\n                                                <label>'+o.data[s].couple.name+":</label>"+t.inputText(o.data[s].couple.field,o.data[s].couple.value,0)+"</div>"):n+='<div class="col-xs-12">\n                                                <label>'+o.data[s].name+":</label>"+t.inputText(o.data[s].field,o.data[s].value,0)+"</div>";n+='<div class="col-xs-12 mt5">'+t.inputTextBtn()+"</div></div>"}else if("autocomplete"===o.type)n+='<div class="col-xs-12">'+t.inputTextAutocomplete($(e).data("field"),o.data.value)+"</div>";else if("select"===o.type)if(1==Object.keys(o.data.value).length)for(var s in o.data.value){n+="age_min"===s||"age_max"===s?'<div class="col-xs-6">':'<div class="col-xs-12 mb5">';var a=o.data.settings?o.data.settings[s]:null;n+=t.selectElement(s,o.data.value[s],o.data.option[s],!1,1,o.data.sort,void 0,a)+"</div>"}else{for(var s in n+='<div class="select__input-group">',o.data.value)n+="age_min"===s||"age_max"===s?'<div class="col-xs-6">':'<div class="col-xs-12 mb5">',n+=t.selectElement(s,o.data.value[s],o.data.option[s],!1,0)+"</div>";n+='<div class="col-xs-12 mt5">'+t.selectElementBtn(!1)+"</div></div>"}else if("multiselect"===o.type)if(void 0!==o.data.couple)for(var s in o.data.couple.value)n+='<div class="col-xs-12 mb5">',n+=t.selectElement(s+"[]",o.data.couple.value[s],o.data.couple.option[s],"multiple",1,o.data.sort,o.view_type),n+="</div>";else for(var s in o.data.value)n+='<div class="col-xs-12 mb5">',n+=t.selectElement(s+"[]",o.data.value[s],o.data.option[s],"multiple",1,o.data.sort,o.view_type),n+="</div>";else"textarea"===o.type?void 0!==o.data.couple?(n+='<div class="col-xs-6">'+t.textArea($(e).data("field"),o.data.value)+"</div>",n+='<div class="col-xs-6">'+t.textArea($(e).data("field")+"_couple",o.data.couple.value)+"</div>"):n+='<div class="col-xs-12">'+t.textArea($(e).data("field"),o.data.value)+"</div>":"datepicker"===o.type?void 0!==o.data.couple?(n+='<div class="col-xs-12">'+t.datePicker($(e).data("field"),o.data.value)+"</div>",n+='<div class="col-xs-12">'+t.datePicker($(e).data("field")+"_couple",o.data.couple.value,"_couple")+"</div>"):n+='<div class="col-xs-12">'+t.datePicker($(e).data("field"),o.data.value)+"</div>":"checkbox"===o.type?void 0!==o.data.couple?(n+='<div class="col-xs-6">'+t.checkbox($(e).data("field"),o.data.value)+"</div>",n+='<div class="col-xs-6">'+t.checkbox($(e).data("field")+"_couple",o.data.couple.value)+"</div>"):n+='<div class="col-xs-12">'+t.checkbox($(e).data("field"),o.data.value)+"</div>":"range"===o.type&&(void 0!==o.data.couple?(n+='<div class="col-xs-12">'+t.range($(e).data("field"),o.data.value)+"</div>",n+='<div class="col-xs-12">'+t.range($(e).data("field")+"_couple",o.data.couple.value)+"</div>"):n+='<div class="col-xs-12">'+t.range($(e).data("field"),o.data.value)+"</div>");return n})),"datepicker"===o.type&&(void 0!==o.data.couple?(t.formatDPickerField(o.data.value),t.formatDPickerField(o.data.couple.value,"_couple")):t.formatDPickerField(o.data.value))},this.datePicker=function(e,o,r){return'<div class="input-group">\n                                    <div id="datepicker'+(r=void 0===r?"":r)+'" class="hidden"></div>\n                                    <input type="text" value="'+o+'" name="'+e+'" class="form-control hidden">\n                                    <button class="btn btn-default" type="button" data-fieldaction="click">'+t.properties.langs.save+"</button>\n                                </div>"},this.range=function(e,o){return'<div class="input-group">\n                        <div class="col-xs-12 col-sm-9">\n '+o+'</div>\n                        <div class="col-xs-12 col-sm-3">\n                            <button class="btn btn-default" type="button" data-fieldaction="click">'+t.properties.langs.save+"</button>\n                        </div>\n                    </div>"},this.formatDPickerField=function(e,o){o=void 0===o?"":o;var r=new Date,i=new Date(r.getFullYear()-t.properties.user.age_max,0,1).getFullYear()+":"+new Date(r.getFullYear()-t.properties.user.age_min,0,1).getFullYear();$("#datepicker"+o).datepicker({dateFormat:"yy-mm-dd",changeYear:!0,changeMonth:!0,yearRange:i}),new DatepickerDropdownTemplate({setDate:e,dateFormat:t.properties.user.dateFormat,inputName:"birth_date"+o,postfix:o})},this.selectElement=function(e,o,r,i,n,s,a,c){var p,l=c&&null!=c.empty_option?c.empty_option:null;null==n&&(n=1);var d={};for(var u in s)d[u]=r[s[u]];-1!==e.indexOf("field")&&(r=d);var _='<div class="input-group">';if(null!=a&&"checkbox"==a)for(var f in _+='<input type="hidden" name="'+e+'" value="0"/>',r){if(p="",!0===Array.isArray(o))for(var h in o)o[h]==s[f]&&(p=1);else p=-1!==e.indexOf("field")?o==s[f]?1:"":o==f?1:"";var m;m=-1!==e.indexOf("field")?s[f]:f,e.replace("[]","_"),_+=t.multiCheckbox(e,p,r[f],m)}else if("multiple"==i){for(var g in _+='<div class="custom-select"><input type="hidden" name="'+e+'" value="0"/>',r){if(p="",!0===Array.isArray(o))for(var b in o)o[b]==s[g]&&(p=1);else p=-1!==e.indexOf("field")?o==s[g]?1:"":o==g?1:"";var v;v=-1!==e.indexOf("field")?s[g]:g,_+='<label class="'+(1===p?"label-active":"")+'" for="'+e+v+'"><input  id="'+e+v+'" type="checkbox" name="'+e+'" value="'+v+'" '+(1===p?"checked":"")+">"+r[g]+"</label>"}_+="</div>"}else{for(var y in _+='<select name="'+e+'" class="form-control">',l&&!i&&(_+='<option  value=" ">...</option>'),r){if(p="",!0===Array.isArray(o))for(var k in o)o[k]==s[y]&&(p="selected");else p=-1!==e.indexOf("field")?o==s[y]?"selected":"":o==y?"selected":"";var w=void 0;w=-1!==e.indexOf("field")?s[y]:y,"age_min"!==e&&"age_max"!==e||(p=o==r[y]?"selected":"",w=r[y]),_+="<option "+p+' value="'+w+'">'+r[y]+"</option>"}_+="</select>"}return 1===n&&(_+="multiple"!==i?'<span class="input-group-btn">\n                    <button class="btn btn-default"  type="button" data-fieldaction="click">'+t.properties.langs.save+"</button>\n               </span>":null!=a&&"checkbox"==a?'<span data-fieldaction="click" class="mt10 btn btn-default">'+t.properties.langs.save+"</span>":'<span data-fieldaction="click" class="input-group-addon btn btn-default">'+t.properties.langs.save+"</span>"),_+="</div>",t.customSelectEvent(this),_},this.selectElementBtn=function(e){return"multiple"!==e?'<button class="btn btn-default" type="button" data-fieldaction="click">'+t.properties.langs.save+"</button>":'<span data-fieldaction="click" class="input-group-addon btn btn-default">'+t.properties.langs.save+"</span>"},this.inputTextAutocomplete=function(e,t){return t},this.inputText=function(e,o,r){void 0===r&&(r=1);var i='<div class="input-group">\n                        <input type="text" name="'+e+'" value="'+o+'" class="form-control">';return 1===r&&(i+='<span class="input-group-btn">\n                            <button class="btn btn-default" type="button" data-fieldaction="click">'+t.properties.langs.save+"</button></span>"),i+"</div>"},this.inputTextBtn=function(){return'<button class="btn btn-default" type="button" data-fieldaction="click">'+t.properties.langs.save+"</button>"},this.textArea=function(e,o){return'<div class="input-group">\n                        <textarea name="'+e+'" class="form-control custom-control" rows="3">'+o+'</textarea>\n                        <span data-fieldaction="click" class="input-group-addon btn btn-default">'+t.properties.langs.save+"</span>\n                    </div>"},this.checkbox=function(e,o){return'<div class="input-group">\n                        <input type="hidden" name="'+e+'" value="0"/>\n                        <input type="checkbox" name="'+e+'" value="1" '+("1"===o?"checked":"")+'>\n                        <span data-fieldaction="click" class="btn btn-default">'+t.properties.langs.save+"</span>\n                    </div>"},this.multiCheckbox=function(e,t,o,r,i){return'<div><input id="'+i+r+'" type="checkbox" name="'+e+'" value="'+r+'" '+(1===t?"checked":"")+'>\n        <label for="'+i+r+'">'+o+"</label></div>"},this.queryField=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.url.getUserField,type:"post",cache:!1,data:{field:$(e).data("field")},dataType:"json",success:function(o){if(void 0!==o.errors&&0!==o.errors.length)return t.properties.errorObj.show_error_block(o.errors,"error"),!1;t.createElement(e,o)}}),!1},this.changeLocation=function(){$.ajax({type:"POST",dataType:"html",url:t.properties.siteUrl+t.properties.getChangeLocationForm,success:function(e){void 0!==e&&t.properties.contentObj.show_load_block(e)},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.saveLocation=function(){var e={id_country:$(t.properties.changeLocationBlock).find("[name=id_country]").val(),id_region:$(t.properties.changeLocationBlock).find("[name=id_region]").val(),id_city:$(t.properties.changeLocationBlock).find("[name=id_city]").val(),lat:$(t.properties.changeLocationBlock).find("[name=lat]").val(),lon:$(t.properties.changeLocationBlock).find("[name=lon]").val()};$.ajax({type:"POST",data:e,dataType:"JSON",url:t.properties.siteUrl+t.properties.setChangeLocationForm,success:function(e){if(void 0!==e.errors&&""!=e.errors)t.properties.errorObj.show_error_block(e.errors,"error");else if(void 0!==e.success&&""!=e.success){t.properties.errorObj.show_error_block(e.success,"success");var o=$(t.properties.changeLocationBlock).find("[name=region_name]").val()||(void 0!==e.location?e.location:t.properties.langs.link_select_region);$(t.properties.dataChangeLocation).html('<i class="fas fa-map-marker-alt"></i>&nbsp;&nbsp;'+o),$(t.properties.data.fieldLocation+">.field-info").html(o+'<i class="fas fa-pencil-alt"></i>'),e.data.id_region&&t.rebuild("location")}t.properties.contentObj.hide_load_block()},error:function(e,t,o){"undefined"!=typeof console&&console.error(o)}})},this.isTerms=function(e){var o="<h1>"+t.properties.langs.welcome+"</h1>";o+='<div class="form-group">'+e+"</div>",o+='<div class="form-group"><button id="i_agree_terms" class="btn btn-primary">'+t.properties.langs.btnIAgree+"</button></div>",t.properties.contentObj.show_load_block(o)},this.iAgreeTerms=function(){$.ajax({type:"POST",dataType:"JSON",data:{agree:1},url:t.properties.siteUrl+t.properties.url.iAgreeTerms,success:function(e){void 0!==e.success&&(t.properties.contentObj.hide_load_block(),t.properties.errorObj.show_error_block(e.success,"success"))}})},this.availableActivation=function(){$.ajax({type:"GET",dataType:"JSON",url:t.properties.siteUrl+t.properties.getAvailableActivation,success:function(e){if(!$.isEmptyObject(e)){var r=['<button type="button" class="close" data-action="close" data-cookie="available_activation" aria-hidden="true">&times;</button>',"<h3>"+e.info.title+"</h3><div>"+e.info.subtitle+"</div>"];if(void 0!==e.info.items){var i=Object.keys(e.info.items).length,n="";for(var s in e.info.items)n+='<div class="'+o[i-1]+' wrap-block">'+t.activationBlock(e.info.items[s],s)+"</div>";n+='<div class="clearfix"></div>',r.push(n),t.properties.errorObj.showStaticErrorsblock(r,"info")}}}})},this.activationBlock=function(e,o){var r="<div data-available='"+o+"' class='available-block'>";return r+="<div><i class='fas fa-times-circle'></i></div>",r+="<div>"+e.text+"</div>",void 0!==e.button&&0!==e.button.length&&(r+="<button "+t.properties.availableActivationData[o]+" class='btn btn-primary'>"+e.button+"</button>"),r+"</div>"},this.changeProfileAvailable=function(e){t.isActiveService($(e).data("service"),(function(){$(t.properties.data.activateProfile).hide()}),(function(){t.properties.usersProfileAvailableView.getPaymentForm($(e).data("service"))}))},this.isActiveService=function(e,o,r){$.ajax({type:"POST",data:{gid:e},dataType:"JSON",url:t.properties.siteUrl+t.properties.url.isActiveService,success:function(e){0===e.status?(o(),t.properties.errorObj.show_error_block(e.success,"success")):r()}})},this.loadAvatar=function(){void 0!==t.properties.avatarObj.load_avatar?t.properties.avatarObj.load_avatar(1):$(".change-photo-button").trigger("click")},this.rebuild=function(e){$('[data-available="'+e+'"]').closest(t.properties.class.wrapBlock).remove();var r=$(t.properties.class.staticAlertBlock).find(".available-block").length;0===r?$(t.properties.class.staticAlertBlock).remove():$(t.properties.class.wrapBlock).removeClass().addClass("wrap-block "+o[r-1])},t.Init(e)})},8041:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.usersConnections=function(e){this.properties={siteUrl:"",addFacebookId:"#add_facebook",addVkId:"#add_vkontakte",addGoogleId:"#add_google",addTwitterId:"#add_twitter",template:"",contentObj:new loadingContent({loadBlockWidth:"400px",loadBlockLeftType:"center",loadBlockTopType:"top",loadBlockTopPoint:100,closeBtnClass:"w",draggable:!0})};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),t.init_controls(),t.properties.template&&"function"==typeof twig&&twig({id:"users_connections",href:t.properties.template,async:!1})},this.uninit=function(){return $(document).off("click","."+t.properties.addFacebookId).off("click","."+t.properties.addVkId).off("click","."+t.properties.addGoogleId).off("click","."+t.properties.addTwitterId),this},this.init_controls=function(){$(document).off("click",t.properties.addFacebookId).on("click",t.properties.addFacebookId,(function(){t.addAccount($(this))})).off("click",t.properties.addVkId).on("click",t.properties.addVkId,(function(){t.addAccount($(this))})).off("click",t.properties.addGoogleId).on("click",t.properties.addGoogleId,(function(){t.addAccount($(this))})).off("click",t.properties.addTwitterId).on("click",t.properties.addTwitterId,(function(){t.addAccount($(this))}))},this.addAccount=function(e){var o=$("input[name=service_user_id]").val(),r=$("select[name=user_type]").val(),i=e.data("href")+"/"+r+"/"+o;$.ajax({type:"POST",dataType:"html",url:i,success:function(e){t.properties.contentObj.show_load_block(e)}})},t.Init(e)})},2353:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.UsersPayments=function(e){this.properties={siteUrl:"/",id:{paySystemsList:"#payment-list",deficitFunds:"#deficit-funds",userPayData:"#user-pay-data",addFunds:"#add-funds",useSystemGid:"#use-system_gid",savePaymentForm:"#save_payment-form"},class:{},dataAction:{paymentList:'[data-action="payment-list"]',setPaymentSystem:'[data-action="set-payment-system"]',updatePaymentSystem:'[data-action="update-payment-system"]',addPayment:'[data-action="add-payment"]',closeBtn:'[data-action="close"]'},url:{addFunds:"users_payments/addFunds/"},lang:{systemError:"System error!"},errorObj:new Errors,contentObj:new loadingContent({loadBlockWidth:"400px",loadBlockLeftType:"center",loadBlockTopType:"top",loadBlockTopPoint:100,draggable:!0,closeBtnUse:!0,closeBtnClass:"btn-close"})};var t=this,o={};this.Init=function(e){t.properties=$.extend(t.properties,e),t.initControls(),$(t.properties.id.addFunds).focus()},this.initControls=function(){$(document).off("click",t.properties.dataAction.paymentList).on("click",t.properties.dataAction.paymentList,(function(){t.paymentSystemsToggle($(this))})).off("click",t.properties.dataAction.setPaymentSystem).on("click",t.properties.dataAction.setPaymentSystem,(function(){t.setPaymentSystems($(this))})).off("click",t.properties.dataAction.updatePaymentSystem).on("click",t.properties.dataAction.updatePaymentSystem,(function(){t.updatePaymentSystem($(this))})).off("click",t.properties.dataAction.addPayment).on("click",t.properties.dataAction.addPayment,(function(){t.addPayment()})).off("click",t.properties.dataAction.closeBtn).on("click",t.properties.dataAction.closeBtn,(function(){t.properties.contentObj.hide_load_block()})).on("input paste change blur focus keyup select",t.properties.id.addFunds,(function(){t.changeAddPaymentBtnStatus()}))},this.paymentSystemsToggle=function(){$(t.properties.id.paySystemsList).toggle()},this.setPaymentSystems=function(e){t.query(t.properties.url.addFunds,{system:e.data("gid"),price:e.data("price"),send:1},"json",(function(r){e.data("gid")?($(t.properties.id.deficitFunds).html(r.html),o.paymentSystem=e.data("gid")):t.properties.contentObj.show_load_block(r.html)}))},this.updatePaymentSystem=function(e){$(t.properties.id.userPayData).find("img").attr("src",e.data("img")),$(t.properties.id.useSystemGid).val(e.data("gid")),$(".b-billing-systems__link").removeClass("active"),e.addClass("active")},this.addPayment=function(){""!==$(t.properties.id.addFunds).val()&&$(t.properties.id.addFunds).val()>0&&$(t.properties.id.savePaymentForm).submit()},this.changeAddPaymentBtnStatus=function(){""!==$(t.properties.id.addFunds).val()&&$(t.properties.id.addFunds).val()>0?$(t.properties.dataAction.addPayment).prop("disabled",!1):$(t.properties.dataAction.addPayment).prop("disabled",!0)},this.query=function(e,o,r,i){return/^(f|ht)tps?:\/\//i.test(e)||(e=t.properties.siteUrl+e),$.ajax({url:e,type:"POST",cache:!1,data:o,dataType:r,success:function(e){void 0!==e.error&&e.error.length>0&&t.properties.errorObj.show_error_block(e.error,"error"),void 0!==e.info.access_denied&&e.info.access_denied.length>0&&t.properties.contentObj.show_load_block(e.info.access_denied),void 0!==e.success&&e.success.length>0&&t.properties.errorObj.show_error_block(e.success,"success"),void 0!==i&&i(e)}}),!1},t.Init(e)})},991:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.GiftMedia=function(e){this.properties={gallery_name:"giftsgallery",siteUrl:"/",idProduct:0,mediaId:"",count_photo:0,photoSize:"smalle",deleteMediaUrl:"admin/virtual_gifts/product_media_delete_",deleteMediaUrlReplace:"admin/virtual_gifts/ajax_product_media_delete_",viewMediaUrl:"admin/virtual_gifts/ajax_view_product_media",galleryContentDiv:"gift_photos",galleryContentUrl:"admin/virtual_gifts/ajax_get_gift_images",galleryContentParam:"all",refreshRecentPhotosButton:"#refresh_recent_photos",refreshRecentPhotosDiv:"#recent_photo",nextMediaButton:"#next_media",previousMediaButton:"#prev_media",contentDiv:"#image_content",mediaBlock:"#media_",photoRemove:".photo-remove",nextMedia:null,previousMedia:null,all_loaded:0,loading_status:0,lang_delete_confirm:"Are you sure you want to delete this file?",post_data:{},windowObj:new loadingContent({loadBlockWidth:"500px",closeBtnClass:"w",loadBlockTopType:"top",loadBlockTopPoint:20,blockBody:!0,showAfterImagesLoad:!1})};var t=null,o=this;this.Init=function(e){o.properties=$.extend(o.properties,e),o.init_links(),o.init_global_events(),o.init_item_block_info()},this.uninit=function(){$(window).unbind("scroll.media").off("changeParam.gallery"),$("#"+o.properties.galleryContentDiv).off(),$(o.properties.galleryPageButton).unbind(),$(o.properties.filterObj).find("li").unbind(),$(o.properties.albumSelectorContainer).off(),$("#"+o.properties.sorterId).off(),$(o.properties.contentDiv).off("click",o.properties.nextMediaButton).off("click",o.properties.previousMediaButton)},this.init_item_block_info=function(){$("#"+o.properties.galleryContentDiv).off("click",'[data-click="view-media-photo"]').on("click",'[data-click="view-media-photo"]',(function(e){e.preventDefault();var t=$(this).data("id-product")?$(this).data("id-product"):o.properties.idProduct,r=$(this).data("id-media");return o.display_edit_view_form(t,r,"photo"),!1})).off("click",'[data-click="view-media-video"]').on("click",'[data-click="view-media-video"]',(function(e){e.preventDefault();var t=$(this).data("id-product")?$(this).data("id-product"):o.properties.idProduct;return o.display_edit_view_form(t,0,"video"),!1})).off("click",".delete-media").on("click",".delete-media",(function(e){e.preventDefault();var t=$(this).attr("href").replace(o.properties.deleteMediaUrl,o.properties.deleteMediaUrlReplace);return alerts.show({text:o.properties.lang_delete_confirm,type:"confirm",ok_callback:function(){o.delete_media(t)}}),!1})).off("mouseenter",".photo").on("mouseenter",".photo",(function(){$(this).find(".info").stop().slideDown(100)})).off("mouseleave",".photo").on("mouseleave",".photo",(function(){$(this).find(".info").stop(!0).delay(100).slideUp(100)}))},this.init_links=function(){$(o.properties.galleryPageButton).unbind("click").on("click",(function(){o.next_page()})),$(o.properties.refreshRecentPhotosButton).unbind("click").on("click",(function(){o.refresh_recent_photos()})),$(o.properties.contentDiv).off("click",o.properties.nextMediaButton).on("click",o.properties.nextMediaButton,(function(){o.display_next_media()})).off("click",o.properties.previousMediaButton).on("click",o.properties.previousMediaButton,(function(){o.display_previous_media()}))},this.init_sorter=function(){$("#"+o.properties.sorterId).off("change","select").on("change","select",(function(){o.load_content(1,!0)})),$("#"+o.properties.sorterId).off("click",'[data-role="sorter-dir"]').on("click",'[data-role="sorter-dir"]',(function(){$(this).hasClass("up")?$(this).removeClass("up").addClass("down"):$(this).removeClass("down").addClass("up"),o.load_content(1,!0)}))},this.init_global_events=function(){$(window).off("changeParam.gallery").on("changeParam.gallery",(function(e,t){o.properties.galleryContentParam=t}))},this.get_post_data=function(){var e=$.extend(o.properties.post_data,{order:o.properties.order,direction:o.properties.direction,gallery_name:o.properties.gallery_name,place:o.properties.place});return $("#"+o.properties.sorterId).length&&(e.order=$("#"+o.properties.sorterId).find("select").val(),e.direction=$("#"+o.properties.sorterId).find('[data-role="sorter-dir"]').hasClass("up")?"asc":"desc"),e},this.next_page=function(){o.properties.galleryContentPage++,o.load_content()},this.display_edit_view_form=function(e,t,r){var i=o.get_post_data();$.ajax({url:o.properties.siteUrl+o.properties.viewMediaUrl+"/"+r+"/"+e+"/"+t,type:"POST",data:i,dataType:"html",cache:!1,success:function(e){o.properties.windowObj.update_css_styles({width:"962px"}),o.properties.windowObj.show_load_block(e),0==t&&$(o.properties.previousMediaButton).hide(),t==parseInt(o.properties.count_photo)-1&&$(o.properties.nextMediaButton).hide()}})},this.delete_media=function(e){var t=o.get_post_data();$.ajax({url:e,type:"POST",data:t,dataType:"json",cache:!1,success:function(e){1==e.status?(o.reload(),error_object.show_error_block(e.message,"success"),e.data&&e.data.albums_select&&$(o.properties.albumSelectorContainer).html(e.data.albums_select)):error_object.show_error_block(e.message,"error")}})},this.show_content=function(e){o.properties.windowObj.update_css_styles({width:"962px"}),o.properties.windowObj.show_load_block(e)},this.reload=function(){o.properties.galleryContentPage=1,o.properties.all_loaded=0,o.load_content(1)},this.load_content=function(e,r){if(r=r||!1)t&&t.abort(),o.properties.galleryContentPage=1;else if(1==o.properties.all_loaded||o.properties.loading_status)return!0;o.properties.loading_status=1;var i=o.get_post_data();t=$.ajax({url:o.properties.siteUrl+o.properties.galleryContentUrl+"/"+o.properties.idProduct+"/"+o.properties.galleryContentParam+"/"+o.properties.photoSize,type:"POST",data:i,dataType:"json",cache:!1,success:function(t){e?($("#"+o.properties.galleryContentDiv).html(t.content),$("textarea").val("")):$("#"+o.properties.galleryContentDiv).append(t.content),t.have_more?$(o.properties.galleryPageContent).show():(o.properties.all_loaded=1,$(o.properties.galleryPageContent).hide())},complete:function(){o.properties.loading_status=0,0==o.properties.nextMedia&&$(o.properties.nextMediaButton).hide(),0==o.properties.previousMedia&&$(o.properties.previousMediaButton).hide(),$(o.properties.photoRemove).show()}})},this.set_properties=function(e){o.properties=$.extend(o.properties,e)},this.refresh_recent_photos=function(){$.ajax({url:o.properties.siteUrl+o.properties.recentMediaUrl,type:"POST",data:{count:16,upload_gid:"photo"},dataType:"html",cache:!1,success:function(e){$(o.properties.refreshRecentPhotosDiv).html(e)}})},this.display_next_media=function(){$(o.properties.nextMediaButton).show(),o.properties.mediaId<parseInt(o.properties.count_photo)-1?(o.properties.mediaId=parseInt(o.properties.mediaId)+1,$(o.properties.mediaBlock+o.properties.mediaId).click()):$(o.properties.nextMediaButton).hide()},this.display_previous_media=function(){$(o.properties.previousMediaButton).show(),o.properties.mediaId>0?(o.properties.mediaId=parseInt(o.properties.mediaId)-1,$(o.properties.mediaBlock+o.properties.mediaId).click()):$(o.properties.previousMediaButton).hide()},o.Init(e)})},8423:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.ReceiptGift=function(e){this.properties={siteUrl:"",use_form:!0,btnForm:"receipt-gift",cFormId:"virtual_gift_form",urlGetForm:"",urlSendForm:"",id_close:"btn_send_gift",errorObj:new Errors,dataType:"html",contentObj:"",closeCookie:"gift_opened",giftsListId:"receipt_gifts_list"};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$("#"+t.properties.giftsListId).on("click","li",(function(e){e.preventDefault();var o=$(this).find("a").attr("gift-id");return t.properties.use_form&&t.get_form(o,!0),!1})),t.properties.contentObj=new loadingContent({loadBlockWidth:"50%",closeBtnClass:"w",scroll:!0,closeBtnPadding:5,blockBody:!0,onClose:t.setCloseCookie})},this.get_form=function(e,o){var r=void 0!==o;return $.ajax({url:t.properties.siteUrl+t.properties.urlGetForm,type:"POST",cache:!1,data:{gift_id:e},dataType:t.properties.dataType,success:function(e){if(t.isJson(e)){var o=JSON.parse(e);o.errors?error_object.show_error_block(o.errors,"error"):!o.info||"virtual_gifts/ajax_get_receipt_gift"==t.properties.urlGetForm&&!0!==r||t.properties.contentObj.show_load_block(o.info.access_denied)}else t.properties.contentObj.show_load_block(e),$("#"+t.properties.id_close).unbind().on("click",(function(){return t.clearBox(),!1}))}}),!1},this.getCloseCookie=function(){return lightGetCookie(t.properties.closeCookie)},this.setCloseCookie=function(){document.cookie=t.properties.closeCookie+"=1;path=/"},this.delCloseCookie=function(){var e=new Date;e.setTime(e.getTime()-1),document.cookie=t.properties.closeCookie+"=;path=/;expires="+e.toGMTString()},this.send_form=function(e){return $.ajax({url:t.properties.siteUrl+t.properties.urlSendForm,type:"POST",data:e,dataType:"json",cache:!1,success:function(e){void 0!==e.error&&""!=e.error?t.properties.errorObj.show_error_block(e.error,"error"):(t.properties.errorObj.show_error_block(e.success,"success"),t.properties.contentObj.hide_load_block())}}),!1},this.clearBox=function(){var e=$("#"+t.properties.cFormId).serialize();t.send_form(e)},this.isJson=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},t.Init(e)})},1950:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.SendGift=function(e){this.properties={siteUrl:"",use_form:!0,btnForm:"btn-virtual_gift",cFormId:"virtual_gift_form",urlGetForm:"",urlSendForm:"",id_close:"btn_send_gift",errorObj:new Errors,contentObj:new loadingContent({loadBlockWidth:"50%",closeBtnClass:"w",scroll:!0,closeBtnPadding:5,blockBody:!0})};var t=this;this.Init=function(e){t.properties=$.extend(t.properties,e),$("#"+t.properties.btnForm).on("click",(function(){t.properties.use_form&&t.get_form()})).show()},this.isJson=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},this.get_form=function(){$.ajax({url:t.properties.siteUrl+t.properties.urlGetForm,type:"POST",cache:!1,dataType:"json",success:function(e){return void 0!==e.errors&&e.errors.length>0?(error_object.show_error_block(e.errors,"error"),!1):void 0!==e.info.access_denied&&e.info.access_denied.length>0?(t.properties.contentObj.properties.onClose=function(){$("body").removeClass("blur-page fixed-top").find(".pjaxcontainer-inner").removeClass("blur-it")},t.properties.contentObj.show_load_block(e.info.access_denied),!1):(t.properties.contentObj.show_load_block(e.content),void $("#"+t.properties.id_close).unbind().on("click",(function(){t.clearBox()})))}})},this.send_form=function(e){$.ajax({url:t.properties.siteUrl+t.properties.urlSendForm,type:"POST",data:e,dataType:"json",cache:!1,success:function(e){void 0!==e.error&&""!=e.error?t.properties.errorObj.show_error_block(e.error,"error"):(t.properties.errorObj.show_error_block(e.success,"success"),t.properties.contentObj.hide_load_block())}})},this.clearBox=function(){var e=$("#"+t.properties.cFormId).serialize();t.send_form(e)},t.Init(e)})},9845:(e,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.Wall=function(){this.properties={id:"wall",place:"myprofile",id_wall:0,id_user:0,url_load:"/wall_events/ajax_get_events/all/",url_load_new:"/wall_events/ajax_get_events/new/",url_post:"/wall_events/ajax_post/",url_delete:"/wall_events/ajax_post_delete/",view_button_title:"View more...",placeholder:"",onInit:function(){},load_on_scroll:0,all_loaded:0,max_id:0,min_id:0,uploaded:!1,gallery:null,next_gallery_image:null,prev_gallery_image:null,images:[],errorObj:new Errors,image_lng:"Image",btnOk:"OK",btnCancel:"Cancel"};var e,t=0,o=0,r=0,i=this;return this.init=function(e){return $.extend(i.properties,e),$("#"+i.properties.id).html("").append('<div id="'+i.properties.id+'_events"></div><div id="'+i.properties.id+'_btn"></div>'),$("#"+i.properties.id+"_btn").append('<div class="show-more-btn center"><input type="button" class="btn btn-secondary" value="'+i.properties.view_button_title+'" /></div>').on("click",'input[type="button"]',(function(){i.loadEvents()})).find('input[type="button"]').hide(),i.properties.load_on_scroll&&setTimeout((function(){i.setLoadOnScroll(1,1)}),500),i.properties.gallery=new loadingContent({loadBlockID:"wall_gallery",loadBlockWidth:"400px",loadBlockLeftType:"center",loadBlockTopType:"top",loadBlockTopPoint:100,showAfterImagesLoad:!0,closeBtnClass:"w"}),i.properties.onInit(),this},this.bind_delete=function(){$(".delete_wall_event, .js-delete_wall_event").off("click").on("click",(function(e){e.preventDefault();var t=$(this).data("id"),o=$(this).data("message");i.viewAlert(o,"deletePost",t)}))},this.viewAlert=function(e,t,o){var r=new loadingContent({loadBlockWidth:"50%",closeBtnClass:"w",scroll:!0,otherClass:"alert_load",closeBtnPadding:5,blockBody:!0}).show_load_block('<div class="center"><div class="alert_text">'+e+'</div><button class="alert_ok alert_ok_delete btn btn-primary mt20 mlr20">'+i.properties.btnOk+'</button> <button class="alert_cancel alert_cancel_delete btn btn-cancel mt20 mlr20">'+i.properties.btnCancel+"</button></div>");$(".alert_ok.alert_ok_delete").unbind("click").on("click",(function(){i[t](o),$(".load_content_close").click(),$("#"+r).parent().hide()})),$(".alert_cancel.alert_cancel_delete").unbind("click").on("click",(function(){$(".load_content_close").click(),$("#"+r).parent().hide()}))},this.bindViewGallery=function(){$("#"+i.properties.id).off("click",".wall-gallery div").on("click",".wall-gallery div",(function(){i.initGallery($(this).children("img").get())}))},this.uninit=function(){return $("#"+i.properties.id+"_btn").off("click",'input[type="button"]'),$(window).unbind("scroll",e),!0},this.nextGalleryImage=function(){i.setGalleryImage(i.properties.next_gallery_image)},this.prevGalleryImage=function(){i.setGalleryImage(i.properties.prev_gallery_image)},this.initGallery=function(e){if(e){var t=$(e).parents(".wall-gallery").attr("gallery");i.properties.images=$('.wall-gallery[gallery="'+t+'"]').find("img"),i.properties.images.length>1&&(i.properties.gallery.create_right((function(){i.nextGalleryImage(),i.properties.gallery.reposition_load_block()})),i.properties.gallery.create_left((function(){i.prevGalleryImage(),i.properties.gallery.reposition_load_block()}))),i.setGalleryImage(e)}return this},this.setGalleryImage=function(e){if(i.properties.images.length){var t=i.properties.images[0],o=i.properties.images[i.properties.images.length-1],r="1 / "+i.properties.images.length;$.each(i.properties.images,(function(n){i.properties.images[n].getAttribute("src")==$(e).attr("src")&&(void 0!==i.properties.images[+n+1]&&(t=i.properties.images[+n+1]),void 0!==i.properties.images[+n-1]&&(o=i.properties.images[+n-1]),r=+n+1+" / "+i.properties.images.length)})),i.properties.next_gallery_image=t,i.properties.prev_gallery_image=o;var n='<img class="hide" src="'+$(o).attr("gallery-src")+'" />',s=($(t).attr("gallery-src"),'<img class="img-responsive" src="'+$(e).attr("gallery-src")+'" />'),a='<div class="gallery-window load_content"><h1>'+i.properties.image_lng+" "+r+"</h1>"+n+s+"</div>";i.properties.gallery.show_load_block(a,!0)}},this.setLoadOnScroll=function(t,o){return o=o||0,e=function(){var e=$("#"+i.properties.id+"_btn").offset(),t=window.innerHeight?window.innerHeight:$(window).height();e&&$(window).scrollTop()>=e.top-t+100&&i.loadEvents()},!t||i.properties.load_on_scroll&&!o?(i.properties.load_on_scroll=0,$(window).unbind("scroll",e)):(i.properties.load_on_scroll=1,$(window).on("scroll",e)),this},this.loadEvents=function(e,o){if(e=e||"all",o=o||null,i.properties.all_loaded&&"new"!=e||t)return this;t=1,$("#"+i.properties.id+"_btn").find('input[type="button"]').attr("disabled","disabled");var r={min_id:i.properties.min_id,max_id:i.properties.max_id,place:i.properties.place,id_user:i.properties.id_user,id_wall:i.properties.id_wall},n="new"==e?i.properties.url_load_new:i.properties.url_load;return $.ajax({type:"POST",url:n,data:r,success:function(r,n,s){i.properties.all_loaded=r.all_loaded,(r.min_id<i.properties.min_id||0==i.properties.min_id)&&(i.properties.min_id=r.min_id),(r.max_id>i.properties.max_id||0==i.properties.max_id)&&(i.properties.max_id=r.max_id),r.html&&""!=r.html&&("new"==e?$("#"+i.properties.id+"_events").prepend($(r.html)):$("#"+i.properties.id+"_events").append($(r.html))),"new"!=e?r.all_loaded?$("#"+i.properties.id+"_btn").find('input[type="button"]').hide():$("#"+i.properties.id+"_btn").find('input[type="button"]').removeAttr("disabled").show():$("#"+i.properties.id+"_btn").find('input[type="button"]').removeAttr("disabled"),t=0,"function"==typeof o&&o(),i.bind_delete(),i.bindViewGallery()},error:function(o,r,n){t=0,"undefined"!=typeof console&&console.error(n),$("#"+i.properties.id+"_btn").find('input[type="button"]').removeAttr("disabled"),"new"!=e&&$("#"+i.properties.id+"_btn").find('input[type="button"]').show()},dataType:"json"}),this},this.newPost=function(e){e=e||null;var t=i.trimStr($("#wall_post_text").val()),o=i.trimStr($("#wall_embed_code").val());return r||!t&&!o||(r=1,$.ajax({type:"POST",url:i.properties.url_post,data:{post:{text:t,embed_code:o,place:i.properties.place,min_id:i.properties.min_id,max_id:i.properties.max_id,id_user:i.properties.id_user,id_wall:i.properties.id_wall}},success:function(t,o,n){if(1==t.status?($("#wall_post_text").val(""),$("#wall_embed_code").val(""),t.joined_id&&$("#wall_event_"+t.joined_id).remove()):t.error,t.msg){var s=t.error?"error":"success";i.properties.errorObj.show_error_block(t.msg,s)}"function"==typeof e&&e(),r=0},error:function(e,t,o){r=0,"undefined"!=typeof console&&console.error(o)},dataType:"json"})),this},this.deletePost=function(e){return e=e||0,o||!e||(o=1,$.ajax({type:"POST",url:i.properties.url_delete,data:{event_id:e},success:function(t,r,n){1==t.status&&$("#wall_event_"+e).remove(),t.msg&&i.properties.errorObj.show_error_block(t.msg,"success"),o=0},error:function(e,t,r){o=0,"undefined"!=typeof console&&console.error(r)},dataType:"json"})),this},this.trimStr=function(e){return(e=e.replace(/^\s+/g,"")).replace(/\s+$/g,"")},this})},8912:()=>{!function(e,t){"use strict";var o,r;if(e.uaMatch=function(e){e=e.toLowerCase();var t=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],o=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||[];return{browser:t[3]||t[1]||"",version:t[2]||"0",platform:o[0]||""}},r={},(o=e.uaMatch(t.navigator.userAgent)).browser&&(r[o.browser]=!0,r.version=o.version,r.versionNumber=parseInt(o.version)),o.platform&&(r[o.platform]=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),r.rv){var i="msie";o.browser=i,r[i]=!0}if(r.opr){var n="opera";o.browser=n,r[n]=!0}if(r.safari&&r.android){var s="android";o.browser=s,r[s]=!0}r.name=o.browser,r.platform=o.platform,e.browser=r}(jQuery,window)},8873:()=>{!function(e){var t,o,r,i,n=1,s=this,a=!1,c=s.postMessage&&!e.browser.opera;e.postMessage=function(t,o,r){o&&(t="string"==typeof t?t:e.param(t),r=r||parent,c?r.postMessage(t,o.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):o&&(r.location=o.replace(/#.*$/,"")+"#"+ +new Date+n+++"&"+t))},e.receiveMessage=i=function(n,p,l){c?(n&&(r&&i(),r=function(t){if("string"==typeof p&&t.origin!==p||e.isFunction(p)&&p(t.origin)===a)return a;n(t)}),s.addEventListener?s[n?"addEventListener":"removeEventListener"]("message",r,a):s[n?"attachEvent":"detachEvent"]("onmessage",r)):(t&&clearInterval(t),t=null,n&&(l="number"==typeof p?p:"number"==typeof l?l:100,t=setInterval((function(){var e=document.location.hash,t=/^#?\d+&/;e!==o&&t.test(e)&&(o=e,n({data:e.replace(t,"")}))}),l)))}}(jQuery)},1189:(e,t)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}"object"===o(t)&&(t.__esModule=!0,t.winks=function(e){var t=this;this.properties={siteUrl:"/",btnSearch:"#winks-search-button",btnWink:".btn-wink",btnWinkBack:".btn-wink-back",btnWinkIgnore:".btn-wink-ignore",dataNew:"is-new",dataPending:"is-pending",errIsPending:"Already winked",errIsOnList:"Already in the list",wink:".wink",list:"#winks-list",noWinks:"#no-winks",replyUrl:"winks/ajax_reply",searchUrl:"users/search",succIgnored:"Ignored",succResponded:"Responded",succWinked:"Winked",titleWink:"Wink",titleWinkBack:"Wink back",winkUrl:"winks/ajax_wink",wink_button_rand:"",repliedWinksClass:".replied-winks",contentObj:new loadingContent({loadBlockWidth:"50%",closeBtnClass:"w",scroll:!0,closeBtnPadding:5,blockBody:!0})};var o=new Errors,r=function(e,o){return $.ajax({data:o,dataType:"json",type:"POST",url:t.properties.siteUrl+e})};this.Init=function(e){t.properties=$.extend(t.properties,e),t.uninit(),t.bindEvents()},this.uninit=function(){$(t.properties.btnWink).off("click"),$(t.properties.btnWinkBack).off("click"),$(t.properties.btnWinkIgnore).off("click")},this.hideRepliedWinks=function(){$(t.properties.repliedWinksClass).each((function(e,t){setTimeout((function(){$(t).fadeOut(5e3)}),5e3*e)}))},this.getPageIds=function(){var e=0,o=[];return $(t.properties.wink,t.properties.list).each((function(){(e=parseInt($(this).data("user-id")))>0&&o.push(e)})),o},this.addUserToList=function(e){if(in_array(e.id,t.getPageIds())){var r=t.properties.errIsOnList.replace(/\[username\]/,e.output_name);return o.show_error_block(r,"error"),!1}var i=$("#wink-_user-id_").outerHTML();i=i.replace(/_user\-id_/g,e.id).replace(/_user\-name_/g,e.output_name).replace(/_user\-link_/g,t.properties.siteUrl+"users/view/"+e.id).replace(/_date_/g,"").replace(/\[img\]/g,'<img src="'+e.media.user_logo.thumbs.small+'" alt="'+e.output_name+'">'),$(t.properties.list).prepend($(i).removeClass("hide-always")),$(t.properties.noWinks).hide(),t.bindEvents()},this.hideFromList=function(e){$("#wink-"+e).remove(),1===$(".wink").length&&$(t.properties.noWinks).show()},this.bindEvents=function(){t.uninit(),$(t.properties.btnWink).on("click",(function(){var e=$(this);if(e.data(t.properties.dataPending)||e.hasClass("link-disabled"))o.show_error_block(t.properties.errIsPending,"error");else{var i=e.data("user-id");r(t.properties.winkUrl,{user_id:i,type:"new"}).done((function(e){if(e.errors)o.show_error_block(e.errors,"error");else{if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return t.properties.contentObj.show_load_block(e.info.access_denied),!1;$(t.properties.btnWink).each((function(){i==$(this).data("user-id")&&($(this).find("i").addClass("g"),$(this).hasClass("btn")?$(this).removeClass("btn-primary").addClass("btn-disabled"):($(this).addClass("link-disabled"),$(this).data("is-new",""),$(this).data("is-pending",1)),$(this).data(t.properties.dataNew,!1),$(this).data(t.properties.dataPending,!0))})),t.hideFromList(i),o.show_error_block(t.properties.succWinked,"success"),sendAnalytics("winks_send_message","communication","user"),t.bindEvents()}})).fail((function(e){console.error(e)}))}})),$(t.properties.btnWinkBack).on("click",(function(){var e=$(this),i=e.data("user-id");e.data(t.properties.dataPending)?o.show_error_block(t.properties.errIsPending,"error"):r(t.properties.replyUrl,{user_id:i,type:"replied"}).done((function(e){if(void 0!==e.info.access_denied&&e.info.access_denied.length>0)return t.properties.contentObj.show_load_block(e.info.access_denied),!1;$(t.properties.btnWinkBack).each((function(){i===$(this).data("user-id")&&($(this).attr("title",t.properties.titleWink),$(this).find("i").addClass("g"),$(this).css("color","#808080"),$(this).data(t.properties.dataPending,!0),$(this).data(t.properties.dataNew,!1))})),t.hideFromList(i),o.show_error_block(t.properties.succResponded,"success"),t.bindEvents()})).fail((function(e){console.error("error")}))})),$(t.properties.btnWinkIgnore).on("click",(function(){var e=$(this).data("user-id");r(t.properties.replyUrl,{user_id:e,type:"ignored"}).done((function(r){if(void 0!==r.info.access_denied&&r.info.access_denied.length>0)return t.properties.contentObj.show_load_block(r.info.access_denied),!1;o.show_error_block(t.properties.succIgnored,"success"),t.hideFromList(e)})).fail((function(e){console.error("error")}))})),$(t.properties.btnSearch).on("click",(function(){redirect(t.properties.siteUrl+t.properties.searchUrl)}))},t.Init(e)})}},__webpack_module_cache__={};function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};window.AccessPermissions=__webpack_require__(7398).AccessPermissions,window.AdminAccessPermissions=__webpack_require__(8582).AdminAccessPermissions,window.Associations=__webpack_require__(6571).Associations,window.audio=__webpack_require__(2169).audio,window.AdminBanners=__webpack_require__(9857).AdminBanners,window.BannerActivate=__webpack_require__(5550).BannerActivate,window.Banners=__webpack_require__(6274).Banners,window.blacklist=__webpack_require__(6669).blacklist,window.BonusesAdmin=__webpack_require__(9388).BonusesAdmin,window.bonusesContent=__webpack_require__(3452).bonusesContent,window.Chatbox=__webpack_require__(6848).Chatbox,window.adminChats=__webpack_require__(1036).adminChats,window.flashchatAdmin=__webpack_require__(7869).flashchatAdmin,window.Oovoochat=__webpack_require__(4536).Oovoochat,__webpack_require__(388),__webpack_require__(638),window.PG_videochat=__webpack_require__(3670).PG_videochat,window.Comments=__webpack_require__(7162).Comments,window.CompanionsAvatar=__webpack_require__(4746).CompanionsAvatar,window.Companions=__webpack_require__(9870).Companions,window.requestSelect=__webpack_require__(751).requestSelect,window.cookiePolicy=__webpack_require__(6959).cookiePolicy,window.InstallLocations=__webpack_require__(296).InstallLocations,window.adminCountriesSelected=__webpack_require__(4015).adminCountriesSelected,window.adminCountries=__webpack_require__(3126).adminCountries,window.sortLocations=__webpack_require__(8372).sortLocations,window.locationAutocomplete=__webpack_require__(9879).locationAutocomplete,window.locationPopUp=__webpack_require__(2680).locationPopUp,window.dashboardAdmin=__webpack_require__(4366).dashboardAdmin,window.EventsAvatar=__webpack_require__(3636).EventsAvatar,window.Events=__webpack_require__(7417).Events,window.eventsCalendar=__webpack_require__(5032).eventsCalendar,window.events_media=__webpack_require__(2972).events_media,window.events_users=__webpack_require__(5634).events_users,window.fastNavigationAdmin=__webpack_require__(534).fastNavigationAdmin,window.favorites=__webpack_require__(3145).favorites,window.fieldEditorSelect=__webpack_require__(3800).fieldEditorSelect,window.formFields=__webpack_require__(3408).formFields,window.formFields=__webpack_require__(7092).formFields,window.friendsInput=__webpack_require__(3519).friendsInput,window.usersSelect=__webpack_require__(7952).usersSelect,window.ListsLinks=__webpack_require__(6282).ListsLinks,__webpack_require__(6370),window.BingMapsv7_Geocoder=__webpack_require__(6647).BingMapsv7_Geocoder,window.GoogleMapsv3_Geocoder=__webpack_require__(9895).GoogleMapsv3_Geocoder,window.YandexMapsv2_Geocoder=__webpack_require__(7611).YandexMapsv2_Geocoder,window.BingMapsv7=__webpack_require__(8827).BingMapsv7,window.geomapAmenitySelect=__webpack_require__(7470).geomapAmenitySelect,window.GoogleMapsv3=__webpack_require__(9557).GoogleMapsv3,__webpack_require__(9367),window.YandexMapsv2=__webpack_require__(2240).YandexMapsv2,__webpack_require__(4740),window.GuidedSetup=__webpack_require__(250).GuidedSetup,window.Im=__webpack_require__(4295).Im,window.registerFormInput=__webpack_require__(4137).registerFormInput,window.productInstall=__webpack_require__(9281).productInstall,window.Kisses=__webpack_require__(2975).Kisses,window.Landings=__webpack_require__(8631).Landings,window.langEditor=__webpack_require__(2404).langEditor,window.LikeMe=__webpack_require__(689).LikeMe,window.MatchMe=__webpack_require__(1166).MatchMe,window.Likes=__webpack_require__(7771).Likes,window.adminMailList=__webpack_require__(9627).adminMailList,window.mailbox=__webpack_require__(2035).mailbox,window.albums=__webpack_require__(9171).albums,window.editMedia=__webpack_require__(2050).editMedia,window.gallery=__webpack_require__(8218).gallery,window.media=__webpack_require__(2011).media,window.mainMenu=__webpack_require__(3616).mainMenu,window.menuBookmark=__webpack_require__(7469).menuBookmark,window.mobileTopMenu=__webpack_require__(8217).mobileTopMenu,window.App=__webpack_require__(8907).App,window.NearestUsers=__webpack_require__(8666).NearestUsers,__webpack_require__(7780),window.PaymentsCardForm=__webpack_require__(7018).PaymentsCardForm,window.AdminPaymentsSettings=__webpack_require__(1900).AdminPaymentsSettings,window.adminPayments=__webpack_require__(1618).adminPayments,window.PaymentSystemTarifs=__webpack_require__(8743).PaymentSystemTarifs,window.PollsList=__webpack_require__(4864).PollsList,window.adminPolls=__webpack_require__(1717).adminPolls,window.adminPollsAnswers=__webpack_require__(9391).adminPollsAnswers,window.Polls=__webpack_require__(9896).Polls,window.Postbacks=__webpack_require__(3091).Postbacks,window.Questions=__webpack_require__(7731).Questions,window.Ratings=__webpack_require__(5264).Ratings,window.RatingsForm=__webpack_require__(1744).RatingsForm,window.RatingsList=__webpack_require__(4174).RatingsList,window.Ratings=__webpack_require__(5780).Ratings,window.Referral_links=__webpack_require__(9365).Referral_links,window.SendMoney=__webpack_require__(5217).SendMoney,window.SendVip=__webpack_require__(2378).SendVip,window.seoUrlCreator=__webpack_require__(6935).seoUrlCreator,window.Services=__webpack_require__(9638).Services,window.Shoutbox=__webpack_require__(9802).Shoutbox,window.Spam=__webpack_require__(314).Spam,__webpack_require__(9653),window.storeBanners=__webpack_require__(6854).storeBanners,window.langInlineEditor=__webpack_require__(5818).langInlineEditor,window.checkBox=__webpack_require__(2853).checkBox,window.date_formats=__webpack_require__(8040).date_formats,window.guide=__webpack_require__(735).guide,window.hlBox=__webpack_require__(7139).hlBox,window.langInlineEditor=__webpack_require__(5177).langInlineEditor,window.options=__webpack_require__(6075).options,window.radio=__webpack_require__(3156).radio,window.search=__webpack_require__(3694).search,window.selectBox=__webpack_require__(697).selectBox,window.StatisticsAdmin=__webpack_require__(7536).StatisticsAdmin,window.Statistics=__webpack_require__(2229).Statistics,window.AdminStore=__webpack_require__(3403).AdminStore,window.storeCart=__webpack_require__(6564).storeCart,window.storeList=__webpack_require__(3434).storeList,window.store_media=__webpack_require__(6888).store_media,window.storeOrders=__webpack_require__(9443).storeOrders,window.tickets=__webpack_require__(4519).tickets,window.TwilioChat=__webpack_require__(290).TwilioChat,window.TwilioChatVideo=__webpack_require__(2815).TwilioChatVideo,__webpack_require__(7591),__webpack_require__(4237),window.UserInformation=__webpack_require__(1202).UserInformation,window.UsersFieldsValidation=__webpack_require__(6999).UsersFieldsValidation,window.UsersRegistration=__webpack_require__(8337).UsersRegistration,window.UsersSearch=__webpack_require__(43).UsersSearch,window.usersSelected=__webpack_require__(1654).usersSelected,window.topMenu=__webpack_require__(1758).topMenu,window.UsersAuth=__webpack_require__(4758).UsersAuth,window.UsersAvatar=__webpack_require__(7276).UsersAvatar,window.usersInput=__webpack_require__(5255).usersInput,window.usersList=__webpack_require__(367).usersList,window.usersMap=__webpack_require__(1143).usersMap,window.usersSelect=__webpack_require__(4520).usersSelect,window.usersSettings=__webpack_require__(1639).usersSettings,window.usersConnections=__webpack_require__(8041).usersConnections,window.UsersPayments=__webpack_require__(2353).UsersPayments,window.GiftMedia=__webpack_require__(991).GiftMedia,window.ReceiptGift=__webpack_require__(8423).ReceiptGift,window.SendGift=__webpack_require__(1950).SendGift,window.Wall=__webpack_require__(9845).Wall,__webpack_require__(8912),__webpack_require__(8873),window.winks=__webpack_require__(1189).winks})();